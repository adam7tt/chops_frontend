(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors"],{"001a":function(t,e,n){"use strict";function r(t){return t&&"object"===typeof t&&"default"in t?t["default"]:t}Object.defineProperty(e,"__esModule",{value:!0});var i=r(n("c23d")),o=n("9ab4"),a={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},s=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return o.__extends(e,t),e}(Error);function u(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}}function c(t,e,n){var r=u(t),i=r,o=void 0;try{var c=e&&e.error;if(c){var h=c.status;if("string"===typeof h){if(!a[h])return new s("internal","internal");r=a[h],i=h}var l=c.message;"string"===typeof l&&(i=l),o=c.details,void 0!==o&&(o=n.decode(o))}}catch(f){}return"ok"===r?null:new s(r,i,o)}var h=function(){function t(t){this.app=t}return t.prototype.getAuthToken=function(){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.app.INTERNAL.getToken()];case 1:return t=e.sent(),t?[2,t.accessToken]:[2,void 0];case 2:return e.sent(),[2,void 0];case 3:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e;return o.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.app.messaging?(t=this.app.messaging(),[4,t.getToken()]):[2,void 0];case 1:return e=n.sent(),e?[2,e]:[2,void 0];case 2:return n.sent(),[2,void 0];case 3:return[2]}}))}))},t.prototype.getContext=function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e;return o.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}(),l="type.googleapis.com/google.protobuf.Int64Value",f="type.googleapis.com/google.protobuf.UInt64Value";
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var d=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"===typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"===typeof t||"object"===typeof t)return p(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case l:case f:var n=Number(t["value"]);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"===typeof t||"object"===typeof t?p(t,(function(t){return e.decode(t)})):t},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m(t){return new Promise((function(e,n){setTimeout((function(){n(new s("deadline-exceeded","deadline-exceeded"))}),t)}))}var y=function(){function t(t,e){var n=this;void 0===e&&(e="us-central1"),this.app_=t,this.region_=e,this.serializer=new d,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return n.deleteService()}},this.contextProvider=new h(t),this.cancelAllRequests=new Promise((function(t){n.deleteService=function(){return t()}}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId,n=this.region_;if(null!==this.emulatorOrigin){var r=this.emulatorOrigin;return r+"/"+e+"/"+n+"/"+t}return"https://"+n+"-"+e+".cloudfunctions.net/"+t},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i;return o.__generator(this,(function(o){switch(o.label){case 0:n.append("Content-Type","application/json"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return r=o.sent(),[3,4];case 3:return o.sent(),[2,{status:0,json:null}];case 4:i=null,o.label=5;case 5:return o.trys.push([5,7,,8]),[4,r.json()];case 6:return i=o.sent(),[3,8];case 7:return o.sent(),[3,8];case 8:return[2,{status:r.status,json:i}]}}))}))},t.prototype.call=function(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i,a,u,h,l,f,p,d;return o.__generator(this,(function(o){switch(o.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},a=new Headers,[4,this.contextProvider.getContext()];case 1:return u=o.sent(),u.authToken&&a.append("Authorization","Bearer "+u.authToken),u.instanceIdToken&&a.append("Firebase-Instance-ID-Token",u.instanceIdToken),h=n.timeout||7e4,[4,Promise.race([this.postJSON(r,i,a),m(h),this.cancelAllRequests])];case 2:if(l=o.sent(),!l)throw new s("cancelled","Firebase Functions instance was deleted.");if(f=c(l.status,l.json,this.serializer),f)throw f;if(!l.json)throw new s("internal","Response is not valid JSON object.");if(p=l.json.data,"undefined"===typeof p&&(p=l.json.result),"undefined"===typeof p)throw new s("internal","Response is missing data field.");return d=this.serializer.decode(p),[2,{data:d}]}}))}))},t}(),g="functions";
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v(t,e,n){return new y(t,n)}function b(t){var e={Functions:y};t.INTERNAL.registerService(g,v,e,void 0,!0)}b(i),e.registerFunctions=b},"01f9":function(t,e,n){"use strict";var r=n("2d00"),i=n("5ca1"),o=n("2aba"),a=n("32e9"),s=n("84f2"),u=n("41a0"),c=n("7f20"),h=n("38fd"),l=n("2b4c")("iterator"),f=!([].keys&&"next"in[].keys()),p="@@iterator",d="keys",m="values",y=function(){return this};t.exports=function(t,e,n,g,v,b,_){u(n,e,g);var w,T,E,S=function(t){if(!f&&t in N)return N[t];switch(t){case d:return function(){return new n(this,t)};case m:return function(){return new n(this,t)}}return function(){return new n(this,t)}},C=e+" Iterator",I=v==m,A=!1,N=t.prototype,k=N[l]||N[p]||v&&N[v],D=k||S(v),x=v?I?S("entries"):D:void 0,O="Array"==e&&N.entries||k;if(O&&(E=h(O.call(new t)),E!==Object.prototype&&E.next&&(c(E,C,!0),r||"function"==typeof E[l]||a(E,l,y))),I&&k&&k.name!==m&&(A=!0,D=function(){return k.call(this)}),r&&!_||!f&&!A&&N[l]||a(N,l,D),s[e]=D,s[C]=y,v)if(w={values:I?D:S(m),keys:b?D:S(d),entries:x},_)for(T in w)T in N||o(N,T,w[T]);else i(i.P+i.F*(f||A),e,w);return w}},"02f4":function(t,e,n){var r=n("4588"),i=n("be13");t.exports=function(t){return function(e,n){var o,a,s=String(i(e)),u=r(n),c=s.length;return u<0||u>=c?t?"":void 0:(o=s.charCodeAt(u),o<55296||o>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):a-56320+(o-55296<<10)+65536)}}},"07e3":function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},"097d":function(t,e,n){"use strict";var r=n("5ca1"),i=n("8378"),o=n("7726"),a=n("ebd6"),s=n("bcaa");r(r.P+r.R,"Promise",{finally:function(t){var e=a(this,i.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then((function(){return n}))}:t,n?function(n){return s(e,t()).then((function(){throw n}))}:t)}})},"0a06":function(t,e,n){"use strict";var r=n("c532"),i=n("30b5"),o=n("f6b4"),a=n("5270"),s=n("4a7b");function u(t){this.defaults=t,this.interceptors={request:new o,response:new o}}u.prototype.request=function(t){"string"===typeof t?(t=arguments[1]||{},t.url=arguments[0]):t=t||{},t=s(this.defaults,t),t.method=t.method?t.method.toLowerCase():"get";var e=[a,void 0],n=Promise.resolve(t);this.interceptors.request.forEach((function(t){e.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){e.push(t.fulfilled,t.rejected)}));while(e.length)n=n.then(e.shift(),e.shift());return n},u.prototype.getUri=function(t){return t=s(this.defaults,t),i(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(t){u.prototype[t]=function(e,n){return this.request(r.merge(n||{},{method:t,url:e}))}})),r.forEach(["post","put","patch"],(function(t){u.prototype[t]=function(e,n,i){return this.request(r.merge(i||{},{method:t,url:e,data:n}))}})),t.exports=u},"0d58":function(t,e,n){var r=n("ce10"),i=n("e11e");t.exports=Object.keys||function(t){return r(t,i)}},"0df6":function(t,e,n){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},"0fc9":function(t,e,n){var r=n("3a38"),i=Math.max,o=Math.min;t.exports=function(t,e){return t=r(t),t<0?i(t+e,0):o(t,e)}},"11e9":function(t,e,n){var r=n("52a7"),i=n("4630"),o=n("6821"),a=n("6a99"),s=n("69a8"),u=n("c69a"),c=Object.getOwnPropertyDescriptor;e.f=n("9e1e")?c:function(t,e){if(t=o(t),e=a(e,!0),u)try{return c(t,e)}catch(n){}if(s(t,e))return i(!r.f.call(t,e),t[e])}},1495:function(t,e,n){var r=n("86cc"),i=n("cb7c"),o=n("0d58");t.exports=n("9e1e")?Object.defineProperties:function(t,e){i(t);var n,a=o(e),s=a.length,u=0;while(s>u)r.f(t,n=a[u++],e[n]);return t}},1654:function(t,e,n){"use strict";var r=n("71c1")(!0);n("30f1")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})}))},1691:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},1991:function(t,e,n){var r,i,o,a=n("9b43"),s=n("31f4"),u=n("fab2"),c=n("230e"),h=n("7726"),l=h.process,f=h.setImmediate,p=h.clearImmediate,d=h.MessageChannel,m=h.Dispatch,y=0,g={},v="onreadystatechange",b=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},_=function(t){b.call(t.data)};f&&p||(f=function(t){var e=[],n=1;while(arguments.length>n)e.push(arguments[n++]);return g[++y]=function(){s("function"==typeof t?t:Function(t),e)},r(y),y},p=function(t){delete g[t]},"process"==n("2d95")(l)?r=function(t){l.nextTick(a(b,t,1))}:m&&m.now?r=function(t){m.now(a(b,t,1))}:d?(i=new d,o=i.port2,i.port1.onmessage=_,r=a(o.postMessage,o,1)):h.addEventListener&&"function"==typeof postMessage&&!h.importScripts?(r=function(t){h.postMessage(t+"","*")},h.addEventListener("message",_,!1)):r=v in c("script")?function(t){u.appendChild(c("script"))[v]=function(){u.removeChild(this),b.call(t)}}:function(t){setTimeout(a(b,t,1),0)}),t.exports={set:f,clear:p}},"1af6":function(t,e,n){var r=n("63b6");r(r.S,"Array",{isArray:n("9003")})},"1bc3":function(t,e,n){var r=n("f772");t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},"1c4c":function(t,e,n){"use strict";var r=n("9b43"),i=n("5ca1"),o=n("4bf8"),a=n("1fa8"),s=n("33a4"),u=n("9def"),c=n("f1ae"),h=n("27ee");i(i.S+i.F*!n("5cc5")((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,i,l,f=o(t),p="function"==typeof this?this:Array,d=arguments.length,m=d>1?arguments[1]:void 0,y=void 0!==m,g=0,v=h(f);if(y&&(m=r(m,d>2?arguments[2]:void 0,2)),void 0==v||p==Array&&s(v))for(e=u(f.length),n=new p(e);e>g;g++)c(n,g,y?m(f[g],g):f[g]);else for(l=v.call(f),n=new p;!(i=l.next()).done;g++)c(n,g,y?a(l,m,[i.value,g],!0):i.value);return n.length=g,n}})},"1d2b":function(t,e,n){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}}},"1ec9":function(t,e,n){var r=n("f772"),i=n("e53d").document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},"1fa8":function(t,e,n){var r=n("cb7c");t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(a){var o=t["return"];throw void 0!==o&&r(o.call(t)),a}}},"20fd":function(t,e,n){"use strict";var r=n("d9f6"),i=n("aebd");t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},"230e":function(t,e,n){var r=n("d3f4"),i=n("7726").document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},"23c6":function(t,e,n){var r=n("2d95"),i=n("2b4c")("toStringTag"),o="Arguments"==r(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(n){}};t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=a(e=Object(t),i))?n:o?r(e):"Object"==(s=r(e))&&"function"==typeof e.callee?"Arguments":s}},"241e":function(t,e,n){var r=n("25eb");t.exports=function(t){return Object(r(t))}},2444:function(t,e,n){"use strict";(function(e){var r=n("c532"),i=n("c8af"),o={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!r.isUndefined(t)&&r.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function s(){var t;return"undefined"!==typeof e&&"[object process]"===Object.prototype.toString.call(e)?t=n("b50d"):"undefined"!==typeof XMLHttpRequest&&(t=n("b50d")),t}var u={adapter:s(),transformRequest:[function(t,e){return i(e,"Accept"),i(e,"Content-Type"),r.isFormData(t)||r.isArrayBuffer(t)||r.isBuffer(t)||r.isStream(t)||r.isFile(t)||r.isBlob(t)?t:r.isArrayBufferView(t)?t.buffer:r.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):r.isObject(t)?(a(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"===typeof t)try{t=JSON.parse(t)}catch(e){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(t){u.headers[t]={}})),r.forEach(["post","put","patch"],(function(t){u.headers[t]=r.merge(o)})),t.exports=u}).call(this,n("4362"))},"25eb":function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},2621:function(t,e){e.f=Object.getOwnPropertySymbols},"27ee":function(t,e,n){var r=n("23c6"),i=n("2b4c")("iterator"),o=n("84f2");t.exports=n("8378").getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[r(t)]}},2877:function(t,e,n){"use strict";function r(t,e,n,r,i,o,a,s){var u,c="function"===typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),r&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),a?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=u):i&&(u=s?function(){i.call(this,this.$root.$options.shadowRoot)}:i),u)if(c.functional){c._injectStyles=u;var h=c.render;c.render=function(t,e){return u.call(e),h(t,e)}}else{var l=c.beforeCreate;c.beforeCreate=l?[].concat(l,u):[u]}return{exports:t,options:c}}n.d(e,"a",(function(){return r}))},"294c":function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},"2aba":function(t,e,n){var r=n("7726"),i=n("32e9"),o=n("69a8"),a=n("ca5a")("src"),s=n("fa5b"),u="toString",c=(""+s).split(u);n("8378").inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var u="function"==typeof n;u&&(o(n,"name")||i(n,"name",e)),t[e]!==n&&(u&&(o(n,a)||i(n,a,t[e]?""+t[e]:c.join(String(e)))),t===r?t[e]=n:s?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,u,(function(){return"function"==typeof this&&this[a]||s.call(this)}))},"2aeb":function(t,e,n){var r=n("cb7c"),i=n("1495"),o=n("e11e"),a=n("613b")("IE_PROTO"),s=function(){},u="prototype",c=function(){var t,e=n("230e")("iframe"),r=o.length,i="<",a=">";e.style.display="none",n("fab2").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(i+"script"+a+"document.F=Object"+i+"/script"+a),t.close(),c=t.F;while(r--)delete c[u][o[r]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(s[u]=r(t),n=new s,s[u]=null,n[a]=t):n=c(),void 0===e?n:i(n,e)}},"2b0e":function(t,e,n){"use strict";(function(t){
/*!
 * Vue.js v2.6.10
 * (c) 2014-2019 Evan You
 * Released under the MIT License.
 */
var n=Object.freeze({});function r(t){return void 0===t||null===t}function i(t){return void 0!==t&&null!==t}function o(t){return!0===t}function a(t){return!1===t}function s(t){return"string"===typeof t||"number"===typeof t||"symbol"===typeof t||"boolean"===typeof t}function u(t){return null!==t&&"object"===typeof t}var c=Object.prototype.toString;function h(t){return"[object Object]"===c.call(t)}function l(t){return"[object RegExp]"===c.call(t)}function f(t){var e=parseFloat(String(t));return e>=0&&Math.floor(e)===e&&isFinite(t)}function p(t){return i(t)&&"function"===typeof t.then&&"function"===typeof t.catch}function d(t){return null==t?"":Array.isArray(t)||h(t)&&t.toString===c?JSON.stringify(t,null,2):String(t)}function m(t){var e=parseFloat(t);return isNaN(e)?t:e}function y(t,e){for(var n=Object.create(null),r=t.split(","),i=0;i<r.length;i++)n[r[i]]=!0;return e?function(t){return n[t.toLowerCase()]}:function(t){return n[t]}}y("slot,component",!0);var g=y("key,ref,slot,slot-scope,is");function v(t,e){if(t.length){var n=t.indexOf(e);if(n>-1)return t.splice(n,1)}}var b=Object.prototype.hasOwnProperty;function _(t,e){return b.call(t,e)}function w(t){var e=Object.create(null);return function(n){var r=e[n];return r||(e[n]=t(n))}}var T=/-(\w)/g,E=w((function(t){return t.replace(T,(function(t,e){return e?e.toUpperCase():""}))})),S=w((function(t){return t.charAt(0).toUpperCase()+t.slice(1)})),C=/\B([A-Z])/g,I=w((function(t){return t.replace(C,"-$1").toLowerCase()}));function A(t,e){function n(n){var r=arguments.length;return r?r>1?t.apply(e,arguments):t.call(e,n):t.call(e)}return n._length=t.length,n}function N(t,e){return t.bind(e)}var k=Function.prototype.bind?N:A;function D(t,e){e=e||0;var n=t.length-e,r=new Array(n);while(n--)r[n]=t[n+e];return r}function x(t,e){for(var n in e)t[n]=e[n];return t}function O(t){for(var e={},n=0;n<t.length;n++)t[n]&&x(e,t[n]);return e}function R(t,e,n){}var M=function(t,e,n){return!1},P=function(t){return t};function L(t,e){if(t===e)return!0;var n=u(t),r=u(e);if(!n||!r)return!n&&!r&&String(t)===String(e);try{var i=Array.isArray(t),o=Array.isArray(e);if(i&&o)return t.length===e.length&&t.every((function(t,n){return L(t,e[n])}));if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(i||o)return!1;var a=Object.keys(t),s=Object.keys(e);return a.length===s.length&&a.every((function(n){return L(t[n],e[n])}))}catch(c){return!1}}function F(t,e){for(var n=0;n<t.length;n++)if(L(t[n],e))return n;return-1}function U(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}var q="data-server-rendered",V=["component","directive","filter"],B=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],j={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:M,isReservedAttr:M,isUnknownElement:M,getTagNamespace:R,parsePlatformTagName:P,mustUseProp:M,async:!0,_lifecycleHooks:B},W=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function K(t){var e=(t+"").charCodeAt(0);return 36===e||95===e}function z(t,e,n,r){Object.defineProperty(t,e,{value:n,enumerable:!!r,writable:!0,configurable:!0})}var G=new RegExp("[^"+W.source+".$_\\d]");function Q(t){if(!G.test(t)){var e=t.split(".");return function(t){for(var n=0;n<e.length;n++){if(!t)return;t=t[e[n]]}return t}}}var H,Y="__proto__"in{},$="undefined"!==typeof window,X="undefined"!==typeof WXEnvironment&&!!WXEnvironment.platform,J=X&&WXEnvironment.platform.toLowerCase(),Z=$&&window.navigator.userAgent.toLowerCase(),tt=Z&&/msie|trident/.test(Z),et=Z&&Z.indexOf("msie 9.0")>0,nt=Z&&Z.indexOf("edge/")>0,rt=(Z&&Z.indexOf("android"),Z&&/iphone|ipad|ipod|ios/.test(Z)||"ios"===J),it=(Z&&/chrome\/\d+/.test(Z),Z&&/phantomjs/.test(Z),Z&&Z.match(/firefox\/(\d+)/)),ot={}.watch,at=!1;if($)try{var st={};Object.defineProperty(st,"passive",{get:function(){at=!0}}),window.addEventListener("test-passive",null,st)}catch(Ea){}var ut=function(){return void 0===H&&(H=!$&&!X&&"undefined"!==typeof t&&(t["process"]&&"server"===t["process"].env.VUE_ENV)),H},ct=$&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function ht(t){return"function"===typeof t&&/native code/.test(t.toString())}var lt,ft="undefined"!==typeof Symbol&&ht(Symbol)&&"undefined"!==typeof Reflect&&ht(Reflect.ownKeys);lt="undefined"!==typeof Set&&ht(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return!0===this.set[t]},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var pt=R,dt=0,mt=function(){this.id=dt++,this.subs=[]};mt.prototype.addSub=function(t){this.subs.push(t)},mt.prototype.removeSub=function(t){v(this.subs,t)},mt.prototype.depend=function(){mt.target&&mt.target.addDep(this)},mt.prototype.notify=function(){var t=this.subs.slice();for(var e=0,n=t.length;e<n;e++)t[e].update()},mt.target=null;var yt=[];function gt(t){yt.push(t),mt.target=t}function vt(){yt.pop(),mt.target=yt[yt.length-1]}var bt=function(t,e,n,r,i,o,a,s){this.tag=t,this.data=e,this.children=n,this.text=r,this.elm=i,this.ns=void 0,this.context=o,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=a,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},_t={child:{configurable:!0}};_t.child.get=function(){return this.componentInstance},Object.defineProperties(bt.prototype,_t);var wt=function(t){void 0===t&&(t="");var e=new bt;return e.text=t,e.isComment=!0,e};function Tt(t){return new bt(void 0,void 0,void 0,String(t))}function Et(t){var e=new bt(t.tag,t.data,t.children&&t.children.slice(),t.text,t.elm,t.context,t.componentOptions,t.asyncFactory);return e.ns=t.ns,e.isStatic=t.isStatic,e.key=t.key,e.isComment=t.isComment,e.fnContext=t.fnContext,e.fnOptions=t.fnOptions,e.fnScopeId=t.fnScopeId,e.asyncMeta=t.asyncMeta,e.isCloned=!0,e}var St=Array.prototype,Ct=Object.create(St),It=["push","pop","shift","unshift","splice","sort","reverse"];It.forEach((function(t){var e=St[t];z(Ct,t,(function(){var n=[],r=arguments.length;while(r--)n[r]=arguments[r];var i,o=e.apply(this,n),a=this.__ob__;switch(t){case"push":case"unshift":i=n;break;case"splice":i=n.slice(2);break}return i&&a.observeArray(i),a.dep.notify(),o}))}));var At=Object.getOwnPropertyNames(Ct),Nt=!0;function kt(t){Nt=t}var Dt=function(t){this.value=t,this.dep=new mt,this.vmCount=0,z(t,"__ob__",this),Array.isArray(t)?(Y?xt(t,Ct):Ot(t,Ct,At),this.observeArray(t)):this.walk(t)};function xt(t,e){t.__proto__=e}function Ot(t,e,n){for(var r=0,i=n.length;r<i;r++){var o=n[r];z(t,o,e[o])}}function Rt(t,e){var n;if(u(t)&&!(t instanceof bt))return _(t,"__ob__")&&t.__ob__ instanceof Dt?n=t.__ob__:Nt&&!ut()&&(Array.isArray(t)||h(t))&&Object.isExtensible(t)&&!t._isVue&&(n=new Dt(t)),e&&n&&n.vmCount++,n}function Mt(t,e,n,r,i){var o=new mt,a=Object.getOwnPropertyDescriptor(t,e);if(!a||!1!==a.configurable){var s=a&&a.get,u=a&&a.set;s&&!u||2!==arguments.length||(n=t[e]);var c=!i&&Rt(n);Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var e=s?s.call(t):n;return mt.target&&(o.depend(),c&&(c.dep.depend(),Array.isArray(e)&&Ft(e))),e},set:function(e){var r=s?s.call(t):n;e===r||e!==e&&r!==r||s&&!u||(u?u.call(t,e):n=e,c=!i&&Rt(e),o.notify())}})}}function Pt(t,e,n){if(Array.isArray(t)&&f(e))return t.length=Math.max(t.length,e),t.splice(e,1,n),n;if(e in t&&!(e in Object.prototype))return t[e]=n,n;var r=t.__ob__;return t._isVue||r&&r.vmCount?n:r?(Mt(r.value,e,n),r.dep.notify(),n):(t[e]=n,n)}function Lt(t,e){if(Array.isArray(t)&&f(e))t.splice(e,1);else{var n=t.__ob__;t._isVue||n&&n.vmCount||_(t,e)&&(delete t[e],n&&n.dep.notify())}}function Ft(t){for(var e=void 0,n=0,r=t.length;n<r;n++)e=t[n],e&&e.__ob__&&e.__ob__.dep.depend(),Array.isArray(e)&&Ft(e)}Dt.prototype.walk=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)Mt(t,e[n])},Dt.prototype.observeArray=function(t){for(var e=0,n=t.length;e<n;e++)Rt(t[e])};var Ut=j.optionMergeStrategies;function qt(t,e){if(!e)return t;for(var n,r,i,o=ft?Reflect.ownKeys(e):Object.keys(e),a=0;a<o.length;a++)n=o[a],"__ob__"!==n&&(r=t[n],i=e[n],_(t,n)?r!==i&&h(r)&&h(i)&&qt(r,i):Pt(t,n,i));return t}function Vt(t,e,n){return n?function(){var r="function"===typeof e?e.call(n,n):e,i="function"===typeof t?t.call(n,n):t;return r?qt(r,i):i}:e?t?function(){return qt("function"===typeof e?e.call(this,this):e,"function"===typeof t?t.call(this,this):t)}:e:t}function Bt(t,e){var n=e?t?t.concat(e):Array.isArray(e)?e:[e]:t;return n?jt(n):n}function jt(t){for(var e=[],n=0;n<t.length;n++)-1===e.indexOf(t[n])&&e.push(t[n]);return e}function Wt(t,e,n,r){var i=Object.create(t||null);return e?x(i,e):i}Ut.data=function(t,e,n){return n?Vt(t,e,n):e&&"function"!==typeof e?t:Vt(t,e)},B.forEach((function(t){Ut[t]=Bt})),V.forEach((function(t){Ut[t+"s"]=Wt})),Ut.watch=function(t,e,n,r){if(t===ot&&(t=void 0),e===ot&&(e=void 0),!e)return Object.create(t||null);if(!t)return e;var i={};for(var o in x(i,t),e){var a=i[o],s=e[o];a&&!Array.isArray(a)&&(a=[a]),i[o]=a?a.concat(s):Array.isArray(s)?s:[s]}return i},Ut.props=Ut.methods=Ut.inject=Ut.computed=function(t,e,n,r){if(!t)return e;var i=Object.create(null);return x(i,t),e&&x(i,e),i},Ut.provide=Vt;var Kt=function(t,e){return void 0===e?t:e};function zt(t,e){var n=t.props;if(n){var r,i,o,a={};if(Array.isArray(n)){r=n.length;while(r--)i=n[r],"string"===typeof i&&(o=E(i),a[o]={type:null})}else if(h(n))for(var s in n)i=n[s],o=E(s),a[o]=h(i)?i:{type:i};else 0;t.props=a}}function Gt(t,e){var n=t.inject;if(n){var r=t.inject={};if(Array.isArray(n))for(var i=0;i<n.length;i++)r[n[i]]={from:n[i]};else if(h(n))for(var o in n){var a=n[o];r[o]=h(a)?x({from:o},a):{from:a}}else 0}}function Qt(t){var e=t.directives;if(e)for(var n in e){var r=e[n];"function"===typeof r&&(e[n]={bind:r,update:r})}}function Ht(t,e,n){if("function"===typeof e&&(e=e.options),zt(e,n),Gt(e,n),Qt(e),!e._base&&(e.extends&&(t=Ht(t,e.extends,n)),e.mixins))for(var r=0,i=e.mixins.length;r<i;r++)t=Ht(t,e.mixins[r],n);var o,a={};for(o in t)s(o);for(o in e)_(t,o)||s(o);function s(r){var i=Ut[r]||Kt;a[r]=i(t[r],e[r],n,r)}return a}function Yt(t,e,n,r){if("string"===typeof n){var i=t[e];if(_(i,n))return i[n];var o=E(n);if(_(i,o))return i[o];var a=S(o);if(_(i,a))return i[a];var s=i[n]||i[o]||i[a];return s}}function $t(t,e,n,r){var i=e[t],o=!_(n,t),a=n[t],s=te(Boolean,i.type);if(s>-1)if(o&&!_(i,"default"))a=!1;else if(""===a||a===I(t)){var u=te(String,i.type);(u<0||s<u)&&(a=!0)}if(void 0===a){a=Xt(r,i,t);var c=Nt;kt(!0),Rt(a),kt(c)}return a}function Xt(t,e,n){if(_(e,"default")){var r=e.default;return t&&t.$options.propsData&&void 0===t.$options.propsData[n]&&void 0!==t._props[n]?t._props[n]:"function"===typeof r&&"Function"!==Jt(e.type)?r.call(t):r}}function Jt(t){var e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:""}function Zt(t,e){return Jt(t)===Jt(e)}function te(t,e){if(!Array.isArray(e))return Zt(e,t)?0:-1;for(var n=0,r=e.length;n<r;n++)if(Zt(e[n],t))return n;return-1}function ee(t,e,n){gt();try{if(e){var r=e;while(r=r.$parent){var i=r.$options.errorCaptured;if(i)for(var o=0;o<i.length;o++)try{var a=!1===i[o].call(r,t,e,n);if(a)return}catch(Ea){re(Ea,r,"errorCaptured hook")}}}re(t,e,n)}finally{vt()}}function ne(t,e,n,r,i){var o;try{o=n?t.apply(e,n):t.call(e),o&&!o._isVue&&p(o)&&!o._handled&&(o.catch((function(t){return ee(t,r,i+" (Promise/async)")})),o._handled=!0)}catch(Ea){ee(Ea,r,i)}return o}function re(t,e,n){if(j.errorHandler)try{return j.errorHandler.call(null,t,e,n)}catch(Ea){Ea!==t&&ie(Ea,null,"config.errorHandler")}ie(t,e,n)}function ie(t,e,n){if(!$&&!X||"undefined"===typeof console)throw t;console.error(t)}var oe,ae=!1,se=[],ue=!1;function ce(){ue=!1;var t=se.slice(0);se.length=0;for(var e=0;e<t.length;e++)t[e]()}if("undefined"!==typeof Promise&&ht(Promise)){var he=Promise.resolve();oe=function(){he.then(ce),rt&&setTimeout(R)},ae=!0}else if(tt||"undefined"===typeof MutationObserver||!ht(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())oe="undefined"!==typeof setImmediate&&ht(setImmediate)?function(){setImmediate(ce)}:function(){setTimeout(ce,0)};else{var le=1,fe=new MutationObserver(ce),pe=document.createTextNode(String(le));fe.observe(pe,{characterData:!0}),oe=function(){le=(le+1)%2,pe.data=String(le)},ae=!0}function de(t,e){var n;if(se.push((function(){if(t)try{t.call(e)}catch(Ea){ee(Ea,e,"nextTick")}else n&&n(e)})),ue||(ue=!0,oe()),!t&&"undefined"!==typeof Promise)return new Promise((function(t){n=t}))}var me=new lt;function ye(t){ge(t,me),me.clear()}function ge(t,e){var n,r,i=Array.isArray(t);if(!(!i&&!u(t)||Object.isFrozen(t)||t instanceof bt)){if(t.__ob__){var o=t.__ob__.dep.id;if(e.has(o))return;e.add(o)}if(i){n=t.length;while(n--)ge(t[n],e)}else{r=Object.keys(t),n=r.length;while(n--)ge(t[r[n]],e)}}}var ve=w((function(t){var e="&"===t.charAt(0);t=e?t.slice(1):t;var n="~"===t.charAt(0);t=n?t.slice(1):t;var r="!"===t.charAt(0);return t=r?t.slice(1):t,{name:t,once:n,capture:r,passive:e}}));function be(t,e){function n(){var t=arguments,r=n.fns;if(!Array.isArray(r))return ne(r,null,arguments,e,"v-on handler");for(var i=r.slice(),o=0;o<i.length;o++)ne(i[o],null,t,e,"v-on handler")}return n.fns=t,n}function _e(t,e,n,i,a,s){var u,c,h,l;for(u in t)c=t[u],h=e[u],l=ve(u),r(c)||(r(h)?(r(c.fns)&&(c=t[u]=be(c,s)),o(l.once)&&(c=t[u]=a(l.name,c,l.capture)),n(l.name,c,l.capture,l.passive,l.params)):c!==h&&(h.fns=c,t[u]=h));for(u in e)r(t[u])&&(l=ve(u),i(l.name,e[u],l.capture))}function we(t,e,n){var a;t instanceof bt&&(t=t.data.hook||(t.data.hook={}));var s=t[e];function u(){n.apply(this,arguments),v(a.fns,u)}r(s)?a=be([u]):i(s.fns)&&o(s.merged)?(a=s,a.fns.push(u)):a=be([s,u]),a.merged=!0,t[e]=a}function Te(t,e,n){var o=e.options.props;if(!r(o)){var a={},s=t.attrs,u=t.props;if(i(s)||i(u))for(var c in o){var h=I(c);Ee(a,u,c,h,!0)||Ee(a,s,c,h,!1)}return a}}function Ee(t,e,n,r,o){if(i(e)){if(_(e,n))return t[n]=e[n],o||delete e[n],!0;if(_(e,r))return t[n]=e[r],o||delete e[r],!0}return!1}function Se(t){for(var e=0;e<t.length;e++)if(Array.isArray(t[e]))return Array.prototype.concat.apply([],t);return t}function Ce(t){return s(t)?[Tt(t)]:Array.isArray(t)?Ae(t):void 0}function Ie(t){return i(t)&&i(t.text)&&a(t.isComment)}function Ae(t,e){var n,a,u,c,h=[];for(n=0;n<t.length;n++)a=t[n],r(a)||"boolean"===typeof a||(u=h.length-1,c=h[u],Array.isArray(a)?a.length>0&&(a=Ae(a,(e||"")+"_"+n),Ie(a[0])&&Ie(c)&&(h[u]=Tt(c.text+a[0].text),a.shift()),h.push.apply(h,a)):s(a)?Ie(c)?h[u]=Tt(c.text+a):""!==a&&h.push(Tt(a)):Ie(a)&&Ie(c)?h[u]=Tt(c.text+a.text):(o(t._isVList)&&i(a.tag)&&r(a.key)&&i(e)&&(a.key="__vlist"+e+"_"+n+"__"),h.push(a)));return h}function Ne(t){var e=t.$options.provide;e&&(t._provided="function"===typeof e?e.call(t):e)}function ke(t){var e=De(t.$options.inject,t);e&&(kt(!1),Object.keys(e).forEach((function(n){Mt(t,n,e[n])})),kt(!0))}function De(t,e){if(t){for(var n=Object.create(null),r=ft?Reflect.ownKeys(t):Object.keys(t),i=0;i<r.length;i++){var o=r[i];if("__ob__"!==o){var a=t[o].from,s=e;while(s){if(s._provided&&_(s._provided,a)){n[o]=s._provided[a];break}s=s.$parent}if(!s)if("default"in t[o]){var u=t[o].default;n[o]="function"===typeof u?u.call(e):u}else 0}}return n}}function xe(t,e){if(!t||!t.length)return{};for(var n={},r=0,i=t.length;r<i;r++){var o=t[r],a=o.data;if(a&&a.attrs&&a.attrs.slot&&delete a.attrs.slot,o.context!==e&&o.fnContext!==e||!a||null==a.slot)(n.default||(n.default=[])).push(o);else{var s=a.slot,u=n[s]||(n[s]=[]);"template"===o.tag?u.push.apply(u,o.children||[]):u.push(o)}}for(var c in n)n[c].every(Oe)&&delete n[c];return n}function Oe(t){return t.isComment&&!t.asyncFactory||" "===t.text}function Re(t,e,r){var i,o=Object.keys(e).length>0,a=t?!!t.$stable:!o,s=t&&t.$key;if(t){if(t._normalized)return t._normalized;if(a&&r&&r!==n&&s===r.$key&&!o&&!r.$hasNormal)return r;for(var u in i={},t)t[u]&&"$"!==u[0]&&(i[u]=Me(e,u,t[u]))}else i={};for(var c in e)c in i||(i[c]=Pe(e,c));return t&&Object.isExtensible(t)&&(t._normalized=i),z(i,"$stable",a),z(i,"$key",s),z(i,"$hasNormal",o),i}function Me(t,e,n){var r=function(){var t=arguments.length?n.apply(null,arguments):n({});return t=t&&"object"===typeof t&&!Array.isArray(t)?[t]:Ce(t),t&&(0===t.length||1===t.length&&t[0].isComment)?void 0:t};return n.proxy&&Object.defineProperty(t,e,{get:r,enumerable:!0,configurable:!0}),r}function Pe(t,e){return function(){return t[e]}}function Le(t,e){var n,r,o,a,s;if(Array.isArray(t)||"string"===typeof t)for(n=new Array(t.length),r=0,o=t.length;r<o;r++)n[r]=e(t[r],r);else if("number"===typeof t)for(n=new Array(t),r=0;r<t;r++)n[r]=e(r+1,r);else if(u(t))if(ft&&t[Symbol.iterator]){n=[];var c=t[Symbol.iterator](),h=c.next();while(!h.done)n.push(e(h.value,n.length)),h=c.next()}else for(a=Object.keys(t),n=new Array(a.length),r=0,o=a.length;r<o;r++)s=a[r],n[r]=e(t[s],s,r);return i(n)||(n=[]),n._isVList=!0,n}function Fe(t,e,n,r){var i,o=this.$scopedSlots[t];o?(n=n||{},r&&(n=x(x({},r),n)),i=o(n)||e):i=this.$slots[t]||e;var a=n&&n.slot;return a?this.$createElement("template",{slot:a},i):i}function Ue(t){return Yt(this.$options,"filters",t,!0)||P}function qe(t,e){return Array.isArray(t)?-1===t.indexOf(e):t!==e}function Ve(t,e,n,r,i){var o=j.keyCodes[e]||n;return i&&r&&!j.keyCodes[e]?qe(i,r):o?qe(o,t):r?I(r)!==e:void 0}function Be(t,e,n,r,i){if(n)if(u(n)){var o;Array.isArray(n)&&(n=O(n));var a=function(a){if("class"===a||"style"===a||g(a))o=t;else{var s=t.attrs&&t.attrs.type;o=r||j.mustUseProp(e,s,a)?t.domProps||(t.domProps={}):t.attrs||(t.attrs={})}var u=E(a),c=I(a);if(!(u in o)&&!(c in o)&&(o[a]=n[a],i)){var h=t.on||(t.on={});h["update:"+a]=function(t){n[a]=t}}};for(var s in n)a(s)}else;return t}function je(t,e){var n=this._staticTrees||(this._staticTrees=[]),r=n[t];return r&&!e?r:(r=n[t]=this.$options.staticRenderFns[t].call(this._renderProxy,null,this),Ke(r,"__static__"+t,!1),r)}function We(t,e,n){return Ke(t,"__once__"+e+(n?"_"+n:""),!0),t}function Ke(t,e,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)t[r]&&"string"!==typeof t[r]&&ze(t[r],e+"_"+r,n);else ze(t,e,n)}function ze(t,e,n){t.isStatic=!0,t.key=e,t.isOnce=n}function Ge(t,e){if(e)if(h(e)){var n=t.on=t.on?x({},t.on):{};for(var r in e){var i=n[r],o=e[r];n[r]=i?[].concat(i,o):o}}else;return t}function Qe(t,e,n,r){e=e||{$stable:!n};for(var i=0;i<t.length;i++){var o=t[i];Array.isArray(o)?Qe(o,e,n):o&&(o.proxy&&(o.fn.proxy=!0),e[o.key]=o.fn)}return r&&(e.$key=r),e}function He(t,e){for(var n=0;n<e.length;n+=2){var r=e[n];"string"===typeof r&&r&&(t[e[n]]=e[n+1])}return t}function Ye(t,e){return"string"===typeof t?e+t:t}function $e(t){t._o=We,t._n=m,t._s=d,t._l=Le,t._t=Fe,t._q=L,t._i=F,t._m=je,t._f=Ue,t._k=Ve,t._b=Be,t._v=Tt,t._e=wt,t._u=Qe,t._g=Ge,t._d=He,t._p=Ye}function Xe(t,e,r,i,a){var s,u=this,c=a.options;_(i,"_uid")?(s=Object.create(i),s._original=i):(s=i,i=i._original);var h=o(c._compiled),l=!h;this.data=t,this.props=e,this.children=r,this.parent=i,this.listeners=t.on||n,this.injections=De(c.inject,i),this.slots=function(){return u.$slots||Re(t.scopedSlots,u.$slots=xe(r,i)),u.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return Re(t.scopedSlots,this.slots())}}),h&&(this.$options=c,this.$slots=this.slots(),this.$scopedSlots=Re(t.scopedSlots,this.$slots)),c._scopeId?this._c=function(t,e,n,r){var o=ln(s,t,e,n,r,l);return o&&!Array.isArray(o)&&(o.fnScopeId=c._scopeId,o.fnContext=i),o}:this._c=function(t,e,n,r){return ln(s,t,e,n,r,l)}}function Je(t,e,r,o,a){var s=t.options,u={},c=s.props;if(i(c))for(var h in c)u[h]=$t(h,c,e||n);else i(r.attrs)&&tn(u,r.attrs),i(r.props)&&tn(u,r.props);var l=new Xe(r,u,a,o,t),f=s.render.call(null,l._c,l);if(f instanceof bt)return Ze(f,r,l.parent,s,l);if(Array.isArray(f)){for(var p=Ce(f)||[],d=new Array(p.length),m=0;m<p.length;m++)d[m]=Ze(p[m],r,l.parent,s,l);return d}}function Ze(t,e,n,r,i){var o=Et(t);return o.fnContext=n,o.fnOptions=r,e.slot&&((o.data||(o.data={})).slot=e.slot),o}function tn(t,e){for(var n in e)t[E(n)]=e[n]}$e(Xe.prototype);var en={init:function(t,e){if(t.componentInstance&&!t.componentInstance._isDestroyed&&t.data.keepAlive){var n=t;en.prepatch(n,n)}else{var r=t.componentInstance=on(t,Dn);r.$mount(e?t.elm:void 0,e)}},prepatch:function(t,e){var n=e.componentOptions,r=e.componentInstance=t.componentInstance;Pn(r,n.propsData,n.listeners,e,n.children)},insert:function(t){var e=t.context,n=t.componentInstance;n._isMounted||(n._isMounted=!0,qn(n,"mounted")),t.data.keepAlive&&(e._isMounted?Jn(n):Fn(n,!0))},destroy:function(t){var e=t.componentInstance;e._isDestroyed||(t.data.keepAlive?Un(e,!0):e.$destroy())}},nn=Object.keys(en);function rn(t,e,n,a,s){if(!r(t)){var c=n.$options._base;if(u(t)&&(t=c.extend(t)),"function"===typeof t){var h;if(r(t.cid)&&(h=t,t=wn(h,c),void 0===t))return _n(h,e,n,a,s);e=e||{},wr(t),i(e.model)&&un(t.options,e);var l=Te(e,t,s);if(o(t.options.functional))return Je(t,l,e,n,a);var f=e.on;if(e.on=e.nativeOn,o(t.options.abstract)){var p=e.slot;e={},p&&(e.slot=p)}an(e);var d=t.options.name||s,m=new bt("vue-component-"+t.cid+(d?"-"+d:""),e,void 0,void 0,void 0,n,{Ctor:t,propsData:l,listeners:f,tag:s,children:a},h);return m}}}function on(t,e){var n={_isComponent:!0,_parentVnode:t,parent:e},r=t.data.inlineTemplate;return i(r)&&(n.render=r.render,n.staticRenderFns=r.staticRenderFns),new t.componentOptions.Ctor(n)}function an(t){for(var e=t.hook||(t.hook={}),n=0;n<nn.length;n++){var r=nn[n],i=e[r],o=en[r];i===o||i&&i._merged||(e[r]=i?sn(o,i):o)}}function sn(t,e){var n=function(n,r){t(n,r),e(n,r)};return n._merged=!0,n}function un(t,e){var n=t.model&&t.model.prop||"value",r=t.model&&t.model.event||"input";(e.attrs||(e.attrs={}))[n]=e.model.value;var o=e.on||(e.on={}),a=o[r],s=e.model.callback;i(a)?(Array.isArray(a)?-1===a.indexOf(s):a!==s)&&(o[r]=[s].concat(a)):o[r]=s}var cn=1,hn=2;function ln(t,e,n,r,i,a){return(Array.isArray(n)||s(n))&&(i=r,r=n,n=void 0),o(a)&&(i=hn),fn(t,e,n,r,i)}function fn(t,e,n,r,o){if(i(n)&&i(n.__ob__))return wt();if(i(n)&&i(n.is)&&(e=n.is),!e)return wt();var a,s,u;(Array.isArray(r)&&"function"===typeof r[0]&&(n=n||{},n.scopedSlots={default:r[0]},r.length=0),o===hn?r=Ce(r):o===cn&&(r=Se(r)),"string"===typeof e)?(s=t.$vnode&&t.$vnode.ns||j.getTagNamespace(e),a=j.isReservedTag(e)?new bt(j.parsePlatformTagName(e),n,r,void 0,void 0,t):n&&n.pre||!i(u=Yt(t.$options,"components",e))?new bt(e,n,r,void 0,void 0,t):rn(u,n,t,r,e)):a=rn(e,n,t,r);return Array.isArray(a)?a:i(a)?(i(s)&&pn(a,s),i(n)&&dn(n),a):wt()}function pn(t,e,n){if(t.ns=e,"foreignObject"===t.tag&&(e=void 0,n=!0),i(t.children))for(var a=0,s=t.children.length;a<s;a++){var u=t.children[a];i(u.tag)&&(r(u.ns)||o(n)&&"svg"!==u.tag)&&pn(u,e,n)}}function dn(t){u(t.style)&&ye(t.style),u(t.class)&&ye(t.class)}function mn(t){t._vnode=null,t._staticTrees=null;var e=t.$options,r=t.$vnode=e._parentVnode,i=r&&r.context;t.$slots=xe(e._renderChildren,i),t.$scopedSlots=n,t._c=function(e,n,r,i){return ln(t,e,n,r,i,!1)},t.$createElement=function(e,n,r,i){return ln(t,e,n,r,i,!0)};var o=r&&r.data;Mt(t,"$attrs",o&&o.attrs||n,null,!0),Mt(t,"$listeners",e._parentListeners||n,null,!0)}var yn,gn=null;function vn(t){$e(t.prototype),t.prototype.$nextTick=function(t){return de(t,this)},t.prototype._render=function(){var t,e=this,n=e.$options,r=n.render,i=n._parentVnode;i&&(e.$scopedSlots=Re(i.data.scopedSlots,e.$slots,e.$scopedSlots)),e.$vnode=i;try{gn=e,t=r.call(e._renderProxy,e.$createElement)}catch(Ea){ee(Ea,e,"render"),t=e._vnode}finally{gn=null}return Array.isArray(t)&&1===t.length&&(t=t[0]),t instanceof bt||(t=wt()),t.parent=i,t}}function bn(t,e){return(t.__esModule||ft&&"Module"===t[Symbol.toStringTag])&&(t=t.default),u(t)?e.extend(t):t}function _n(t,e,n,r,i){var o=wt();return o.asyncFactory=t,o.asyncMeta={data:e,context:n,children:r,tag:i},o}function wn(t,e){if(o(t.error)&&i(t.errorComp))return t.errorComp;if(i(t.resolved))return t.resolved;var n=gn;if(n&&i(t.owners)&&-1===t.owners.indexOf(n)&&t.owners.push(n),o(t.loading)&&i(t.loadingComp))return t.loadingComp;if(n&&!i(t.owners)){var a=t.owners=[n],s=!0,c=null,h=null;n.$on("hook:destroyed",(function(){return v(a,n)}));var l=function(t){for(var e=0,n=a.length;e<n;e++)a[e].$forceUpdate();t&&(a.length=0,null!==c&&(clearTimeout(c),c=null),null!==h&&(clearTimeout(h),h=null))},f=U((function(n){t.resolved=bn(n,e),s?a.length=0:l(!0)})),d=U((function(e){i(t.errorComp)&&(t.error=!0,l(!0))})),m=t(f,d);return u(m)&&(p(m)?r(t.resolved)&&m.then(f,d):p(m.component)&&(m.component.then(f,d),i(m.error)&&(t.errorComp=bn(m.error,e)),i(m.loading)&&(t.loadingComp=bn(m.loading,e),0===m.delay?t.loading=!0:c=setTimeout((function(){c=null,r(t.resolved)&&r(t.error)&&(t.loading=!0,l(!1))}),m.delay||200)),i(m.timeout)&&(h=setTimeout((function(){h=null,r(t.resolved)&&d(null)}),m.timeout)))),s=!1,t.loading?t.loadingComp:t.resolved}}function Tn(t){return t.isComment&&t.asyncFactory}function En(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var n=t[e];if(i(n)&&(i(n.componentOptions)||Tn(n)))return n}}function Sn(t){t._events=Object.create(null),t._hasHookEvent=!1;var e=t.$options._parentListeners;e&&Nn(t,e)}function Cn(t,e){yn.$on(t,e)}function In(t,e){yn.$off(t,e)}function An(t,e){var n=yn;return function r(){var i=e.apply(null,arguments);null!==i&&n.$off(t,r)}}function Nn(t,e,n){yn=t,_e(e,n||{},Cn,In,An,t),yn=void 0}function kn(t){var e=/^hook:/;t.prototype.$on=function(t,n){var r=this;if(Array.isArray(t))for(var i=0,o=t.length;i<o;i++)r.$on(t[i],n);else(r._events[t]||(r._events[t]=[])).push(n),e.test(t)&&(r._hasHookEvent=!0);return r},t.prototype.$once=function(t,e){var n=this;function r(){n.$off(t,r),e.apply(n,arguments)}return r.fn=e,n.$on(t,r),n},t.prototype.$off=function(t,e){var n=this;if(!arguments.length)return n._events=Object.create(null),n;if(Array.isArray(t)){for(var r=0,i=t.length;r<i;r++)n.$off(t[r],e);return n}var o,a=n._events[t];if(!a)return n;if(!e)return n._events[t]=null,n;var s=a.length;while(s--)if(o=a[s],o===e||o.fn===e){a.splice(s,1);break}return n},t.prototype.$emit=function(t){var e=this,n=e._events[t];if(n){n=n.length>1?D(n):n;for(var r=D(arguments,1),i='event handler for "'+t+'"',o=0,a=n.length;o<a;o++)ne(n[o],e,r,e,i)}return e}}var Dn=null;function xn(t){var e=Dn;return Dn=t,function(){Dn=e}}function On(t){var e=t.$options,n=e.parent;if(n&&!e.abstract){while(n.$options.abstract&&n.$parent)n=n.$parent;n.$children.push(t)}t.$parent=n,t.$root=n?n.$root:t,t.$children=[],t.$refs={},t._watcher=null,t._inactive=null,t._directInactive=!1,t._isMounted=!1,t._isDestroyed=!1,t._isBeingDestroyed=!1}function Rn(t){t.prototype._update=function(t,e){var n=this,r=n.$el,i=n._vnode,o=xn(n);n._vnode=t,n.$el=i?n.__patch__(i,t):n.__patch__(n.$el,t,e,!1),o(),r&&(r.__vue__=null),n.$el&&(n.$el.__vue__=n),n.$vnode&&n.$parent&&n.$vnode===n.$parent._vnode&&(n.$parent.$el=n.$el)},t.prototype.$forceUpdate=function(){var t=this;t._watcher&&t._watcher.update()},t.prototype.$destroy=function(){var t=this;if(!t._isBeingDestroyed){qn(t,"beforeDestroy"),t._isBeingDestroyed=!0;var e=t.$parent;!e||e._isBeingDestroyed||t.$options.abstract||v(e.$children,t),t._watcher&&t._watcher.teardown();var n=t._watchers.length;while(n--)t._watchers[n].teardown();t._data.__ob__&&t._data.__ob__.vmCount--,t._isDestroyed=!0,t.__patch__(t._vnode,null),qn(t,"destroyed"),t.$off(),t.$el&&(t.$el.__vue__=null),t.$vnode&&(t.$vnode.parent=null)}}}function Mn(t,e,n){var r;return t.$el=e,t.$options.render||(t.$options.render=wt),qn(t,"beforeMount"),r=function(){t._update(t._render(),n)},new nr(t,r,R,{before:function(){t._isMounted&&!t._isDestroyed&&qn(t,"beforeUpdate")}},!0),n=!1,null==t.$vnode&&(t._isMounted=!0,qn(t,"mounted")),t}function Pn(t,e,r,i,o){var a=i.data.scopedSlots,s=t.$scopedSlots,u=!!(a&&!a.$stable||s!==n&&!s.$stable||a&&t.$scopedSlots.$key!==a.$key),c=!!(o||t.$options._renderChildren||u);if(t.$options._parentVnode=i,t.$vnode=i,t._vnode&&(t._vnode.parent=i),t.$options._renderChildren=o,t.$attrs=i.data.attrs||n,t.$listeners=r||n,e&&t.$options.props){kt(!1);for(var h=t._props,l=t.$options._propKeys||[],f=0;f<l.length;f++){var p=l[f],d=t.$options.props;h[p]=$t(p,d,e,t)}kt(!0),t.$options.propsData=e}r=r||n;var m=t.$options._parentListeners;t.$options._parentListeners=r,Nn(t,r,m),c&&(t.$slots=xe(o,i.context),t.$forceUpdate())}function Ln(t){while(t&&(t=t.$parent))if(t._inactive)return!0;return!1}function Fn(t,e){if(e){if(t._directInactive=!1,Ln(t))return}else if(t._directInactive)return;if(t._inactive||null===t._inactive){t._inactive=!1;for(var n=0;n<t.$children.length;n++)Fn(t.$children[n]);qn(t,"activated")}}function Un(t,e){if((!e||(t._directInactive=!0,!Ln(t)))&&!t._inactive){t._inactive=!0;for(var n=0;n<t.$children.length;n++)Un(t.$children[n]);qn(t,"deactivated")}}function qn(t,e){gt();var n=t.$options[e],r=e+" hook";if(n)for(var i=0,o=n.length;i<o;i++)ne(n[i],t,null,t,r);t._hasHookEvent&&t.$emit("hook:"+e),vt()}var Vn=[],Bn=[],jn={},Wn=!1,Kn=!1,zn=0;function Gn(){zn=Vn.length=Bn.length=0,jn={},Wn=Kn=!1}var Qn=0,Hn=Date.now;if($&&!tt){var Yn=window.performance;Yn&&"function"===typeof Yn.now&&Hn()>document.createEvent("Event").timeStamp&&(Hn=function(){return Yn.now()})}function $n(){var t,e;for(Qn=Hn(),Kn=!0,Vn.sort((function(t,e){return t.id-e.id})),zn=0;zn<Vn.length;zn++)t=Vn[zn],t.before&&t.before(),e=t.id,jn[e]=null,t.run();var n=Bn.slice(),r=Vn.slice();Gn(),Zn(n),Xn(r),ct&&j.devtools&&ct.emit("flush")}function Xn(t){var e=t.length;while(e--){var n=t[e],r=n.vm;r._watcher===n&&r._isMounted&&!r._isDestroyed&&qn(r,"updated")}}function Jn(t){t._inactive=!1,Bn.push(t)}function Zn(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,Fn(t[e],!0)}function tr(t){var e=t.id;if(null==jn[e]){if(jn[e]=!0,Kn){var n=Vn.length-1;while(n>zn&&Vn[n].id>t.id)n--;Vn.splice(n+1,0,t)}else Vn.push(t);Wn||(Wn=!0,de($n))}}var er=0,nr=function(t,e,n,r,i){this.vm=t,i&&(t._watcher=this),t._watchers.push(this),r?(this.deep=!!r.deep,this.user=!!r.user,this.lazy=!!r.lazy,this.sync=!!r.sync,this.before=r.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=n,this.id=++er,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new lt,this.newDepIds=new lt,this.expression="","function"===typeof e?this.getter=e:(this.getter=Q(e),this.getter||(this.getter=R)),this.value=this.lazy?void 0:this.get()};nr.prototype.get=function(){var t;gt(this);var e=this.vm;try{t=this.getter.call(e,e)}catch(Ea){if(!this.user)throw Ea;ee(Ea,e,'getter for watcher "'+this.expression+'"')}finally{this.deep&&ye(t),vt(),this.cleanupDeps()}return t},nr.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},nr.prototype.cleanupDeps=function(){var t=this.deps.length;while(t--){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var n=this.depIds;this.depIds=this.newDepIds,this.newDepIds=n,this.newDepIds.clear(),n=this.deps,this.deps=this.newDeps,this.newDeps=n,this.newDeps.length=0},nr.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():tr(this)},nr.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||u(t)||this.deep){var e=this.value;if(this.value=t,this.user)try{this.cb.call(this.vm,t,e)}catch(Ea){ee(Ea,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,t,e)}}},nr.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},nr.prototype.depend=function(){var t=this.deps.length;while(t--)this.deps[t].depend()},nr.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||v(this.vm._watchers,this);var t=this.deps.length;while(t--)this.deps[t].removeSub(this);this.active=!1}};var rr={enumerable:!0,configurable:!0,get:R,set:R};function ir(t,e,n){rr.get=function(){return this[e][n]},rr.set=function(t){this[e][n]=t},Object.defineProperty(t,n,rr)}function or(t){t._watchers=[];var e=t.$options;e.props&&ar(t,e.props),e.methods&&dr(t,e.methods),e.data?sr(t):Rt(t._data={},!0),e.computed&&hr(t,e.computed),e.watch&&e.watch!==ot&&mr(t,e.watch)}function ar(t,e){var n=t.$options.propsData||{},r=t._props={},i=t.$options._propKeys=[],o=!t.$parent;o||kt(!1);var a=function(o){i.push(o);var a=$t(o,e,n,t);Mt(r,o,a),o in t||ir(t,"_props",o)};for(var s in e)a(s);kt(!0)}function sr(t){var e=t.$options.data;e=t._data="function"===typeof e?ur(e,t):e||{},h(e)||(e={});var n=Object.keys(e),r=t.$options.props,i=(t.$options.methods,n.length);while(i--){var o=n[i];0,r&&_(r,o)||K(o)||ir(t,"_data",o)}Rt(e,!0)}function ur(t,e){gt();try{return t.call(e,e)}catch(Ea){return ee(Ea,e,"data()"),{}}finally{vt()}}var cr={lazy:!0};function hr(t,e){var n=t._computedWatchers=Object.create(null),r=ut();for(var i in e){var o=e[i],a="function"===typeof o?o:o.get;0,r||(n[i]=new nr(t,a||R,R,cr)),i in t||lr(t,i,o)}}function lr(t,e,n){var r=!ut();"function"===typeof n?(rr.get=r?fr(e):pr(n),rr.set=R):(rr.get=n.get?r&&!1!==n.cache?fr(e):pr(n.get):R,rr.set=n.set||R),Object.defineProperty(t,e,rr)}function fr(t){return function(){var e=this._computedWatchers&&this._computedWatchers[t];if(e)return e.dirty&&e.evaluate(),mt.target&&e.depend(),e.value}}function pr(t){return function(){return t.call(this,this)}}function dr(t,e){t.$options.props;for(var n in e)t[n]="function"!==typeof e[n]?R:k(e[n],t)}function mr(t,e){for(var n in e){var r=e[n];if(Array.isArray(r))for(var i=0;i<r.length;i++)yr(t,n,r[i]);else yr(t,n,r)}}function yr(t,e,n,r){return h(n)&&(r=n,n=n.handler),"string"===typeof n&&(n=t[n]),t.$watch(e,n,r)}function gr(t){var e={get:function(){return this._data}},n={get:function(){return this._props}};Object.defineProperty(t.prototype,"$data",e),Object.defineProperty(t.prototype,"$props",n),t.prototype.$set=Pt,t.prototype.$delete=Lt,t.prototype.$watch=function(t,e,n){var r=this;if(h(e))return yr(r,t,e,n);n=n||{},n.user=!0;var i=new nr(r,t,e,n);if(n.immediate)try{e.call(r,i.value)}catch(o){ee(o,r,'callback for immediate watcher "'+i.expression+'"')}return function(){i.teardown()}}}var vr=0;function br(t){t.prototype._init=function(t){var e=this;e._uid=vr++,e._isVue=!0,t&&t._isComponent?_r(e,t):e.$options=Ht(wr(e.constructor),t||{},e),e._renderProxy=e,e._self=e,On(e),Sn(e),mn(e),qn(e,"beforeCreate"),ke(e),or(e),Ne(e),qn(e,"created"),e.$options.el&&e.$mount(e.$options.el)}}function _r(t,e){var n=t.$options=Object.create(t.constructor.options),r=e._parentVnode;n.parent=e.parent,n._parentVnode=r;var i=r.componentOptions;n.propsData=i.propsData,n._parentListeners=i.listeners,n._renderChildren=i.children,n._componentTag=i.tag,e.render&&(n.render=e.render,n.staticRenderFns=e.staticRenderFns)}function wr(t){var e=t.options;if(t.super){var n=wr(t.super),r=t.superOptions;if(n!==r){t.superOptions=n;var i=Tr(t);i&&x(t.extendOptions,i),e=t.options=Ht(n,t.extendOptions),e.name&&(e.components[e.name]=t)}}return e}function Tr(t){var e,n=t.options,r=t.sealedOptions;for(var i in n)n[i]!==r[i]&&(e||(e={}),e[i]=n[i]);return e}function Er(t){this._init(t)}function Sr(t){t.use=function(t){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(t)>-1)return this;var n=D(arguments,1);return n.unshift(this),"function"===typeof t.install?t.install.apply(t,n):"function"===typeof t&&t.apply(null,n),e.push(t),this}}function Cr(t){t.mixin=function(t){return this.options=Ht(this.options,t),this}}function Ir(t){t.cid=0;var e=1;t.extend=function(t){t=t||{};var n=this,r=n.cid,i=t._Ctor||(t._Ctor={});if(i[r])return i[r];var o=t.name||n.options.name;var a=function(t){this._init(t)};return a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a.cid=e++,a.options=Ht(n.options,t),a["super"]=n,a.options.props&&Ar(a),a.options.computed&&Nr(a),a.extend=n.extend,a.mixin=n.mixin,a.use=n.use,V.forEach((function(t){a[t]=n[t]})),o&&(a.options.components[o]=a),a.superOptions=n.options,a.extendOptions=t,a.sealedOptions=x({},a.options),i[r]=a,a}}function Ar(t){var e=t.options.props;for(var n in e)ir(t.prototype,"_props",n)}function Nr(t){var e=t.options.computed;for(var n in e)lr(t.prototype,n,e[n])}function kr(t){V.forEach((function(e){t[e]=function(t,n){return n?("component"===e&&h(n)&&(n.name=n.name||t,n=this.options._base.extend(n)),"directive"===e&&"function"===typeof n&&(n={bind:n,update:n}),this.options[e+"s"][t]=n,n):this.options[e+"s"][t]}}))}function Dr(t){return t&&(t.Ctor.options.name||t.tag)}function xr(t,e){return Array.isArray(t)?t.indexOf(e)>-1:"string"===typeof t?t.split(",").indexOf(e)>-1:!!l(t)&&t.test(e)}function Or(t,e){var n=t.cache,r=t.keys,i=t._vnode;for(var o in n){var a=n[o];if(a){var s=Dr(a.componentOptions);s&&!e(s)&&Rr(n,o,r,i)}}}function Rr(t,e,n,r){var i=t[e];!i||r&&i.tag===r.tag||i.componentInstance.$destroy(),t[e]=null,v(n,e)}br(Er),gr(Er),kn(Er),Rn(Er),vn(Er);var Mr=[String,RegExp,Array],Pr={name:"keep-alive",abstract:!0,props:{include:Mr,exclude:Mr,max:[String,Number]},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var t in this.cache)Rr(this.cache,t,this.keys)},mounted:function(){var t=this;this.$watch("include",(function(e){Or(t,(function(t){return xr(e,t)}))})),this.$watch("exclude",(function(e){Or(t,(function(t){return!xr(e,t)}))}))},render:function(){var t=this.$slots.default,e=En(t),n=e&&e.componentOptions;if(n){var r=Dr(n),i=this,o=i.include,a=i.exclude;if(o&&(!r||!xr(o,r))||a&&r&&xr(a,r))return e;var s=this,u=s.cache,c=s.keys,h=null==e.key?n.Ctor.cid+(n.tag?"::"+n.tag:""):e.key;u[h]?(e.componentInstance=u[h].componentInstance,v(c,h),c.push(h)):(u[h]=e,c.push(h),this.max&&c.length>parseInt(this.max)&&Rr(u,c[0],c,this._vnode)),e.data.keepAlive=!0}return e||t&&t[0]}},Lr={KeepAlive:Pr};function Fr(t){var e={get:function(){return j}};Object.defineProperty(t,"config",e),t.util={warn:pt,extend:x,mergeOptions:Ht,defineReactive:Mt},t.set=Pt,t.delete=Lt,t.nextTick=de,t.observable=function(t){return Rt(t),t},t.options=Object.create(null),V.forEach((function(e){t.options[e+"s"]=Object.create(null)})),t.options._base=t,x(t.options.components,Lr),Sr(t),Cr(t),Ir(t),kr(t)}Fr(Er),Object.defineProperty(Er.prototype,"$isServer",{get:ut}),Object.defineProperty(Er.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(Er,"FunctionalRenderContext",{value:Xe}),Er.version="2.6.10";var Ur=y("style,class"),qr=y("input,textarea,option,select,progress"),Vr=function(t,e,n){return"value"===n&&qr(t)&&"button"!==e||"selected"===n&&"option"===t||"checked"===n&&"input"===t||"muted"===n&&"video"===t},Br=y("contenteditable,draggable,spellcheck"),jr=y("events,caret,typing,plaintext-only"),Wr=function(t,e){return Hr(e)||"false"===e?"false":"contenteditable"===t&&jr(e)?e:"true"},Kr=y("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,translate,truespeed,typemustmatch,visible"),zr="http://www.w3.org/1999/xlink",Gr=function(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)},Qr=function(t){return Gr(t)?t.slice(6,t.length):""},Hr=function(t){return null==t||!1===t};function Yr(t){var e=t.data,n=t,r=t;while(i(r.componentInstance))r=r.componentInstance._vnode,r&&r.data&&(e=$r(r.data,e));while(i(n=n.parent))n&&n.data&&(e=$r(e,n.data));return Xr(e.staticClass,e.class)}function $r(t,e){return{staticClass:Jr(t.staticClass,e.staticClass),class:i(t.class)?[t.class,e.class]:e.class}}function Xr(t,e){return i(t)||i(e)?Jr(t,Zr(e)):""}function Jr(t,e){return t?e?t+" "+e:t:e||""}function Zr(t){return Array.isArray(t)?ti(t):u(t)?ei(t):"string"===typeof t?t:""}function ti(t){for(var e,n="",r=0,o=t.length;r<o;r++)i(e=Zr(t[r]))&&""!==e&&(n&&(n+=" "),n+=e);return n}function ei(t){var e="";for(var n in t)t[n]&&(e&&(e+=" "),e+=n);return e}var ni={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},ri=y("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),ii=y("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignObject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),oi=function(t){return ri(t)||ii(t)};function ai(t){return ii(t)?"svg":"math"===t?"math":void 0}var si=Object.create(null);function ui(t){if(!$)return!0;if(oi(t))return!1;if(t=t.toLowerCase(),null!=si[t])return si[t];var e=document.createElement(t);return t.indexOf("-")>-1?si[t]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:si[t]=/HTMLUnknownElement/.test(e.toString())}var ci=y("text,number,password,search,email,tel,url");function hi(t){if("string"===typeof t){var e=document.querySelector(t);return e||document.createElement("div")}return t}function li(t,e){var n=document.createElement(t);return"select"!==t?n:(e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&n.setAttribute("multiple","multiple"),n)}function fi(t,e){return document.createElementNS(ni[t],e)}function pi(t){return document.createTextNode(t)}function di(t){return document.createComment(t)}function mi(t,e,n){t.insertBefore(e,n)}function yi(t,e){t.removeChild(e)}function gi(t,e){t.appendChild(e)}function vi(t){return t.parentNode}function bi(t){return t.nextSibling}function _i(t){return t.tagName}function wi(t,e){t.textContent=e}function Ti(t,e){t.setAttribute(e,"")}var Ei=Object.freeze({createElement:li,createElementNS:fi,createTextNode:pi,createComment:di,insertBefore:mi,removeChild:yi,appendChild:gi,parentNode:vi,nextSibling:bi,tagName:_i,setTextContent:wi,setStyleScope:Ti}),Si={create:function(t,e){Ci(e)},update:function(t,e){t.data.ref!==e.data.ref&&(Ci(t,!0),Ci(e))},destroy:function(t){Ci(t,!0)}};function Ci(t,e){var n=t.data.ref;if(i(n)){var r=t.context,o=t.componentInstance||t.elm,a=r.$refs;e?Array.isArray(a[n])?v(a[n],o):a[n]===o&&(a[n]=void 0):t.data.refInFor?Array.isArray(a[n])?a[n].indexOf(o)<0&&a[n].push(o):a[n]=[o]:a[n]=o}}var Ii=new bt("",{},[]),Ai=["create","activate","update","remove","destroy"];function Ni(t,e){return t.key===e.key&&(t.tag===e.tag&&t.isComment===e.isComment&&i(t.data)===i(e.data)&&ki(t,e)||o(t.isAsyncPlaceholder)&&t.asyncFactory===e.asyncFactory&&r(e.asyncFactory.error))}function ki(t,e){if("input"!==t.tag)return!0;var n,r=i(n=t.data)&&i(n=n.attrs)&&n.type,o=i(n=e.data)&&i(n=n.attrs)&&n.type;return r===o||ci(r)&&ci(o)}function Di(t,e,n){var r,o,a={};for(r=e;r<=n;++r)o=t[r].key,i(o)&&(a[o]=r);return a}function xi(t){var e,n,a={},u=t.modules,c=t.nodeOps;for(e=0;e<Ai.length;++e)for(a[Ai[e]]=[],n=0;n<u.length;++n)i(u[n][Ai[e]])&&a[Ai[e]].push(u[n][Ai[e]]);function h(t){return new bt(c.tagName(t).toLowerCase(),{},[],void 0,t)}function l(t,e){function n(){0===--n.listeners&&f(t)}return n.listeners=e,n}function f(t){var e=c.parentNode(t);i(e)&&c.removeChild(e,t)}function p(t,e,n,r,a,s,u){if(i(t.elm)&&i(s)&&(t=s[u]=Et(t)),t.isRootInsert=!a,!d(t,e,n,r)){var h=t.data,l=t.children,f=t.tag;i(f)?(t.elm=t.ns?c.createElementNS(t.ns,f):c.createElement(f,t),T(t),b(t,l,e),i(h)&&w(t,e),v(n,t.elm,r)):o(t.isComment)?(t.elm=c.createComment(t.text),v(n,t.elm,r)):(t.elm=c.createTextNode(t.text),v(n,t.elm,r))}}function d(t,e,n,r){var a=t.data;if(i(a)){var s=i(t.componentInstance)&&a.keepAlive;if(i(a=a.hook)&&i(a=a.init)&&a(t,!1),i(t.componentInstance))return m(t,e),v(n,t.elm,r),o(s)&&g(t,e,n,r),!0}}function m(t,e){i(t.data.pendingInsert)&&(e.push.apply(e,t.data.pendingInsert),t.data.pendingInsert=null),t.elm=t.componentInstance.$el,_(t)?(w(t,e),T(t)):(Ci(t),e.push(t))}function g(t,e,n,r){var o,s=t;while(s.componentInstance)if(s=s.componentInstance._vnode,i(o=s.data)&&i(o=o.transition)){for(o=0;o<a.activate.length;++o)a.activate[o](Ii,s);e.push(s);break}v(n,t.elm,r)}function v(t,e,n){i(t)&&(i(n)?c.parentNode(n)===t&&c.insertBefore(t,e,n):c.appendChild(t,e))}function b(t,e,n){if(Array.isArray(e)){0;for(var r=0;r<e.length;++r)p(e[r],n,t.elm,null,!0,e,r)}else s(t.text)&&c.appendChild(t.elm,c.createTextNode(String(t.text)))}function _(t){while(t.componentInstance)t=t.componentInstance._vnode;return i(t.tag)}function w(t,n){for(var r=0;r<a.create.length;++r)a.create[r](Ii,t);e=t.data.hook,i(e)&&(i(e.create)&&e.create(Ii,t),i(e.insert)&&n.push(t))}function T(t){var e;if(i(e=t.fnScopeId))c.setStyleScope(t.elm,e);else{var n=t;while(n)i(e=n.context)&&i(e=e.$options._scopeId)&&c.setStyleScope(t.elm,e),n=n.parent}i(e=Dn)&&e!==t.context&&e!==t.fnContext&&i(e=e.$options._scopeId)&&c.setStyleScope(t.elm,e)}function E(t,e,n,r,i,o){for(;r<=i;++r)p(n[r],o,t,e,!1,n,r)}function S(t){var e,n,r=t.data;if(i(r))for(i(e=r.hook)&&i(e=e.destroy)&&e(t),e=0;e<a.destroy.length;++e)a.destroy[e](t);if(i(e=t.children))for(n=0;n<t.children.length;++n)S(t.children[n])}function C(t,e,n,r){for(;n<=r;++n){var o=e[n];i(o)&&(i(o.tag)?(I(o),S(o)):f(o.elm))}}function I(t,e){if(i(e)||i(t.data)){var n,r=a.remove.length+1;for(i(e)?e.listeners+=r:e=l(t.elm,r),i(n=t.componentInstance)&&i(n=n._vnode)&&i(n.data)&&I(n,e),n=0;n<a.remove.length;++n)a.remove[n](t,e);i(n=t.data.hook)&&i(n=n.remove)?n(t,e):e()}else f(t.elm)}function A(t,e,n,o,a){var s,u,h,l,f=0,d=0,m=e.length-1,y=e[0],g=e[m],v=n.length-1,b=n[0],_=n[v],w=!a;while(f<=m&&d<=v)r(y)?y=e[++f]:r(g)?g=e[--m]:Ni(y,b)?(k(y,b,o,n,d),y=e[++f],b=n[++d]):Ni(g,_)?(k(g,_,o,n,v),g=e[--m],_=n[--v]):Ni(y,_)?(k(y,_,o,n,v),w&&c.insertBefore(t,y.elm,c.nextSibling(g.elm)),y=e[++f],_=n[--v]):Ni(g,b)?(k(g,b,o,n,d),w&&c.insertBefore(t,g.elm,y.elm),g=e[--m],b=n[++d]):(r(s)&&(s=Di(e,f,m)),u=i(b.key)?s[b.key]:N(b,e,f,m),r(u)?p(b,o,t,y.elm,!1,n,d):(h=e[u],Ni(h,b)?(k(h,b,o,n,d),e[u]=void 0,w&&c.insertBefore(t,h.elm,y.elm)):p(b,o,t,y.elm,!1,n,d)),b=n[++d]);f>m?(l=r(n[v+1])?null:n[v+1].elm,E(t,l,n,d,v,o)):d>v&&C(t,e,f,m)}function N(t,e,n,r){for(var o=n;o<r;o++){var a=e[o];if(i(a)&&Ni(t,a))return o}}function k(t,e,n,s,u,h){if(t!==e){i(e.elm)&&i(s)&&(e=s[u]=Et(e));var l=e.elm=t.elm;if(o(t.isAsyncPlaceholder))i(e.asyncFactory.resolved)?O(t.elm,e,n):e.isAsyncPlaceholder=!0;else if(o(e.isStatic)&&o(t.isStatic)&&e.key===t.key&&(o(e.isCloned)||o(e.isOnce)))e.componentInstance=t.componentInstance;else{var f,p=e.data;i(p)&&i(f=p.hook)&&i(f=f.prepatch)&&f(t,e);var d=t.children,m=e.children;if(i(p)&&_(e)){for(f=0;f<a.update.length;++f)a.update[f](t,e);i(f=p.hook)&&i(f=f.update)&&f(t,e)}r(e.text)?i(d)&&i(m)?d!==m&&A(l,d,m,n,h):i(m)?(i(t.text)&&c.setTextContent(l,""),E(l,null,m,0,m.length-1,n)):i(d)?C(l,d,0,d.length-1):i(t.text)&&c.setTextContent(l,""):t.text!==e.text&&c.setTextContent(l,e.text),i(p)&&i(f=p.hook)&&i(f=f.postpatch)&&f(t,e)}}}function D(t,e,n){if(o(n)&&i(t.parent))t.parent.data.pendingInsert=e;else for(var r=0;r<e.length;++r)e[r].data.hook.insert(e[r])}var x=y("attrs,class,staticClass,staticStyle,key");function O(t,e,n,r){var a,s=e.tag,u=e.data,c=e.children;if(r=r||u&&u.pre,e.elm=t,o(e.isComment)&&i(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(i(u)&&(i(a=u.hook)&&i(a=a.init)&&a(e,!0),i(a=e.componentInstance)))return m(e,n),!0;if(i(s)){if(i(c))if(t.hasChildNodes())if(i(a=u)&&i(a=a.domProps)&&i(a=a.innerHTML)){if(a!==t.innerHTML)return!1}else{for(var h=!0,l=t.firstChild,f=0;f<c.length;f++){if(!l||!O(l,c[f],n,r)){h=!1;break}l=l.nextSibling}if(!h||l)return!1}else b(e,c,n);if(i(u)){var p=!1;for(var d in u)if(!x(d)){p=!0,w(e,n);break}!p&&u["class"]&&ye(u["class"])}}else t.data!==e.text&&(t.data=e.text);return!0}return function(t,e,n,s){if(!r(e)){var u=!1,l=[];if(r(t))u=!0,p(e,l);else{var f=i(t.nodeType);if(!f&&Ni(t,e))k(t,e,l,null,null,s);else{if(f){if(1===t.nodeType&&t.hasAttribute(q)&&(t.removeAttribute(q),n=!0),o(n)&&O(t,e,l))return D(e,l,!0),t;t=h(t)}var d=t.elm,m=c.parentNode(d);if(p(e,l,d._leaveCb?null:m,c.nextSibling(d)),i(e.parent)){var y=e.parent,g=_(e);while(y){for(var v=0;v<a.destroy.length;++v)a.destroy[v](y);if(y.elm=e.elm,g){for(var b=0;b<a.create.length;++b)a.create[b](Ii,y);var w=y.data.hook.insert;if(w.merged)for(var T=1;T<w.fns.length;T++)w.fns[T]()}else Ci(y);y=y.parent}}i(m)?C(m,[t],0,0):i(t.tag)&&S(t)}}return D(e,l,u),e.elm}i(t)&&S(t)}}var Oi={create:Ri,update:Ri,destroy:function(t){Ri(t,Ii)}};function Ri(t,e){(t.data.directives||e.data.directives)&&Mi(t,e)}function Mi(t,e){var n,r,i,o=t===Ii,a=e===Ii,s=Li(t.data.directives,t.context),u=Li(e.data.directives,e.context),c=[],h=[];for(n in u)r=s[n],i=u[n],r?(i.oldValue=r.value,i.oldArg=r.arg,Ui(i,"update",e,t),i.def&&i.def.componentUpdated&&h.push(i)):(Ui(i,"bind",e,t),i.def&&i.def.inserted&&c.push(i));if(c.length){var l=function(){for(var n=0;n<c.length;n++)Ui(c[n],"inserted",e,t)};o?we(e,"insert",l):l()}if(h.length&&we(e,"postpatch",(function(){for(var n=0;n<h.length;n++)Ui(h[n],"componentUpdated",e,t)})),!o)for(n in s)u[n]||Ui(s[n],"unbind",t,t,a)}var Pi=Object.create(null);function Li(t,e){var n,r,i=Object.create(null);if(!t)return i;for(n=0;n<t.length;n++)r=t[n],r.modifiers||(r.modifiers=Pi),i[Fi(r)]=r,r.def=Yt(e.$options,"directives",r.name,!0);return i}function Fi(t){return t.rawName||t.name+"."+Object.keys(t.modifiers||{}).join(".")}function Ui(t,e,n,r,i){var o=t.def&&t.def[e];if(o)try{o(n.elm,t,n,r,i)}catch(Ea){ee(Ea,n.context,"directive "+t.name+" "+e+" hook")}}var qi=[Si,Oi];function Vi(t,e){var n=e.componentOptions;if((!i(n)||!1!==n.Ctor.options.inheritAttrs)&&(!r(t.data.attrs)||!r(e.data.attrs))){var o,a,s,u=e.elm,c=t.data.attrs||{},h=e.data.attrs||{};for(o in i(h.__ob__)&&(h=e.data.attrs=x({},h)),h)a=h[o],s=c[o],s!==a&&Bi(u,o,a);for(o in(tt||nt)&&h.value!==c.value&&Bi(u,"value",h.value),c)r(h[o])&&(Gr(o)?u.removeAttributeNS(zr,Qr(o)):Br(o)||u.removeAttribute(o))}}function Bi(t,e,n){t.tagName.indexOf("-")>-1?ji(t,e,n):Kr(e)?Hr(n)?t.removeAttribute(e):(n="allowfullscreen"===e&&"EMBED"===t.tagName?"true":e,t.setAttribute(e,n)):Br(e)?t.setAttribute(e,Wr(e,n)):Gr(e)?Hr(n)?t.removeAttributeNS(zr,Qr(e)):t.setAttributeNS(zr,e,n):ji(t,e,n)}function ji(t,e,n){if(Hr(n))t.removeAttribute(e);else{if(tt&&!et&&"TEXTAREA"===t.tagName&&"placeholder"===e&&""!==n&&!t.__ieph){var r=function(e){e.stopImmediatePropagation(),t.removeEventListener("input",r)};t.addEventListener("input",r),t.__ieph=!0}t.setAttribute(e,n)}}var Wi={create:Vi,update:Vi};function Ki(t,e){var n=e.elm,o=e.data,a=t.data;if(!(r(o.staticClass)&&r(o.class)&&(r(a)||r(a.staticClass)&&r(a.class)))){var s=Yr(e),u=n._transitionClasses;i(u)&&(s=Jr(s,Zr(u))),s!==n._prevClass&&(n.setAttribute("class",s),n._prevClass=s)}}var zi,Gi={create:Ki,update:Ki},Qi="__r",Hi="__c";function Yi(t){if(i(t[Qi])){var e=tt?"change":"input";t[e]=[].concat(t[Qi],t[e]||[]),delete t[Qi]}i(t[Hi])&&(t.change=[].concat(t[Hi],t.change||[]),delete t[Hi])}function $i(t,e,n){var r=zi;return function i(){var o=e.apply(null,arguments);null!==o&&Zi(t,i,n,r)}}var Xi=ae&&!(it&&Number(it[1])<=53);function Ji(t,e,n,r){if(Xi){var i=Qn,o=e;e=o._wrapper=function(t){if(t.target===t.currentTarget||t.timeStamp>=i||t.timeStamp<=0||t.target.ownerDocument!==document)return o.apply(this,arguments)}}zi.addEventListener(t,e,at?{capture:n,passive:r}:n)}function Zi(t,e,n,r){(r||zi).removeEventListener(t,e._wrapper||e,n)}function to(t,e){if(!r(t.data.on)||!r(e.data.on)){var n=e.data.on||{},i=t.data.on||{};zi=e.elm,Yi(n),_e(n,i,Ji,Zi,$i,e.context),zi=void 0}}var eo,no={create:to,update:to};function ro(t,e){if(!r(t.data.domProps)||!r(e.data.domProps)){var n,o,a=e.elm,s=t.data.domProps||{},u=e.data.domProps||{};for(n in i(u.__ob__)&&(u=e.data.domProps=x({},u)),s)n in u||(a[n]="");for(n in u){if(o=u[n],"textContent"===n||"innerHTML"===n){if(e.children&&(e.children.length=0),o===s[n])continue;1===a.childNodes.length&&a.removeChild(a.childNodes[0])}if("value"===n&&"PROGRESS"!==a.tagName){a._value=o;var c=r(o)?"":String(o);io(a,c)&&(a.value=c)}else if("innerHTML"===n&&ii(a.tagName)&&r(a.innerHTML)){eo=eo||document.createElement("div"),eo.innerHTML="<svg>"+o+"</svg>";var h=eo.firstChild;while(a.firstChild)a.removeChild(a.firstChild);while(h.firstChild)a.appendChild(h.firstChild)}else if(o!==s[n])try{a[n]=o}catch(Ea){}}}}function io(t,e){return!t.composing&&("OPTION"===t.tagName||oo(t,e)||ao(t,e))}function oo(t,e){var n=!0;try{n=document.activeElement!==t}catch(Ea){}return n&&t.value!==e}function ao(t,e){var n=t.value,r=t._vModifiers;if(i(r)){if(r.number)return m(n)!==m(e);if(r.trim)return n.trim()!==e.trim()}return n!==e}var so={create:ro,update:ro},uo=w((function(t){var e={},n=/;(?![^(]*\))/g,r=/:(.+)/;return t.split(n).forEach((function(t){if(t){var n=t.split(r);n.length>1&&(e[n[0].trim()]=n[1].trim())}})),e}));function co(t){var e=ho(t.style);return t.staticStyle?x(t.staticStyle,e):e}function ho(t){return Array.isArray(t)?O(t):"string"===typeof t?uo(t):t}function lo(t,e){var n,r={};if(e){var i=t;while(i.componentInstance)i=i.componentInstance._vnode,i&&i.data&&(n=co(i.data))&&x(r,n)}(n=co(t.data))&&x(r,n);var o=t;while(o=o.parent)o.data&&(n=co(o.data))&&x(r,n);return r}var fo,po=/^--/,mo=/\s*!important$/,yo=function(t,e,n){if(po.test(e))t.style.setProperty(e,n);else if(mo.test(n))t.style.setProperty(I(e),n.replace(mo,""),"important");else{var r=vo(e);if(Array.isArray(n))for(var i=0,o=n.length;i<o;i++)t.style[r]=n[i];else t.style[r]=n}},go=["Webkit","Moz","ms"],vo=w((function(t){if(fo=fo||document.createElement("div").style,t=E(t),"filter"!==t&&t in fo)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),n=0;n<go.length;n++){var r=go[n]+e;if(r in fo)return r}}));function bo(t,e){var n=e.data,o=t.data;if(!(r(n.staticStyle)&&r(n.style)&&r(o.staticStyle)&&r(o.style))){var a,s,u=e.elm,c=o.staticStyle,h=o.normalizedStyle||o.style||{},l=c||h,f=ho(e.data.style)||{};e.data.normalizedStyle=i(f.__ob__)?x({},f):f;var p=lo(e,!0);for(s in l)r(p[s])&&yo(u,s,"");for(s in p)a=p[s],a!==l[s]&&yo(u,s,null==a?"":a)}}var _o={create:bo,update:bo},wo=/\s+/;function To(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(wo).forEach((function(e){return t.classList.add(e)})):t.classList.add(e);else{var n=" "+(t.getAttribute("class")||"")+" ";n.indexOf(" "+e+" ")<0&&t.setAttribute("class",(n+e).trim())}}function Eo(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(wo).forEach((function(e){return t.classList.remove(e)})):t.classList.remove(e),t.classList.length||t.removeAttribute("class");else{var n=" "+(t.getAttribute("class")||"")+" ",r=" "+e+" ";while(n.indexOf(r)>=0)n=n.replace(r," ");n=n.trim(),n?t.setAttribute("class",n):t.removeAttribute("class")}}function So(t){if(t){if("object"===typeof t){var e={};return!1!==t.css&&x(e,Co(t.name||"v")),x(e,t),e}return"string"===typeof t?Co(t):void 0}}var Co=w((function(t){return{enterClass:t+"-enter",enterToClass:t+"-enter-to",enterActiveClass:t+"-enter-active",leaveClass:t+"-leave",leaveToClass:t+"-leave-to",leaveActiveClass:t+"-leave-active"}})),Io=$&&!et,Ao="transition",No="animation",ko="transition",Do="transitionend",xo="animation",Oo="animationend";Io&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(ko="WebkitTransition",Do="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(xo="WebkitAnimation",Oo="webkitAnimationEnd"));var Ro=$?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(t){return t()};function Mo(t){Ro((function(){Ro(t)}))}function Po(t,e){var n=t._transitionClasses||(t._transitionClasses=[]);n.indexOf(e)<0&&(n.push(e),To(t,e))}function Lo(t,e){t._transitionClasses&&v(t._transitionClasses,e),Eo(t,e)}function Fo(t,e,n){var r=qo(t,e),i=r.type,o=r.timeout,a=r.propCount;if(!i)return n();var s=i===Ao?Do:Oo,u=0,c=function(){t.removeEventListener(s,h),n()},h=function(e){e.target===t&&++u>=a&&c()};setTimeout((function(){u<a&&c()}),o+1),t.addEventListener(s,h)}var Uo=/\b(transform|all)(,|$)/;function qo(t,e){var n,r=window.getComputedStyle(t),i=(r[ko+"Delay"]||"").split(", "),o=(r[ko+"Duration"]||"").split(", "),a=Vo(i,o),s=(r[xo+"Delay"]||"").split(", "),u=(r[xo+"Duration"]||"").split(", "),c=Vo(s,u),h=0,l=0;e===Ao?a>0&&(n=Ao,h=a,l=o.length):e===No?c>0&&(n=No,h=c,l=u.length):(h=Math.max(a,c),n=h>0?a>c?Ao:No:null,l=n?n===Ao?o.length:u.length:0);var f=n===Ao&&Uo.test(r[ko+"Property"]);return{type:n,timeout:h,propCount:l,hasTransform:f}}function Vo(t,e){while(t.length<e.length)t=t.concat(t);return Math.max.apply(null,e.map((function(e,n){return Bo(e)+Bo(t[n])})))}function Bo(t){return 1e3*Number(t.slice(0,-1).replace(",","."))}function jo(t,e){var n=t.elm;i(n._leaveCb)&&(n._leaveCb.cancelled=!0,n._leaveCb());var o=So(t.data.transition);if(!r(o)&&!i(n._enterCb)&&1===n.nodeType){var a=o.css,s=o.type,c=o.enterClass,h=o.enterToClass,l=o.enterActiveClass,f=o.appearClass,p=o.appearToClass,d=o.appearActiveClass,y=o.beforeEnter,g=o.enter,v=o.afterEnter,b=o.enterCancelled,_=o.beforeAppear,w=o.appear,T=o.afterAppear,E=o.appearCancelled,S=o.duration,C=Dn,I=Dn.$vnode;while(I&&I.parent)C=I.context,I=I.parent;var A=!C._isMounted||!t.isRootInsert;if(!A||w||""===w){var N=A&&f?f:c,k=A&&d?d:l,D=A&&p?p:h,x=A&&_||y,O=A&&"function"===typeof w?w:g,R=A&&T||v,M=A&&E||b,P=m(u(S)?S.enter:S);0;var L=!1!==a&&!et,F=zo(O),q=n._enterCb=U((function(){L&&(Lo(n,D),Lo(n,k)),q.cancelled?(L&&Lo(n,N),M&&M(n)):R&&R(n),n._enterCb=null}));t.data.show||we(t,"insert",(function(){var e=n.parentNode,r=e&&e._pending&&e._pending[t.key];r&&r.tag===t.tag&&r.elm._leaveCb&&r.elm._leaveCb(),O&&O(n,q)})),x&&x(n),L&&(Po(n,N),Po(n,k),Mo((function(){Lo(n,N),q.cancelled||(Po(n,D),F||(Ko(P)?setTimeout(q,P):Fo(n,s,q)))}))),t.data.show&&(e&&e(),O&&O(n,q)),L||F||q()}}}function Wo(t,e){var n=t.elm;i(n._enterCb)&&(n._enterCb.cancelled=!0,n._enterCb());var o=So(t.data.transition);if(r(o)||1!==n.nodeType)return e();if(!i(n._leaveCb)){var a=o.css,s=o.type,c=o.leaveClass,h=o.leaveToClass,l=o.leaveActiveClass,f=o.beforeLeave,p=o.leave,d=o.afterLeave,y=o.leaveCancelled,g=o.delayLeave,v=o.duration,b=!1!==a&&!et,_=zo(p),w=m(u(v)?v.leave:v);0;var T=n._leaveCb=U((function(){n.parentNode&&n.parentNode._pending&&(n.parentNode._pending[t.key]=null),b&&(Lo(n,h),Lo(n,l)),T.cancelled?(b&&Lo(n,c),y&&y(n)):(e(),d&&d(n)),n._leaveCb=null}));g?g(E):E()}function E(){T.cancelled||(!t.data.show&&n.parentNode&&((n.parentNode._pending||(n.parentNode._pending={}))[t.key]=t),f&&f(n),b&&(Po(n,c),Po(n,l),Mo((function(){Lo(n,c),T.cancelled||(Po(n,h),_||(Ko(w)?setTimeout(T,w):Fo(n,s,T)))}))),p&&p(n,T),b||_||T())}}function Ko(t){return"number"===typeof t&&!isNaN(t)}function zo(t){if(r(t))return!1;var e=t.fns;return i(e)?zo(Array.isArray(e)?e[0]:e):(t._length||t.length)>1}function Go(t,e){!0!==e.data.show&&jo(e)}var Qo=$?{create:Go,activate:Go,remove:function(t,e){!0!==t.data.show?Wo(t,e):e()}}:{},Ho=[Wi,Gi,no,so,_o,Qo],Yo=Ho.concat(qi),$o=xi({nodeOps:Ei,modules:Yo});et&&document.addEventListener("selectionchange",(function(){var t=document.activeElement;t&&t.vmodel&&ia(t,"input")}));var Xo={inserted:function(t,e,n,r){"select"===n.tag?(r.elm&&!r.elm._vOptions?we(n,"postpatch",(function(){Xo.componentUpdated(t,e,n)})):Jo(t,e,n.context),t._vOptions=[].map.call(t.options,ea)):("textarea"===n.tag||ci(t.type))&&(t._vModifiers=e.modifiers,e.modifiers.lazy||(t.addEventListener("compositionstart",na),t.addEventListener("compositionend",ra),t.addEventListener("change",ra),et&&(t.vmodel=!0)))},componentUpdated:function(t,e,n){if("select"===n.tag){Jo(t,e,n.context);var r=t._vOptions,i=t._vOptions=[].map.call(t.options,ea);if(i.some((function(t,e){return!L(t,r[e])}))){var o=t.multiple?e.value.some((function(t){return ta(t,i)})):e.value!==e.oldValue&&ta(e.value,i);o&&ia(t,"change")}}}};function Jo(t,e,n){Zo(t,e,n),(tt||nt)&&setTimeout((function(){Zo(t,e,n)}),0)}function Zo(t,e,n){var r=e.value,i=t.multiple;if(!i||Array.isArray(r)){for(var o,a,s=0,u=t.options.length;s<u;s++)if(a=t.options[s],i)o=F(r,ea(a))>-1,a.selected!==o&&(a.selected=o);else if(L(ea(a),r))return void(t.selectedIndex!==s&&(t.selectedIndex=s));i||(t.selectedIndex=-1)}}function ta(t,e){return e.every((function(e){return!L(e,t)}))}function ea(t){return"_value"in t?t._value:t.value}function na(t){t.target.composing=!0}function ra(t){t.target.composing&&(t.target.composing=!1,ia(t.target,"input"))}function ia(t,e){var n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}function oa(t){return!t.componentInstance||t.data&&t.data.transition?t:oa(t.componentInstance._vnode)}var aa={bind:function(t,e,n){var r=e.value;n=oa(n);var i=n.data&&n.data.transition,o=t.__vOriginalDisplay="none"===t.style.display?"":t.style.display;r&&i?(n.data.show=!0,jo(n,(function(){t.style.display=o}))):t.style.display=r?o:"none"},update:function(t,e,n){var r=e.value,i=e.oldValue;if(!r!==!i){n=oa(n);var o=n.data&&n.data.transition;o?(n.data.show=!0,r?jo(n,(function(){t.style.display=t.__vOriginalDisplay})):Wo(n,(function(){t.style.display="none"}))):t.style.display=r?t.__vOriginalDisplay:"none"}},unbind:function(t,e,n,r,i){i||(t.style.display=t.__vOriginalDisplay)}},sa={model:Xo,show:aa},ua={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function ca(t){var e=t&&t.componentOptions;return e&&e.Ctor.options.abstract?ca(En(e.children)):t}function ha(t){var e={},n=t.$options;for(var r in n.propsData)e[r]=t[r];var i=n._parentListeners;for(var o in i)e[E(o)]=i[o];return e}function la(t,e){if(/\d-keep-alive$/.test(e.tag))return t("keep-alive",{props:e.componentOptions.propsData})}function fa(t){while(t=t.parent)if(t.data.transition)return!0}function pa(t,e){return e.key===t.key&&e.tag===t.tag}var da=function(t){return t.tag||Tn(t)},ma=function(t){return"show"===t.name},ya={name:"transition",props:ua,abstract:!0,render:function(t){var e=this,n=this.$slots.default;if(n&&(n=n.filter(da),n.length)){0;var r=this.mode;0;var i=n[0];if(fa(this.$vnode))return i;var o=ca(i);if(!o)return i;if(this._leaving)return la(t,i);var a="__transition-"+this._uid+"-";o.key=null==o.key?o.isComment?a+"comment":a+o.tag:s(o.key)?0===String(o.key).indexOf(a)?o.key:a+o.key:o.key;var u=(o.data||(o.data={})).transition=ha(this),c=this._vnode,h=ca(c);if(o.data.directives&&o.data.directives.some(ma)&&(o.data.show=!0),h&&h.data&&!pa(o,h)&&!Tn(h)&&(!h.componentInstance||!h.componentInstance._vnode.isComment)){var l=h.data.transition=x({},u);if("out-in"===r)return this._leaving=!0,we(l,"afterLeave",(function(){e._leaving=!1,e.$forceUpdate()})),la(t,i);if("in-out"===r){if(Tn(o))return c;var f,p=function(){f()};we(u,"afterEnter",p),we(u,"enterCancelled",p),we(l,"delayLeave",(function(t){f=t}))}}return i}}},ga=x({tag:String,moveClass:String},ua);delete ga.mode;var va={props:ga,beforeMount:function(){var t=this,e=this._update;this._update=function(n,r){var i=xn(t);t.__patch__(t._vnode,t.kept,!1,!0),t._vnode=t.kept,i(),e.call(t,n,r)}},render:function(t){for(var e=this.tag||this.$vnode.data.tag||"span",n=Object.create(null),r=this.prevChildren=this.children,i=this.$slots.default||[],o=this.children=[],a=ha(this),s=0;s<i.length;s++){var u=i[s];if(u.tag)if(null!=u.key&&0!==String(u.key).indexOf("__vlist"))o.push(u),n[u.key]=u,(u.data||(u.data={})).transition=a;else;}if(r){for(var c=[],h=[],l=0;l<r.length;l++){var f=r[l];f.data.transition=a,f.data.pos=f.elm.getBoundingClientRect(),n[f.key]?c.push(f):h.push(f)}this.kept=t(e,null,c),this.removed=h}return t(e,null,o)},updated:function(){var t=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";t.length&&this.hasMove(t[0].elm,e)&&(t.forEach(ba),t.forEach(_a),t.forEach(wa),this._reflow=document.body.offsetHeight,t.forEach((function(t){if(t.data.moved){var n=t.elm,r=n.style;Po(n,e),r.transform=r.WebkitTransform=r.transitionDuration="",n.addEventListener(Do,n._moveCb=function t(r){r&&r.target!==n||r&&!/transform$/.test(r.propertyName)||(n.removeEventListener(Do,t),n._moveCb=null,Lo(n,e))})}})))},methods:{hasMove:function(t,e){if(!Io)return!1;if(this._hasMove)return this._hasMove;var n=t.cloneNode();t._transitionClasses&&t._transitionClasses.forEach((function(t){Eo(n,t)})),To(n,e),n.style.display="none",this.$el.appendChild(n);var r=qo(n);return this.$el.removeChild(n),this._hasMove=r.hasTransform}}};function ba(t){t.elm._moveCb&&t.elm._moveCb(),t.elm._enterCb&&t.elm._enterCb()}function _a(t){t.data.newPos=t.elm.getBoundingClientRect()}function wa(t){var e=t.data.pos,n=t.data.newPos,r=e.left-n.left,i=e.top-n.top;if(r||i){t.data.moved=!0;var o=t.elm.style;o.transform=o.WebkitTransform="translate("+r+"px,"+i+"px)",o.transitionDuration="0s"}}var Ta={Transition:ya,TransitionGroup:va};Er.config.mustUseProp=Vr,Er.config.isReservedTag=oi,Er.config.isReservedAttr=Ur,Er.config.getTagNamespace=ai,Er.config.isUnknownElement=ui,x(Er.options.directives,sa),x(Er.options.components,Ta),Er.prototype.__patch__=$?$o:R,Er.prototype.$mount=function(t,e){return t=t&&$?hi(t):void 0,Mn(this,t,e)},$&&setTimeout((function(){j.devtools&&ct&&ct.emit("init",Er)}),0),e["a"]=Er}).call(this,n("c8ba"))},"2b4c":function(t,e,n){var r=n("5537")("wks"),i=n("ca5a"),o=n("7726").Symbol,a="function"==typeof o,s=t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))};s.store=r},"2d00":function(t,e){t.exports=!1},"2d83":function(t,e,n){"use strict";var r=n("387f");t.exports=function(t,e,n,i,o){var a=new Error(t);return r(a,e,n,i,o)}},"2d95":function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},"2e66":function(t,e,n){"use strict";n.r(e),n.d(e,"registerStorage",(function(){return Me}));var r=n("c23d"),i=n.n(r),o=n("9ab4"),a="firebasestorage.googleapis.com",s="storageBucket",u=12e4,c=6e5,h=-9007199254740991,l=function(){function t(t,e){this.code_=p(t),this.message_="Firebase Storage: "+e,this.serverResponse_=null,this.name_="FirebaseError"}return t.prototype.codeProp=function(){return this.code},t.prototype.codeEquals=function(t){return p(t)===this.codeProp()},t.prototype.serverResponseProp=function(){return this.serverResponse_},t.prototype.setServerResponseProp=function(t){this.serverResponse_=t},Object.defineProperty(t.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),t}(),f={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"};function p(t){return"storage/"+t}function d(){var t="An unknown error occurred, please check the error payload for server response.";return new l(f.UNKNOWN,t)}function m(t){return new l(f.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function y(t){return new l(f.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function g(){var t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new l(f.UNAUTHENTICATED,t)}function v(t){return new l(f.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function b(){return new l(f.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function _(){return new l(f.CANCELED,"User canceled the upload/download.")}function w(t){return new l(f.INVALID_URL,"Invalid URL '"+t+"'.")}function T(t){return new l(f.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function E(){return new l(f.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+s+"' property when initializing the app?")}function S(){return new l(f.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function C(){return new l(f.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function I(){return new l(f.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function A(t,e,n){return new l(f.INVALID_ARGUMENT,"Invalid argument in `"+e+"` at index "+t+": "+n)}function N(t,e,n,r){var i,o;return t===e?(i=t,o=1===t?"argument":"arguments"):(i="between "+t+" and "+e,o="arguments"),new l(f.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+n+"`: Expected "+i+" "+o+", received "+r+".")}function k(){return new l(f.APP_DELETED,"The Firebase app was deleted.")}function D(t){return new l(f.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function x(t,e){return new l(f.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function O(t){throw new l(f.INTERNAL_ERROR,"Internal error: "+t)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var R={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};function M(t){switch(t){case R.RAW:case R.BASE64:case R.BASE64URL:case R.DATA_URL:return;default:throw"Expected one of the event types: ["+R.RAW+", "+R.BASE64+", "+R.BASE64URL+", "+R.DATA_URL+"]."}}var P=function(){function t(t,e){this.data=t,this.contentType=e||null}return t}();function L(t,e){switch(t){case R.RAW:return new P(F(e));case R.BASE64:case R.BASE64URL:return new P(q(t,e));case R.DATA_URL:return new P(B(e),j(e))}throw d()}function F(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296===(64512&r)){var i=n<t.length-1&&56320===(64512&t.charCodeAt(n+1));if(i){var o=r,a=t.charCodeAt(++n);r=65536|(1023&o)<<10|1023&a,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else e.push(239,191,189)}else 56320===(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function U(t){var e;try{e=decodeURIComponent(t)}catch(n){throw x(R.DATA_URL,"Malformed data URL.")}return F(e)}function q(t,e){switch(t){case R.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r){var i=n?"-":"_";throw x(t,"Invalid character '"+i+"' found: is it base64url encoded?")}break;case R.BASE64URL:var o=-1!==e.indexOf("+"),a=-1!==e.indexOf("/");if(o||a){i=o?"+":"/";throw x(t,"Invalid character '"+i+"' found: is it base64 encoded?")}e=e.replace(/-/g,"+").replace(/_/g,"/");break}var s;try{s=atob(e)}catch(h){throw x(t,"Invalid character found")}for(var u=new Uint8Array(s.length),c=0;c<s.length;c++)u[c]=s.charCodeAt(c);return u}var V=function(){function t(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw x(R.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=W(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1)}return t}();function B(t){var e=new V(t);return e.base64?q(R.BASE64,e.rest):U(e.rest)}function j(t){var e=new V(t);return e.contentType}function W(t,e){var n=t.length>=e.length;return!!n&&t.substring(t.length-e.length)===e}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var K,z={STATE_CHANGED:"state_changed"},G={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"},Q={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function H(t){switch(t){case G.RUNNING:case G.PAUSING:case G.CANCELING:return Q.RUNNING;case G.PAUSED:return Q.PAUSED;case G.SUCCESS:return Q.SUCCESS;case G.CANCELED:return Q.CANCELED;case G.ERROR:return Q.ERROR;default:return Q.ERROR}}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y(t){return null!=t}function $(t){return void 0!==t}function X(t){return"function"===typeof t}function J(t){return"object"===typeof t}function Z(t){return J(t)&&null!==t}function tt(t){return J(t)&&!Array.isArray(t)}function et(t){return"string"===typeof t||t instanceof String}function nt(t){return rt(t)&&Number.isInteger(t)}function rt(t){return"number"===typeof t||t instanceof Number}function it(t){return ot()&&t instanceof Blob}function ot(){return"undefined"!==typeof Blob}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(t){t[t["NO_ERROR"]=0]="NO_ERROR",t[t["NETWORK_ERROR"]=1]="NETWORK_ERROR",t[t["ABORT"]=2]="ABORT"})(K||(K={}));
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var at=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=K.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=K.ABORT,e(t)})),t.xhr_.addEventListener("error",(function(){t.errorCode_=K.NETWORK_ERROR,e(t)})),t.xhr_.addEventListener("load",(function(){e(t)}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw O("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),Y(r))for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return Y(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw O("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw O("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw O("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){Y(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){Y(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",t)},t}(),st=function(){function t(){}return t.prototype.createXhrIo=function(){return new at},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ut(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function ct(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=ut();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(ot())return new Blob(t);throw Error("This browser doesn't seem to support creating Blobs")}function ht(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lt=function(){function t(t,e){var n=0,r="";it(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(it(this.data_)){var r=this.data_,i=ht(r,e,n);return null===i?null:new t(i)}var o=new Uint8Array(this.data_.buffer,e,n-e);return new t(o,!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(ot()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(ct.apply(null,r))}var i=e.map((function(t){return et(t)?L(R.RAW,t).data:t.data_})),o=0;i.forEach((function(t){o+=t.byteLength}));var a=new Uint8Array(o),s=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]})),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}(),ft=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!0,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(r){return new t(e,"")}if(""===n.path)return n;throw T(e)},t.makeFromUrl=function(e){var n=null,r="([A-Za-z0-9.\\-_]+)";function i(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}var o="(/(.*))?$",s="(/([^?#]*).*)?$",u=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function h(t){t.path_=decodeURIComponent(t.path)}for(var l="v[A-Za-z0-9_]+",f=a.replace(/[.]/g,"\\."),p=new RegExp("^https?://"+f+"/"+l+"/b/"+r+"/o"+s,"i"),d={bucket:1,path:3},m=[{regex:u,indices:c,postModify:i},{regex:p,indices:d,postModify:h}],y=0;y<m.length;y++){var g=m[y],v=g.regex.exec(e);if(v){var b=v[g.indices.bucket],_=v[g.indices.path];_||(_=""),n=new t(b,_),g.postModify(n);break}}if(null==n)throw w(e);return n},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function pt(t){var e;try{e=JSON.parse(t)}catch(n){return null}return tt(e)?e:null}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(t){if(0===t.length)return null;var e=t.lastIndexOf("/");if(-1===e)return"";var n=t.slice(0,e);return n}function mt(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}function yt(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(t){return"https://"+a+"/v0"+t}function vt(t){var e=encodeURIComponent,n="?";for(var r in t)if(t.hasOwnProperty(r)){var i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(t,e){return e}var _t=function(){function t(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||bt}return t}(),wt=null;function Tt(t){return!et(t)||t.length<2?t:yt(t)}function Et(){if(wt)return wt;var t=[];function e(t,e){return Tt(e)}t.push(new _t("bucket")),t.push(new _t("generation")),t.push(new _t("metageneration")),t.push(new _t("name","fullPath",!0));var n=new _t("name");function r(t,e){return Y(e)?Number(e):e}n.xform=e,t.push(n);var i=new _t("size");return i.xform=r,t.push(i),t.push(new _t("timeCreated")),t.push(new _t("updated")),t.push(new _t("md5Hash",null,!0)),t.push(new _t("cacheControl",null,!0)),t.push(new _t("contentDisposition",null,!0)),t.push(new _t("contentEncoding",null,!0)),t.push(new _t("contentLanguage",null,!0)),t.push(new _t("contentType",null,!0)),t.push(new _t("metadata","customMetadata",!0)),wt=t,wt}function St(t,e){function n(){var n=t["bucket"],r=t["fullPath"],i=new ft(n,r);return e.makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function Ct(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return St(r,t),r}function It(t,e,n){var r=pt(e);if(null===r)return null;var i=r;return Ct(t,i,n)}function At(t,e){var n=pt(e);if(null===n)return null;if(!et(n["downloadTokens"]))return null;var r=n["downloadTokens"];if(0===r.length)return null;var i=encodeURIComponent,o=r.split(","),a=o.map((function(e){var n=t["bucket"],r=t["fullPath"],o="/b/"+i(n)+"/o/"+i(r),a=gt(o),s=vt({alt:"media",token:e});return a+s}));return a[0]}function Nt(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}function kt(t){if(!J(t)||!t)throw"Expected Metadata object.";for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];if("customMetadata"===e){if(!J(n))throw"Expected object for 'customMetadata' mapping."}else if(Z(n))throw"Mapping for '"+e+"' cannot be an object."}}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dt="maxResults",xt=1e3,Ot="pageToken",Rt="prefixes",Mt="items";function Pt(t,e){var n={prefixes:[],items:[],nextPageToken:e["nextPageToken"]},r=t.bucket();if(null===r)throw E();if(e[Rt])for(var i=0,o=e[Rt];i<o.length;i++){var a=o[i],s=a.replace(/\/$/,""),u=t.makeStorageReference(new ft(r,s));n.prefixes.push(u)}if(e[Mt])for(var c=0,h=e[Mt];c<h.length;c++){var l=h[c];u=t.makeStorageReference(new ft(r,l["name"]));n.items.push(u)}return n}function Lt(t,e){var n=pt(e);if(null===n)return null;var r=n;return Pt(t,r)}function Ft(t){if(!J(t)||!t)throw"Expected ListOptions object.";for(var e in t)if(e===Dt){if(!nt(t[Dt])||t[Dt]<=0)throw"Expected maxResults to be a positive number.";if(t[Dt]>1e3)throw"Expected maxResults to be less than or equal to "+xt+"."}else{if(e!==Ot)throw"Unknown option: "+e;if(t[Ot]&&!et(t[Ot]))throw"Expected pageToken to be string."}}var Ut=function(){function t(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}return t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qt(t){if(!t)throw d()}function Vt(t,e){function n(n,r){var i=It(t,r,e);return qt(null!==i),i}return n}function Bt(t){function e(e,n){var r=Lt(t,n);return qt(null!==r),r}return e}function jt(t,e){function n(n,r){var i=It(t,r,e);return qt(null!==i),At(i,r)}return n}function Wt(t){function e(e,n){var r;return r=401===e.getStatus()?g():402===e.getStatus()?y(t.bucket):403===e.getStatus()?v(t.path):n,r.setServerResponseProp(n.serverResponseProp()),r}return e}function Kt(t){var e=Wt(t);function n(n,r){var i=e(n,r);return 404===n.getStatus()&&(i=m(t.path)),i.setServerResponseProp(r.serverResponseProp()),i}return n}function zt(t,e,n){var r=e.fullServerUrl(),i=gt(r),o="GET",a=t.maxOperationRetryTime(),s=new Ut(i,o,Vt(t,n),a);return s.errorHandler=Kt(e),s}function Gt(t,e,n,r,i){var o={};e.isRoot?o["prefix"]="":o["prefix"]=e.path+"/",n&&n.length>0&&(o["delimiter"]=n),r&&(o["pageToken"]=r),i&&(o["maxResults"]=i);var a=e.bucketOnlyServerUrl(),s=gt(a),u="GET",c=t.maxOperationRetryTime(),h=new Ut(s,u,Bt(t),c);return h.urlParams=o,h.errorHandler=Wt(e),h}function Qt(t,e,n){var r=e.fullServerUrl(),i=gt(r),o="GET",a=t.maxOperationRetryTime(),s=new Ut(i,o,jt(t,n),a);return s.errorHandler=Kt(e),s}function Ht(t,e,n,r){var i=e.fullServerUrl(),o=gt(i),a="PATCH",s=Nt(n,r),u={"Content-Type":"application/json; charset=utf-8"},c=t.maxOperationRetryTime(),h=new Ut(o,a,Vt(t,r),c);return h.headers=u,h.body=s,h.errorHandler=Kt(e),h}function Yt(t,e){var n=e.fullServerUrl(),r=gt(n),i="DELETE",o=t.maxOperationRetryTime();function a(t,e){}var s=new Ut(r,i,a,o);return s.successCodes=[200,204],s.errorHandler=Kt(e),s}function $t(t,e){return t&&t["contentType"]||e&&e.type()||"application/octet-stream"}function Xt(t,e,n){var r=Object.assign({},n);return r["fullPath"]=t.path,r["size"]=e.size(),r["contentType"]||(r["contentType"]=$t(null,e)),r}function Jt(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function s(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}var u=s();a["Content-Type"]="multipart/related; boundary="+u;var c=Xt(e,r,i),h=Nt(c,n),l="--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+h+"\r\n--"+u+"\r\nContent-Type: "+c["contentType"]+"\r\n\r\n",f="\r\n--"+u+"--",p=lt.getBlob(l,r,f);if(null===p)throw S();var d={name:c["fullPath"]},m=gt(o),y="POST",g=t.maxUploadRetryTime(),v=new Ut(m,y,Vt(t,n),g);return v.urlParams=d,v.headers=a,v.body=p.uploadData(),v.errorHandler=Wt(e),v}var Zt=function(){function t(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null}return t}();function te(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(i){qt(!1)}var r=e||["active"];return qt(!!n&&-1!==r.indexOf(n)),n}function ee(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=Xt(e,r,i),s={name:a["fullPath"]},u=gt(o),c="POST",h={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a["contentType"],"Content-Type":"application/json; charset=utf-8"},l=Nt(a,n),f=t.maxUploadRetryTime();function p(t){var e;te(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(n){qt(!1)}return qt(et(e)),e}var d=new Ut(u,c,p,f);return d.urlParams=s,d.headers=h,d.body=l,d.errorHandler=Wt(e),d}function ne(t,e,n,r){var i={"X-Goog-Upload-Command":"query"};function o(t){var e=te(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(o){qt(!1)}n||qt(!1);var i=Number(n);return qt(!isNaN(i)),new Zt(i,r.size(),"final"===e)}var a="POST",s=t.maxUploadRetryTime(),u=new Ut(n,a,o,s);return u.headers=i,u.errorHandler=Wt(e),u}var re=262144;function ie(t,e,n,r,i,o,a,s){var u=new Zt(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw C();var c=u.total-u.current,h=c;i>0&&(h=Math.min(h,i));var l=u.current,f=l+h,p=h===c?"upload, finalize":"upload",d={"X-Goog-Upload-Command":p,"X-Goog-Upload-Offset":u.current},m=r.slice(l,f);if(null===m)throw S();function y(t,n){var i,a=te(t,["active","final"]),s=u.current+h,c=r.size();return i="final"===a?Vt(e,o)(t,n):null,new Zt(s,c,"final"===a,i)}var g="POST",v=e.maxUploadRetryTime(),b=new Ut(n,g,y,v);return b.headers=d,b.body=m.uploadData(),b.progressCallback=s||null,b.errorHandler=Wt(t),b}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oe=function(){function t(t,e,n){var r=X(t)||Y(e)||Y(n);if(r)this.next=t,this.error=e||null,this.complete=n||null;else{var i=t;this.next=i.next||null,this.error=i.error||null,this.complete=i.complete||null}}return t}(),ae=function(){function t(t,e,n,r,i,o){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=o}return t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function se(t,e,n){for(var r=e.length,i=e.length,o=0;o<e.length;o++)if(e[o].optional){r=o;break}var a=r<=n.length&&n.length<=i;if(!a)throw N(r,i,t,n.length);for(o=0;o<n.length;o++)try{e[o].validator(n[o])}catch(s){throw s instanceof Error?A(o,t,s.message):A(o,t,s)}}var ue=function(){function t(t,e){var n=this;this.validator=function(e){n.optional&&!$(e)||t(e)},this.optional=!!e}return t}();function ce(t,e){return function(n){t(n),e(n)}}function he(t,e){function n(t){if(!et(t))throw"Expected string."}var r;return r=t?ce(n,t):n,new ue(r,e)}function le(){function t(t){var e=t instanceof Uint8Array||t instanceof ArrayBuffer||ot()&&t instanceof Blob;if(!e)throw"Expected Blob or File."}return new ue(t)}function fe(t){return new ue(kt,t)}function pe(t){return new ue(Ft,t)}function de(){function t(t){var e=rt(t)&&t>=0;if(!e)throw"Expected a number 0 or greater."}return new ue(t)}function me(t,e){function n(e){var n=null===e||Y(e)&&e instanceof Object;if(!n)throw"Expected an Object.";void 0!==t&&null!==t&&t(e)}return new ue(n,e)}function ye(t){function e(t){var e=null===t||X(t);if(!e)throw"Expected a Function."}return new ue(e,t)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ge(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ve=function(){function t(t,e,n,r,i,o){var a=this;void 0===o&&(o=null),this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=t,this.authWrapper_=e,this.location_=n,this.blob_=i,this.metadata_=o,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=G.RUNNING,this.errorHandler_=function(t){a.request_=null,a.chunkMultiplier_=1,t.codeEquals(f.CANCELED)?(a.needToFetchStatus_=!0,a.completeTransitions_()):(a.error_=t,a.transition_(G.ERROR))},this.metadataErrorHandler_=function(t){a.request_=null,t.codeEquals(f.CANCELED)?a.completeTransitions_():(a.error_=t,a.transition_(G.ERROR))},this.promise_=new Promise((function(t,e){a.resolve_=t,a.reject_=e,a.start_()})),this.promise_.then(null,(function(){}))}return t.prototype.makeProgressCallback_=function(){var t=this,e=this.transferred_;return function(n){return t.updateProgress_(e+n)}},t.prototype.shouldDoResumable_=function(t){return t.size()>262144},t.prototype.start_=function(){this.state_===G.RUNNING&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},t.prototype.resolveToken_=function(t){var e=this;this.authWrapper_.getAuthToken().then((function(n){switch(e.state_){case G.RUNNING:t(n);break;case G.CANCELING:e.transition_(G.CANCELED);break;case G.PAUSING:e.transition_(G.PAUSED);break}}))},t.prototype.createResumable_=function(){var t=this;this.resolveToken_((function(e){var n=ee(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then((function(e){t.request_=null,t.uploadUrl_=e,t.needToFetchStatus_=!1,t.completeTransitions_()}),t.errorHandler_)}))},t.prototype.fetchStatus_=function(){var t=this,e=this.uploadUrl_;this.resolveToken_((function(n){var r=ne(t.authWrapper_,t.location_,e,t.blob_),i=t.authWrapper_.makeRequest(r,n);t.request_=i,i.getPromise().then((function(e){e=e,t.request_=null,t.updateProgress_(e.current),t.needToFetchStatus_=!1,e.finalized&&(t.needToFetchMetadata_=!0),t.completeTransitions_()}),t.errorHandler_)}))},t.prototype.continueUpload_=function(){var t=this,e=re*this.chunkMultiplier_,n=new Zt(this.transferred_,this.blob_.size()),r=this.uploadUrl_;this.resolveToken_((function(i){var o;try{o=ie(t.location_,t.authWrapper_,r,t.blob_,e,t.mappings_,n,t.makeProgressCallback_())}catch(s){return t.error_=s,void t.transition_(G.ERROR)}var a=t.authWrapper_.makeRequest(o,i);t.request_=a,a.getPromise().then((function(e){t.increaseMultiplier_(),t.request_=null,t.updateProgress_(e.current),e.finalized?(t.metadata_=e.metadata,t.transition_(G.SUCCESS)):t.completeTransitions_()}),t.errorHandler_)}))},t.prototype.increaseMultiplier_=function(){var t=re*this.chunkMultiplier_;t<33554432&&(this.chunkMultiplier_*=2)},t.prototype.fetchMetadata_=function(){var t=this;this.resolveToken_((function(e){var n=zt(t.authWrapper_,t.location_,t.mappings_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then((function(e){t.request_=null,t.metadata_=e,t.transition_(G.SUCCESS)}),t.metadataErrorHandler_)}))},t.prototype.oneShotUpload_=function(){var t=this;this.resolveToken_((function(e){var n=Jt(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then((function(e){t.request_=null,t.metadata_=e,t.updateProgress_(t.blob_.size()),t.transition_(G.SUCCESS)}),t.errorHandler_)}))},t.prototype.updateProgress_=function(t){var e=this.transferred_;this.transferred_=t,this.transferred_!==e&&this.notifyObservers_()},t.prototype.transition_=function(t){if(this.state_!==t)switch(t){case G.CANCELING:this.state_=t,null!==this.request_&&this.request_.cancel();break;case G.PAUSING:this.state_=t,null!==this.request_&&this.request_.cancel();break;case G.RUNNING:var e=this.state_===G.PAUSED;this.state_=t,e&&(this.notifyObservers_(),this.start_());break;case G.PAUSED:this.state_=t,this.notifyObservers_();break;case G.CANCELED:this.error_=_(),this.state_=t,this.notifyObservers_();break;case G.ERROR:this.state_=t,this.notifyObservers_();break;case G.SUCCESS:this.state_=t,this.notifyObservers_();break}},t.prototype.completeTransitions_=function(){switch(this.state_){case G.PAUSING:this.transition_(G.PAUSED);break;case G.CANCELING:this.transition_(G.CANCELED);break;case G.RUNNING:this.start_();break}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=H(this.state_);return new ae(this.transferred_,this.blob_.size(),t,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,n,r){function i(){if(t!==z.STATE_CHANGED)throw"Expected one of the event types: ["+z.STATE_CHANGED+"]."}var o="Expected a function or an Object with one of `next`, `error`, `complete` properties.",a=ye(!0).validator,s=me(null,!0).validator;function u(t){try{return void a(t)}catch(n){}try{s(t);var e=$(t["next"])||$(t["error"])||$(t["complete"]);if(!e)throw"";return}catch(n){throw o}}var c=[he(i),me(u,!0),ye(!0),ye(!0)];se("on",c,arguments);var h=this;function l(t){function e(e,n,i){null!==t&&se("on",t,arguments);var o=new oe(e,n,r);return h.addObserver_(o),function(){h.removeObserver_(o)}}return e}function f(t){if(null===t)throw o;u(t)}var p=[me(f),ye(!0),ye(!0)],d=!($(e)||$(n)||$(r));return d?l(p):l(null)(e,n,r)},t.prototype.then=function(t,e){return this.promise_.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.addObserver_=function(t){this.observers_.push(t),this.notifyObserver_(t)},t.prototype.removeObserver_=function(t){var e=this.observers_.indexOf(t);-1!==e&&this.observers_.splice(e,1)},t.prototype.notifyObservers_=function(){var t=this;this.finishPromise_();var e=this.observers_.slice();e.forEach((function(e){t.notifyObserver_(e)}))},t.prototype.finishPromise_=function(){if(null!==this.resolve_){var t=!0;switch(H(this.state_)){case Q.SUCCESS:ge(this.resolve_.bind(null,this.snapshot))();break;case Q.CANCELED:case Q.ERROR:var e=this.reject_;ge(e.bind(null,this.error_))();break;default:t=!1;break}t&&(this.resolve_=null,this.reject_=null)}},t.prototype.notifyObserver_=function(t){var e=H(this.state_);switch(e){case Q.RUNNING:case Q.PAUSED:t.next&&ge(t.next.bind(t,this.snapshot))();break;case Q.SUCCESS:t.complete&&ge(t.complete.bind(t))();break;case Q.CANCELED:case Q.ERROR:t.error&&ge(t.error.bind(t,this.error_))();break;default:t.error&&ge(t.error.bind(t,this.error_))()}},t.prototype.resume=function(){se("resume",[],arguments);var t=this.state_===G.PAUSED||this.state_===G.PAUSING;return t&&this.transition_(G.RUNNING),t},t.prototype.pause=function(){se("pause",[],arguments);var t=this.state_===G.RUNNING;return t&&this.transition_(G.PAUSING),t},t.prototype.cancel=function(){se("cancel",[],arguments);var t=this.state_===G.RUNNING||this.state_===G.PAUSING;return t&&this.transition_(G.CANCELING),t},t}(),be=function(){function t(t,e){this.authWrapper=t,this.location=e instanceof ft?e:ft.makeFromUrl(e)}return t.prototype.toString=function(){return se("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},t.prototype.newRef=function(e,n){return new t(e,n)},t.prototype.mappings=function(){return Et()},t.prototype.child=function(t){se("child",[he()],arguments);var e=mt(this.location.path,t),n=new ft(this.location.bucket,e);return this.newRef(this.authWrapper,n)},Object.defineProperty(t.prototype,"parent",{get:function(){var t=dt(this.location.path);if(null===t)return null;var e=new ft(this.location.bucket,t);return this.newRef(this.authWrapper,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){var t=new ft(this.location.bucket,"");return this.newRef(this.authWrapper,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return yt(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),t.prototype.put=function(t,e){return void 0===e&&(e=null),se("put",[le(),fe(!0)],arguments),this.throwIfRoot_("put"),new ve(this,this.authWrapper,this.location,this.mappings(),new lt(t),e)},t.prototype.putString=function(t,e,n){void 0===e&&(e=R.RAW),se("putString",[he(),he(M,!0),fe(!0)],arguments),this.throwIfRoot_("putString");var r=L(e,t),i=Object.assign({},n);return!Y(i["contentType"])&&Y(r.contentType)&&(i["contentType"]=r.contentType),new ve(this,this.authWrapper,this.location,this.mappings(),new lt(r.data,!0),i)},t.prototype.delete=function(){var t=this;return se("delete",[],arguments),this.throwIfRoot_("delete"),this.authWrapper.getAuthToken().then((function(e){var n=Yt(t.authWrapper,t.location);return t.authWrapper.makeRequest(n,e).getPromise()}))},t.prototype.listAll=function(){se("listAll",[],arguments);var t={prefixes:[],items:[]};return this.listAllHelper(t).then((function(){return t}))},t.prototype.listAllHelper=function(t,e){return Object(o["__awaiter"])(this,void 0,void 0,(function(){var n,r,i,a;return Object(o["__generator"])(this,(function(o){switch(o.label){case 0:return n={pageToken:e},[4,this.list(n)];case 1:return r=o.sent(),(i=t.prefixes).push.apply(i,r.prefixes),(a=t.items).push.apply(a,r.items),null==r.nextPageToken?[3,3]:[4,this.listAllHelper(t,r.nextPageToken)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))},t.prototype.list=function(t){se("list",[pe(!0)],arguments);var e=this;return this.authWrapper.getAuthToken().then((function(n){var r=t||{},i=Gt(e.authWrapper,e.location,"/",r.pageToken,r.maxResults);return e.authWrapper.makeRequest(i,n).getPromise()}))},t.prototype.getMetadata=function(){var t=this;return se("getMetadata",[],arguments),this.throwIfRoot_("getMetadata"),this.authWrapper.getAuthToken().then((function(e){var n=zt(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise()}))},t.prototype.updateMetadata=function(t){var e=this;return se("updateMetadata",[fe()],arguments),this.throwIfRoot_("updateMetadata"),this.authWrapper.getAuthToken().then((function(n){var r=Ht(e.authWrapper,e.location,t,e.mappings());return e.authWrapper.makeRequest(r,n).getPromise()}))},t.prototype.getDownloadURL=function(){var t=this;return se("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL"),this.authWrapper.getAuthToken().then((function(e){var n=Qt(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise().then((function(t){if(null===t)throw I();return t}))}))},t.prototype.throwIfRoot_=function(t){if(""===this.location.path)throw D(t)},t}(),_e=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}(),we=function(){function t(){this.map=new Map,this.id=h}return t.prototype.addRequest=function(t){var e=this,n=this.id;this.id++,this.map.set(n,t),t.getPromise().then((function(){return e.map.delete(n)}),(function(){return e.map.delete(n)}))},t.prototype.clear=function(){this.map.forEach((function(t){t&&t.cancel(!0)})),this.map.clear()},t}(),Te=function(){function t(e,n,r,i,o){if(this.bucket_=null,this.deleted_=!1,this.app_=e,null!==this.app_){var a=this.app_.options;Y(a)&&(this.bucket_=t.extractBucket_(a))}this.storageRefMaker_=n,this.requestMaker_=r,this.pool_=o,this.service_=i,this.maxOperationRetryTime_=u,this.maxUploadRetryTime_=c,this.requestMap_=new we}return t.extractBucket_=function(t){var e=t[s]||null;if(null==e)return null;var n=ft.makeFromBucketSpec(e);return n.bucket},t.prototype.getAuthToken=function(){return null!==this.app_&&Y(this.app_.INTERNAL)&&Y(this.app_.INTERNAL.getToken)?this.app_.INTERNAL.getToken().then((function(t){return null!==t?t.accessToken:null}),(function(){return null})):Promise.resolve(null)},t.prototype.bucket=function(){if(this.deleted_)throw k();return this.bucket_},t.prototype.service=function(){return this.service_},t.prototype.makeStorageReference=function(t){return this.storageRefMaker_(this,t)},t.prototype.makeRequest=function(t,e){if(this.deleted_)return new _e(k());var n=this.requestMaker_(t,e,this.pool_);return this.requestMap_.addRequest(n),n},t.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},t.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},t.prototype.setMaxUploadRetryTime=function(t){this.maxUploadRetryTime_=t},t.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},t.prototype.setMaxOperationRetryTime=function(t){this.maxOperationRetryTime_=t},t}();
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Ee(t,e,n){var r=1,i=null,a=!1,s=0;function u(){return 2===s}var c=!1;function h(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];c||(c=!0,e.apply(null,t))}function l(e){i=setTimeout((function(){i=null,t(f,u())}),e)}function f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!c)if(t)h.call.apply(h,Object(o["__spreadArrays"])([null,t],e));else{var i,f=u()||a;if(f)h.call.apply(h,Object(o["__spreadArrays"])([null,t],e));else r<64&&(r*=2),1===s?(s=2,i=0):i=1e3*(r+Math.random()),l(i)}}var p=!1;function d(t){p||(p=!0,c||(null!==i?(t||(s=2),clearTimeout(i),l(0)):t||(s=1)))}return l(0),setTimeout((function(){a=!0,d(!0)}),n),d}function Se(t){t(!1)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ce=function(){function t(t,e,n,r,i,o,a,s,u,c,h){var l=this;this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=h,this.promise_=new Promise((function(t,e){l.resolve_=t,l.reject_=e,l.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){if(n)e(!1,new Ie(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null,n=n;var r=n.getErrorCode()===K.NO_ERROR,o=n.getStatus();if(r&&!t.isRetryStatusCode_(o)){var a=-1!==t.successCodes_.indexOf(o);e(!0,new Ie(a,n))}else{var s=n.getErrorCode()===K.ABORT;e(!1,new Ie(!1,null,s))}}))}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}}function n(e,n){var r=t.resolve_,i=t.reject_,o=n.xhr;if(n.wasSuccessCode)try{var a=t.callback_(o,o.getResponseText());$(a)?r(a):r()}catch(u){i(u)}else if(null!==o){var s=d();s.setServerResponseProp(o.getResponseText()),t.errorCallback_?i(t.errorCallback_(o,s)):i(s)}else if(n.canceled){s=t.appDelete_?k():_();i(s)}else{s=b();i(s)}}this.canceled_?n(!1,new Ie(!1,null,!0)):this.backoffId_=Ee(e,n,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&Se(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=[408,429],r=-1!==n.indexOf(t),i=-1!==this.additionalRetryCodes_.indexOf(t);return e||r||i},t}(),Ie=function(){function t(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n}return t}();function Ae(t,e){null!==e&&e.length>0&&(t["Authorization"]="Firebase "+e)}function Ne(t){var e="undefined"!==typeof i.a?i.a.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}function ke(t,e,n){var r=vt(t.urlParams),i=t.url+r,o=Object.assign({},t.headers);return Ae(o,e),Ne(o),new Ce(i,t.method,o,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,n)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var De=function(){function t(t,e,n){function r(t,e){return new be(t,e)}if(this.bucket_=null,this.authWrapper_=new Te(t,r,ke,this,e),this.app_=t,null!=n)this.bucket_=ft.makeFromBucketSpec(n);else{var i=this.authWrapper_.bucket();null!=i&&(this.bucket_=new ft(i,""))}this.internals_=new xe(this)}return t.prototype.ref=function(t){function e(t){if("string"!==typeof t)throw"Path is not a string.";if(/^[A-Za-z]+:\/\//.test(t))throw"Expected child path but got a URL, use refFromURL instead."}if(se("ref",[he(e,!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var n=new be(this.authWrapper_,this.bucket_);return null!=t?n.child(t):n},t.prototype.refFromURL=function(t){function e(t){if("string"!==typeof t)throw"Path is not a string.";if(!/^[A-Za-z]+:\/\//.test(t))throw"Expected full URL but got a child path, use ref instead.";try{ft.makeFromUrl(t)}catch(e){throw"Expected valid full URL but got an invalid one."}}return se("refFromURL",[he(e,!1)],arguments),new be(this.authWrapper_,t)},Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxUploadRetryTime=function(t){se("setMaxUploadRetryTime",[de()],arguments),this.authWrapper_.setMaxUploadRetryTime(t)},t.prototype.setMaxOperationRetryTime=function(t){se("setMaxOperationRetryTime",[de()],arguments),this.authWrapper_.setMaxOperationRetryTime(t)},Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),t}(),xe=function(){function t(t){this.service_=t}return t.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),Promise.resolve()},t}(),Oe="storage";function Re(t,e,n){return new De(t,new st,n)}function Me(t){var e={TaskState:Q,TaskEvent:z,StringFormat:R,Storage:De,Reference:be};t.INTERNAL.registerService(Oe,Re,e,void 0,!0)}Me(i.a)},"2e67":function(t,e,n){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},"2f62":function(t,e,n){"use strict";(function(t){
/**
 * vuex v3.1.2
 * (c) 2019 Evan You
 * @license MIT
 */
function n(t){var e=Number(t.version.split(".")[0]);if(e>=2)t.mixin({beforeCreate:r});else{var n=t.prototype._init;t.prototype._init=function(t){void 0===t&&(t={}),t.init=t.init?[r].concat(t.init):r,n.call(this,t)}}function r(){var t=this.$options;t.store?this.$store="function"===typeof t.store?t.store():t.store:t.parent&&t.parent.$store&&(this.$store=t.parent.$store)}}var r="undefined"!==typeof window?window:"undefined"!==typeof t?t:{},i=r.__VUE_DEVTOOLS_GLOBAL_HOOK__;function o(t){i&&(t._devtoolHook=i,i.emit("vuex:init",t),i.on("vuex:travel-to-state",(function(e){t.replaceState(e)})),t.subscribe((function(t,e){i.emit("vuex:mutation",t,e)})))}function a(t,e){Object.keys(t).forEach((function(n){return e(t[n],n)}))}function s(t){return null!==t&&"object"===typeof t}function u(t){return t&&"function"===typeof t.then}function c(t,e){return function(){return t(e)}}var h=function(t,e){this.runtime=e,this._children=Object.create(null),this._rawModule=t;var n=t.state;this.state=("function"===typeof n?n():n)||{}},l={namespaced:{configurable:!0}};l.namespaced.get=function(){return!!this._rawModule.namespaced},h.prototype.addChild=function(t,e){this._children[t]=e},h.prototype.removeChild=function(t){delete this._children[t]},h.prototype.getChild=function(t){return this._children[t]},h.prototype.update=function(t){this._rawModule.namespaced=t.namespaced,t.actions&&(this._rawModule.actions=t.actions),t.mutations&&(this._rawModule.mutations=t.mutations),t.getters&&(this._rawModule.getters=t.getters)},h.prototype.forEachChild=function(t){a(this._children,t)},h.prototype.forEachGetter=function(t){this._rawModule.getters&&a(this._rawModule.getters,t)},h.prototype.forEachAction=function(t){this._rawModule.actions&&a(this._rawModule.actions,t)},h.prototype.forEachMutation=function(t){this._rawModule.mutations&&a(this._rawModule.mutations,t)},Object.defineProperties(h.prototype,l);var f=function(t){this.register([],t,!1)};function p(t,e,n){if(e.update(n),n.modules)for(var r in n.modules){if(!e.getChild(r))return void 0;p(t.concat(r),e.getChild(r),n.modules[r])}}f.prototype.get=function(t){return t.reduce((function(t,e){return t.getChild(e)}),this.root)},f.prototype.getNamespace=function(t){var e=this.root;return t.reduce((function(t,n){return e=e.getChild(n),t+(e.namespaced?n+"/":"")}),"")},f.prototype.update=function(t){p([],this.root,t)},f.prototype.register=function(t,e,n){var r=this;void 0===n&&(n=!0);var i=new h(e,n);if(0===t.length)this.root=i;else{var o=this.get(t.slice(0,-1));o.addChild(t[t.length-1],i)}e.modules&&a(e.modules,(function(e,i){r.register(t.concat(i),e,n)}))},f.prototype.unregister=function(t){var e=this.get(t.slice(0,-1)),n=t[t.length-1];e.getChild(n).runtime&&e.removeChild(n)};var d;var m=function(t){var e=this;void 0===t&&(t={}),!d&&"undefined"!==typeof window&&window.Vue&&k(window.Vue);var n=t.plugins;void 0===n&&(n=[]);var r=t.strict;void 0===r&&(r=!1),this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new f(t),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._watcherVM=new d,this._makeLocalGettersCache=Object.create(null);var i=this,a=this,s=a.dispatch,u=a.commit;this.dispatch=function(t,e){return s.call(i,t,e)},this.commit=function(t,e,n){return u.call(i,t,e,n)},this.strict=r;var c=this._modules.root.state;_(this,c,[],this._modules.root),b(this,c),n.forEach((function(t){return t(e)}));var h=void 0!==t.devtools?t.devtools:d.config.devtools;h&&o(this)},y={state:{configurable:!0}};function g(t,e){return e.indexOf(t)<0&&e.push(t),function(){var n=e.indexOf(t);n>-1&&e.splice(n,1)}}function v(t,e){t._actions=Object.create(null),t._mutations=Object.create(null),t._wrappedGetters=Object.create(null),t._modulesNamespaceMap=Object.create(null);var n=t.state;_(t,n,[],t._modules.root,!0),b(t,n,e)}function b(t,e,n){var r=t._vm;t.getters={},t._makeLocalGettersCache=Object.create(null);var i=t._wrappedGetters,o={};a(i,(function(e,n){o[n]=c(e,t),Object.defineProperty(t.getters,n,{get:function(){return t._vm[n]},enumerable:!0})}));var s=d.config.silent;d.config.silent=!0,t._vm=new d({data:{$$state:e},computed:o}),d.config.silent=s,t.strict&&I(t),r&&(n&&t._withCommit((function(){r._data.$$state=null})),d.nextTick((function(){return r.$destroy()})))}function _(t,e,n,r,i){var o=!n.length,a=t._modules.getNamespace(n);if(r.namespaced&&(t._modulesNamespaceMap[a],t._modulesNamespaceMap[a]=r),!o&&!i){var s=A(e,n.slice(0,-1)),u=n[n.length-1];t._withCommit((function(){d.set(s,u,r.state)}))}var c=r.context=w(t,a,n);r.forEachMutation((function(e,n){var r=a+n;E(t,r,e,c)})),r.forEachAction((function(e,n){var r=e.root?n:a+n,i=e.handler||e;S(t,r,i,c)})),r.forEachGetter((function(e,n){var r=a+n;C(t,r,e,c)})),r.forEachChild((function(r,o){_(t,e,n.concat(o),r,i)}))}function w(t,e,n){var r=""===e,i={dispatch:r?t.dispatch:function(n,r,i){var o=N(n,r,i),a=o.payload,s=o.options,u=o.type;return s&&s.root||(u=e+u),t.dispatch(u,a)},commit:r?t.commit:function(n,r,i){var o=N(n,r,i),a=o.payload,s=o.options,u=o.type;s&&s.root||(u=e+u),t.commit(u,a,s)}};return Object.defineProperties(i,{getters:{get:r?function(){return t.getters}:function(){return T(t,e)}},state:{get:function(){return A(t.state,n)}}}),i}function T(t,e){if(!t._makeLocalGettersCache[e]){var n={},r=e.length;Object.keys(t.getters).forEach((function(i){if(i.slice(0,r)===e){var o=i.slice(r);Object.defineProperty(n,o,{get:function(){return t.getters[i]},enumerable:!0})}})),t._makeLocalGettersCache[e]=n}return t._makeLocalGettersCache[e]}function E(t,e,n,r){var i=t._mutations[e]||(t._mutations[e]=[]);i.push((function(e){n.call(t,r.state,e)}))}function S(t,e,n,r){var i=t._actions[e]||(t._actions[e]=[]);i.push((function(e){var i=n.call(t,{dispatch:r.dispatch,commit:r.commit,getters:r.getters,state:r.state,rootGetters:t.getters,rootState:t.state},e);return u(i)||(i=Promise.resolve(i)),t._devtoolHook?i.catch((function(e){throw t._devtoolHook.emit("vuex:error",e),e})):i}))}function C(t,e,n,r){t._wrappedGetters[e]||(t._wrappedGetters[e]=function(t){return n(r.state,r.getters,t.state,t.getters)})}function I(t){t._vm.$watch((function(){return this._data.$$state}),(function(){0}),{deep:!0,sync:!0})}function A(t,e){return e.length?e.reduce((function(t,e){return t[e]}),t):t}function N(t,e,n){return s(t)&&t.type&&(n=e,e=t,t=t.type),{type:t,payload:e,options:n}}function k(t){d&&t===d||(d=t,n(d))}y.state.get=function(){return this._vm._data.$$state},y.state.set=function(t){0},m.prototype.commit=function(t,e,n){var r=this,i=N(t,e,n),o=i.type,a=i.payload,s=(i.options,{type:o,payload:a}),u=this._mutations[o];u&&(this._withCommit((function(){u.forEach((function(t){t(a)}))})),this._subscribers.forEach((function(t){return t(s,r.state)})))},m.prototype.dispatch=function(t,e){var n=this,r=N(t,e),i=r.type,o=r.payload,a={type:i,payload:o},s=this._actions[i];if(s){try{this._actionSubscribers.filter((function(t){return t.before})).forEach((function(t){return t.before(a,n.state)}))}catch(c){0}var u=s.length>1?Promise.all(s.map((function(t){return t(o)}))):s[0](o);return u.then((function(t){try{n._actionSubscribers.filter((function(t){return t.after})).forEach((function(t){return t.after(a,n.state)}))}catch(c){0}return t}))}},m.prototype.subscribe=function(t){return g(t,this._subscribers)},m.prototype.subscribeAction=function(t){var e="function"===typeof t?{before:t}:t;return g(e,this._actionSubscribers)},m.prototype.watch=function(t,e,n){var r=this;return this._watcherVM.$watch((function(){return t(r.state,r.getters)}),e,n)},m.prototype.replaceState=function(t){var e=this;this._withCommit((function(){e._vm._data.$$state=t}))},m.prototype.registerModule=function(t,e,n){void 0===n&&(n={}),"string"===typeof t&&(t=[t]),this._modules.register(t,e),_(this,this.state,t,this._modules.get(t),n.preserveState),b(this,this.state)},m.prototype.unregisterModule=function(t){var e=this;"string"===typeof t&&(t=[t]),this._modules.unregister(t),this._withCommit((function(){var n=A(e.state,t.slice(0,-1));d.delete(n,t[t.length-1])})),v(this)},m.prototype.hotUpdate=function(t){this._modules.update(t),v(this,!0)},m.prototype._withCommit=function(t){var e=this._committing;this._committing=!0,t(),this._committing=e},Object.defineProperties(m.prototype,y);var D=F((function(t,e){var n={};return P(e).forEach((function(e){var r=e.key,i=e.val;n[r]=function(){var e=this.$store.state,n=this.$store.getters;if(t){var r=U(this.$store,"mapState",t);if(!r)return;e=r.context.state,n=r.context.getters}return"function"===typeof i?i.call(this,e,n):e[i]},n[r].vuex=!0})),n})),x=F((function(t,e){var n={};return P(e).forEach((function(e){var r=e.key,i=e.val;n[r]=function(){var e=[],n=arguments.length;while(n--)e[n]=arguments[n];var r=this.$store.commit;if(t){var o=U(this.$store,"mapMutations",t);if(!o)return;r=o.context.commit}return"function"===typeof i?i.apply(this,[r].concat(e)):r.apply(this.$store,[i].concat(e))}})),n})),O=F((function(t,e){var n={};return P(e).forEach((function(e){var r=e.key,i=e.val;i=t+i,n[r]=function(){if(!t||U(this.$store,"mapGetters",t))return this.$store.getters[i]},n[r].vuex=!0})),n})),R=F((function(t,e){var n={};return P(e).forEach((function(e){var r=e.key,i=e.val;n[r]=function(){var e=[],n=arguments.length;while(n--)e[n]=arguments[n];var r=this.$store.dispatch;if(t){var o=U(this.$store,"mapActions",t);if(!o)return;r=o.context.dispatch}return"function"===typeof i?i.apply(this,[r].concat(e)):r.apply(this.$store,[i].concat(e))}})),n})),M=function(t){return{mapState:D.bind(null,t),mapGetters:O.bind(null,t),mapMutations:x.bind(null,t),mapActions:R.bind(null,t)}};function P(t){return L(t)?Array.isArray(t)?t.map((function(t){return{key:t,val:t}})):Object.keys(t).map((function(e){return{key:e,val:t[e]}})):[]}function L(t){return Array.isArray(t)||s(t)}function F(t){return function(e,n){return"string"!==typeof e?(n=e,e=""):"/"!==e.charAt(e.length-1)&&(e+="/"),t(e,n)}}function U(t,e,n){var r=t._modulesNamespaceMap[n];return r}var q={Store:m,install:k,version:"3.1.2",mapState:D,mapMutations:x,mapGetters:O,mapActions:R,createNamespacedHelpers:M};e["a"]=q}).call(this,n("c8ba"))},"30b5":function(t,e,n){"use strict";var r=n("c532");function i(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var o;if(n)o=n(e);else if(r.isURLSearchParams(e))o=e.toString();else{var a=[];r.forEach(e,(function(t,e){null!==t&&"undefined"!==typeof t&&(r.isArray(t)?e+="[]":t=[t],r.forEach(t,(function(t){r.isDate(t)?t=t.toISOString():r.isObject(t)&&(t=JSON.stringify(t)),a.push(i(e)+"="+i(t))})))})),o=a.join("&")}if(o){var s=t.indexOf("#");-1!==s&&(t=t.slice(0,s)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}},"30f1":function(t,e,n){"use strict";var r=n("b8e3"),i=n("63b6"),o=n("9138"),a=n("35e8"),s=n("481b"),u=n("8f60"),c=n("45f2"),h=n("53e2"),l=n("5168")("iterator"),f=!([].keys&&"next"in[].keys()),p="@@iterator",d="keys",m="values",y=function(){return this};t.exports=function(t,e,n,g,v,b,_){u(n,e,g);var w,T,E,S=function(t){if(!f&&t in N)return N[t];switch(t){case d:return function(){return new n(this,t)};case m:return function(){return new n(this,t)}}return function(){return new n(this,t)}},C=e+" Iterator",I=v==m,A=!1,N=t.prototype,k=N[l]||N[p]||v&&N[v],D=k||S(v),x=v?I?S("entries"):D:void 0,O="Array"==e&&N.entries||k;if(O&&(E=h(O.call(new t)),E!==Object.prototype&&E.next&&(c(E,C,!0),r||"function"==typeof E[l]||a(E,l,y))),I&&k&&k.name!==m&&(A=!0,D=function(){return k.call(this)}),r&&!_||!f&&!A&&N[l]||a(N,l,D),s[e]=D,s[C]=y,v)if(w={values:I?D:S(m),keys:b?D:S(d),entries:x},_)for(T in w)T in N||o(N,T,w[T]);else i(i.P+i.F*(f||A),e,w);return w}},"31f4":function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},"32e9":function(t,e,n){var r=n("86cc"),i=n("4630");t.exports=n("9e1e")?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},"32fc":function(t,e,n){var r=n("e53d").document;t.exports=r&&r.documentElement},"335c":function(t,e,n){var r=n("6b4c");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},"33a4":function(t,e,n){var r=n("84f2"),i=n("2b4c")("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},3523:function(t,e,n){"use strict";(function(r){function i(t){return t&&"object"===typeof t&&"default"in t?t["default"]:t}Object.defineProperty(e,"__esModule",{value:!0});var o=i(n("c23d")),a=n("9ab4"),s=n("cd51"),u=n("abfd"),c=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),s.stringify(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:s.jsonEval(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),h=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return s.contains(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),l=function(t){try{if("undefined"!==typeof window&&"undefined"!==typeof window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new c(e)}}catch(n){}return new h},f=l("localStorage"),p=l("sessionStorage"),d=new u.Logger("@firebase/database"),m=function(){var t=1;return function(){return t++}}(),y=function(t){var e=s.stringToByteArray(t),n=new s.Sha1;n.update(e);var r=n.digest();return s.base64.encodeByteArray(r)},g=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++)Array.isArray(t[r])||t[r]&&"object"===typeof t[r]&&"number"===typeof t[r].length?n+=g.apply(null,t[r]):"object"===typeof t[r]?n+=s.stringify(t[r]):n+=t[r],n+=" ";return n},v=null,b=!0,_=function(t,e){s.assert(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(d.logLevel=u.LogLevel.VERBOSE,v=d.log.bind(d),e&&p.set("logging_enabled",!0)):"function"===typeof t?v=t:(v=null,p.remove("logging_enabled"))},w=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===b&&(b=!1,null===v&&!0===p.get("logging_enabled")&&_(!0)),v){var n=g.apply(null,t);v(n)}},T=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];w.apply(void 0,a.__spread([t],e))}},E=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+g.apply(void 0,a.__spread(t));d.error(n)},S=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+g.apply(void 0,a.__spread(t));throw d.error(n),new Error(n)},C=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+g.apply(void 0,a.__spread(t));d.warn(n)},I=function(){"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&C("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},A=function(t){return"number"===typeof t&&(t!=t||t==Number.POSITIVE_INFINITY||t==Number.NEGATIVE_INFINITY)},N=function(t){if(s.isNodeSdk()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}},k="[MIN_NAME]",D="[MAX_NAME]",x=function(t,e){if(t===e)return 0;if(t===k||e===D)return-1;if(e===k||t===D)return 1;var n=j(t),r=j(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},O=function(t,e){return t===e?0:t<e?-1:1},R=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+s.stringify(e))},M=function(t){if("object"!==typeof t||null===t)return s.stringify(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=s.stringify(e[i]),r+=":",r+=M(t[e[i]]);return r+="}",r},P=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function L(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var F=function(t){s.assert(!A(t),"Invalid JSON number");var e,n,r,i,o,a,u,c=11,h=52,l=(1<<c-1)-1;for(0===t?(n=0,r=0,e=1/t===-1/0?1:0):(e=t<0,t=Math.abs(t),t>=Math.pow(2,1-l)?(i=Math.min(Math.floor(Math.log(t)/Math.LN2),l),n=i+l,r=Math.round(t*Math.pow(2,h-i)-Math.pow(2,h))):(n=0,r=Math.round(t/Math.pow(2,1-l-h)))),a=[],o=h;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=c;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(e?1:0),a.reverse(),u=a.join("");var f="";for(o=0;o<64;o+=8){var p=parseInt(u.substr(o,8),2).toString(16);1===p.length&&(p="0"+p),f+=p}return f.toLowerCase()},U=function(){return!("object"!==typeof window||!window["chrome"]||!window["chrome"]["extension"]||/^chrome/.test(window.location.href))},q=function(){return"object"===typeof Windows&&"object"===typeof Windows.UI},V=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==t?n="Client doesn't have permission to access the desired data.":"unavailable"==t&&(n="The service is unavailable");var r=new Error(t+" at "+e.path.toString()+": "+n);return r.code=t.toUpperCase(),r},B=new RegExp("^-?(0*)\\d{1,10}$"),j=function(t){if(B.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},W=function(t){try{t()}catch(e){setTimeout((function(){var t=e.stack||"";throw C("Exception was thrown by user callback.",t),e}),Math.floor(0))}},K=function(){var t="object"===typeof window&&window["navigator"]&&window["navigator"]["userAgent"]||"";return t.search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},z=function(t,e){var n=setTimeout(t,e);return"object"===typeof n&&n["unref"]&&n["unref"](),n},G=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!0,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(e instanceof t)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var r=e.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),r=e.slice(),i=0;i<n.length&&i<r.length;i++){var o=x(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;while(e<this.pieces_.length){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}(),Q=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=s.stringLength(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),t.prototype.push=function(t){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=s.stringLength(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=s.stringLength(t),this.parts_.length>0&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}(),H="5",Y="v",$="s",X="r",J="f",Z="firebaseio.com",tt="ls",et="websocket",nt="long_polling",rt=function(){function t(t,e,n,r,i,o){void 0===i&&(i=""),void 0===o&&(o=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.includeNamespaceInQueryParams=o,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=f.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&f.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){var n;if(s.assert("string"===typeof t,"typeof type must == string"),s.assert("object"===typeof e,"typeof params must == object"),t===et)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(t!==nt)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e["ns"]=this.namespace);var r=[];return L(e,(function(t,e){r.push(t+"="+e)})),n+r.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function it(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}e+="/"+i}return e}function ot(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=a.__values(t.split("&")),o=i.next();!o.done;o=i.next()){var s=o.value;if(0!==s.length){var u=s.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):C("Invalid query segment '"+s+"' in query '"+t+"'")}}}catch(c){e={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}var at,st,ut=function(t){var e=ct(t),n=e.namespace;"firebase"===e.domain&&S(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!=n||"localhost"===e.domain||S("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||I();var r="ws"===e.scheme||"wss"===e.scheme;return{repoInfo:new rt(e.host,e.secure,n,r,"",n!=e.subdomain),path:new G(e.pathString)}},ct=function(t){var e="",n="",r="",i="",o="",a=!0,s="https",u=443;if("string"===typeof t){var c=t.indexOf("//");c>=0&&(s=t.substring(0,c-1),t=t.substring(c+2));var h=t.indexOf("/");-1===h&&(h=t.length);var l=t.indexOf("?");-1===l&&(l=t.length),e=t.substring(0,Math.min(h,l)),h<l&&(i=it(t.substring(h,l)));var f=ot(t.substring(Math.min(t.length,l)));c=e.indexOf(":"),c>=0?(a="https"===s||"wss"===s,u=parseInt(e.substring(c+1),10)):c=t.length;var p=e.split(".");3===p.length?(n=p[1],r=p[0].toLowerCase(),o=r):2===p.length?n=p[0]:"localhost"===p[0].slice(0,c).toLowerCase()&&(n="localhost"),"ns"in f&&(o=f["ns"])}return{host:e,port:u,domain:n,subdomain:r,secure:a,scheme:s,pathString:i,namespace:o}},ht=/[\[\].#$\/\u0000-\u001F\u007F]/,lt=/[\[\].#$\u0000-\u001F\u007F]/,ft=10485760,pt=function(t){return"string"===typeof t&&0!==t.length&&!ht.test(t)},dt=function(t){return"string"===typeof t&&0!==t.length&&!lt.test(t)},mt=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),dt(t)},yt=function(t){return null===t||"string"===typeof t||"number"===typeof t&&!A(t)||t&&"object"===typeof t&&s.contains(t,".sv")},gt=function(t,e,n,r,i){i&&void 0===n||vt(s.errorPrefix(t,e,i),n,r)},vt=function(t,e,n){var r=n instanceof G?new Q(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+r.toErrorString());if("function"===typeof e)throw new Error(t+"contains a function "+r.toErrorString()+" with contents = "+e.toString());if(A(e))throw new Error(t+"contains "+e.toString()+" "+r.toErrorString());if("string"===typeof e&&e.length>ft/3&&s.stringLength(e)>ft)throw new Error(t+"contains a string greater than "+ft+" utf8 bytes "+r.toErrorString()+" ('"+e.substring(0,50)+"...')");if(e&&"object"===typeof e){var i=!1,o=!1;if(L(e,(function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(o=!0,!pt(e)))throw new Error(t+" contains an invalid key ("+e+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(e),vt(t,n,r),r.pop()})),i&&o)throw new Error(t+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},bt=function(t,e){var n,r;for(n=0;n<e.length;n++){r=e[n];for(var i=r.slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!pt(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(G.comparePaths);var a=null;for(n=0;n<e.length;n++){if(r=e[n],null!==a&&a.contains(r))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}},_t=function(t,e,n,r,i){if(!i||void 0!==n){var o=s.errorPrefix(t,e,i);if(!n||"object"!==typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var a=[];L(n,(function(t,e){var n=new G(t);if(vt(o,e,r.child(n)),".priority"===n.getBack()&&!yt(e))throw new Error(o+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(n)})),bt(o,a)}},wt=function(t,e,n,r){if(!r||void 0!==n){if(A(n))throw new Error(s.errorPrefix(t,e,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!yt(n))throw new Error(s.errorPrefix(t,e,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Tt=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(s.errorPrefix(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},Et=function(t,e,n,r){if((!r||void 0!==n)&&!pt(n))throw new Error(s.errorPrefix(t,e,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},St=function(t,e,n,r){if((!r||void 0!==n)&&!dt(n))throw new Error(s.errorPrefix(t,e,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ct=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),St(t,e,n,r)},It=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},At=function(t,e,n){var r=n.path.toString();if("string"!==typeof n.repoInfo.host||0===n.repoInfo.host.length||!pt(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!mt(r))throw new Error(s.errorPrefix(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Nt=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!==typeof n)throw new Error(s.errorPrefix(t,e,r)+"must be a boolean.")},kt=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){s.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),s.validateCallback("OnDisconnect.cancel",1,t,!0);var e=new s.Deferred;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){s.validateArgCount("OnDisconnect.remove",0,1,arguments.length),It("OnDisconnect.remove",this.path_),s.validateCallback("OnDisconnect.remove",1,t,!0);var e=new s.Deferred;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){s.validateArgCount("OnDisconnect.set",1,2,arguments.length),It("OnDisconnect.set",this.path_),gt("OnDisconnect.set",1,t,this.path_,!1),s.validateCallback("OnDisconnect.set",2,e,!0);var n=new s.Deferred;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){s.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),It("OnDisconnect.setWithPriority",this.path_),gt("OnDisconnect.setWithPriority",1,t,this.path_,!1),wt("OnDisconnect.setWithPriority",2,e,!1),s.validateCallback("OnDisconnect.setWithPriority",3,n,!0);var r=new s.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,r.wrapCallback(n)),r.promise},t.prototype.update=function(t,e){if(s.validateArgCount("OnDisconnect.update",1,2,arguments.length),It("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,C("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_t("OnDisconnect.update",1,t,this.path_,!1),s.validateCallback("OnDisconnect.update",2,e,!0);var i=new s.Deferred;return this.repo_.onDisconnectUpdate(this.path_,t,i.wrapCallback(e)),i.promise},t}(),Dt=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return s.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),xt=function(){var t="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",e=0,n=[];return function(r){var i,o=r===e;e=r;var a=new Array(8);for(i=7;i>=0;i--)a[i]=t.charAt(r%64),r=Math.floor(r/64);s.assert(0===r,"Cannot push at time == 0");var u=a.join("");if(o){for(i=11;i>=0&&63===n[i];i--)n[i]=0;n[i]++}else for(i=0;i<12;i++)n[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)u+=t.charAt(n[i]);return s.assert(20===u.length,"nextPushId: Length should be 20."),u}}(),Ot=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),Rt=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new Ot(k,t),r=new Ot(k,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return Ot.MIN},t}(),Mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return at},set:function(t){at=t},enumerable:!0,configurable:!0}),e.prototype.compare=function(t,e){return x(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw s.assertionError("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return Ot.MIN},e.prototype.maxPost=function(){return new Ot(D,at)},e.prototype.makePost=function(t,e){return s.assert("string"===typeof t,"KeyIndex indexValue must always be a string."),new Ot(t,at)},e.prototype.toString=function(){return".key"},e}(Rt),Pt=new Mt;function Lt(t){st=t}var Ft,Ut,qt,Vt=function(t){return"number"===typeof t?"number:"+F(t):"string:"+t},Bt=function(t){if(t.isLeafNode()){var e=t.val();s.assert("string"===typeof e||"number"===typeof e||"object"===typeof e&&s.contains(e,".sv"),"Priority must be a string or number.")}else s.assert(t===st||t.isEmpty(),"priority of unexpected type.");s.assert(t===st||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},jt=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,s.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Bt(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return Ft},set:function(t){Ft=t},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=e.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(s.assert(".priority"!==r||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Vt(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?F(this.value_):this.value_,this.lazyHash_=y(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(s.assert(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),o=t.VALUE_TYPE_ORDER.indexOf(r);return s.assert(i>=0,"Unknown leaf type: "+n),s.assert(o>=0,"Unknown leaf type: "+r),i===o?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}();function Wt(t){Ut=t}function Kt(t){qt=t}var zt,Gt,Qt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?x(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return Ot.MIN},e.prototype.maxPost=function(){return new Ot(D,new jt("[PRIORITY-POST]",qt))},e.prototype.makePost=function(t,e){var n=Ut(t);return new Ot(e,new jt("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(Rt),Ht=new Qt,Yt=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];var o=1;while(!t.isEmpty())if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_){e=e.left;while(!e.isEmpty())this.nodeStack_.push(e),e=e.right}else{e=e.right;while(!e.isEmpty())this.nodeStack_.push(e),e=e.left}return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),$t=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Jt.EMPTY_NODE,this.right=null!=o?o:Jt.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r,i;return i=this,r=n(t,i.key),i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Jt.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()},t.prototype.remove=function(t,e){var n,r;if(n=this,e(t,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Jt.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){var t;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if(t=this.left.check_(),t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),Xt=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new $t(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Jt=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,$t.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,$t.BLACK,null,null))},t.prototype.get=function(t){var e,n=this.root_;while(!n.isEmpty()){if(e=this.comparator_(t,n.key),0===e)return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){var e,n=this.root_,r=null;while(!n.isEmpty()){if(e=this.comparator_(t,n.key),0===e){if(n.left.isEmpty())return r?r.key:null;n=n.left;while(!n.right.isEmpty())n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Yt(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Yt(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new Yt(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new Yt(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new Xt,t}(),Zt=Math.log(2),te=function(){function t(t){var e=function(t){return parseInt(Math.log(t)/Zt,10)},n=function(t){return parseInt(Array(t+1).join("1"),2)};this.count=e(t+1),this.current_=this.count-1;var r=n(this.count);this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),ee=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,a,s=r-e;if(0==s)return null;if(1==s)return o=t[e],a=n?n(o):o,new $t(a,o.node,$t.BLACK,null,null);var u=parseInt(s/2,10)+e,c=i(e,u),h=i(u+1,r);return o=t[u],a=n?n(o):o,new $t(a,o.node,$t.BLACK,c,h)},o=function(e){for(var r=null,o=null,a=t.length,s=function(e,r){var o=a-e,s=a;a-=e;var c=i(o+1,s),h=t[o],l=n?n(h):h;u(new $t(l,h.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var h=e.nextBitIsOne(),l=Math.pow(2,e.count-(c+1));h?s(l,$t.BLACK):(s(l,$t.BLACK),s(l,$t.RED))}return o},a=new te(t.length),s=o(a);return new Jt(r||e,s)},ne={},re=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return s.assert(ne&&Ht,"ChildrenNode.ts has not been loaded"),zt=zt||new t({".priority":ne},{".priority":Ht}),zt},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var e=s.safeGet(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Jt?e:null},t.prototype.hasIndex=function(t){return s.contains(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){s.assert(e!==Pt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");var r,i=[],o=!1,u=n.getIterator(Ot.Wrap),c=u.getNext();while(c)o=o||e.isDefinedOn(c.node),i.push(c),c=u.getNext();r=o?ee(i,e.getCompare()):ne;var h=e.toString(),l=a.__assign({},this.indexSet_);l[h]=e;var f=a.__assign({},this.indexes_);return f[h]=r,new t(f,l)},t.prototype.addToIndexes=function(e,n){var r=this,i=s.map(this.indexes_,(function(t,i){var o=s.safeGet(r.indexSet_,i);if(s.assert(o,"Missing index implementation for "+i),t===ne){if(o.isDefinedOn(e.node)){var a=[],u=n.getIterator(Ot.Wrap),c=u.getNext();while(c)c.name!=e.name&&a.push(c),c=u.getNext();return a.push(e),ee(a,o.getCompare())}return ne}var h=n.get(e.name),l=t;return h&&(l=l.remove(new Ot(e.name,h))),l.insert(e,e.node)}));return new t(i,this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){var r=s.map(this.indexes_,(function(t){if(t===ne)return t;var r=n.get(e.name);return r?t.remove(new Ot(e.name,r)):t}));return new t(r,this.indexSet_)},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ie(t,e){return x(t.name,e.name)}function oe(t,e){return x(t,e)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ae=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Bt(this.priorityNode_),this.children_.isEmpty()&&s.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return Gt||(Gt=new t(new Jt(oe),null,re.Default))},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||Gt},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?Gt:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(s.assert(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new Ot(e,n),i=void 0,o=void 0,a=void 0;return n.isEmpty()?(i=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),o=this.indexMap_.addToIndexes(r,this.children_)),a=i.isEmpty()?Gt:this.priorityNode_,new t(i,a,o)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;s.assert(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(Ht,(function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Vt(this.getPriority().val())+":"),this.forEachChild(Ht,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":y(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Ot(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new Ot(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new Ot(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));var r=this.children_.getIteratorFrom(t.name,Ot.Wrap),i=r.peek();while(null!=i&&e.compare(i,t)<0)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));var r=this.children_.getReverseIteratorFrom(t.name,Ot.Wrap),i=r.peek();while(null!=i&&e.compare(i,t)>0)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===ue?-1:0},t.prototype.withIndex=function(e){if(e===Pt||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===Pt||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){var n=this.getIterator(Ht),r=e.getIterator(Ht),i=n.getNext(),o=r.getNext();while(i&&o){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===Pt?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),se=function(t){function e(){return t.call(this,new Jt(oe),ae.EMPTY_NODE,re.Default)||this}return a.__extends(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return ae.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(ae),ue=new se;Object.defineProperties(Ot,{MIN:{value:new Ot(k,ae.EMPTY_NODE)},MAX:{value:new Ot(D,ue)}}),Mt.__EMPTY_NODE=ae.EMPTY_NODE,jt.__childrenNodeConstructor=ae,Lt(ue),Kt(ue);
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ce=!0;function he(t,e){if(void 0===e&&(e=null),null===t)return ae.EMPTY_NODE;if("object"===typeof t&&".priority"in t&&(e=t[".priority"]),s.assert(null===e||"string"===typeof e||"number"===typeof e||"object"===typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"===typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!==typeof t||".sv"in t){var n=t;return new jt(n,he(e))}if(t instanceof Array||!ce){var r=ae.EMPTY_NODE;return L(t,(function(e,n){if(s.contains(t,e)&&"."!==e.substring(0,1)){var i=he(n);!i.isLeafNode()&&i.isEmpty()||(r=r.updateImmediateChild(e,i))}})),r.updatePriority(he(e))}var i=[],o=!1,a=t;if(L(a,(function(t,e){if("."!==t.substring(0,1)){var n=he(e);n.isEmpty()||(o=o||!n.getPriority().isEmpty(),i.push(new Ot(t,n)))}})),0==i.length)return ae.EMPTY_NODE;var u=ee(i,ie,(function(t){return t.name}),oe);if(o){var c=ee(i,Ht.getCompare());return new ae(u,he(e),new re({".priority":c},{".priority":Ht}))}return new ae(u,he(e),re.Default)}Wt(he);
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var le,fe,pe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?x(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return Ot.MIN},e.prototype.maxPost=function(){return Ot.MAX},e.prototype.makePost=function(t,e){var n=he(t);return new Ot(e,n)},e.prototype.toString=function(){return".value"},e}(Rt),de=new pe,me=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,s.assert(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return a.__extends(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?x(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=he(t),r=ae.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ot(e,r)},e.prototype.maxPost=function(){var t=ae.EMPTY_NODE.updateChild(this.indexPath_,ue);return new Ot(D,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(Rt),ye=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return s.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return s.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return s.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return s.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){s.validateArgCount("DataSnapshot.child",0,1,arguments.length),e=String(e),St("DataSnapshot.child",1,e,!1);var n=new G(e),r=this.ref_.child(n);return new t(this.node_.getChild(n),r,Ht)},t.prototype.hasChild=function(t){s.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),St("DataSnapshot.hasChild",1,t,!1);var e=new G(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return s.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;if(s.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),s.validateCallback("DataSnapshot.forEach",1,e,!1),this.node_.isLeafNode())return!1;var r=this.node_;return!!r.forEachChild(this.index_,(function(r,i){return e(new t(i,n.ref_.child(r),Ht))}))},t.prototype.hasChildren=function(){return s.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),t.prototype.numChildren=function(){return s.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return s.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}(),ge=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+s.stringify(this.snapshot.exportVal())},t}(),ve=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),be=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new ge("value",this,new ye(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){s.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callback_;return function(){r.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new ve(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}(),_e=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,s.contains(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new ve(this,t,e):null},t.prototype.createEvent=function(t,e){s.assert(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),r=e.getQueryParams().getIndex();return new ge(t.type,this,new ye(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){s.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callbacks_[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){var n=this;if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var r=Object.keys(e.callbacks_),i=Object.keys(this.callbacks_),o=r.length,a=i.length;if(o===a){if(1===o){var s=r[0],u=i[0];return u===s&&(!e.callbacks_[s]||!this.callbacks_[u]||e.callbacks_[s]===this.callbacks_[u])}return i.every((function(t){return e.callbacks_[t]===n.callbacks_[t]}))}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}(),we=function(){function t(t,e,n,r){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return s.assert(le,"Reference.ts has not been loaded"),le},set:function(t){le=t},enumerable:!0,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Pt){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){var o=t.getIndexStartName();if(o!=k)throw new Error(r);if("string"!==typeof e)throw new Error(i)}if(t.hasEnd()){var a=t.getIndexEndName();if(a!=D)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(t.getIndex()===Ht){if(null!=e&&!yt(e)||null!=n&&!yt(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(s.assert(t.getIndex()instanceof me||t.getIndex()===de,"unknown index type."),null!=e&&"object"===typeof e||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return s.validateArgCount("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,r,i){s.validateArgCount("Query.on",2,4,arguments.length),Tt("Query.on",1,e,!1),s.validateCallback("Query.on",2,n,!1);var o=t.getCancelAndContextArgs_("Query.on",r,i);if("value"===e)this.onValueEvent(n,o.cancel,o.context);else{var a={};a[e]=n,this.onChildEvent(a,o.cancel,o.context)}return n},t.prototype.onValueEvent=function(t,e,n){var r=new be(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},t.prototype.onChildEvent=function(t,e,n){var r=new _e(t,e,n);this.repo.addEventCallbackForQuery(this,r)},t.prototype.off=function(t,e,n){s.validateArgCount("Query.off",0,3,arguments.length),Tt("Query.off",1,t,!0),s.validateCallback("Query.off",2,e,!0),s.validateContextObject("Query.off",3,n,!0);var r=null,i=null;if("value"===t){var o=e||null;r=new be(o,null,n||null)}else t&&(e&&(i={},i[t]=e),r=new _e(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},t.prototype.once=function(e,n,r,i){var o=this;s.validateArgCount("Query.once",1,4,arguments.length),Tt("Query.once",1,e,!1),s.validateCallback("Query.once",2,n,!0);var a=t.getCancelAndContextArgs_("Query.once",r,i),u=!0,c=new s.Deferred;c.promise.catch((function(){}));var h=function(t){u&&(u=!1,o.off(e,h),n&&n.bind(a.context)(t),c.resolve(t))};return this.on(e,h,(function(t){o.off(e,h),a.cancel&&a.cancel.bind(a.context)(t),c.reject(t)})),c.promise},t.prototype.limitToFirst=function(e){if(s.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if(s.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if(s.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');St("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new G(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new me(n),i=this.queryParams_.orderBy(r);return t.validateQueryEndpoints_(i),new t(this.repo,this.path,i,!0)},t.prototype.orderByKey=function(){s.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(Pt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){s.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(Ht);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){s.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(de);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),s.validateArgCount("Query.startAt",0,2,arguments.length),gt("Query.startAt",1,e,this.path,!0),Et("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),s.validateArgCount("Query.endAt",0,2,arguments.length),gt("Query.endAt",1,e,this.path,!0),Et("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if(s.validateArgCount("Query.equalTo",1,2,arguments.length),gt("Query.equalTo",1,t,this.path,!1),Et("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return s.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return s.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=M(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if(s.validateArgCount("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}var r=this.repo===e.repo,i=this.path.equals(e.path),o=this.queryIdentifier()===e.queryIdentifier();return r&&i&&o},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,s.validateCallback(t,3,r.cancel,!0),r.context=n,s.validateContextObject(t,4,r.context,!0);else if(e)if("object"===typeof e&&null!==e)r.context=e;else{if("function"!==typeof e)throw new Error(s.errorPrefix(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}(),Te=function(){function t(){this.value=null,this.children=new Map}return t.prototype.find=function(t){if(null!=this.value)return this.value.getChild(t);if(!t.isEmpty()&&this.children.size>0){var e=t.getFront();if(t=t.popFront(),this.children.has(e)){var n=this.children.get(e);return n.find(t)}return null}return null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value=n,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(e,n);else{var r=e.getFront();this.children.has(r)||this.children.set(r,new t);var i=this.children.get(r);e=e.popFront(),i.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var e=this.value;this.value=null;var n=this;return e.forEachChild(Ht,(function(t,e){n.remember(new G(t),e)})),this.forget(t)}if(this.children.size>0){var r=t.getFront();if(t=t.popFront(),this.children.has(r)){var i=this.children.get(r).forget(t);i&&this.children.delete(r)}return 0===this.children.size}return!0},t.prototype.forEachTree=function(t,e){null!==this.value?e(t,this.value):this.forEachChild((function(n,r){var i=new G(t.toString()+"/"+n);r.forEachTree(i,e)}))},t.prototype.forEachChild=function(t){this.children.forEach((function(e,n){t(n,e)}))},t}(),Ee=function(t){return t=t||{},t["timestamp"]=t["timestamp"]||(new Date).getTime(),t},Se=function(t,e){return t&&"object"===typeof t?(s.assert(".sv"in t,"Unexpected leaf node or priority contents"),e[t[".sv"]]):t},Ce=function(t,e){var n=new Te;return t.forEachTree(new G(""),(function(t,r){n.remember(t,Ie(r,e))})),n},Ie=function(t,e){var n,r=t.getPriority().val(),i=Se(r,e);if(t.isLeafNode()){var o=t,a=Se(o.getValue(),e);return a!==o.getValue()||i!==o.getPriority().val()?new jt(a,he(i)):t}var s=t;return n=s,i!==s.getPriority().val()&&(n=n.updatePriority(new jt(i))),s.forEachChild(Ht,(function(t,r){var i=Ie(r,e);i!==r&&(n=n.updateImmediateChild(t,i))})),n};(function(t){t[t["OVERWRITE"]=0]="OVERWRITE",t[t["MERGE"]=1]="MERGE",t[t["ACK_USER_WRITE"]=2]="ACK_USER_WRITE",t[t["LISTEN_COMPLETE"]=3]="LISTEN_COMPLETE"})(fe||(fe={}));var Ae,Ne,ke=function(){function t(t,e,n,r){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=r,s.assert(!r||e,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}(),De=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=fe.ACK_USER_WRITE,this.source=ke.User}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return s.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new G(e));return new t(G.Empty,n,this.revert)}return s.assert(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}(),xe=function(){return Ae||(Ae=new Jt(O)),Ae},Oe=function(){function t(t,e){void 0===e&&(e=xe()),this.value=t,this.children=e}return t.fromObject=function(e){var n=t.Empty;return L(e,(function(t,e){n=n.set(new G(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:G.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);if(null!=i){var o=new G(n).child(i.path);return{path:o,value:i.value}}return null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),r=this.children.get(n);return null!==r?r.subtree(e.popFront()):t.Empty},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var r=e.getFront(),i=this.children.get(r)||t.Empty,o=i.set(e.popFront(),n),a=this.children.insert(r,o);return new t(this.value,a)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?t.Empty:new t(null,this.children);var n=e.getFront(),r=this.children.get(n);if(r){var i=r.remove(e.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?t.Empty:new t(this.value,o)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var r=e.getFront(),i=this.children.get(r)||t.Empty,o=i.setTree(e.popFront(),n),a=void 0;return a=o.isEmpty()?this.children.remove(r):this.children.insert(r,o),new t(this.value,a)},t.prototype.fold=function(t){return this.fold_(G.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(t.child(r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,G.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.findOnPath_(t.popFront(),e.child(i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,G.Empty,e)},t.prototype.foreachOnPath_=function(e,n,r){if(e.isEmpty())return this;this.value&&r(n,this.value);var i=e.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(e.popFront(),n.child(i),r):t.Empty},t.prototype.foreach=function(t){this.foreach_(G.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(t.child(n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t.Empty=new t(null),t}(),Re=function(){function t(t,e){this.source=t,this.path=e,this.type=fe.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,G.Empty):new t(this.source,this.path.popFront())},t}(),Me=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=fe.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,G.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}(),Pe=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=fe.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new G(e));return n.isEmpty()?null:n.value?new Me(this.source,G.Empty,n.value):new t(this.source,G.Empty,n)}return s.assert(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),Le=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),Fe=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,r){return new t(new Le(e,n,r),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,r){return new t(this.eventCache_,new Le(e,n,r))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t.Empty=new t(new Le(ae.EMPTY_NODE,!1,!1),new Le(ae.EMPTY_NODE,!1,!1)),t}(),Ue=function(){function t(t,e,n,r,i){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=r,this.prevName=i}return t.valueChange=function(e){return new t(t.VALUE,e)},t.childAddedChange=function(e,n){return new t(t.CHILD_ADDED,n,e)},t.childRemovedChange=function(e,n){return new t(t.CHILD_REMOVED,n,e)},t.childChangedChange=function(e,n,r){return new t(t.CHILD_CHANGED,n,e,r)},t.childMovedChange=function(e,n){return new t(t.CHILD_MOVED,n,e)},t.CHILD_ADDED="child_added",t.CHILD_REMOVED="child_removed",t.CHILD_CHANGED="child_changed",t.CHILD_MOVED="child_moved",t.VALUE="value",t}(),qe=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,o){s.assert(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=t.getImmediateChild(e);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()==n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(Ue.childRemovedChange(e,a)):s.assert(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ue.childAddedChange(e,n)):o.trackChildChange(Ue.childChangedChange(e,n,a))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(Ht,(function(t,r){e.hasChild(t)||n.trackChildChange(Ue.childRemovedChange(t,r))})),e.isLeafNode()||e.forEachChild(Ht,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(Ue.childChangedChange(e,r,i))}else n.trackChildChange(Ue.childAddedChange(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?ae.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),Ve=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;s.assert(e==Ue.CHILD_ADDED||e==Ue.CHILD_CHANGED||e==Ue.CHILD_REMOVED,"Only child changes supported for tracking"),s.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if(e==Ue.CHILD_ADDED&&i==Ue.CHILD_REMOVED)this.changeMap.set(n,Ue.childChangedChange(n,t.snapshotNode,r.snapshotNode));else if(e==Ue.CHILD_REMOVED&&i==Ue.CHILD_ADDED)this.changeMap.delete(n);else if(e==Ue.CHILD_REMOVED&&i==Ue.CHILD_CHANGED)this.changeMap.set(n,Ue.childRemovedChange(n,r.oldSnap));else if(e==Ue.CHILD_CHANGED&&i==Ue.CHILD_ADDED)this.changeMap.set(n,Ue.childAddedChange(n,t.snapshotNode));else{if(e!=Ue.CHILD_CHANGED||i!=Ue.CHILD_CHANGED)throw s.assertionError("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,Ue.childChangedChange(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),Be=function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}(),je=new Be,We=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new Le(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},t}(),Ke=function(){function t(t,e){this.viewCache=t,this.changes=e}return t}(),ze=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){s.assert(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),s.assert(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,r,i){var o,a,u=new Ve;if(n.type===fe.OVERWRITE){var c=n;c.source.fromUser?o=this.applyUserOverwrite_(e,c.path,c.snap,r,i,u):(s.assert(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.getServerCache().isFiltered()&&!c.path.isEmpty(),o=this.applyServerOverwrite_(e,c.path,c.snap,r,i,a,u))}else if(n.type===fe.MERGE){var h=n;h.source.fromUser?o=this.applyUserMerge_(e,h.path,h.children,r,i,u):(s.assert(h.source.fromServer,"Unknown source."),a=h.source.tagged||e.getServerCache().isFiltered(),o=this.applyServerMerge_(e,h.path,h.children,r,i,a,u))}else if(n.type===fe.ACK_USER_WRITE){var l=n;o=l.revert?this.revertUserWrite_(e,l.path,r,i,u):this.ackUserWrite_(e,l.path,l.affectedTree,r,i,u)}else{if(n.type!==fe.LISTEN_COMPLETE)throw s.assertionError("Unknown operation type: "+n.type);o=this.listenComplete_(e,n.path,r,u)}var f=u.getChanges();return t.maybeAddValueEvent_(e,o,f),new Ke(o,f)},t.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(n.length>0||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Ue.valueChange(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,i){var o=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var a=void 0,u=void 0;if(e.isEmpty())if(s.assert(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var c=t.getCompleteServerSnap(),h=c instanceof ae?c:ae.EMPTY_NODE,l=n.calcCompleteEventChildren(h);a=this.filter_.updateFullNode(t.getEventCache().getNode(),l,i)}else{var f=n.calcCompleteEventCache(t.getCompleteServerSnap());a=this.filter_.updateFullNode(t.getEventCache().getNode(),f,i)}else{var p=e.getFront();if(".priority"==p){s.assert(1==e.getLength(),"Can't have a priority with additional path components");var d=o.getNode();u=t.getServerCache().getNode();var m=n.calcEventCacheAfterServerOverwrite(e,d,u);a=null!=m?this.filter_.updatePriority(d,m):o.getNode()}else{var y=e.popFront(),g=void 0;if(o.isCompleteForChild(p)){u=t.getServerCache().getNode();var v=n.calcEventCacheAfterServerOverwrite(e,o.getNode(),u);g=null!=v?o.getNode().getImmediateChild(p).updateChild(y,v):o.getNode().getImmediateChild(p)}else g=n.calcCompleteChild(p,t.getServerCache());a=null!=g?this.filter_.updateChild(o.getNode(),p,g,y,r,i):o.getNode()}}return t.updateEventSnap(a,o.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,a){var s,u=t.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())s=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var h=u.getNode().updateChild(e,n);s=c.updateFullNode(u.getNode(),h,null)}else{var l=e.getFront();if(!u.isCompleteForPath(e)&&e.getLength()>1)return t;var f=e.popFront(),p=u.getNode().getImmediateChild(l),d=p.updateChild(f,n);s=".priority"==l?c.updatePriority(u.getNode(),d):c.updateChild(u.getNode(),l,d,f,je,null)}var m=t.updateServerSnap(s,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),y=new We(r,m,i);return this.generateEventCacheAfterServerEvent_(m,e,r,y,a)},t.prototype.applyUserOverwrite_=function(t,e,n,r,i,o){var a,s,u=t.getEventCache(),c=new We(r,t,i);if(e.isEmpty())s=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),a=t.updateEventSnap(s,!0,this.filter_.filtersNodes());else{var h=e.getFront();if(".priority"===h)s=this.filter_.updatePriority(t.getEventCache().getNode(),n),a=t.updateEventSnap(s,u.isFullyInitialized(),u.isFiltered());else{var l=e.popFront(),f=u.getNode().getImmediateChild(h),p=void 0;if(l.isEmpty())p=n;else{var d=c.getCompleteChild(h);p=null!=d?".priority"===l.getBack()&&d.getChild(l.parent()).isEmpty()?d:d.updateChild(l,n):ae.EMPTY_NODE}if(f.equals(p))a=t;else{var m=this.filter_.updateChild(u.getNode(),h,p,l,c,o);a=t.updateEventSnap(m,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,r,i,o,a){var s=this,u=e;return r.foreach((function(r,c){var h=n.child(r);t.cacheHasChild_(e,h.getFront())&&(u=s.applyUserOverwrite_(u,h,c,i,o,a))})),r.foreach((function(r,c){var h=n.child(r);t.cacheHasChild_(e,h.getFront())||(u=s.applyUserOverwrite_(u,h,c,i,o,a))})),u},t.prototype.applyMerge_=function(t,e){return e.foreach((function(e,n){t=t.updateChild(e,n)})),t},t.prototype.applyServerMerge_=function(t,e,n,r,i,o,a){var s=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var u,c=t;u=e.isEmpty()?n:Oe.Empty.setTree(e,n);var h=t.getServerCache().getNode();return u.children.inorderTraversal((function(e,n){if(h.hasChild(e)){var u=t.getServerCache().getNode().getImmediateChild(e),l=s.applyMerge_(u,n);c=s.applyServerOverwrite_(c,new G(e),l,r,i,o,a)}})),u.children.inorderTraversal((function(e,n){var u=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!h.hasChild(e)&&!u){var l=t.getServerCache().getNode().getImmediateChild(e),f=s.applyMerge_(l,n);c=s.applyServerOverwrite_(c,new G(e),f,r,i,o,a)}})),c},t.prototype.ackUserWrite_=function(t,e,n,r,i,o){if(null!=r.shadowingWrite(e))return t;var a=t.getServerCache().isFiltered(),s=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,s.getNode().getChild(e),r,i,a,o);if(e.isEmpty()){var u=Oe.Empty;return s.getNode().forEachChild(Pt,(function(t,e){u=u.set(new G(t),e)})),this.applyServerMerge_(t,e,u,r,i,a,o)}return t}var c=Oe.Empty;return n.foreach((function(t,n){var r=e.child(t);s.isCompleteForPath(r)&&(c=c.set(t,s.getNode().getChild(r)))})),this.applyServerMerge_(t,e,c,r,i,a,o)},t.prototype.listenComplete_=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,je,r)},t.prototype.revertUserWrite_=function(t,e,n,r,i){var o;if(null!=n.shadowingWrite(e))return t;var a=new We(n,t,r),u=t.getEventCache().getNode(),c=void 0;if(e.isEmpty()||".priority"===e.getFront()){var h=void 0;if(t.getServerCache().isFullyInitialized())h=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var l=t.getServerCache().getNode();s.assert(l instanceof ae,"serverChildren would be complete if leaf node"),h=n.calcCompleteEventChildren(l)}h=h,c=this.filter_.updateFullNode(u,h,i)}else{var f=e.getFront(),p=n.calcCompleteChild(f,t.getServerCache());null==p&&t.getServerCache().isCompleteForChild(f)&&(p=u.getImmediateChild(f)),c=null!=p?this.filter_.updateChild(u,f,p,e.popFront(),a,i):t.getEventCache().getNode().hasChild(f)?this.filter_.updateChild(u,f,ae.EMPTY_NODE,e.popFront(),a,i):u,c.isEmpty()&&t.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(t.getCompleteServerSnap()),o.isLeafNode()&&(c=this.filter_.updateFullNode(c,o,i)))}return o=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(G.Empty),t.updateEventSnap(c,o,this.filter_.filtersNodes())},t}(),Ge=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var r=this,i=[],o=[];return t.forEach((function(t){t.type===Ue.CHILD_CHANGED&&r.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(Ue.childMovedChange(t.childName,t.snapshotNode))})),this.generateEventsForType_(i,Ue.CHILD_REMOVED,t,n,e),this.generateEventsForType_(i,Ue.CHILD_ADDED,t,n,e),this.generateEventsForType_(i,Ue.CHILD_MOVED,o,n,e),this.generateEventsForType_(i,Ue.CHILD_CHANGED,t,n,e),this.generateEventsForType_(i,Ue.VALUE,t,n,e),i},t.prototype.generateEventsForType_=function(t,e,n,r,i){var o=this,a=n.filter((function(t){return t.type===e}));a.sort(this.compareChanges_.bind(this)),a.forEach((function(e){var n=o.materializeSingleChange_(e,i);r.forEach((function(r){r.respondsTo(e.type)&&t.push(r.createEvent(n,o.query_))}))}))},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type?t:(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_),t)},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw s.assertionError("Should only compare child_ events.");var n=new Ot(t.childName,t.snapshotNode),r=new Ot(e.childName,e.snapshotNode);return this.index_.compare(n,r)},t}(),Qe=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new qe(n.getIndex()),i=n.getNodeFilter();this.processor_=new ze(i);var o=e.getServerCache(),a=e.getEventCache(),s=r.updateFullNode(ae.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(ae.EMPTY_NODE,a.getNode(),null),c=new Le(s,o.isFullyInitialized(),r.filtersNodes()),h=new Le(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=new Fe(h,c),this.eventGenerator_=new Ge(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){s.assert(null==t,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach((function(t){e=e;var i=t.createCancelEvent(e,r);i&&n.push(i)}))}if(t){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(t)){if(t.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===fe.MERGE&&null!==t.source.queryId&&(s.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),s.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,t,e,n);return this.processor_.assertIndexed(i.viewCache),s.assert(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];if(!e.getNode().isLeafNode()){var r=e.getNode();r.forEachChild(Ht,(function(t,e){n.push(Ue.childAddedChange(t,e))}))}return e.isFullyInitialized()&&n.push(Ue.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(t,e,r)},t}(),He=function(){function t(){this.views=new Map}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return s.assert(Ne,"Reference.ts has not been loaded"),Ne},set:function(t){s.assert(!Ne,"__referenceConstructor has already been defined"),Ne=t},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.views.size},t.prototype.applyOperation=function(t,e,n){var r,i,o=t.source.queryId;if(null!==o){var u=this.views.get(o);return s.assert(null!=u,"SyncTree gave us an op for an invalid query."),u.applyOperation(t,e,n)}var c=[];try{for(var h=a.__values(this.views.values()),l=h.next();!l.done;l=h.next()){u=l.value;c=c.concat(u.applyOperation(t,e,n))}}catch(f){r={error:f}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}return c},t.prototype.addEventRegistration=function(t,e,n,r,i){var o=t.queryIdentifier(),a=this.views.get(o);if(!a){var s=n.calcCompleteEventCache(i?r:null),u=!1;s?u=!0:r instanceof ae?(s=n.calcCompleteEventChildren(r),u=!1):(s=ae.EMPTY_NODE,u=!1);var c=new Fe(new Le(s,u,!1),new Le(r,i,!1));a=new Qe(t,c),this.views.set(o,a)}return a.addEventRegistration(e),a.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,r){var i,o,s=e.queryIdentifier(),u=[],c=[],h=this.hasCompleteView();if("default"===s)try{for(var l=a.__values(this.views.entries()),f=l.next();!f.done;f=l.next()){var p=a.__read(f.value,2),d=p[0],m=p[1];c=c.concat(m.removeEventRegistration(n,r)),m.isEmpty()&&(this.views.delete(d),m.getQuery().getQueryParams().loadsAllData()||u.push(m.getQuery()))}}catch(y){i={error:y}}finally{try{f&&!f.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}else{m=this.views.get(s);m&&(c=c.concat(m.removeEventRegistration(n,r)),m.isEmpty()&&(this.views.delete(s),m.getQuery().getQueryParams().loadsAllData()||u.push(m.getQuery())))}return h&&!this.hasCompleteView()&&u.push(new t.__referenceConstructor(e.repo,e.path)),{removed:u,events:c}},t.prototype.getQueryViews=function(){var t,e,n=[];try{for(var r=a.__values(this.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;o.getQuery().getQueryParams().loadsAllData()||n.push(o)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},t.prototype.getCompleteServerCache=function(t){var e,n,r=null;try{for(var i=a.__values(this.views.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r||s.getCompleteServerCache(t)}}catch(u){e={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},t.prototype.viewForQuery=function(t){var e=t.getQueryParams();if(e.loadsAllData())return this.getCompleteView();var n=t.queryIdentifier();return this.views.get(n)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){var t,e;try{for(var n=a.__values(this.views.values()),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.getQuery().getQueryParams().loadsAllData())return i}}catch(o){t={error:o}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return null},t}(),Ye=function(){function t(t){this.writeTree_=t}return t.prototype.addWrite=function(e,n){if(e.isEmpty())return new t(new Oe(n));var r=this.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,a=G.relativePath(i,e);return o=o.updateChild(a,n),new t(this.writeTree_.set(i,o))}var s=new Oe(n),u=this.writeTree_.setTree(e,s);return new t(u)},t.prototype.addWrites=function(t,e){var n=this;return L(e,(function(e,r){n=n.addWrite(t.child(e),r)})),n},t.prototype.removeWrite=function(e){if(e.isEmpty())return t.Empty;var n=this.writeTree_.setTree(e,Oe.Empty);return new t(n)},t.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},t.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild(G.relativePath(e.path,t)):null},t.prototype.getCompleteChildren=function(){var t=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(Ht,(function(e,n){t.push(new Ot(e,n))})):this.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new Ot(e,n.value))})),t},t.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var n=this.getCompleteNode(e);return new t(null!=n?new Oe(n):this.writeTree_.subtree(e))},t.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},t.prototype.apply=function(t){return $e(G.Empty,this.writeTree_,t)},t.Empty=new t(new Oe(null)),t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $e(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);var r=null;return e.children.inorderTraversal((function(e,i){".priority"===e?(s.assert(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=$e(t.child(e),i,n)})),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(t.child(".priority"),r)),n}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe=function(){function t(){this.visibleWrites_=Ye.Empty,this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new Je(t,this)},t.prototype.addOverwrite=function(t,e,n,r){s.assert(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){s.assert(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex((function(e){return e.writeId===t}));s.assert(n>=0,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);var i=r.visible,o=!1,a=this.allWrites_.length-1;while(i&&a>=0){var u=this.allWrites_[a];u.visible&&(a>=n&&this.recordContainsPath_(u,r.path)?i=!1:r.path.contains(u.path)&&(o=!0)),a--}if(i){if(o)return this.resetTree_(),!0;if(r.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(r.path);else{var c=r.children;L(c,(function(t){e.visibleWrites_=e.visibleWrites_.removeWrite(r.path.child(t))}))}return!0}return!1},t.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcCompleteEventCache=function(e,n,r,i){if(r||i){var o=this.visibleWrites_.childCompoundWrite(e);if(!i&&o.isEmpty())return n;if(i||null!=n||o.hasCompleteWrite(G.Empty)){var a=function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))},s=t.layerTree_(this.allWrites_,a,e);h=n||ae.EMPTY_NODE;return s.apply(h)}return null}var u=this.visibleWrites_.getCompleteNode(e);if(null!=u)return u;var c=this.visibleWrites_.childCompoundWrite(e);if(c.isEmpty())return n;if(null!=n||c.hasCompleteWrite(G.Empty)){var h=n||ae.EMPTY_NODE;return c.apply(h)}return null},t.prototype.calcCompleteEventChildren=function(t,e){var n=ae.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(t);if(r)return r.isLeafNode()||r.forEachChild(Ht,(function(t,e){n=n.updateImmediateChild(t,e)})),n;if(e){var i=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(Ht,(function(t,e){var r=i.childCompoundWrite(new G(t)).apply(e);n=n.updateImmediateChild(t,r)})),i.getCompleteChildren().forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n}var o=this.visibleWrites_.childCompoundWrite(t);return o.getCompleteChildren().forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){s.assert(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=t.child(e);if(this.visibleWrites_.hasCompleteWrite(i))return null;var o=this.visibleWrites_.childCompoundWrite(i);return o.isEmpty()?r.getChild(e):o.apply(r.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=this.visibleWrites_.getCompleteNode(r);if(null!=i)return i;if(n.isCompleteForChild(e)){var o=this.visibleWrites_.childCompoundWrite(r);return o.apply(n.getNode().getImmediateChild(e))}return null},t.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcIndexedSlice=function(t,e,n,r,i,o){var a,s=this.visibleWrites_.childCompoundWrite(t),u=s.getCompleteNode(G.Empty);if(null!=u)a=u;else{if(null==e)return[];a=s.apply(e)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];var c=[],h=o.getCompare(),l=i?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o),f=l.getNext();while(f&&c.length<r)0!==h(f,n)&&c.push(f),f=l.getNext();return c},t.prototype.recordContainsPath_=function(t,e){if(t.snap)return t.path.contains(e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&t.path.child(n).contains(e))return!0;return!1},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,G.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var r=Ye.Empty,i=0;i<t.length;++i){var o=t[i];if(e(o)){var a=o.path,u=void 0;if(o.snap)n.contains(a)?(u=G.relativePath(n,a),r=r.addWrite(u,o.snap)):a.contains(n)&&(u=G.relativePath(a,n),r=r.addWrite(G.Empty,o.snap.getChild(u)));else{if(!o.children)throw s.assertionError("WriteRecord should have .snap or .children");if(n.contains(a))u=G.relativePath(n,a),r=r.addWrites(u,o.children);else if(a.contains(n))if(u=G.relativePath(a,n),u.isEmpty())r=r.addWrites(G.Empty,o.children);else{var c=s.safeGet(o.children,u.getFront());if(c){var h=c.getChild(u.popFront());r=r.addWrite(G.Empty,h)}}}}}return r},t}(),Je=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,r,i)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}(),Ze=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=Oe.Empty,this.pendingWriteTree_=new Xe,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return t.prototype.applyUserOverwrite=function(t,e,n,r){return this.pendingWriteTree_.addOverwrite(t,e,n,r),r?this.applyOperationToSyncPoints_(new Me(ke.User,t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var r=Oe.fromObject(e);return this.applyOperationToSyncPoints_(new Pe(ke.User,t,r))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t),r=this.pendingWriteTree_.removeWrite(t);if(r){var i=Oe.Empty;return null!=n.snap?i=i.set(G.Empty,!0):L(n.children,(function(t,e){i=i.set(new G(t),e)})),this.applyOperationToSyncPoints_(new De(n.path,i,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new Me(ke.Server,t,e))},t.prototype.applyServerMerge=function(t,e){var n=Oe.fromObject(e);return this.applyOperationToSyncPoints_(new Pe(ke.Server,t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new Re(ke.Server,t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=G.relativePath(a,e),c=new Me(ke.forServerTaggedQuery(s),u,n);return this.applyTaggedOperation_(a,c)}return[]},t.prototype.applyTaggedQueryMerge=function(e,n,r){var i=this.queryKeyForTag_(r);if(i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=G.relativePath(a,e),c=Oe.fromObject(n),h=new Pe(ke.forServerTaggedQuery(s),u,c);return this.applyTaggedOperation_(a,h)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var r=this.queryKeyForTag_(n);if(r){var i=t.parseQueryKey_(r),o=i.path,a=i.queryId,s=G.relativePath(o,e),u=new Re(ke.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(o,u)}return[]},t.prototype.addEventRegistration=function(e,n){var r=e.path,i=null,o=!1;this.syncPointTree_.foreachOnPath(r,(function(t,e){var n=G.relativePath(t,r);i=i||e.getCompleteServerCache(n),o=o||e.hasCompleteView()}));var a,u=this.syncPointTree_.get(r);if(u?(o=o||u.hasCompleteView(),i=i||u.getCompleteServerCache(G.Empty)):(u=new He,this.syncPointTree_=this.syncPointTree_.set(r,u)),null!=i)a=!0;else{a=!1,i=ae.EMPTY_NODE;var c=this.syncPointTree_.subtree(r);c.foreachChild((function(t,e){var n=e.getCompleteServerCache(G.Empty);n&&(i=i.updateImmediateChild(t,n))}))}var h=u.viewExistsForQuery(e);if(!h&&!e.getQueryParams().loadsAllData()){var l=t.makeQueryKey_(e);s.assert(!this.queryToTagMap.has(l),"View does not exist, but we have a tag");var f=t.getNextQueryTag_();this.queryToTagMap.set(l,f),this.tagToQueryMap.set(f,l)}var p=this.pendingWriteTree_.childWrites(r),d=u.addEventRegistration(e,n,p,i,a);if(!h&&!o){var m=u.viewForQuery(e);d=d.concat(this.setupListener_(e,m))}return d},t.prototype.removeEventRegistration=function(e,n,r){var i=this,o=e.path,a=this.syncPointTree_.get(o),s=[];if(a&&("default"===e.queryIdentifier()||a.viewExistsForQuery(e))){var u=a.removeEventRegistration(e,n,r);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;s=u.events;var h=-1!==c.findIndex((function(t){return t.getQueryParams().loadsAllData()})),l=this.syncPointTree_.findOnPath(o,(function(t,e){return e.hasCompleteView()}));if(h&&!l){var f=this.syncPointTree_.subtree(o);if(!f.isEmpty())for(var p=this.collectDistinctViewsForSubTree_(f),d=0;d<p.length;++d){var m=p[d],y=m.getQuery(),g=this.createListenerForView_(m);this.listenProvider_.startListening(t.queryForListening_(y),this.tagForQuery_(y),g.hashFn,g.onComplete)}}if(!l&&c.length>0&&!r)if(h){var v=null;this.listenProvider_.stopListening(t.queryForListening_(e),v)}else c.forEach((function(e){var n=i.queryToTagMap.get(t.makeQueryKey_(e));i.listenProvider_.stopListening(t.queryForListening_(e),n)}));this.removeTags_(c)}return s},t.prototype.calcCompleteEventCache=function(t,e){var n=!0,r=this.pendingWriteTree_,i=this.syncPointTree_.findOnPath(t,(function(e,n){var r=G.relativePath(e,t),i=n.getCompleteServerCache(r);if(i)return i}));return r.calcCompleteEventCache(t,i,e,n)},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold((function(t,e,n){if(e&&e.hasCompleteView()){var r=e.getCompleteView();return[r]}var i=[];return e&&(i=e.getQueryViews()),L(n,(function(t,e){i=i.concat(e)})),i}))},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var r=e[n];if(!r.getQueryParams().loadsAllData()){var i=t.makeQueryKey_(r),o=this.queryToTagMap.get(i);this.queryToTagMap.delete(i),this.tagToQueryMap.delete(o)}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var r=e.path,i=this.tagForQuery_(e),o=this.createListenerForView_(n),a=this.listenProvider_.startListening(t.queryForListening_(e),i,o.hashFn,o.onComplete),u=this.syncPointTree_.subtree(r);if(i)s.assert(!u.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold((function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map((function(t){return t.getQuery()})))),L(n,(function(t,e){r=r.concat(e)})),r})),h=0;h<c.length;++h){var l=c[h];this.listenProvider_.stopListening(t.queryForListening_(l),this.tagForQuery_(l))}return a},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){var e=t.getServerCache()||ae.EMPTY_NODE;return e.hash()},onComplete:function(t){if("ok"===t)return r?e.applyTaggedListenComplete(n.path,r):e.applyListenComplete(n.path);var i=V(t,n);return e.removeEventRegistration(n,null,i)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return s.assert(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new G(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap.get(t)},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return this.queryToTagMap.get(n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);s.assert(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,r,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(G.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,r){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,r);var i=e.get(G.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(G.Empty));var o=[],a=t.path.getFront(),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,h=r.child(a);o=o.concat(this.applyOperationHelper_(s,u,c,h))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,r){var i=this,o=e.get(G.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(G.Empty));var a=[];return e.children.inorderTraversal((function(e,o){var s=n?n.getImmediateChild(e):null,u=r.child(e),c=t.operationForChild(e);c&&(a=a.concat(i.applyOperationDescendantsHelper_(c,o,s,u)))})),o&&(a=a.concat(o.applyOperation(t,r,n))),a},t.nextQueryTag_=1,t}(),tn=function(){function t(){this.rootNode_=ae.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}(),en=function(){function t(t){this.app_=t}return t.prototype.getToken=function(t){return this.app_["INTERNAL"]["getToken"](t).then(null,(function(t){return t&&"auth/token-not-initialized"===t.code?(w("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)}))},t.prototype.addTokenChangeListener=function(t){this.app_["INTERNAL"]["addAuthTokenListener"](t)},t.prototype.removeTokenChangeListener=function(t){this.app_["INTERNAL"]["removeAuthTokenListener"](t)},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',C(t)},t}(),nn=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),s.contains(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return s.deepCopy(this.counters_)},t}(),rn=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new nn),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}(),on=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=a.__assign({},t);return this.last_&&L(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),an=1e4,sn=3e4,un=3e5,cn=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new on(t);var n=an+(sn-an)*Math.random();z(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;L(e,(function(e,i){i>0&&s.contains(t.statsToReport_,e)&&(n[e]=i,r=!0)})),r&&this.server_.reportStats(n),z(this.reportStats_.bind(this),Math.floor(2*Math.random()*un))},t}(),hn=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new ln(i)),e.add(r)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.equals(t)}))},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.contains(t)||t.contains(e)}))},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];if(r){var i=r.getPath();t(i)?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1}}e&&(this.eventLists_=[]),this.recursionDepth_--},t}(),ln=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();v&&w("event: "+e.toString()),W(n)}}},t.prototype.getPath=function(){return this.path_},t}(),fn=function(){function t(t){this.allowedEvents_=t,this.listeners_={},s.assert(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=a.__spread(this.listeners_[t]),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){s.assert(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),pn=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document["hidden"]?(n="visibilitychange",e="hidden"):"undefined"!==typeof document["mozHidden"]?(n="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document["msHidden"]?(n="msvisibilitychange",e="msHidden"):"undefined"!==typeof document["webkitHidden"]&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return a.__extends(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return s.assert("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(fn),dn=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||s.isMobileCordova()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return a.__extends(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return s.assert("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(fn),mn=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&W((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;while(this.pendingResponses[this.currentResponseNum]){var o=r();if("break"===o)break}},t}(),yn="start",gn="close",vn="pLPCommand",bn="pRTLPCB",_n="id",wn="pw",Tn="ser",En="cb",Sn="seg",Cn="ts",In="d",An="dframe",Nn=1870,kn=30,Dn=Nn-kn,xn=25e3,On=3e4,Rn=function(){function t(t,e,n,r){this.connId=t,this.repoInfo=e,this.transportSessionId=n,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=T(t),this.stats_=rn.getCollection(e),this.urlFn=function(t){return e.connectionURL(nt,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new mn(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(On)),N((function(){if(!n.isClosed_){n.scriptTagHolder=new Mn((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=a.__read(t,5),i=r[0],o=r[1],s=r[2];r[3],r[4];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i==yn)n.id=o,n.password=s;else{if(i!==gn)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=a.__read(t,2),i=r[0],o=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var t={};t[yn]="t",t[Tn]=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t[En]=n.scriptTagHolder.uniqueCallbackIdentifier),t[Y]=H,n.transportSessionId&&(t[$]=n.transportSessionId),n.lastSessionId&&(t[tt]=n.lastSessionId),"undefined"!==typeof location&&location.href&&-1!==location.href.indexOf(Z)&&(t[X]=J);var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!s.isNodeSdk()&&(!!t.forceAllow_||!t.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!U()&&!q())},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=s.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=s.base64Encode(e),r=P(n,Dn),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!s.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var n={};n[An]="t",n[_n]=t,n[wn]=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=s.stringify(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),Mn=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,s.isNodeSdk())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=m(),window[vn+this.uniqueCallbackIdentifier]=e,window[bn+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var o="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){var a=document.domain;o='<script>document.domain="'+a+'";<\/script>'}var u="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(u),this.myIFrame.doc.close()}catch(c){w("frame writing exception"),c.stack&&w(c.stack),w(c)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{var e=t.contentWindow.document;e||w("No IE domain setting required")}catch(r){var n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){this.myID=t,this.myPW=e,this.alive=!0;while(this.newRequest_());},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t[_n]=this.myID,t[wn]=this.myPW,t[Tn]=this.currentSerial;var e=this.urlFn(t),n="",r=0;while(this.pendingSegs.length>0){var i=this.pendingSegs[0];if(!(i.d.length+kn+n.length<=Nn))break;var o=this.pendingSegs.shift();n=n+"&"+Sn+r+"="+o.seg+"&"+Cn+r+"="+o.ts+"&"+In+r+"="+o.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(xn)),o=function(){clearTimeout(i),r()};this.addTag(t,o)},t.prototype.addTag=function(t,e){var n=this;s.isNodeSdk()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){w("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))},t}(),Pn="";function Ln(t){Pn=t}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fn=16384,Un=45e3,qn=null;"undefined"!==typeof MozWebSocket?qn=MozWebSocket:"undefined"!==typeof WebSocket&&(qn=WebSocket);var Vn=function(){function t(e,n,r,i){this.connId=e,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=T(this.connId),this.stats_=rn.getCollection(n),this.connURL=t.connectionURL_(n,r,i)}return t.connectionURL_=function(t,e,n){var r={};return r[Y]=H,!s.isNodeSdk()&&"undefined"!==typeof location&&location.href&&-1!==location.href.indexOf(Z)&&(r[X]=J),e&&(r[$]=e),n&&(r[tt]=n),t.connectionURL(et,r)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,f.set("previous_websocket_failure",!0);try{if(s.isNodeSdk()){var i=s.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",o={headers:{"User-Agent":"Firebase/"+H+"/"+Pn+"/"+r.platform+"/"+i}},a=Object({NODE_ENV:"production",BASE_URL:"/"}),u=0==this.connURL.indexOf("wss://")?a["HTTPS_PROXY"]||a["https_proxy"]:a["HTTP_PROXY"]||a["http_proxy"];u&&(o["proxy"]={origin:u}),this.mySock=new qn(this.connURL,[],o)}else this.mySock=new qn(this.connURL)}catch(h){this.log_("Error instantiating WebSocket.");var c=h.message||h.data;return c&&this.log_(c),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&null!==qn&&!t.forceDisallow_},t.previouslyFailed=function(){return f.isInMemoryStorage||!0===f.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){f.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length==this.totalFrames){var e=this.frames.join("");this.frames=null;var n=s.jsonEval(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if(s.assert(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t["data"];if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=s.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=P(e,Fn);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(Un))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),Bn=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[Rn,Vn]},enumerable:!0,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,i=Vn&&Vn["isAvailable"](),o=i&&!Vn.previouslyFailed();if(e.webSocketOnly&&(i||C("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[Vn];else{var s=this.transports_=[];try{for(var u=a.__values(t.ALL_TRANSPORTS),c=u.next();!c.done;c=u.next()){var h=c.value;h&&h["isAvailable"]()&&s.push(h)}}catch(l){n={error:l}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),jn=6e4,Wn=5e3,Kn=10240,zn=102400,Gn="t",Qn="d",Hn="s",Yn="r",$n="e",Xn="o",Jn="a",Zn="n",tr="p",er="h",nr=function(){function t(t,e,n,r,i,o,a){this.id=t,this.repoInfo_=e,this.onMessage_=n,this.onReady_=r,this.onDisconnect_=i,this.onKill_=o,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=T("c:"+this.id+":"),this.transportManager_=new Bn(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e["responsesRequiredToBeHealthy"]||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e["healthyTimeout"]||0;i>0&&(this.healthyTimeout_=z((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>zn?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>Kn?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!=e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if(Gn in t){var e=t[Gn];e===Jn?this.upgradeIfSecondaryHealthy_():e===Yn?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):e===Xn&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=R("t",t),n=R("d",t);if("c"==e)this.onSecondaryControl_(n);else{if("d"!=e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:tr,d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Jn,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Zn,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=R("t",t),n=R("d",t);"c"==e?this.onControl_(n):"d"==e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=R(Gn,t);if(Qn in t){var n=t[Qn];if(e===er)this.onHandshake_(n);else if(e===Zn){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else e===Hn?this.onConnectionShutdown_(n):e===Yn?this.onReset_(n):e===$n?E("Server Error: "+n):e===Xn?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):E("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(r),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),H!==n&&C("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=t["responsesRequiredToBeHealthy"]||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),z((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(jn))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):z((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(Wn))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:tr,d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(f.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),rr=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),ir=1e3,or=3e5,ar=3e4,sr=1.3,ur=3e4,cr="server_kill",hr=3,lr=function(t){function e(n,r,i,o,a,u){var c=t.call(this)||this;if(c.repoInfo_=n,c.onDataUpdate_=r,c.onConnectStatus_=i,c.onServerInfoUpdate_=o,c.authTokenProvider_=a,c.authOverride_=u,c.id=e.nextPersistentConnectionId_++,c.log_=T("p:"+c.id+":"),c.interruptReasons_={},c.listens=new Map,c.outstandingPuts_=[],c.outstandingPutCount_=0,c.onDisconnectRequestQueue_=[],c.connected_=!1,c.reconnectDelay_=ir,c.maxReconnectDelay_=or,c.securityDebugCallback_=null,c.lastSessionId=null,c.establishConnectionTimer_=null,c.visible_=!1,c.requestCBHash_={},c.requestNumber_=0,c.realtime_=null,c.authToken_=null,c.forceTokenRefresh_=!1,c.invalidAuthTokenCount_=0,c.firstConnection_=!0,c.lastConnectionAttemptTime_=null,c.lastConnectionEstablishedTime_=null,u&&!s.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return c.scheduleConnect_(0),pn.getInstance().on("visible",c.onVisible_,c),-1===n.host.indexOf("fblocal")&&dn.getInstance().on("online",c.onOnline_,c),c}return a.__extends(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_(s.stringify(i)),s.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),o=t.path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),s.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),s.assert(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var a={p:i},s="q";t.tag&&(a["q"]=r.queryObject(),a["t"]=t.tag),a["h"]=t.hashFn(),this.sendRequest(s,a,(function(a){var s=a["d"],u=a["s"];e.warnOnListenWarnings_(s,r);var c=n.listens.get(i)&&n.listens.get(i).get(o);c===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"===typeof t&&s.contains(t,"w")){var n=s.safeGet(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();C("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){var e=t&&40===t.length;(e||s.isAdmin(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=ar)},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=s.isValidFormat(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r["noauth"]=!0:"object"===typeof this.authOverride_&&(r["authvar"]=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n["s"],i=n["d"]||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),r=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),s.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query");var i=this.removeListen_(n,r);i&&this.connected_&&this.sendUnlisten_(n,r,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t},o="n";r&&(i["q"]=n,i["t"]=r),this.sendRequest(o,i)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t["s"],t["d"])}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o["h"]=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r["s"],r["d"])}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){var n=t["s"];if("ok"!==n){var r=t["d"];e.log_("reportStats","Error sending stats: "+r)}}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+s.stringify(t));var e=t["r"],n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t["b"]))}else{if("error"in t)throw"A server-side error has occurred: "+t["error"];"a"in t&&this.onDataPush_(t["a"],t["b"])}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e["p"],e["d"],!1,e["t"]):"m"===t?this.onDataUpdate_(e["p"],e["d"],!0,e["t"]):"c"===t?this.onListenRevoked_(e["p"],e["q"]):"ac"===t?this.onAuthRevoked_(e["s"],e["d"]):"sd"===t?this.onSecurityDebugPacket_(e):E("Unrecognized action received from server: "+s.stringify(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;s.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ir,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=ir,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){var t=(new Date).getTime()-this.lastConnectionEstablishedTime_;t>ur&&(this.reconnectDelay_=ir),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*sr)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,o=this,a=this.lastSessionId,u=!1,c=null,h=function(){c?c.close():(u=!0,r())},l=function(t){s.assert(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(t)};this.realtime_={close:h,sendRequest:l};var f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(f).then((function(e){u?w("getToken() completed but was canceled"):(w("getToken() completed. Creating connection."),o.authToken_=e&&e.accessToken,c=new nr(i,o.repoInfo_,t,n,r,(function(t){C(t+" ("+o.repoInfo_.toString()+")"),o.interrupt(cr)}),a))})).then(null,(function(t){o.log_("Failed to get token: "+t),u||(s.CONSTANTS.NODE_ADMIN&&C(t),h())}))}},e.prototype.interrupt=function(t){w("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){w("Resuming connection for reason: "+t),delete this.interruptReasons_[t],s.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=ir,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return M(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new G(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){w("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=hr&&(this.reconnectDelay_=ar,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t["msg"].replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth();try{for(var i=a.__values(this.listens.values()),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var u=(n=void 0,a.__values(s.values())),c=u.next();!c.done;c=u.next()){var h=c.value;this.sendListen_(h)}}catch(p){n={error:p}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(d){t={error:d}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);while(this.onDisconnectRequestQueue_.length){var f=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(f.action,f.pathString,f.data,f.onComplete)}},e.prototype.sendConnectStats_=function(){var t={},e="js";s.CONSTANTS.NODE_ADMIN?e="admin_node":s.CONSTANTS.NODE_CLIENT&&(e="node"),t["sdk."+e+"."+Pn.replace(/\./g,"-")]=1,s.isMobileCordova()?t["framework.cordova"]=1:s.isReactNative()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=dn.getInstance().currentlyOnline();return s.isEmpty(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(rr),fr=function(t){function e(e,n,r){var i=t.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=T("p:rest:"),i.listens_={},i}return a.__extends(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(s.assert(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,r,i){var o=this,a=t.path.toString();this.log_("Listen called for "+a+" "+t.queryIdentifier());var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var h=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",h,(function(t,e){var n,h=e;(404===t&&(h=null,t=null),null===t&&o.onDataUpdate_(a,h,!1,r),s.safeGet(o.listens_,u)===c)&&(n=t?401==t?"permission_denied":"rest_error:"+t:"ok",i(n,null))}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;void 0===e&&(e={}),e["format"]="export",this.authTokenProvider_.getToken(!1).then((function(i){var o=i&&i.accessToken;o&&(e["auth"]=o);var a=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+s.querystring(e);r.log_("Sending REST request for "+a);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(n&&4===u.readyState){r.log_("REST Response for "+a+" received. status:",u.status,"response:",u.responseText);var t=null;if(u.status>=200&&u.status<300){try{t=s.jsonEval(u.responseText)}catch(e){C("Failed to parse JSON response for "+a+": "+u.responseText)}n(null,t)}else 401!==u.status&&404!==u.status&&C("Got unsuccessful REST response for "+a+" Status: "+u.status),n(u.status);n=null}},u.open("GET",a,!0),u.send()}))},e}(rr),pr="repo_interrupt",dr=function(){function t(t,e,n){var r=this;this.repoInfo_=t,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new hn,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new Te,this.persistentConnection_=null;var i=new en(n);if(this.stats_=rn.getCollection(t),e||K())this.server_=new fr(this.repoInfo_,this.onDataUpdate_.bind(this),i),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var o=n.options["databaseAuthVariableOverride"];if("undefined"!==typeof o&&null!==o){if("object"!==typeof o)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{s.stringify(o)}catch(a){throw new Error("Invalid authOverride provided: "+a)}}this.persistentConnection_=new lr(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),i,o),this.server_=this.persistentConnection_}i.addTokenChangeListener((function(t){r.server_.refreshAuthToken(t)})),this.statsReporter_=rn.getOrCreateReporter(t,(function(){return new cn(r.stats_,r.server_)})),this.transactions_init_(),this.infoData_=new tn,this.infoSyncTree_=new Ze({startListening:function(t,e,n,i){var o=[],a=r.infoData_.getNode(t.path);return a.isEmpty()||(o=r.infoSyncTree_.applyServerOverwrite(t.path,a),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new Ze({startListening:function(t,e,n,i){return r.server_.listen(t,n,e,(function(e,n){var o=i(e,n);r.eventQueue_.raiseEventsForChangedPath(t.path,o)})),[]},stopListening:function(t,e){r.server_.unlisten(t,e)}})}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new G(".info/serverTimeOffset")),e=t.val()||0;return(new Date).getTime()+e},t.prototype.generateServerValues=function(){return Ee({timestamp:this.serverTime()})},t.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var i=new G(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var o=[];if(r)if(n){var a=s.map(e,(function(t){return he(t)}));o=this.serverSyncTree_.applyTaggedQueryMerge(i,a,r)}else{var u=he(e);o=this.serverSyncTree_.applyTaggedQueryOverwrite(i,u,r)}else if(n){var c=s.map(e,(function(t){return he(t)}));o=this.serverSyncTree_.applyServerMerge(i,c)}else{var h=he(e);o=this.serverSyncTree_.applyServerOverwrite(i,h)}var l=i;o.length>0&&(l=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(l,o)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;L(t,(function(t,n){e.updateInfo_(t,n)}))},t.prototype.updateInfo_=function(t,e){var n=new G("/.info/"+t),r=he(e);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.setWithPriority=function(t,e,n,r){var i=this;this.log_("set",{path:t.toString(),value:e,priority:n});var o=this.generateServerValues(),a=he(e,n),s=Ie(a,o),u=this.getNextWriteId_(),c=this.serverSyncTree_.applyUserOverwrite(t,s,u,!0);this.eventQueue_.queueEvents(c),this.server_.put(t.toString(),a.val(!0),(function(e,n){var o="ok"===e;o||C("set at "+t+" failed: "+e);var a=i.serverSyncTree_.ackUserWrite(u,!o);i.eventQueue_.raiseEventsForChangedPath(t,a),i.callOnCompleteCallback(r,e,n)}));var h=this.abortTransactions_(t);this.rerunTransactions_(h),this.eventQueue_.raiseEventsForChangedPath(h,[])},t.prototype.update=function(t,e,n){var r=this;this.log_("update",{path:t.toString(),value:e});var i=!0,o=this.generateServerValues(),a={};if(L(e,(function(t,e){i=!1;var n=he(e);a[t]=Ie(n,o)})),i)w("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var s=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserMerge(t,a,s);this.eventQueue_.queueEvents(u),this.server_.merge(t.toString(),e,(function(e,i){var o="ok"===e;o||C("update at "+t+" failed: "+e);var a=r.serverSyncTree_.ackUserWrite(s,!o),u=a.length>0?r.rerunTransactions_(t):t;r.eventQueue_.raiseEventsForChangedPath(u,a),r.callOnCompleteCallback(n,e,i)})),L(e,(function(e){var n=r.abortTransactions_(t.child(e));r.rerunTransactions_(n)})),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),n=Ce(this.onDisconnect_,e),r=[];n.forEachTree(G.Empty,(function(e,n){r=r.concat(t.serverSyncTree_.applyServerOverwrite(e,n));var i=t.abortTransactions_(e);t.rerunTransactions_(i)})),this.onDisconnect_=new Te,this.eventQueue_.raiseEventsForChangedPath(G.Empty,r)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,r,i)}))},t.prototype.onDisconnectSet=function(t,e,n){var r=this,i=he(e);this.server_.onDisconnectPut(t.toString(),i.val(!0),(function(e,o){"ok"===e&&r.onDisconnect_.remember(t,i),r.callOnCompleteCallback(n,e,o)}))},t.prototype.onDisconnectSetWithPriority=function(t,e,n,r){var i=this,o=he(e,n);this.server_.onDisconnectPut(t.toString(),o.val(!0),(function(e,n){"ok"===e&&i.onDisconnect_.remember(t,o),i.callOnCompleteCallback(r,e,n)}))},t.prototype.onDisconnectUpdate=function(t,e,n){var r=this;if(s.isEmpty(e))return w("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,(function(i,o){"ok"===i&&L(e,(function(e,n){var i=he(n);r.onDisconnect_.remember(t.child(e),i)})),r.callOnCompleteCallback(n,i,o)}))},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(pr)},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(pr)},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!==typeof console){var e;t?(this.statsListener_||(this.statsListener_=new on(this.stats_)),e=this.statsListener_.get()):e=this.stats_.get();var n=Object.keys(e).reduce((function(t,e){return Math.max(e.length,t)}),0);L(e,(function(t,e){for(var r=t,i=t.length;i<n+2;i++)r+=" ";console.log(r+e)}))}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),w.apply(void 0,a.__spread([n],t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&W((function(){if("ok"==e)t(null);else{var r=(e||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,t(o)}}))},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new Ir(this))},enumerable:!0,configurable:!0}),t}(),mr=function(){function t(e){this.indexedFilter_=new qe(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new Ot(e,n))||(n=ae.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=ae.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(ae.EMPTY_NODE);var i=this;return e.forEachChild(Ht,(function(t,e){i.matches(new Ot(t,e))||(r=r.updateImmediateChild(t,ae.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),yr=function(){function t(t){this.rangedFilter_=new mr(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new Ot(e,n))||(n=ae.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=ae.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=ae.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);var o=0;while(i.hasNext()&&o<this.limit_){var a=i.getNext(),s=void 0;if(s=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0,!s)break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=e.withIndex(this.index_),r=r.updatePriority(ae.EMPTY_NODE);var u=void 0,c=void 0,h=void 0;i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),c=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();h=function(t,e){return l(e,t)}}else i=r.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),c=this.rangedFilter_.getEndPost(),h=this.index_.getCompare();o=0;var f=!1;while(i.hasNext()){a=i.getNext();!f&&h(u,a)<=0&&(f=!0);s=f&&o<this.limit_&&h(a,c)<=0;s?o++:r=r.updateImmediateChild(a.name,ae.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(t,e){return a(e,t)}}else o=this.index_.getCompare();var u=t;s.assert(u.numChildren()==this.limit_,"");var c=new Ot(e,n),h=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),l=this.rangedFilter_.matches(c);if(u.hasChild(e)){var f=u.getImmediateChild(e),p=r.getChildAfterChild(this.index_,h,this.reverse_);while(null!=p&&(p.name==e||u.hasChild(p.name)))p=r.getChildAfterChild(this.index_,p,this.reverse_);var d=null==p?1:o(p,c),m=l&&!n.isEmpty()&&d>=0;if(m)return null!=i&&i.trackChildChange(Ue.childChangedChange(e,n,f)),u.updateImmediateChild(e,n);null!=i&&i.trackChildChange(Ue.childRemovedChange(e,f));var y=u.updateImmediateChild(e,ae.EMPTY_NODE),g=null!=p&&this.rangedFilter_.matches(p);return g?(null!=i&&i.trackChildChange(Ue.childAddedChange(p.name,p.node)),y.updateImmediateChild(p.name,p.node)):y}return n.isEmpty()?t:l&&o(h,c)>=0?(null!=i&&(i.trackChildChange(Ue.childRemovedChange(h.name,h.node)),i.trackChildChange(Ue.childAddedChange(e,n))),u.updateImmediateChild(e,n).updateImmediateChild(h.name,ae.EMPTY_NODE)):t},t}(),gr=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ht}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return s.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return s.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:k},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return s.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return s.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:D},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return s.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=r}return this.index_!==Ht&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==Ht},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new qe(this.getIndex()):this.hasLimit()?new yr(this):new mr(this)},t.prototype.toRestQueryStringParameters=function(){var e,n=t.REST_QUERY_CONSTANTS_,r={};return this.isDefault()?r:(this.index_===Ht?e=n.PRIORITY_INDEX:this.index_===de?e=n.VALUE_INDEX:this.index_===Pt?e=n.KEY_INDEX:(s.assert(this.index_ instanceof me,"Unrecognized index type!"),e=this.index_.toString()),r[n.ORDER_BY]=s.stringify(e),this.startSet_&&(r[n.START_AT]=s.stringify(this.indexStartValue_),this.startNameSet_&&(r[n.START_AT]+=","+s.stringify(this.indexStartName_))),this.endSet_&&(r[n.END_AT]=s.stringify(this.indexEndValue_),this.endNameSet_&&(r[n.END_AT]+=","+s.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?r[n.LIMIT_TO_FIRST]=this.limit_:r[n.LIMIT_TO_LAST]=this.limit_),r)},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t.DEFAULT=new t,t}(),vr=function(t){function e(e,n){var r=this;if(!(e instanceof dr))throw new Error("new Reference() no longer supported - use app.database().");return r=t.call(this,e,n,gr.DEFAULT,!1)||this,r}return a.__extends(e,t),e.prototype.getKey=function(){return s.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return s.validateArgCount("Reference.child",1,1,arguments.length),"number"===typeof t?t=String(t):t instanceof G||(null===this.path.getFront()?Ct("Reference.child",1,t,!1):St("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){s.validateArgCount("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){s.validateArgCount("Reference.root",0,0,arguments.length);var t=this;while(null!==t.getParent())t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){s.validateArgCount("Reference.set",1,2,arguments.length),It("Reference.set",this.path),gt("Reference.set",1,t,this.path,!1),s.validateCallback("Reference.set",2,e,!0);var n=new s.Deferred;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(s.validateArgCount("Reference.update",1,2,arguments.length),It("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,C("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_t("Reference.update",1,t,this.path,!1),s.validateCallback("Reference.update",2,e,!0);var i=new s.Deferred;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},e.prototype.setWithPriority=function(t,e,n){if(s.validateArgCount("Reference.setWithPriority",2,3,arguments.length),It("Reference.setWithPriority",this.path),gt("Reference.setWithPriority",1,t,this.path,!1),wt("Reference.setWithPriority",2,e,!1),s.validateCallback("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new s.Deferred;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},e.prototype.remove=function(t){return s.validateArgCount("Reference.remove",0,1,arguments.length),It("Reference.remove",this.path),s.validateCallback("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if(s.validateArgCount("Reference.transaction",1,3,arguments.length),It("Reference.transaction",this.path),s.validateCallback("Reference.transaction",1,t,!1),s.validateCallback("Reference.transaction",2,e,!0),Nt("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new s.Deferred;"function"===typeof e&&r.promise.catch((function(){}));var i=function(t,n,i){t?r.reject(t):r.resolve(new Dt(n,i)),"function"===typeof e&&e(t,n,i)};return this.repo.startTransaction(this.path,t,i,n),r.promise},e.prototype.setPriority=function(t,e){s.validateArgCount("Reference.setPriority",1,2,arguments.length),It("Reference.setPriority",this.path),wt("Reference.setPriority",1,t,!1),s.validateCallback("Reference.setPriority",2,e,!0);var n=new s.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){s.validateArgCount("Reference.push",0,2,arguments.length),It("Reference.push",this.path),gt("Reference.push",1,t,this.path,!0),s.validateCallback("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=xt(r),o=this.child(i),a=this.child(i);return n=null!=t?o.set(t,e).then((function(){return a})):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"===typeof e&&n.catch((function(){})),o},e.prototype.onDisconnect=function(){return It("Reference.onDisconnect",this.path),new kt(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),e}(we);
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */we.__referenceConstructor=vr,He.__referenceConstructor=vr;
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var br,_r=function(){function t(){this.children={},this.childCount=0,this.value=null}return t}(),wr=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new _r),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){var n,r=e instanceof G?e:new G(e),i=this;while(null!==(n=r.getFront())){var o=s.safeGet(i.node_.children,n)||new _r;i=new t(n,i,o),r=r.popFront()}return i},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){s.assert("undefined"!==typeof t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return this.node_.childCount>0},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;L(this.node_.children,(function(r,i){e(new t(r,n,i))}))},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild((function(e){e.forEachDescendant(t,!0,n)})),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){var n=e?this:this.parent();while(null!==n){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild((function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)}))},t.prototype.path=function(){return new G(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),r=s.contains(this.node_.children,t);n&&r?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}();(function(t){t[t["RUN"]=0]="RUN",t[t["SENT"]=1]="SENT",t[t["COMPLETED"]=2]="COMPLETED",t[t["SENT_NEEDS_ABORT"]=3]="SENT_NEEDS_ABORT",t[t["NEEDS_ABORT"]=4]="NEEDS_ABORT"})(br||(br={})),dr.MAX_TRANSACTION_RETRIES_=25,dr.prototype.transactions_init_=function(){this.transactionQueueTree_=new wr},dr.prototype.startTransaction=function(t,e,n,r){this.log_("transaction on "+t);var i=function(){},o=new vr(this,t);o.on("value",i);var a=function(){o.off("value",i)},u={path:t,update:e,onComplete:n,status:null,order:m(),applyLocally:r,retryCount:0,unwatcher:a,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},c=this.getLatestState_(t);u.currentInputSnapshot=c;var h=u.update(c.val());if(void 0===h){if(u.unwatcher(),u.currentOutputSnapshotRaw=null,u.currentOutputSnapshotResolved=null,u.onComplete){var l=new ye(u.currentInputSnapshot,new vr(this,u.path),Ht);u.onComplete(null,!1,l)}}else{vt("transaction failed: Data returned ",h,u.path),u.status=br.RUN;var f=this.transactionQueueTree_.subTree(t),p=f.getValue()||[];p.push(u),f.setValue(p);var d=void 0;if("object"===typeof h&&null!==h&&s.contains(h,".priority"))d=s.safeGet(h,".priority"),s.assert(yt(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{var y=this.serverSyncTree_.calcCompleteEventCache(t)||ae.EMPTY_NODE;d=y.getPriority().val()}d=d;var g=this.generateServerValues(),v=he(h,d),b=Ie(v,g);u.currentOutputSnapshotRaw=v,u.currentOutputSnapshotResolved=b,u.currentWriteId=this.getNextWriteId_();var _=this.serverSyncTree_.applyUserOverwrite(t,b,u.currentWriteId,u.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,_),this.sendReadyTransactions_()}},dr.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||ae.EMPTY_NODE},dr.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);s.assert(n.length>0,"Sending zero length transaction queue");var r=n.every((function(t){return t.status===br.RUN}));r&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild((function(t){e.sendReadyTransactions_(t)}))},dr.prototype.sendTransactionQueue_=function(t,e){for(var n=this,r=e.map((function(t){return t.currentWriteId})),i=this.getLatestState_(t,r),o=i,a=i.hash(),u=0;u<e.length;u++){var c=e[u];s.assert(c.status===br.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=br.SENT,c.retryCount++;var h=G.relativePath(t,c.path);o=o.updateChild(h,c.currentOutputSnapshotRaw)}var l=o.val(!0),f=t;this.server_.put(f.toString(),l,(function(r){n.log_("transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=0;a<e.length;a++){if(e[a].status=br.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(e[a].currentWriteId)),e[a].onComplete){var s=e[a].currentOutputSnapshotResolved,u=new vr(n,e[a].path),c=new ye(s,u,Ht);o.push(e[a].onComplete.bind(null,null,!0,c))}e[a].unwatcher()}n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,i);for(a=0;a<o.length;a++)W(o[a])}else{if("datastale"===r)for(a=0;a<e.length;a++)e[a].status===br.SENT_NEEDS_ABORT?e[a].status=br.NEEDS_ABORT:e[a].status=br.RUN;else{C("transaction at "+f.toString()+" failed: "+r);for(a=0;a<e.length;a++)e[a].status=br.NEEDS_ABORT,e[a].abortReason=r}n.rerunTransactions_(t)}}),a)},dr.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),r=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(r,n),n},dr.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n=[],r=[],i=t.filter((function(t){return t.status===br.RUN})),o=i.map((function(t){return t.currentWriteId})),a=0;a<t.length;a++){var u=t[a],c=G.relativePath(e,u.path),h=!1,l=void 0;if(s.assert(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===br.NEEDS_ABORT)h=!0,l=u.abortReason,r=r.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,!0));else if(u.status===br.RUN)if(u.retryCount>=dr.MAX_TRANSACTION_RETRIES_)h=!0,l="maxretry",r=r.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,!0));else{var f=this.getLatestState_(u.path,o);u.currentInputSnapshot=f;var p=t[a].update(f.val());if(void 0!==p){vt("transaction failed: Data returned ",p,u.path);var d=he(p),m="object"===typeof p&&null!=p&&s.contains(p,".priority");m||(d=d.updatePriority(f.getPriority()));var y=u.currentWriteId,g=this.generateServerValues(),v=Ie(d,g);u.currentOutputSnapshotRaw=d,u.currentOutputSnapshotResolved=v,u.currentWriteId=this.getNextWriteId_(),o.splice(o.indexOf(y),1),r=r.concat(this.serverSyncTree_.applyUserOverwrite(u.path,v,u.currentWriteId,u.applyLocally)),r=r.concat(this.serverSyncTree_.ackUserWrite(y,!0))}else h=!0,l="nodata",r=r.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,r),r=[],h&&(t[a].status=br.COMPLETED,function(t){setTimeout(t,Math.floor(0))}(t[a].unwatcher),t[a].onComplete))if("nodata"===l){var b=new vr(this,t[a].path),_=t[a].currentInputSnapshot,w=new ye(_,b,Ht);n.push(t[a].onComplete.bind(null,null,!1,w))}else n.push(t[a].onComplete.bind(null,new Error(l),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(a=0;a<n.length;a++)W(n[a]);this.sendReadyTransactions_()}},dr.prototype.getAncestorTransactionNode_=function(t){var e,n=this.transactionQueueTree_;while(null!==(e=t.getFront())&&null===n.getValue())n=n.subTree(e),t=t.popFront();return n},dr.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort((function(t,e){return t.order-e.order})),e},dr.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild((function(t){n.aggregateTransactionQueuesForNode_(t,e)}))},dr.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==br.COMPLETED&&(n[r]=n[i],r++);n.length=r,t.setValue(n.length>0?n:null)}t.forEachChild((function(t){e.pruneCompletedTransactionsBelowNode_(t)}))},dr.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),r=this.transactionQueueTree_.subTree(t);return r.forEachAncestor((function(t){e.abortTransactionsOnNode_(t)})),this.abortTransactionsOnNode_(r),r.forEachDescendant((function(t){e.abortTransactionsOnNode_(t)})),n},dr.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],r=[],i=-1,o=0;o<e.length;o++)if(e[o].status===br.SENT_NEEDS_ABORT);else if(e[o].status===br.SENT)s.assert(i===o-1,"All SENT items should be at beginning of queue."),i=o,e[o].status=br.SENT_NEEDS_ABORT,e[o].abortReason="set";else if(s.assert(e[o].status===br.RUN,"Unexpected transaction status in abort"),e[o].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(e[o].currentWriteId,!0)),e[o].onComplete){var a=null;n.push(e[o].onComplete.bind(null,new Error("set"),!1,a))}-1===i?t.setValue(null):e.length=i+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),r);for(o=0;o<n.length;o++)W(n[o])}};
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Tr,Er="databaseURL",Sr="FIREBASE_DATABASE_EMULATOR_HOST",Cr=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return Tr||(Tr=new t),Tr},t.prototype.interrupt=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].interrupt()},t.prototype.resume=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].resume()},t.prototype.databaseFromApp=function(t,e){var n=e||t.options[Er];void 0===n&&S("Can't determine Firebase Database URL.  Be sure to include "+Er+" option when calling firebase.initializeApp().");var i=ut(n),o=i.repoInfo,a=void 0;"undefined"!==typeof r&&(a=Object({NODE_ENV:"production",BASE_URL:"/"})[Sr]),a&&(n="http://"+a+"?ns="+o.namespace,i=ut(n),o=i.repoInfo),At("Invalid Firebase Database URL",1,i),i.path.isEmpty()||S("Database URL must point to the root of a Firebase Database (not including a child path).");var s=this.createRepo(o,t);return s.database},t.prototype.deleteRepo=function(t){var e=s.safeGet(this.repos_,t.app.name);e&&s.safeGet(e,t.repoInfo_.toURLString())===t||S("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.repoInfo_.toURLString()]},t.prototype.createRepo=function(t,e){var n=s.safeGet(this.repos_,e.name);n||(n={},this.repos_[e.name]=n);var r=s.safeGet(n,t.toURLString());return r&&S("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new dr(t,this.useRestClient_,e),n[t.toURLString()]=r,r},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}(),Ir=function(){function t(t){this.repo_=t,t instanceof dr||S("Don't call new Database() directly - please use firebase.database()."),this.root_=new vr(t,G.Empty),this.INTERNAL=new Ar(this)}return Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),t.prototype.ref=function(t){return this.checkDeleted_("ref"),s.validateArgCount("database.ref",0,1,arguments.length),t instanceof vr?this.refFromURL(t.toString()):void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),s.validateArgCount(e,1,1,arguments.length);var n=ut(t);At(e,1,n);var r=n.repoInfo;return r.host!==this.repo_.repoInfo_.host&&S(e+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repo_&&S("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){s.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){s.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"}},t}(),Ar=function(){function t(t){this.database=t}return t.prototype.delete=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){return this.database.checkDeleted_("delete"),Cr.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]}))}))},t}(),Nr=function(){Vn.forceDisallow(),Rn.forceAllow()},kr=function(){Rn.forceDisallow()},Dr=function(){return Vn["isAvailable"]()},xr=function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},Or=function(t,e){t.repo.stats(e)},Rr=function(t,e){t.repo.statsIncrementCounter(e)},Mr=function(t){return t.repo.dataUpdateCount},Pr=function(t,e){return t.repo.interceptServerData_(e)},Lr=Object.freeze({__proto__:null,forceLongPolling:Nr,forceWebSockets:kr,isWebSocketsAvailable:Dr,setSecurityDebugCallback:xr,stats:Or,statsIncrementCounter:Rr,dataUpdateCount:Mr,interceptServerData:Pr}),Fr=lr;lr.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},lr.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var Ur=nr,qr=function(t){var e=lr.prototype.put;return lr.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){lr.prototype.put=e}},Vr=rt,Br=function(t){return t.queryIdentifier()},jr=function(t){Cr.getInstance().forceRestClient(t)},Wr=Object.freeze({__proto__:null,DataConnection:Fr,RealTimeConnection:Ur,hijackHash:qr,ConnectionTarget:Vr,queryIdentifier:Br,forceRestClient:jr}),Kr=Ir.ServerValue;function zr(e){Ln(e.SDK_VERSION);var n=e.INTERNAL.registerService("database",(function(t,e,n){return Cr.getInstance().databaseFromApp(t,n)}),{Reference:vr,Query:we,Database:Ir,DataSnapshot:ye,enableLogging:_,INTERNAL:Lr,ServerValue:Kr,TEST_ACCESS:Wr},null,!0);s.isNodeSdk()&&(t.exports=n)}zr(o),e.DataSnapshot=ye,e.Database=Ir,e.OnDisconnect=kt,e.Query=we,e.Reference=vr,e.ServerValue=Kr,e.enableLogging=_,e.registerDatabase=zr}).call(this,n("4362"))},"35e8":function(t,e,n){var r=n("d9f6"),i=n("aebd");t.exports=n("8e60")?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},3666:function(t,e,n){(function(e,n,r){t.exports=r(),t.exports["default"]=r()})(0,0,(function(){var t=JSON.parse('{"$":"dollar","%":"percent","&":"and","<":"less",">":"greater","|":"or","¢":"cent","£":"pound","¤":"currency","¥":"yen","©":"(c)","ª":"a","®":"(r)","º":"o","À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ý":"Y","Þ":"TH","ß":"ss","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","þ":"th","ÿ":"y","Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"C","ć":"c","Č":"C","č":"c","Ď":"D","ď":"d","Đ":"DJ","đ":"dj","Ē":"E","ē":"e","Ė":"E","ė":"e","Ę":"e","ę":"e","Ě":"E","ě":"e","Ğ":"G","ğ":"g","Ģ":"G","ģ":"g","Ĩ":"I","ĩ":"i","Ī":"i","ī":"i","Į":"I","į":"i","İ":"I","ı":"i","Ķ":"k","ķ":"k","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ł":"L","ł":"l","Ń":"N","ń":"n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","Ő":"O","ő":"o","Œ":"OE","œ":"oe","Ŕ":"R","ŕ":"r","Ř":"R","ř":"r","Ś":"S","ś":"s","Ş":"S","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","Ť":"T","ť":"t","Ũ":"U","ũ":"u","Ū":"u","ū":"u","Ů":"U","ů":"u","Ű":"U","ű":"u","Ų":"U","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","ź":"z","Ż":"Z","ż":"z","Ž":"Z","ž":"z","ƒ":"f","Ơ":"O","ơ":"o","Ư":"U","ư":"u","ǈ":"LJ","ǉ":"lj","ǋ":"NJ","ǌ":"nj","Ș":"S","ș":"s","Ț":"T","ț":"t","˚":"o","Ά":"A","Έ":"E","Ή":"H","Ί":"I","Ό":"O","Ύ":"Y","Ώ":"W","ΐ":"i","Α":"A","Β":"B","Γ":"G","Δ":"D","Ε":"E","Ζ":"Z","Η":"H","Θ":"8","Ι":"I","Κ":"K","Λ":"L","Μ":"M","Ν":"N","Ξ":"3","Ο":"O","Π":"P","Ρ":"R","Σ":"S","Τ":"T","Υ":"Y","Φ":"F","Χ":"X","Ψ":"PS","Ω":"W","Ϊ":"I","Ϋ":"Y","ά":"a","έ":"e","ή":"h","ί":"i","ΰ":"y","α":"a","β":"b","γ":"g","δ":"d","ε":"e","ζ":"z","η":"h","θ":"8","ι":"i","κ":"k","λ":"l","μ":"m","ν":"n","ξ":"3","ο":"o","π":"p","ρ":"r","ς":"s","σ":"s","τ":"t","υ":"y","φ":"f","χ":"x","ψ":"ps","ω":"w","ϊ":"i","ϋ":"y","ό":"o","ύ":"y","ώ":"w","Ё":"Yo","Ђ":"DJ","Є":"Ye","І":"I","Ї":"Yi","Ј":"J","Љ":"LJ","Њ":"NJ","Ћ":"C","Џ":"DZ","А":"A","Б":"B","В":"V","Г":"G","Д":"D","Е":"E","Ж":"Zh","З":"Z","И":"I","Й":"J","К":"K","Л":"L","М":"M","Н":"N","О":"O","П":"P","Р":"R","С":"S","Т":"T","У":"U","Ф":"F","Х":"H","Ц":"C","Ч":"Ch","Ш":"Sh","Щ":"Sh","Ъ":"U","Ы":"Y","Ь":"","Э":"E","Ю":"Yu","Я":"Ya","а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ж":"zh","з":"z","и":"i","й":"j","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"h","ц":"c","ч":"ch","ш":"sh","щ":"sh","ъ":"u","ы":"y","ь":"","э":"e","ю":"yu","я":"ya","ё":"yo","ђ":"dj","є":"ye","і":"i","ї":"yi","ј":"j","љ":"lj","њ":"nj","ћ":"c","ѝ":"u","џ":"dz","Ґ":"G","ґ":"g","Ғ":"GH","ғ":"gh","Қ":"KH","қ":"kh","Ң":"NG","ң":"ng","Ү":"UE","ү":"ue","Ұ":"U","ұ":"u","Һ":"H","һ":"h","Ә":"AE","ә":"ae","Ө":"OE","ө":"oe","฿":"baht","ა":"a","ბ":"b","გ":"g","დ":"d","ე":"e","ვ":"v","ზ":"z","თ":"t","ი":"i","კ":"k","ლ":"l","მ":"m","ნ":"n","ო":"o","პ":"p","ჟ":"zh","რ":"r","ს":"s","ტ":"t","უ":"u","ფ":"f","ქ":"k","ღ":"gh","ყ":"q","შ":"sh","ჩ":"ch","ც":"ts","ძ":"dz","წ":"ts","ჭ":"ch","ხ":"kh","ჯ":"j","ჰ":"h","Ẁ":"W","ẁ":"w","Ẃ":"W","ẃ":"w","Ẅ":"W","ẅ":"w","ẞ":"SS","Ạ":"A","ạ":"a","Ả":"A","ả":"a","Ấ":"A","ấ":"a","Ầ":"A","ầ":"a","Ẩ":"A","ẩ":"a","Ẫ":"A","ẫ":"a","Ậ":"A","ậ":"a","Ắ":"A","ắ":"a","Ằ":"A","ằ":"a","Ẳ":"A","ẳ":"a","Ẵ":"A","ẵ":"a","Ặ":"A","ặ":"a","Ẹ":"E","ẹ":"e","Ẻ":"E","ẻ":"e","Ẽ":"E","ẽ":"e","Ế":"E","ế":"e","Ề":"E","ề":"e","Ể":"E","ể":"e","Ễ":"E","ễ":"e","Ệ":"E","ệ":"e","Ỉ":"I","ỉ":"i","Ị":"I","ị":"i","Ọ":"O","ọ":"o","Ỏ":"O","ỏ":"o","Ố":"O","ố":"o","Ồ":"O","ồ":"o","Ổ":"O","ổ":"o","Ỗ":"O","ỗ":"o","Ộ":"O","ộ":"o","Ớ":"O","ớ":"o","Ờ":"O","ờ":"o","Ở":"O","ở":"o","Ỡ":"O","ỡ":"o","Ợ":"O","ợ":"o","Ụ":"U","ụ":"u","Ủ":"U","ủ":"u","Ứ":"U","ứ":"u","Ừ":"U","ừ":"u","Ử":"U","ử":"u","Ữ":"U","ữ":"u","Ự":"U","ự":"u","Ỳ":"Y","ỳ":"y","Ỵ":"Y","ỵ":"y","Ỷ":"Y","ỷ":"y","Ỹ":"Y","ỹ":"y","‘":"\'","’":"\'","“":"\\"","”":"\\"","†":"+","•":"*","…":"...","₠":"ecu","₢":"cruzeiro","₣":"french franc","₤":"lira","₥":"mill","₦":"naira","₧":"peseta","₨":"rupee","₩":"won","₪":"new shequel","₫":"dong","€":"euro","₭":"kip","₮":"tugrik","₯":"drachma","₰":"penny","₱":"peso","₲":"guarani","₳":"austral","₴":"hryvnia","₵":"cedi","₸":"kazakhstani tenge","₹":"indian rupee","₽":"russian ruble","₿":"bitcoin","℠":"sm","™":"tm","∂":"d","∆":"delta","∑":"sum","∞":"infinity","♥":"love","元":"yuan","円":"yen","﷼":"rial"}'),e=JSON.parse('{"vi":{"Đ":"D","đ":"d"}}');function n(n,r){if("string"!==typeof n)throw new Error("slugify: string argument expected");r="string"===typeof r?{replacement:r}:r||{};var i=e[r.locale]||{},o=n.split("").reduce((function(e,n){return e+(i[n]||t[n]||n).replace(r.remove||/[^\w\s$*_+~.()'"!\-:@]/g,"")}),"").trim().replace(/[-\s]+/g,r.replacement||"-");return r.lower?o.toLowerCase():o}return n.extend=function(e){for(var n in e)t[n]=e[n]},n}))},"36c3":function(t,e,n){var r=n("335c"),i=n("25eb");t.exports=function(t){return r(i(t))}},3702:function(t,e,n){var r=n("481b"),i=n("5168")("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},"387f":function(t,e,n){"use strict";t.exports=function(t,e,n,r,i){return t.config=e,n&&(t.code=n),t.request=r,t.response=i,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},"38fd":function(t,e,n){var r=n("69a8"),i=n("4bf8"),o=n("613b")("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},3934:function(t,e,n){"use strict";var r=n("c532");t.exports=r.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(t){var r=t;return e&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=i(window.location.href),function(e){var n=r.isString(e)?i(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return function(){return!0}}()},"3a38":function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},"3b59":function(t,e,n){"use strict";function r(t){return t&&"object"===typeof t&&"default"in t?t["default"]:t}Object.defineProperty(e,"__esModule",{value:!0});var i=r(n("c23d"));n("7d28");var o,a=n("9ab4"),s=n("cd51"),u=n("abfd"),c=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o;return a.__generator(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=a.sent(),n=e[0],r=e[1],r&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=a.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return a.sent(),[2,i]}}))}))},t}(),h=(o={},o["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",o["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",o["registration-api-key"]="Undefined API key. Check Firebase app initialization.",o["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",o["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",o["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",o["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",o["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",o["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",o["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',o["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',o["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",o["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",o),l=new s.ErrorFactory("remoteconfig","Remote Config",h);function f(t,e){return t instanceof s.FirebaseError&&-1!==t.code.indexOf(e)}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p(t){return void 0===t&&(t=navigator),t.languages&&t.languages[0]||t.language}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var d=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o,s,u,c,h,f,d,m,y,g,v,b,_,w,T;return a.__generator(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=a.sent(),n=e[0],r=e[1],i=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=i+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,s={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},u={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:p()},c={method:"POST",headers:s,body:JSON.stringify(u)},h=fetch(o,c),f=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)}))})),a.label=2;case 2:return a.trys.push([2,5,,6]),[4,Promise.race([h,f])];case 3:return a.sent(),[4,h];case 4:return d=a.sent(),[3,6];case 5:throw m=a.sent(),y="fetch-client-network","AbortError"===m.name&&(y="fetch-timeout"),l.create(y,{originalErrorMessage:m.message});case 6:if(g=d.status,v=d.headers.get("ETag")||void 0,200!==d.status)return[3,11];w=void 0,a.label=7;case 7:return a.trys.push([7,9,,10]),[4,d.json()];case 8:return w=a.sent(),[3,10];case 9:throw T=a.sent(),l.create("fetch-client-parse",{originalErrorMessage:T.message});case 10:b=w["entries"],_=w["state"],a.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===_?g=500:"NO_CHANGE"===_?g=304:"NO_TEMPLATE"!==_&&"EMPTY_CONFIG"!==_||(b={}),304!==g&&200!==g)throw l.create("fetch-status",{httpStatus:g});return[2,{status:g,eTag:v,config:b}]}}))}))},t}(),m=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),y=!1,g="",v=0,b=["1","true","t","yes","y","on"],_=function(){function t(t,e){void 0===e&&(e=g),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"===this._source?y:b.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return v;var t=Number(this._value);return isNaN(t)&&(t=v),t},t.prototype.getSource=function(){return this._source},t}(),w=6e4,T=432e5,E=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:w,minimumFetchIntervalMillis:T},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=u.LogLevel.DEBUG;break;case"silent":this._logger.logLevel=u.LogLevel.SILENT;break;default:this._logger.logLevel=u.LogLevel.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!0,configurable:!0}),t.prototype.activate=function(){return a.__awaiter(this,void 0,void 0,(function(){var t,e,n;return a.__generator(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=r.sent(),e=t[0],n=t[1],e&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}}))}))},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),this._initializePromise},t.prototype.fetch=function(){return a.__awaiter(this,void 0,void 0,(function(){var t=this;return a.__generator(this,(function(e){return[2,new Promise((function(e,n){return a.__awaiter(t,void 0,void 0,(function(){var t,r,i,o=this;return a.__generator(this,(function(s){switch(s.label){case 0:t=new m,setTimeout((function(){return a.__awaiter(o,void 0,void 0,(function(){return a.__generator(this,(function(e){return t.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),s.label=1;case 1:return s.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return s.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return s.sent(),e(),[3,6];case 4:return r=s.sent(),i=f(r,"fetch-throttle")?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(i)];case 5:return s.sent(),n(r),[3,6];case 6:return[2]}}))}))}))]}))}))},t.prototype.fetchAndActivate=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}}))}))},t.prototype.getAll=function(){var t=this;return S(this._storageCache.getActiveConfig(),this.defaultConfig).reduce((function(e,n){return e[n]=t.getValue(n),e}),{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new _("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new _("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new _("static"))},t}();
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S(t,e){return void 0===t&&(t={}),void 0===e&&(e={}),Object.keys(a.__assign(a.__assign({},t),e))}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C(t,e){var n=t.target.error||void 0;return l.create(e,{originalErrorMessage:n&&n.message})}var I="app_namespace_store",A="firebase_remote_config",N=1;function k(){return new Promise((function(t,e){var n=indexedDB.open(A,N);n.onerror=function(t){e(C(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(I,{keyPath:"compositeKey"})}}}))}var D=function(){function t(t,e,n,r){void 0===r&&(r=k()),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n=this;return a.__generator(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([I],"readonly"),a=o.objectStore(I),s=n.createCompositeKey(t);try{var u=a.get(s);u.onerror=function(t){i(C(t,"storage-get"))},u.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(c){i(l.create("storage-get",{originalErrorMessage:c&&c.message}))}}))]}}))}))},t.prototype.set=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){var n,r=this;return a.__generator(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise((function(i,o){var a=n.transaction([I],"readwrite"),s=a.objectStore(I),u=r.createCompositeKey(t);try{var c=s.put({compositeKey:u,value:e});c.onerror=function(t){o(C(t,"storage-set"))},c.onsuccess=function(){i()}}catch(h){o(l.create("storage-set",{originalErrorMessage:h&&h.message}))}}))]}}))}))},t.prototype.delete=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n=this;return a.__generator(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([I],"readwrite"),a=o.objectStore(I),s=n.createCompositeKey(t);try{var u=a.delete(s);u.onerror=function(t){i(C(t,"storage-delete"))},u.onsuccess=function(){r()}}catch(c){i(l.create("storage-delete",{originalErrorMessage:c&&c.message}))}}))]}}))}))},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),x=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return a.__awaiter(this,void 0,void 0,(function(){var t,e,n,r,i,o;return a.__generator(this,(function(a){switch(a.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return r=a.sent(),r&&(this.lastFetchStatus=r),[4,e];case 2:return i=a.sent(),i&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return o=a.sent(),o&&(this.activeConfig=o),[2]}}))}))},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}(),O=1e3,R=2,M=144e5,P=.5;
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L(t){var e=O*Math.pow(R,t),n=Math.round(P*e*(Math.random()-.5)*2);return Math.min(M,e+n)}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(l.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}function U(t){if(!(t instanceof s.FirebaseError))return!1;var e=Number(t["httpStatus"]);return 429===e||500===e||503===e||504===e}var q=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e;return a.__generator(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}}))}))},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return a.__awaiter(this,void 0,void 0,(function(){var e,i,o;return a.__generator(this,(function(a){switch(a.label){case 0:return[4,F(t.signal,n)];case 1:a.sent(),a.label=2;case 2:return a.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=a.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return a.sent(),[2,e];case 5:if(i=a.sent(),!U(i))throw i;return o={throttleEndTimeMillis:Date.now()+L(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(o)];case 6:return a.sent(),[2,this.attemptFetch(t,o)];case 7:return[2]}}))}))},t}(),V="@firebase/remote-config";
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function B(t){t.INTERNAL.registerService("remoteConfig",(function(e,n,r){if("undefined"===typeof window)throw l.create("registration-window");var i=e.options,o=i.projectId,a=i.apiKey,s=i.appId;if(!o)throw l.create("registration-project-id");if(!a)throw l.create("registration-api-key");if(!s)throw l.create("registration-app-id");r=r||"firebase";var h=new D(s,e.name,r),f=new x(h),p=new u.Logger(V);p.logLevel=u.LogLevel.ERROR;var m=new d(e.installations(),t.SDK_VERSION,r,o,a,s),y=new q(m,h),g=new c(y,h,f,p),v=new E(e,g,f,h,p);return v.ensureInitialized(),v}),void 0,void 0,!0)}B(i),e.registerRemoteConfig=B},"40c3":function(t,e,n){var r=n("6b4c"),i=n("5168")("toStringTag"),o="Arguments"==r(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(n){}};t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=a(e=Object(t),i))?n:o?r(e):"Object"==(s=r(e))&&"function"==typeof e.callee?"Arguments":s}},"41a0":function(t,e,n){"use strict";var r=n("2aeb"),i=n("4630"),o=n("7f20"),a={};n("32e9")(a,n("2b4c")("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=r(a,{next:i(1,n)}),o(t,e+" Iterator")}},4362:function(t,e,n){e.nextTick=function(t){var e=Array.prototype.slice.call(arguments);e.shift(),setTimeout((function(){t.apply(null,e)}),0)},e.platform=e.arch=e.execPath=e.title="browser",e.pid=1,e.browser=!0,e.env={},e.argv=[],e.binding=function(t){throw new Error("No such module. (Possibly not yet loaded)")},function(){var t,r="/";e.cwd=function(){return r},e.chdir=function(e){t||(t=n("df7c")),r=t.resolve(e,r)}}(),e.exit=e.kill=e.umask=e.dlopen=e.uptime=e.memoryUsage=e.uvCounters=function(){},e.features={}},4588:function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},"45f2":function(t,e,n){var r=n("d9f6").f,i=n("07e3"),o=n("5168")("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},4630:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"467f":function(t,e,n){"use strict";var r=n("2d83");t.exports=function(t,e,n){var i=n.config.validateStatus;!i||i(n.status)?t(n):e(r("Request failed with status code "+n.status,n.config,null,n.request,n))}},"481b":function(t,e){t.exports={}},"4a59":function(t,e,n){var r=n("9b43"),i=n("1fa8"),o=n("33a4"),a=n("cb7c"),s=n("9def"),u=n("27ee"),c={},h={};e=t.exports=function(t,e,n,l,f){var p,d,m,y,g=f?function(){return t}:u(t),v=r(n,l,e?2:1),b=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(p=s(t.length);p>b;b++)if(y=e?v(a(d=t[b])[0],d[1]):v(t[b]),y===c||y===h)return y}else for(m=g.call(t);!(d=m.next()).done;)if(y=i(m,v,d.value,e),y===c||y===h)return y};e.BREAK=c,e.RETURN=h},"4a7b":function(t,e,n){"use strict";var r=n("c532");t.exports=function(t,e){e=e||{};var n={};return r.forEach(["url","method","params","data"],(function(t){"undefined"!==typeof e[t]&&(n[t]=e[t])})),r.forEach(["headers","auth","proxy"],(function(i){r.isObject(e[i])?n[i]=r.deepMerge(t[i],e[i]):"undefined"!==typeof e[i]?n[i]=e[i]:r.isObject(t[i])?n[i]=r.deepMerge(t[i]):"undefined"!==typeof t[i]&&(n[i]=t[i])})),r.forEach(["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],(function(r){"undefined"!==typeof e[r]?n[r]=e[r]:"undefined"!==typeof t[r]&&(n[r]=t[r])})),n}},"4bf8":function(t,e,n){var r=n("be13");t.exports=function(t){return Object(r(t))}},"4ee1":function(t,e,n){var r=n("5168")("iterator"),i=!1;try{var o=[7][r]();o["return"]=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(a){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],s=o[r]();s.next=function(){return{done:n=!0}},o[r]=function(){return s},t(o)}catch(a){}return n}},"50ed":function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},5168:function(t,e,n){var r=n("dbdb")("wks"),i=n("62a0"),o=n("e53d").Symbol,a="function"==typeof o,s=t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))};s.store=r},5270:function(t,e,n){"use strict";var r=n("c532"),i=n("c401"),o=n("2e67"),a=n("2444"),s=n("d925"),u=n("e683");function c(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){c(t),t.baseURL&&!s(t.url)&&(t.url=u(t.baseURL,t.url)),t.headers=t.headers||{},t.data=i(t.data,t.headers,t.transformRequest),t.headers=r.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]}));var e=t.adapter||a.adapter;return e(t).then((function(e){return c(t),e.data=i(e.data,e.headers,t.transformResponse),e}),(function(e){return o(e)||(c(t),e&&e.response&&(e.response.data=i(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},"52a7":function(t,e){e.f={}.propertyIsEnumerable},"53e2":function(t,e,n){var r=n("07e3"),i=n("241e"),o=n("5559")("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},"549b":function(t,e,n){"use strict";var r=n("d864"),i=n("63b6"),o=n("241e"),a=n("b0dc"),s=n("3702"),u=n("b447"),c=n("20fd"),h=n("7cd6");i(i.S+i.F*!n("4ee1")((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,i,l,f=o(t),p="function"==typeof this?this:Array,d=arguments.length,m=d>1?arguments[1]:void 0,y=void 0!==m,g=0,v=h(f);if(y&&(m=r(m,d>2?arguments[2]:void 0,2)),void 0==v||p==Array&&s(v))for(e=u(f.length),n=new p(e);e>g;g++)c(n,g,y?m(f[g],g):f[g]);else for(l=v.call(f),n=new p;!(i=l.next()).done;g++)c(n,g,y?a(l,m,[i.value,g],!0):i.value);return n.length=g,n}})},"54a1":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("95d5")},"551c":function(t,e,n){"use strict";var r,i,o,a,s=n("2d00"),u=n("7726"),c=n("9b43"),h=n("23c6"),l=n("5ca1"),f=n("d3f4"),p=n("d8e8"),d=n("f605"),m=n("4a59"),y=n("ebd6"),g=n("1991").set,v=n("8079")(),b=n("a5b8"),_=n("9c80"),w=n("a25f"),T=n("bcaa"),E="Promise",S=u.TypeError,C=u.process,I=C&&C.versions,A=I&&I.v8||"",N=u[E],k="process"==h(C),D=function(){},x=i=b.f,O=!!function(){try{var t=N.resolve(1),e=(t.constructor={})[n("2b4c")("species")]=function(t){t(D,D)};return(k||"function"==typeof PromiseRejectionEvent)&&t.then(D)instanceof e&&0!==A.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(r){}}(),R=function(t){var e;return!(!f(t)||"function"!=typeof(e=t.then))&&e},M=function(t,e){if(!t._n){t._n=!0;var n=t._c;v((function(){var r=t._v,i=1==t._s,o=0,a=function(e){var n,o,a,s=i?e.ok:e.fail,u=e.resolve,c=e.reject,h=e.domain;try{s?(i||(2==t._h&&F(t),t._h=1),!0===s?n=r:(h&&h.enter(),n=s(r),h&&(h.exit(),a=!0)),n===e.promise?c(S("Promise-chain cycle")):(o=R(n))?o.call(n,u,c):u(n)):c(r)}catch(l){h&&!a&&h.exit(),c(l)}};while(n.length>o)a(n[o++]);t._c=[],t._n=!1,e&&!t._h&&P(t)}))}},P=function(t){g.call(u,(function(){var e,n,r,i=t._v,o=L(t);if(o&&(e=_((function(){k?C.emit("unhandledRejection",i,t):(n=u.onunhandledrejection)?n({promise:t,reason:i}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",i)})),t._h=k||L(t)?2:1),t._a=void 0,o&&e.e)throw e.v}))},L=function(t){return 1!==t._h&&0===(t._a||t._c).length},F=function(t){g.call(u,(function(){var e;k?C.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})}))},U=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),M(e,!0))},q=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw S("Promise can't be resolved itself");(e=R(t))?v((function(){var r={_w:n,_d:!1};try{e.call(t,c(q,r,1),c(U,r,1))}catch(i){U.call(r,i)}})):(n._v=t,n._s=1,M(n,!1))}catch(r){U.call({_w:n,_d:!1},r)}}};O||(N=function(t){d(this,N,E,"_h"),p(t),r.call(this);try{t(c(q,this,1),c(U,this,1))}catch(e){U.call(this,e)}},r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=n("dcbc")(N.prototype,{then:function(t,e){var n=x(y(this,N));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=k?C.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&M(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new r;this.promise=t,this.resolve=c(q,t,1),this.reject=c(U,t,1)},b.f=x=function(t){return t===N||t===a?new o(t):i(t)}),l(l.G+l.W+l.F*!O,{Promise:N}),n("7f20")(N,E),n("7a56")(E),a=n("8378")[E],l(l.S+l.F*!O,E,{reject:function(t){var e=x(this),n=e.reject;return n(t),e.promise}}),l(l.S+l.F*(s||!O),E,{resolve:function(t){return T(s&&this===a?N:this,t)}}),l(l.S+l.F*!(O&&n("5cc5")((function(t){N.all(t)["catch"](D)}))),E,{all:function(t){var e=this,n=x(e),r=n.resolve,i=n.reject,o=_((function(){var n=[],o=0,a=1;m(t,!1,(function(t){var s=o++,u=!1;n.push(void 0),a++,e.resolve(t).then((function(t){u||(u=!0,n[s]=t,--a||r(n))}),i)})),--a||r(n)}));return o.e&&i(o.v),n.promise},race:function(t){var e=this,n=x(e),r=n.reject,i=_((function(){m(t,!1,(function(t){e.resolve(t).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},5537:function(t,e,n){var r=n("8378"),i=n("7726"),o="__core-js_shared__",a=i[o]||(i[o]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n("2d00")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},5559:function(t,e,n){var r=n("dbdb")("keys"),i=n("62a0");t.exports=function(t){return r[t]||(r[t]=i(t))}},"584a":function(t,e){var n=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=n)},"59ca":function(t,e,n){"use strict";function r(t){return t&&"object"===typeof t&&"default"in t?t["default"]:t}var i=r(n("c23d"));
/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */t.exports=i},"5b4e":function(t,e,n){var r=n("36c3"),i=n("b447"),o=n("0fc9");t.exports=function(t){return function(e,n,a){var s,u=r(e),c=i(u.length),h=o(a,c);if(t&&n!=n){while(c>h)if(s=u[h++],s!=s)return!0}else for(;c>h;h++)if((t||h in u)&&u[h]===n)return t||h||0;return!t&&-1}}},"5ca1":function(t,e,n){var r=n("7726"),i=n("8378"),o=n("32e9"),a=n("2aba"),s=n("9b43"),u="prototype",c=function(t,e,n){var h,l,f,p,d=t&c.F,m=t&c.G,y=t&c.S,g=t&c.P,v=t&c.B,b=m?r:y?r[e]||(r[e]={}):(r[e]||{})[u],_=m?i:i[e]||(i[e]={}),w=_[u]||(_[u]={});for(h in m&&(n=e),n)l=!d&&b&&void 0!==b[h],f=(l?b:n)[h],p=v&&l?s(f,r):g&&"function"==typeof f?s(Function.call,f):f,b&&a(b,h,f,t&c.U),_[h]!=f&&o(_,h,p),g&&w[h]!=f&&(w[h]=f)};r.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},"5cc5":function(t,e,n){var r=n("2b4c")("iterator"),i=!1;try{var o=[7][r]();o["return"]=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(a){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],s=o[r]();s.next=function(){return{done:n=!0}},o[r]=function(){return s},t(o)}catch(a){}return n}},"5dbc":function(t,e,n){var r=n("d3f4"),i=n("8b97").set;t.exports=function(t,e,n){var o,a=e.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(t,o),t}},"5df3":function(t,e,n){"use strict";var r=n("02f4")(!0);n("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})}))},"613b":function(t,e,n){var r=n("5537")("keys"),i=n("ca5a");t.exports=function(t){return r[t]||(r[t]=i(t))}},"626a":function(t,e,n){var r=n("2d95");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},"62a0":function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},"63b6":function(t,e,n){var r=n("e53d"),i=n("584a"),o=n("d864"),a=n("35e8"),s=n("07e3"),u="prototype",c=function(t,e,n){var h,l,f,p=t&c.F,d=t&c.G,m=t&c.S,y=t&c.P,g=t&c.B,v=t&c.W,b=d?i:i[e]||(i[e]={}),_=b[u],w=d?r:m?r[e]:(r[e]||{})[u];for(h in d&&(n=e),n)l=!p&&w&&void 0!==w[h],l&&s(b,h)||(f=l?w[h]:n[h],b[h]=d&&"function"!=typeof w[h]?n[h]:g&&l?o(f,r):v&&w[h]==f?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e[u]=t[u],e}(f):y&&"function"==typeof f?o(Function.call,f):f,y&&((b.virtual||(b.virtual={}))[h]=f,t&c.R&&_&&!_[h]&&a(_,h,f)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},6821:function(t,e,n){var r=n("626a"),i=n("be13");t.exports=function(t){return r(i(t))}},"69a8":function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},"6a99":function(t,e,n){var r=n("d3f4");t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},"6b4c":function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},"6c1c":function(t,e,n){n("c367");for(var r=n("e53d"),i=n("35e8"),o=n("481b"),a=n("5168")("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var c=s[u],h=r[c],l=h&&h.prototype;l&&!l[a]&&i(l,a,c),o[c]=o.Array}},"6d09":function(t,e,n){"use strict";function r(t){return t&&"object"===typeof t&&"default"in t?t["default"]:t}Object.defineProperty(e,"__esModule",{value:!0});var i=r(n("c23d")),o=n("9ab4"),a=n("cd51");n("7d28");var s,u,c,h,l=n("abfd"),f="0.2.25",p=f,d="FB-PERF-TRACE-START",m="FB-PERF-TRACE-STOP",y="FB-PERF-TRACE-MEASURE",g="_wt_",v="_fp",b="_fcp",_="_fid",w="@firebase/performance/config",T="@firebase/performance/configexpire",E="performance",S="Performance",C=(s={},s["trace started"]="Trace {$traceName} was started before.",s["trace stopped"]="Trace {$traceName} is not running.",s["no window"]="Window is not available.",s["no app id"]="App id is not available.",s["no project id"]="Project id is not available.",s["no api key"]="Api key is not available.",s["invalid cc log"]="Attempted to queue invalid cc event",s["FB not default"]="Performance can only start when Firebase app instance is the default one.",s["RC response not ok"]="RC response is not ok",s["invalid attribute name"]="Attribute name {$attributeName} is invalid.",s["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",s["invalide custom metric name"]="Custom metric name {$customMetricName} is invalid",s),I=new a.ErrorFactory(E,S,C),A=function(){function t(t){if(!t)throw I.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return!!(fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled)},t.prototype.setupObserver=function(t,e){if(this.PerformanceObserver){var n=new this.PerformanceObserver((function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];e(i)}}));n.observe({entryTypes:[t]})}},t.getInstance=function(){return void 0===u&&(u=new t(c)),u},t}();function N(t){c=t}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var k,D,x=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw I.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw I.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw I.create("no api key");return t},t.getInstance=function(){return void 0===h&&(h=new t),h},t}();
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O(){var t=x.getInstance().firebaseAppInstance.installations().getId();return t.then((function(t){k=t})),t}function R(){return k}function M(){var t=x.getInstance().firebaseAppInstance.installations().getToken();return t.then((function(t){})),t}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(t){t[t["UNKNOWN"]=0]="UNKNOWN",t[t["VISIBLE"]=1]="VISIBLE",t[t["HIDDEN"]=2]="HIDDEN",t[t["PRERENDER"]=3]="PRERENDER",t[t["UNLOADED"]=4]="UNLOADED"})(D||(D={}));var P=["firebase_","google_","ga_"],L=new RegExp("^[a-zA-Z]\\w*$"),F=40,U=100;function q(){var t=A.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function V(){var t=A.getInstance().document,e=t.visibilityState;switch(e){case"visible":return D.VISIBLE;case"hidden":return D.HIDDEN;case"prerender":return D.PRERENDER;default:return D.UNKNOWN}}function B(){var t=A.getInstance().navigator,e=t.connection,n=e&&e.effectiveType;switch(n){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function j(t){if(0===t.length||t.length>F)return!1;var e=P.some((function(e){return t.startsWith(e)}));return!e&&!!t.match(L)}function W(t){return 0!==t.length&&t.length<=U}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var K=new l.Logger(S);K.logLevel=l.LogLevel.INFO;
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var z="0.0.1",G={loggingEnabled:!0},Q="FIREBASE_INSTALLATIONS_AUTH";function H(t){var e=Y();return e?(Z(e),Promise.resolve()):J(t).then((function(t){return Z(t)})).then((function(t){return $(t)}),(function(){}))}function Y(){var t=A.getInstance().localStorage,e=t.getItem(T);if(e&&tt(e)){var n=t.getItem(w);if(n)try{var r=JSON.parse(n);return r}catch(s){return}}}function $(t){if(t){var e=A.getInstance().localStorage;e.setItem(w,JSON.stringify(t)),e.setItem(T,String(Date.now()+60*x.getInstance().configTimeToLive*60*1e3))}}var X="Could not fetch config, will use default configs";function J(t){return M().then((function(e){var n=x.getInstance().getProjectId(),r="https://firebaseremoteconfig.googleapis.com/v1/projects/"+n+"/namespaces/fireperf:fetch?key="+x.getInstance().getApiKey(),i=new Request(r,{method:"POST",headers:{Authorization:Q+" "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:x.getInstance().getAppId(),app_version:p,sdk_version:z})});return fetch(i).then((function(t){if(t.ok)return t.json();throw I.create("RC response not ok")}))})).catch((function(){K.info(X)}))}function Z(t){if(!t)return t;var e=x.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=G.loggingEnabled,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=et(e.tracesSamplingRate),e.logNetworkAfterSampling=et(e.networkRequestsSamplingRate),t}function tt(t){return Number(t)>Date.now()}function et(t){return Math.random()<=t}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nt,rt=1;function it(){return rt=2,nt=nt||at(),nt}function ot(){return 3===rt}function at(){return st().then((function(){return O()})).then((function(t){return H(t)})).then((function(){return ut()}),(function(){return ut()}))}function st(){var t=A.getInstance().document;return new Promise((function(e){if(t&&"complete"!==t.readyState){var n=function(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()}))}function ut(){rt=3}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ct,ht=1e4,lt=5500,ft=3,pt=ft,dt=[];function mt(t){setTimeout((function(){if(0!==pt){if(!dt.length)return mt(ht);var t=o.__spreadArrays(dt);dt=[];var e=t.map((function(t){return{source_extension_json:t.message,event_time_ms:String(t.eventTime)}})),n={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:x.getInstance().logSource,log_event:e};fetch(x.getInstance().logEndPointUrl,{method:"POST",body:JSON.stringify(n)}).then((function(t){return t.ok||K.info("Call to Firebase backend failed."),t.json()})).then((function(t){var e=Number(t.next_request_wait_millis),n=isNaN(e)?ht:Math.max(ht,e);pt=ft,mt(n)})).catch((function(){dt=o.__spreadArrays(t,dt),pt--,K.info("Tries left: "+pt+"."),mt(ht)}))}}),t)}function yt(t){if(!t.eventTime||!t.message)throw I.create("invalid cc log");dt=o.__spreadArrays(dt,[t])}function gt(t){return function(e,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=t.apply(void 0,r);yt({message:o,eventTime:Date.now()})}}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(){if(ct)return ct;var t=gt(Tt);return ct=new l.Logger("@firebase/performance/cc"),ct.logHandler=t,ct}function bt(t){var e=x.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&A.getInstance().requiredApisAvailable()&&(t.isAuto&&V()!==D.VISIBLE||e.loggingEnabled&&e.logTraceAfterSampling&&(ot()?_t(t):it().then((function(){return _t(t)}),(function(){return _t(t)}))))}function _t(t){R()&&setTimeout((function(){return vt().log(t,1)}),0)}function wt(t){var e=x.getInstance();e.instrumentationEnabled&&t.url!==e.logEndPointUrl.split("?")[0]&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((function(){return vt().log(t,0)}),0)}function Tt(t,e){return 0===e?Et(t):St(t)}function Et(t){var e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},n={application_info:Ct(),network_request_metric:e};return JSON.stringify(n)}function St(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=It(t.counters));var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=It(n));var r={application_info:Ct(),trace_metric:e};return JSON.stringify(r)}function Ct(){return{google_app_id:x.getInstance().getAppId(),app_instance_id:R(),web_app_info:{sdk_version:p,page_url:A.getInstance().getUrl(),service_worker_status:q(),visibility_state:V(),effective_connection_type:B()},application_process_state:0}}function It(t){var e=Object.keys(t);return e.map((function(e){return{key:e,value:t[e]}}))}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mt(lt);var At=100,Nt="_",kt=[v,b,_];function Dt(t,e){return!(0===t.length||t.length>At)&&(e&&e.startsWith(g)&&kt.indexOf(t)>-1||!t.startsWith(Nt))}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xt=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=A.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=d+"-"+this.randomId+"-"+this.name,this.traceStopMark=m+"-"+this.randomId+"-"+this.name,this.traceMeasure=n||y+"-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw I.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw I.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),bt(this)},t.prototype.record=function(t,e,n){if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=o.__assign({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var a=i[r];isNaN(Number(n.metrics[a]))||(this.counters[a]=Number(Math.floor(n.metrics[a])))}bt(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]&&this.putMetric(t,0),this.counters[t]+=e},t.prototype.putMetric=function(t,e){if(!Dt(t,this.name))throw I.create("invalide custom metric name",{customMetricName:t});this.counters[t]=e},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n=j(t),r=W(e);if(n&&r)this.customAttributes[t]=e;else{if(!n)throw I.create("invalid attribute name",{attributeName:t});if(!r)throw I.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return o.__assign({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=A.getInstance().getUrl();if(i){var o=new t(g+i,!0),a=Math.floor(1e3*A.getInstance().getTimeOrigin());o.setStartTime(a),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd)));var s="first-paint",u="first-contentful-paint";if(n){var c=n.find((function(t){return t.name===s}));c&&c.startTime&&o.putMetric(v,Math.floor(1e3*c.startTime));var h=n.find((function(t){return t.name===u}));h&&h.startTime&&o.putMetric(b,Math.floor(1e3*h.startTime)),r&&o.putMetric(_,Math.floor(1e3*r))}bt(o)}},t.createUserTimingTrace=function(e){var n=new t(e,!1,e);bt(n)},t}();
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(t){var e=t;if(e&&void 0!==e.responseStart){var n=A.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime)),a=e.name&&e.name.split("?")[0],s={url:a,responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o};wt(s)}}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rt=5e3;function Mt(){R()&&(setTimeout((function(){return Lt()}),0),setTimeout((function(){return Pt()}),0),setTimeout((function(){return Ft()}),0))}function Pt(){for(var t=A.getInstance(),e=t.getEntriesByType("resource"),n=0,r=e;n<r.length;n++){var i=r[n];Ot(i)}t.setupObserver("resource",Ot)}function Lt(){var t=A.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout((function(){xt.createOobTrace(e,n),r=void 0}),Rt);t.onFirstInputDelay((function(t){r&&(clearTimeout(r),xt.createOobTrace(e,n,t))}))}else xt.createOobTrace(e,n)}function Ft(){for(var t=A.getInstance(),e=t.getEntriesByType("measure"),n=0,r=e;n<r.length;n++){var i=r[n];Ut(i)}t.setupObserver("measure",Ut)}function Ut(t){var e=t.name;e.substring(0,y.length)!==y&&xt.createUserTimingTrace(e)}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qt=function(){function t(t){this.app=t,A.getInstance().requiredApisAvailable()?it().then(Mt,Mt):K.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled.")}return t.prototype.trace=function(t){return new xt(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return x.getInstance().instrumentationEnabled},set:function(t){x.getInstance().instrumentationEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return x.getInstance().dataCollectionEnabled},set:function(t){x.getInstance().dataCollectionEnabled=t},enumerable:!0,configurable:!0}),t}(),Vt="[DEFAULT]";
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bt(t){var e=function(t){if(t.name!==Vt)throw I.create("FB not default");if("undefined"===typeof window)throw I.create("no window");return N(window),x.getInstance().firebaseAppInstance=t,new qt(t)},n={};t.INTERNAL.registerService("performance",e,n)}Bt(i),e.registerPerformance=Bt},"71c1":function(t,e,n){var r=n("3a38"),i=n("25eb");t.exports=function(t){return function(e,n){var o,a,s=String(i(e)),u=r(n),c=s.length;return u<0||u>=c?t?"":void 0:(o=s.charCodeAt(u),o<55296||o>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):a-56320+(o-55296<<10)+65536)}}},7333:function(t,e,n){"use strict";var r=n("9e1e"),i=n("0d58"),o=n("2621"),a=n("52a7"),s=n("4bf8"),u=n("626a"),c=Object.assign;t.exports=!c||n("79e5")((function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach((function(t){e[t]=t})),7!=c({},t)[n]||Object.keys(c({},e)).join("")!=r}))?function(t,e){var n=s(t),c=arguments.length,h=1,l=o.f,f=a.f;while(c>h){var p,d=u(arguments[h++]),m=l?i(d).concat(l(d)):i(d),y=m.length,g=0;while(y>g)p=m[g++],r&&!f.call(d,p)||(n[p]=d[p])}return n}:c},"75fc":function(t,e,n){"use strict";var r=n("a745"),i=n.n(r);function o(t){if(i()(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}var a=n("774e"),s=n.n(a),u=n("c8bb"),c=n.n(u);function h(t){if(c()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t))return s()(t)}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(t){return o(t)||h(t)||l()}n.d(e,"a",(function(){return f}))},7726:function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},"774e":function(t,e,n){t.exports=n("d2d5")},"77f1":function(t,e,n){var r=n("4588"),i=Math.max,o=Math.min;t.exports=function(t,e){return t=r(t),t<0?i(t+e,0):o(t,e)}},"794b":function(t,e,n){t.exports=!n("8e60")&&!n("294c")((function(){return 7!=Object.defineProperty(n("1ec9")("div"),"a",{get:function(){return 7}}).a}))},"79aa":function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},"79e5":function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},"7a56":function(t,e,n){"use strict";var r=n("7726"),i=n("86cc"),o=n("9e1e"),a=n("2b4c")("species");t.exports=function(t){var e=r[t];o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},"7a77":function(t,e,n){"use strict";function r(t){this.message=t}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,t.exports=r},"7aac":function(t,e,n){"use strict";var r=n("c532");t.exports=r.isStandardBrowserEnv()?function(){return{write:function(t,e,n,i,o,a){var s=[];s.push(t+"="+encodeURIComponent(e)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},"7cd6":function(t,e,n){var r=n("40c3"),i=n("5168")("iterator"),o=n("481b");t.exports=n("584a").getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[r(t)]}},"7d28":function(t,e,n){"use strict";n.r(e),n.d(e,"registerInstallations",(function(){return gt}));var r,i=n("c23d"),o=n.n(i),a=n("9ab4"),s=n("cd51"),u=n("9dbb"),c="0.3.5",h=1e4,l="w:"+c,f="FIS_v2",p="https://firebaseinstallations.googleapis.com/v1",d=36e5,m="installations",y="Installations",g=(r={},r["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',r["not-registered"]="Firebase Installation is not registered.",r["installation-not-found"]="Firebase Installation not found.",r["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',r["app-offline"]="Could not process request. Application offline.",r["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",r),v=new s["ErrorFactory"](m,y,g);function b(t){return t instanceof s["FirebaseError"]&&t.code.includes("request-failed")}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _(t){var e,n;if(!t||!t.options)throw w("App Configuration");if(!t.name)throw w("App Name");var r=["projectId","apiKey","appId"];try{for(var i=Object(a["__values"])(r),o=i.next();!o.done;o=i.next()){var s=o.value;if(!t.options[s])throw w(s)}}catch(u){e={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function w(t){return v.create("missing-app-config-values",{valueName:t})}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T(t){var e=t.projectId;return p+"/projects/"+e+"/installations"}function E(t){return{token:t.token,requestStatus:2,expiresIn:N(t.expiresIn),creationTime:Date.now()}}function S(t,e){return Object(a["__awaiter"])(this,void 0,void 0,(function(){var n,r;return Object(a["__generator"])(this,(function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),r=n.error,[2,v.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function C(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function I(t,e){var n=e.refreshToken,r=C(t);return r.append("Authorization",k(n)),r}function A(t){return Object(a["__awaiter"])(this,void 0,void 0,(function(){var e;return Object(a["__generator"])(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return e=n.sent(),e.status>=500&&e.status<600?[2,t()]:[2,e]}}))}))}function N(t){return Number(t.replace("s","000"))}function k(t){return f+" "+t}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D(t,e){var n=e.fid;return Object(a["__awaiter"])(this,void 0,void 0,(function(){var e,r,i,o,s,u,c;return Object(a["__generator"])(this,(function(a){switch(a.label){case 0:return e=T(t),r=C(t),i={fid:n,authVersion:f,appId:t.appId,sdkVersion:l},o={method:"POST",headers:r,body:JSON.stringify(i)},[4,A((function(){return fetch(e,o)}))];case 1:return s=a.sent(),s.ok?[4,s.json()]:[3,3];case 2:return u=a.sent(),c={fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:E(u.authToken)},[2,c];case 3:return[4,S("Create Installation",s)];case 4:throw a.sent()}}))}))}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x(t){return new Promise((function(e){setTimeout(e,t)}))}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O(t){var e=btoa(String.fromCharCode.apply(String,Object(a["__spread"])(t)));return e.replace(/\+/g,"-").replace(/\//g,"_")}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var R=/^[cdef][\w-]{21}$/,M="";function P(){try{var t=new Uint8Array(17),e=self.crypto||self.msCrypto;e.getRandomValues(t),t[0]=112+t[0]%16;var n=L(t);return R.test(n)?n:M}catch(r){return M}}function L(t){var e=O(t);return e.substr(0,22)}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var F="firebase-installations-database",U=1,q="firebase-installations-store",V=null;function B(){return V||(V=Object(u["openDb"])(F,U,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(q)}}))),V}function j(t,e){return Object(a["__awaiter"])(this,void 0,void 0,(function(){var n,r,i;return Object(a["__generator"])(this,(function(o){switch(o.label){case 0:return n=z(t),[4,B()];case 1:return r=o.sent(),i=r.transaction(q,"readwrite"),[4,i.objectStore(q).put(e,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,e]}}))}))}function W(t){return Object(a["__awaiter"])(this,void 0,void 0,(function(){var e,n,r;return Object(a["__generator"])(this,(function(i){switch(i.label){case 0:return e=z(t),[4,B()];case 1:return n=i.sent(),r=n.transaction(q,"readwrite"),[4,r.objectStore(q).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function K(t,e){return Object(a["__awaiter"])(this,void 0,void 0,(function(){var n,r,i,o,s,u;return Object(a["__generator"])(this,(function(a){switch(a.label){case 0:return n=z(t),[4,B()];case 1:return r=a.sent(),i=r.transaction(q,"readwrite"),o=i.objectStore(q),[4,o.get(n)];case 2:return s=a.sent(),u=e(s),void 0!==u?[3,4]:[4,o.delete(n)];case 3:return a.sent(),[3,6];case 4:return[4,o.put(u,n)];case 5:a.sent(),a.label=6;case 6:return[4,i.complete];case 7:return a.sent(),[2,u]}}))}))}function z(t){return t.appName+"!"+t.appId}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G(t){return Object(a["__awaiter"])(this,void 0,void 0,(function(){var e,n,r;return Object(a["__generator"])(this,(function(i){switch(i.label){case 0:return[4,K(t,(function(n){var r=Q(n),i=H(t,r);return e=i.registrationPromise,i.installationEntry}))];case 1:return n=i.sent(),n.fid!==M?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function Q(t){var e=t||{fid:P(),registrationStatus:0};return J(e)}function H(t,e){if(0===e.registrationStatus){if(!navigator.onLine){var n=Promise.reject(v.create("app-offline"));return{installationEntry:e,registrationPromise:n}}var r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=Y(t,r);return{installationEntry:r,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:$(t)}:{installationEntry:e}}function Y(t,e){return Object(a["__awaiter"])(this,void 0,void 0,(function(){var n,r;return Object(a["__generator"])(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,D(t,e)];case 1:return n=i.sent(),[2,j(t,n)];case 2:return r=i.sent(),b(r)&&409===r.serverCode?[4,W(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,j(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}function $(t){return Object(a["__awaiter"])(this,void 0,void 0,(function(){var e,n,r,i;return Object(a["__generator"])(this,(function(o){switch(o.label){case 0:return[4,X(t)];case 1:e=o.sent(),o.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,x(100)];case 3:return o.sent(),[4,X(t)];case 4:return e=o.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,G(t)];case 6:return n=o.sent(),r=n.installationEntry,i=n.registrationPromise,i?[2,i]:[2,r];case 7:return[2,e]}}))}))}function X(t){return K(t,(function(t){if(!t)throw v.create("installation-not-found");return J(t)}))}function J(t){return Z(t)?{fid:t.fid,registrationStatus:0}:t}function Z(t){return 1===t.registrationStatus&&t.registrationTime+h<Date.now()}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(t,e){return Object(a["__awaiter"])(this,void 0,void 0,(function(){var n,r,i,o,s,u,c;return Object(a["__generator"])(this,(function(a){switch(a.label){case 0:return n=et(t,e),r=I(t,e),i={installation:{sdkVersion:l}},o={method:"POST",headers:r,body:JSON.stringify(i)},[4,A((function(){return fetch(n,o)}))];case 1:return s=a.sent(),s.ok?[4,s.json()]:[3,3];case 2:return u=a.sent(),c=E(u),[2,c];case 3:return[4,S("Generate Auth Token",s)];case 4:throw a.sent()}}))}))}function et(t,e){var n=e.fid;return T(t)+"/"+n+"/authTokens:generate"}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nt(t,e){return void 0===e&&(e=!1),Object(a["__awaiter"])(this,void 0,void 0,(function(){var n,r,i,o;return Object(a["__generator"])(this,(function(a){switch(a.label){case 0:return[4,K(t,(function(r){if(!at(r))throw v.create("not-registered");var i=r.authToken;if(!e&&st(i))return r;if(1===i.requestStatus)return n=rt(t,e),r;if(!navigator.onLine)throw v.create("app-offline");var o=ct(r);return n=ot(t,o),o}))];case 1:return r=a.sent(),n?[4,n]:[3,3];case 2:return o=a.sent(),[3,4];case 3:o=r.authToken,a.label=4;case 4:return i=o,[2,i]}}))}))}function rt(t,e){return Object(a["__awaiter"])(this,void 0,void 0,(function(){var n,r;return Object(a["__generator"])(this,(function(i){switch(i.label){case 0:return[4,it(t)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,x(100)];case 3:return i.sent(),[4,it(t)];case 4:return n=i.sent(),[3,2];case 5:return r=n.authToken,0===r.requestStatus?[2,nt(t,e)]:[2,r]}}))}))}function it(t){return K(t,(function(t){if(!at(t))throw v.create("not-registered");var e=t.authToken;return ht(e)?Object(a["__assign"])(Object(a["__assign"])({},t),{authToken:{requestStatus:0}}):t}))}function ot(t,e){return Object(a["__awaiter"])(this,void 0,void 0,(function(){var n,r,i;return Object(a["__generator"])(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,tt(t,e)];case 1:return n=o.sent(),i=Object(a["__assign"])(Object(a["__assign"])({},e),{authToken:n}),[4,j(t,i)];case 2:return o.sent(),[2,n];case 3:return r=o.sent(),!b(r)||401!==r.serverCode&&404!==r.serverCode?[3,5]:[4,W(t)];case 4:return o.sent(),[3,7];case 5:return i=Object(a["__assign"])(Object(a["__assign"])({},e),{authToken:{requestStatus:0}}),[4,j(t,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}}))}))}function at(t){return void 0!==t&&2===t.registrationStatus}function st(t){return 2===t.requestStatus&&!ut(t)}function ut(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+d}function ct(t){var e={requestStatus:1,requestTime:Date.now()};return Object(a["__assign"])(Object(a["__assign"])({},t),{authToken:e})}function ht(t){return 1===t.requestStatus&&t.requestTime+h<Date.now()}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lt(t){return Object(a["__awaiter"])(this,void 0,void 0,(function(){var e,n,r,i;return Object(a["__generator"])(this,(function(o){switch(o.label){case 0:return e=_(t),[4,G(e)];case 1:return n=o.sent(),r=n.installationEntry,i=n.registrationPromise,i?i.catch(console.error):nt(e).catch(console.error),[2,r.fid]}}))}))}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ft(t,e){return void 0===e&&(e=!1),Object(a["__awaiter"])(this,void 0,void 0,(function(){var n,r;return Object(a["__generator"])(this,(function(i){switch(i.label){case 0:return n=_(t),[4,pt(n)];case 1:return i.sent(),[4,nt(n,e)];case 2:return r=i.sent(),[2,r.token]}}))}))}function pt(t){return Object(a["__awaiter"])(this,void 0,void 0,(function(){var e;return Object(a["__generator"])(this,(function(n){switch(n.label){case 0:return[4,G(t)];case 1:return e=n.sent().registrationPromise,e?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(t,e){return Object(a["__awaiter"])(this,void 0,void 0,(function(){var n,r,i,o;return Object(a["__generator"])(this,(function(a){switch(a.label){case 0:return n=mt(t,e),r=I(t,e),i={method:"DELETE",headers:r},[4,A((function(){return fetch(n,i)}))];case 1:return o=a.sent(),o.ok?[3,3]:[4,S("Delete Installation",o)];case 2:throw a.sent();case 3:return[2]}}))}))}function mt(t,e){var n=e.fid;return T(t)+"/"+n}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yt(t){return Object(a["__awaiter"])(this,void 0,void 0,(function(){var e,n;return Object(a["__generator"])(this,(function(r){switch(r.label){case 0:return e=_(t),[4,K(e,(function(t){if(!t||0!==t.registrationStatus)return t}))];case 1:if(n=r.sent(),!n)return[3,6];if(1!==n.registrationStatus)return[3,2];throw v.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw v.create("app-offline");case 3:return[4,dt(e,n)];case 4:return r.sent(),[4,W(e)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(t){var e="installations",n=function(t){return _(t),{app:t,getId:function(){return lt(t)},getToken:function(e){return ft(t,e)},delete:function(){return yt(t)}}};t.INTERNAL.registerService(e,n)}gt(o.a)},"7e90":function(t,e,n){var r=n("d9f6"),i=n("e4ae"),o=n("c3a1");t.exports=n("8e60")?Object.defineProperties:function(t,e){i(t);var n,a=o(e),s=a.length,u=0;while(s>u)r.f(t,n=a[u++],e[n]);return t}},"7f20":function(t,e,n){var r=n("86cc").f,i=n("69a8"),o=n("2b4c")("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},8071:function(t,e,n){"use strict";n.r(e),n.d(e,"isSupported",(function(){return H})),n.d(e,"registerMessaging",(function(){return Q}));var r,i,o=n("c23d"),a=n.n(o),s=n("9ab4"),u=n("cd51"),c=(n("7d28"),r={},r["only-available-in-window"]="This method is available in a Window context.",r["only-available-in-sw"]="This method is available in a service worker context.",r["should-be-overriden"]="This method should be overriden by extended classes.",r["bad-sender-id"]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",r["permission-default"]="The required permissions were not granted and dismissed instead.",r["permission-blocked"]="The required permissions were not granted and blocked instead.",r["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",r["notifications-blocked"]="Notifications have been blocked.",r["failed-serviceworker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",r["sw-registration-expected"]="A service worker registration was the expected input.",r["get-subscription-failed"]="There was an error when trying to get any existing Push Subscriptions.",r["invalid-saved-token"]="Unable to access details of the saved token.",r["sw-reg-redundant"]="The service worker being used for push was made redundant.",r["token-subscribe-failed"]="A problem occured while subscribing the user to FCM: {$errorInfo}",r["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",r["token-unsubscribe-failed"]="A problem occured while unsubscribing the user from FCM: {$errorInfo}",r["token-update-failed"]="A problem occured while updating the user from FCM: {$errorInfo}",r["token-update-no-token"]="FCM returned no token when updating the user to push.",r["use-sw-before-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",r["invalid-delete-token"]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",r["delete-token-not-found"]="The deletion attempt for token could not be performed as the token was not found.",r["delete-scope-not-found"]="The deletion attempt for service worker scope could not be performed as the scope was not found.",r["bg-handler-function-expected"]="The input to setBackgroundMessageHandler() must be a function.",r["no-window-client-to-msg"]="An attempt was made to message a non-existant window client.",r["unable-to-resubscribe"]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$errorInfo}",r["no-fcm-token-for-resubscribe"]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",r["failed-to-delete-token"]="Unable to delete the currently saved token.",r["no-sw-in-reg"]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",r["bad-scope"]="The service worker scope must be a string with at least one character.",r["bad-vapid-key"]="The public VAPID key is not a Uint8Array with 65 bytes.",r["bad-subscription"]="The subscription must be a valid PushSubscription.",r["bad-token"]="The FCM Token used for storage / lookup was not a valid token string.",r["failed-delete-vapid-key"]="The VAPID key could not be deleted.",r["invalid-public-vapid-key"]="The public VAPID key must be a string.",r["use-public-key-before-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",r["public-vapid-key-decryption-failed"]="The public VAPID key did not equal 65 bytes when decrypted.",r),h=new u["ErrorFactory"]("messaging","Messaging",c),l=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),f="https://fcmregistrations.googleapis.com/v1",p="google.c.a.c_id",d="google.c.a.c_l",m="google.c.a.ts",y="google.c.a.e";
/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function g(t,e){if(null==t||null==e)return!1;if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(var n=new DataView(t),r=new DataView(e),i=0;i<t.byteLength;i++)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,Object(s["__spread"])(e)))}function b(t){var e=v(t);return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(t){t["PUSH_MSG_RECEIVED"]="push-msg-received",t["NOTIFICATION_CLICKED"]="notification-clicked"})(i||(i={}));var _=function(){function t(){}return t.prototype.getToken=function(t,e,n){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var r,i,o,a,u,c,l;return Object(s["__generator"])(this,(function(s){switch(s.label){case 0:return[4,T(t)];case 1:r=s.sent(),i=E(e,n),o={method:"POST",headers:r,body:JSON.stringify(i)},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(w(t),o)];case 3:return u=s.sent(),[4,u.json()];case 4:return a=s.sent(),[3,6];case 5:throw c=s.sent(),h.create("token-subscribe-failed",{errorInfo:c});case 6:if(a.error)throw l=a.error.message,h.create("token-subscribe-failed",{errorInfo:l});if(!a.token)throw h.create("token-subscribe-no-token");return[2,a.token]}}))}))},t.prototype.updateToken=function(t,e,n,r){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var i,o,a,u,c,l,f;return Object(s["__generator"])(this,(function(s){switch(s.label){case 0:return[4,T(e)];case 1:i=s.sent(),o=E(n,r),a={method:"PATCH",headers:i,body:JSON.stringify(o)},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(w(e)+"/"+t.fcmToken,a)];case 3:return c=s.sent(),[4,c.json()];case 4:return u=s.sent(),[3,6];case 5:throw l=s.sent(),h.create("token-update-failed",{errorInfo:l});case 6:if(u.error)throw f=u.error.message,h.create("token-update-failed",{errorInfo:f});if(!u.token)throw h.create("token-update-no-token");return[2,u.token]}}))}))},t.prototype.deleteToken=function(t,e){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var n,r,i,o,a,u;return Object(s["__generator"])(this,(function(s){switch(s.label){case 0:return[4,T(t)];case 1:n=s.sent(),r={method:"DELETE",headers:n},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(w(t)+"/"+e.fcmToken,r)];case 3:return i=s.sent(),[4,i.json()];case 4:if(o=s.sent(),o.error)throw a=o.error.message,h.create("token-unsubscribe-failed",{errorInfo:a});return[3,6];case 5:throw u=s.sent(),h.create("token-unsubscribe-failed",{errorInfo:u});case 6:return[2]}}))}))},t}();function w(t){return f+"/projects/"+t.options.projectId+"/registrations"}function T(t){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var e,n;return Object(s["__generator"])(this,(function(r){switch(r.label){case 0:return e=t.installations(),[4,e.getToken()];case 1:return n=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.options.apiKey,"x-goog-firebase-installations-auth":"FIS "+n})]}}))}))}function E(t,e){var n=b(t.getKey("p256dh")),r=b(t.getKey("auth")),i={web:{endpoint:t.endpoint,p256dh:n,auth:r}};return g(e.buffer,l.buffer)||(i.web.applicationPubKey=b(e)),i}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S(t){for(var e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var C="undefined",I="fcm_token_object_Store";function A(t,e){if(t.objectStoreNames.contains(I)){var n=t.transaction(I),r=n.objectStore(I),i=new _,o=r.openCursor();o.onerror=function(t){console.warn("Unable to cleanup old IDB.",t)},o.onsuccess=function(){var n=o.result;if(n){var r=n.value;i.deleteToken(e,r),n.continue()}else t.close(),indexedDB.deleteDatabase(C)}}}function N(t){var e=indexedDB.open(C);e.onerror=function(t){},e.onsuccess=function(n){var r=e.result;A(r,t)}}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var k=function(){function t(){this.dbPromise=null}return t.prototype.get=function(t){return this.createTransaction((function(e){return e.get(t)}))},t.prototype.getIndex=function(t,e){function n(n){var r=n.index(t);return r.get(e)}return this.createTransaction(n)},t.prototype.put=function(t){return this.createTransaction((function(e){return e.put(t)}),"readwrite")},t.prototype.delete=function(t){return this.createTransaction((function(e){return e.delete(t)}),"readwrite")},t.prototype.closeDatabase=function(){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var t;return Object(s["__generator"])(this,(function(e){switch(e.label){case 0:return this.dbPromise?[4,this.dbPromise]:[3,2];case 1:t=e.sent(),t.close(),this.dbPromise=null,e.label=2;case 2:return[2]}}))}))},t.prototype.createTransaction=function(t,e){return void 0===e&&(e="readonly"),Object(s["__awaiter"])(this,void 0,void 0,(function(){var n,r,i,o;return Object(s["__generator"])(this,(function(a){switch(a.label){case 0:return[4,this.getDb()];case 1:return n=a.sent(),r=n.transaction(this.objectStoreName,e),i=r.objectStore(this.objectStoreName),[4,D(t(i))];case 2:return o=a.sent(),[2,new Promise((function(t,e){r.oncomplete=function(){t(o)},r.onerror=function(){e(r.error)}}))]}}))}))},t.prototype.getDb=function(){var t=this;return this.dbPromise||(this.dbPromise=new Promise((function(e,n){var r=indexedDB.open(t.dbName,t.dbVersion);r.onsuccess=function(){e(r.result)},r.onerror=function(){t.dbPromise=null,n(r.error)},r.onupgradeneeded=function(e){return t.onDbUpgrade(r,e)}}))),this.dbPromise},t}();function D(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var x=function(t){function e(e){var n=t.call(this)||this;return n.app=e,n.dbName="fcm_token_details_db",n.dbVersion=4,n.objectStoreName="fcm_token_object_Store",n}return Object(s["__extends"])(e,t),e.prototype.onDbUpgrade=function(t,e){var n=t.result;switch(e.oldVersion){case 0:var r=n.createObjectStore(this.objectStoreName,{keyPath:"swScope"});r.createIndex("fcmSenderId","fcmSenderId",{unique:!1}),r.createIndex("fcmToken","fcmToken",{unique:!0});case 1:N(this.app);case 2:r=t.transaction.objectStore(this.objectStoreName);var i=r.openCursor();i.onsuccess=function(){var t=i.result;if(t){var e=t.value,n=Object(s["__assign"])({},e);e.createTime||(n.createTime=Date.now()),"string"===typeof e.vapidKey&&(n.vapidKey=S(e.vapidKey)),"string"===typeof e.auth&&(n.auth=S(e.auth).buffer),"string"===typeof e.auth&&(n.p256dh=S(e.p256dh).buffer),"string"===typeof e.fcmPushSet&&delete n.fcmPushSet,t.update(n),t.continue()}};break;case 3:r=t.transaction.objectStore(this.objectStoreName);var o=r.openCursor();o.onsuccess=function(){var t=o.result;if(t){var e=t.value,n=Object(s["__assign"])({},e);"string"===typeof e.fcmPushSet&&delete n.fcmPushSet,t.update(n),t.continue()}}}},e.prototype.getTokenDetailsFromToken=function(t){return Object(s["__awaiter"])(this,void 0,void 0,(function(){return Object(s["__generator"])(this,(function(e){if(!t)throw h.create("bad-token");return O({fcmToken:t}),[2,this.getIndex("fcmToken",t)]}))}))},e.prototype.getTokenDetailsFromSWScope=function(t){return Object(s["__awaiter"])(this,void 0,void 0,(function(){return Object(s["__generator"])(this,(function(e){if(!t)throw h.create("bad-scope");return O({swScope:t}),[2,this.get(t)]}))}))},e.prototype.saveTokenDetails=function(t){return Object(s["__awaiter"])(this,void 0,void 0,(function(){return Object(s["__generator"])(this,(function(e){if(!t.swScope)throw h.create("bad-scope");if(!t.vapidKey)throw h.create("bad-vapid-key");if(!t.endpoint||!t.auth||!t.p256dh)throw h.create("bad-subscription");if(!t.fcmSenderId)throw h.create("bad-sender-id");if(!t.fcmToken)throw h.create("bad-token");return O(t),[2,this.put(t)]}))}))},e.prototype.deleteToken=function(t){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var e;return Object(s["__generator"])(this,(function(n){switch(n.label){case 0:return"string"!==typeof t||0===t.length?[2,Promise.reject(h.create("invalid-delete-token"))]:[4,this.getTokenDetailsFromToken(t)];case 1:if(e=n.sent(),!e)throw h.create("delete-token-not-found");return[4,this.delete(e.swScope)];case 2:return n.sent(),[2,e]}}))}))},e}(k);function O(t){if(t.fcmToken&&("string"!==typeof t.fcmToken||0===t.fcmToken.length))throw h.create("bad-token");if(t.swScope&&("string"!==typeof t.swScope||0===t.swScope.length))throw h.create("bad-scope");if(t.vapidKey&&(!(t.vapidKey instanceof Uint8Array)||65!==t.vapidKey.length))throw h.create("bad-vapid-key");if(t.endpoint&&("string"!==typeof t.endpoint||0===t.endpoint.length))throw h.create("bad-subscription");if(t.auth&&!(t.auth instanceof ArrayBuffer))throw h.create("bad-subscription");if(t.p256dh&&!(t.p256dh instanceof ArrayBuffer))throw h.create("bad-subscription");if(t.fcmSenderId&&("string"!==typeof t.fcmSenderId||0===t.fcmSenderId.length))throw h.create("bad-sender-id")}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var R=65,M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dbName="fcm_vapid_details_db",e.dbVersion=1,e.objectStoreName="fcm_vapid_object_Store",e}return Object(s["__extends"])(e,t),e.prototype.onDbUpgrade=function(t){var e=t.result;e.createObjectStore(this.objectStoreName,{keyPath:"swScope"})},e.prototype.getVapidFromSWScope=function(t){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var e;return Object(s["__generator"])(this,(function(n){switch(n.label){case 0:if("string"!==typeof t||0===t.length)throw h.create("bad-scope");return[4,this.get(t)];case 1:return e=n.sent(),[2,e?e.vapidKey:void 0]}}))}))},e.prototype.saveVapidDetails=function(t,e){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var n;return Object(s["__generator"])(this,(function(r){if("string"!==typeof t||0===t.length)throw h.create("bad-scope");if(null===e||e.length!==R)throw h.create("bad-vapid-key");return n={swScope:t,vapidKey:e},[2,this.put(n)]}))}))},e.prototype.deleteVapidDetails=function(t){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var e;return Object(s["__generator"])(this,(function(n){switch(n.label){case 0:return[4,this.getVapidFromSWScope(t)];case 1:if(e=n.sent(),!e)throw h.create("delete-scope-not-found");return[4,this.delete(t)];case 2:return n.sent(),[2,e]}}))}))},e}(k),P=6048e5,L=function(){function t(t){var e=this;if(this.app=t,this.vapidDetailsModel=new M,this.subscriptionManager=new _,!t.options.messagingSenderId||"string"!==typeof t.options.messagingSenderId)throw h.create("bad-sender-id");this.INTERNAL={delete:function(){return e.delete()}},this.tokenDetailsModel=new x(t)}return t.prototype.getToken=function(){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var t,e,n,r,i;return Object(s["__generator"])(this,(function(o){switch(o.label){case 0:if(t=this.getNotificationPermission_(),"denied"===t)throw h.create("notifications-blocked");return"granted"!==t?[2,null]:[4,this.getSWRegistration_()];case 1:return e=o.sent(),[4,this.getPublicVapidKey_()];case 2:return n=o.sent(),[4,this.getPushSubscription(e,n)];case 3:return r=o.sent(),[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(e.scope)];case 4:return i=o.sent(),i?[2,this.manageExistingToken(e,r,n,i)]:[2,this.getNewToken(e,r,n)]}}))}))},t.prototype.manageExistingToken=function(t,e,n,r){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var i,o;return Object(s["__generator"])(this,(function(a){switch(a.label){case 0:return i=F(e,n,r),i?(o=Date.now(),o<r.createTime+P?[2,r.fcmToken]:[2,this.updateToken(t,e,n,r)]):[3,1];case 1:return[4,this.deleteTokenFromDB(r.fcmToken)];case 2:return a.sent(),[2,this.getNewToken(t,e,n)];case 3:return[2]}}))}))},t.prototype.updateToken=function(t,e,n,r){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var i,o,a;return Object(s["__generator"])(this,(function(s){switch(s.label){case 0:return s.trys.push([0,4,,6]),[4,this.subscriptionManager.updateToken(r,this.app,e,n)];case 1:return i=s.sent(),o={swScope:t.scope,vapidKey:n,fcmSenderId:this.app.options.messagingSenderId,fcmToken:i,createTime:Date.now(),endpoint:e.endpoint,auth:e.getKey("auth"),p256dh:e.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(o)];case 2:return s.sent(),[4,this.vapidDetailsModel.saveVapidDetails(t.scope,n)];case 3:return s.sent(),[2,i];case 4:return a=s.sent(),[4,this.deleteToken(r.fcmToken)];case 5:throw s.sent(),a;case 6:return[2]}}))}))},t.prototype.getNewToken=function(t,e,n){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var r,i;return Object(s["__generator"])(this,(function(o){switch(o.label){case 0:return[4,this.subscriptionManager.getToken(this.app,e,n)];case 1:return r=o.sent(),i={swScope:t.scope,vapidKey:n,fcmSenderId:this.app.options.messagingSenderId,fcmToken:r,createTime:Date.now(),endpoint:e.endpoint,auth:e.getKey("auth"),p256dh:e.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(i)];case 2:return o.sent(),[4,this.vapidDetailsModel.saveVapidDetails(t.scope,n)];case 3:return o.sent(),[2,r]}}))}))},t.prototype.deleteToken=function(t){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var e,n;return Object(s["__generator"])(this,(function(r){switch(r.label){case 0:return[4,this.deleteTokenFromDB(t)];case 1:return r.sent(),[4,this.getSWRegistration_()];case 2:return e=r.sent(),e?[4,e.pushManager.getSubscription()]:[3,4];case 3:if(n=r.sent(),n)return[2,n.unsubscribe()];r.label=4;case 4:return[2,!0]}}))}))},t.prototype.deleteTokenFromDB=function(t){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var e;return Object(s["__generator"])(this,(function(n){switch(n.label){case 0:return[4,this.tokenDetailsModel.deleteToken(t)];case 1:return e=n.sent(),[4,this.subscriptionManager.deleteToken(this.app,e)];case 2:return n.sent(),[2]}}))}))},t.prototype.getPushSubscription=function(t,e){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var n;return Object(s["__generator"])(this,(function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return n=r.sent(),n?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e})]}}))}))},t.prototype.requestPermission=function(){throw h.create("only-available-in-window")},t.prototype.useServiceWorker=function(t){throw h.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){throw h.create("only-available-in-window")},t.prototype.onMessage=function(t,e,n){throw h.create("only-available-in-window")},t.prototype.onTokenRefresh=function(t,e,n){throw h.create("only-available-in-window")},t.prototype.setBackgroundMessageHandler=function(t){throw h.create("only-available-in-sw")},t.prototype.delete=function(){return Object(s["__awaiter"])(this,void 0,void 0,(function(){return Object(s["__generator"])(this,(function(t){switch(t.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:return t.sent(),[2]}}))}))},t.prototype.getNotificationPermission_=function(){return Notification.permission},t.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel},t.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel},t.prototype.getSubscriptionManager=function(){return this.subscriptionManager},t}();function F(t,e,n){if(!n.vapidKey||!g(e.buffer,n.vapidKey.buffer))return!1;var r=t.endpoint===n.endpoint,i=g(t.getKey("auth"),n.auth),o=g(t.getKey("p256dh"),n.p256dh);return r&&i&&o}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var U="FCM_MSG",q=function(t){function e(e){var n=t.call(this,e)||this;return n.bgMessageHandler=null,self.addEventListener("push",(function(t){n.onPush(t)})),self.addEventListener("pushsubscriptionchange",(function(t){n.onSubChange(t)})),self.addEventListener("notificationclick",(function(t){n.onNotificationClick(t)})),n}return Object(s["__extends"])(e,t),e.prototype.onPush=function(t){t.waitUntil(this.onPush_(t))},e.prototype.onSubChange=function(t){t.waitUntil(this.onSubChange_(t))},e.prototype.onNotificationClick=function(t){t.waitUntil(this.onNotificationClick_(t))},e.prototype.onPush_=function(t){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var e,n,r,i,o,a,u;return Object(s["__generator"])(this,(function(s){switch(s.label){case 0:if(!t.data)return[2];try{e=t.data.json()}catch(c){return[2]}return[4,this.hasVisibleClients_()];case 1:return n=s.sent(),n?[2,this.sendMessageToWindowClients_(e)]:(r=this.getNotificationData_(e),r?(i=r.title||"",[4,this.getSWRegistration_()]):[3,3]);case 2:return o=s.sent(),a=r.actions,u=Notification.maxActions,a&&u&&a.length>u&&console.warn("This browser only supports "+u+" actions.The remaining actions will not be displayed."),[2,o.showNotification(i,r)];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(e)]:[3,5];case 4:return s.sent(),[2];case 5:return[2]}}))}))},e.prototype.onSubChange_=function(t){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var t,e,n,r,i;return Object(s["__generator"])(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.getSWRegistration_()];case 1:return t=o.sent(),[3,3];case 2:throw e=o.sent(),h.create("unable-to-resubscribe",{errorInfo:e});case 3:return o.trys.push([3,5,,8]),[4,t.pushManager.getSubscription()];case 4:return o.sent(),[3,8];case 5:return n=o.sent(),r=this.getTokenDetailsModel(),[4,r.getTokenDetailsFromSWScope(t.scope)];case 6:if(i=o.sent(),!i)throw n;return[4,this.deleteToken(i.fcmToken)];case 7:throw o.sent(),n;case 8:return[2]}}))}))},e.prototype.onNotificationClick_=function(t){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var e,n,r,o;return Object(s["__generator"])(this,(function(a){switch(a.label){case 0:if(!(t.notification&&t.notification.data&&t.notification.data[U]))return[2];if(t.action)return[2];if(t.stopImmediatePropagation(),t.notification.close(),e=t.notification.data[U],!e.notification)return[2];if(n=e.fcmOptions&&e.fcmOptions.link||e.notification.click_action,!n){if(!(e.data&&p in e.data))return[2];n=self.location.origin}return[4,this.getWindowClient_(n)];case 1:return r=a.sent(),r?[3,4]:[4,self.clients.openWindow(n)];case 2:return r=a.sent(),[4,j(3e3)];case 3:return a.sent(),[3,6];case 4:return[4,r.focus()];case 5:r=a.sent(),a.label=6;case 6:return r?(delete e.notification,delete e.fcmOptions,o=B(i.NOTIFICATION_CLICKED,e),[2,this.attemptToMessageClient_(r,o)]):[2]}}))}))},e.prototype.getNotificationData_=function(t){var e;if(t&&"object"===typeof t.notification){var n=Object(s["__assign"])({},t.notification);return n.data=Object(s["__assign"])(Object(s["__assign"])({},t.notification.data),(e={},e[U]=t,e)),n}},e.prototype.setBackgroundMessageHandler=function(t){if(!t||"function"!==typeof t)throw h.create("bg-handler-function-expected");this.bgMessageHandler=t},e.prototype.getWindowClient_=function(t){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var e,n,r,i,o;return Object(s["__generator"])(this,(function(a){switch(a.label){case 0:return e=new URL(t,self.location.href).href,[4,V()];case 1:for(n=a.sent(),r=null,i=0;i<n.length;i++)if(o=new URL(n[i].url,self.location.href).href,o===e){r=n[i];break}return[2,r]}}))}))},e.prototype.attemptToMessageClient_=function(t,e){return Object(s["__awaiter"])(this,void 0,void 0,(function(){return Object(s["__generator"])(this,(function(n){if(!t)throw h.create("no-window-client-to-msg");return t.postMessage(e),[2]}))}))},e.prototype.hasVisibleClients_=function(){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var t;return Object(s["__generator"])(this,(function(e){switch(e.label){case 0:return[4,V()];case 1:return t=e.sent(),[2,t.some((function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))]}}))}))},e.prototype.sendMessageToWindowClients_=function(t){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var e,n,r=this;return Object(s["__generator"])(this,(function(o){switch(o.label){case 0:return[4,V()];case 1:return e=o.sent(),n=B(i.PUSH_MSG_RECEIVED,t),[4,Promise.all(e.map((function(t){return r.attemptToMessageClient_(t,n)})))];case 2:return o.sent(),[2]}}))}))},e.prototype.getSWRegistration_=function(){return Object(s["__awaiter"])(this,void 0,void 0,(function(){return Object(s["__generator"])(this,(function(t){return[2,self.registration]}))}))},e.prototype.getPublicVapidKey_=function(){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var t,e;return Object(s["__generator"])(this,(function(n){switch(n.label){case 0:return[4,this.getSWRegistration_()];case 1:if(t=n.sent(),!t)throw h.create("sw-registration-expected");return[4,this.getVapidDetailsModel().getVapidFromSWScope(t.scope)];case 2:return e=n.sent(),null==e?[2,l]:[2,e]}}))}))},e}(L);function V(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function B(t,e){return{firebaseMessagingType:t,firebaseMessagingData:e}}function j(t){return new Promise((function(e){setTimeout(e,t)}))}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var W="/firebase-messaging-sw.js",K="/firebase-cloud-messaging-push-scope",z=function(t){function e(e){var n=t.call(this,e)||this;return n.registrationToUse=null,n.publicVapidKeyToUse=null,n.messageObserver=null,n.tokenRefreshObserver=null,n.onMessageInternal=Object(u["createSubscribe"])((function(t){n.messageObserver=t})),n.onTokenRefreshInternal=Object(u["createSubscribe"])((function(t){n.tokenRefreshObserver=t})),n.setupSWMessageListener_(),n}return Object(s["__extends"])(e,t),e.prototype.requestPermission=function(){return Object(s["__awaiter"])(this,void 0,void 0,(function(){var t;return Object(s["__generator"])(this,(function(e){switch(e.label){case 0:return"granted"===this.getNotificationPermission_()?[2]:[4,Notification.requestPermission()];case 1:if(t=e.sent(),"granted"===t)return[2];throw"denied"===t?h.create("permission-blocked"):h.create("permission-default")}}))}))},e.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw h.create("sw-registration-expected");if(null!=this.registrationToUse)throw h.create("use-sw-before-get-token");this.registrationToUse=t},e.prototype.usePublicVapidKey=function(t){if("string"!==typeof t)throw h.create("invalid-public-vapid-key");if(null!=this.publicVapidKeyToUse)throw h.create("use-public-key-before-get-token");var e=S(t);if(65!==e.length)throw h.create("public-vapid-key-decryption-failed");this.publicVapidKeyToUse=e},e.prototype.onMessage=function(t,e,n){return"function"===typeof t?this.onMessageInternal(t,e,n):this.onMessageInternal(t)},e.prototype.onTokenRefresh=function(t,e,n){return"function"===typeof t?this.onTokenRefreshInternal(t,e,n):this.onTokenRefreshInternal(t)},e.prototype.waitForRegistrationToActivate_=function(t){var e=t.installing||t.waiting||t.active;return new Promise((function(n,r){if(e)if("activated"!==e.state)if("redundant"!==e.state){var i=function(){if("activated"===e.state)n(t);else{if("redundant"!==e.state)return;r(h.create("sw-reg-redundant"))}e.removeEventListener("statechange",i)};e.addEventListener("statechange",i)}else r(h.create("sw-reg-redundant"));else n(t);else r(h.create("no-sw-in-reg"))}))},e.prototype.getSWRegistration_=function(){var t=this;return this.registrationToUse?this.waitForRegistrationToActivate_(this.registrationToUse):(this.registrationToUse=null,navigator.serviceWorker.register(W,{scope:K}).catch((function(t){throw h.create("failed-serviceworker-registration",{browserErrorMessage:t.message})})).then((function(e){return t.waitForRegistrationToActivate_(e).then((function(){return t.registrationToUse=e,e.update(),e}))})))},e.prototype.getPublicVapidKey_=function(){return Object(s["__awaiter"])(this,void 0,void 0,(function(){return Object(s["__generator"])(this,(function(t){return this.publicVapidKeyToUse?[2,this.publicVapidKeyToUse]:[2,l]}))}))},e.prototype.setupSWMessageListener_=function(){var t=this;navigator.serviceWorker.addEventListener("message",(function(e){if(e.data&&e.data.firebaseMessagingType&&e.data.firebaseMessagingData){var n=e.data,r=n.firebaseMessagingType,i=n.firebaseMessagingData;t.messageObserver&&t.messageObserver.next(i);var o=i.data;if(o&&p in o&&"1"===o[y]){var a=G(r);t.app.INTERNAL.analytics.logEvent(a,{message_name:o[d],message_id:o[p],message_time:o[m],message_device_time:Math.floor(Date.now()/1e3)})}}}),!1)},e}(L);function G(t){switch(t){case i.NOTIFICATION_CLICKED:return"notification_open";case i.PUSH_MSG_RECEIVED:return"notification_foreground";default:throw new Error}}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q(t){var e="messaging",n=function(t){if(!H())throw h.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new q(t):new z(t)},r={isSupported:H};t.INTERNAL.registerService(e,n,r)}function H(){return self&&"ServiceWorkerGlobalScope"in self?$():Y()}function Y(){return navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function $(){return"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}Q(a.a)},8079:function(t,e,n){var r=n("7726"),i=n("1991").set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,u="process"==n("2d95")(a);t.exports=function(){var t,e,n,c=function(){var r,i;u&&(r=a.domain)&&r.exit();while(t){i=t.fn,t=t.next;try{i()}catch(o){throw t?n():e=void 0,o}}e=void 0,r&&r.enter()};if(u)n=function(){a.nextTick(c)};else if(!o||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var h=s.resolve(void 0);n=function(){h.then(c)}}else n=function(){i.call(r,c)};else{var l=!0,f=document.createTextNode("");new o(c).observe(f,{characterData:!0}),n=function(){f.data=l=!l}}return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},8378:function(t,e){var n=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=n)},8436:function(t,e){t.exports=function(){}},"84f2":function(t,e){t.exports={}},"86cc":function(t,e,n){var r=n("cb7c"),i=n("c69a"),o=n("6a99"),a=Object.defineProperty;e.f=n("9e1e")?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(s){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},"8aa5":function(t,e,n){"use strict";function r(t){return t&&"object"===typeof t&&"default"in t?t["default"]:t}var i=r(n("c23d"));n("b7aa"),n("3523"),n("e89a"),n("001a"),n("8071"),n("2e66"),n("6d09"),n("dcaa"),n("3b59"),
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport * as firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),t.exports=i},"8b97":function(t,e,n){var r=n("d3f4"),i=n("cb7c"),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{r=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),r(t,[]),e=!(t instanceof Array)}catch(i){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},"8c4f":function(t,e,n){"use strict";
/*!
  * vue-router v3.1.3
  * (c) 2019 Evan You
  * @license MIT
  */function r(t,e){0}function i(t){return Object.prototype.toString.call(t).indexOf("Error")>-1}function o(t,e){return e instanceof t||e&&(e.name===t.name||e._name===t._name)}function a(t,e){for(var n in e)t[n]=e[n];return t}var s={name:"RouterView",functional:!0,props:{name:{type:String,default:"default"}},render:function(t,e){var n=e.props,r=e.children,i=e.parent,o=e.data;o.routerView=!0;var s=i.$createElement,c=n.name,h=i.$route,l=i._routerViewCache||(i._routerViewCache={}),f=0,p=!1;while(i&&i._routerRoot!==i){var d=i.$vnode&&i.$vnode.data;d&&(d.routerView&&f++,d.keepAlive&&i._inactive&&(p=!0)),i=i.$parent}if(o.routerViewDepth=f,p)return s(l[c],o,r);var m=h.matched[f];if(!m)return l[c]=null,s();var y=l[c]=m.components[c];o.registerRouteInstance=function(t,e){var n=m.instances[c];(e&&n!==t||!e&&n===t)&&(m.instances[c]=e)},(o.hook||(o.hook={})).prepatch=function(t,e){m.instances[c]=e.componentInstance},o.hook.init=function(t){t.data.keepAlive&&t.componentInstance&&t.componentInstance!==m.instances[c]&&(m.instances[c]=t.componentInstance)};var g=o.props=u(h,m.props&&m.props[c]);if(g){g=o.props=a({},g);var v=o.attrs=o.attrs||{};for(var b in g)y.props&&b in y.props||(v[b]=g[b],delete g[b])}return s(y,o,r)}};function u(t,e){switch(typeof e){case"undefined":return;case"object":return e;case"function":return e(t);case"boolean":return e?t.params:void 0;default:0}}var c=/[!'()*]/g,h=function(t){return"%"+t.charCodeAt(0).toString(16)},l=/%2C/g,f=function(t){return encodeURIComponent(t).replace(c,h).replace(l,",")},p=decodeURIComponent;function d(t,e,n){void 0===e&&(e={});var r,i=n||m;try{r=i(t||"")}catch(a){r={}}for(var o in e)r[o]=e[o];return r}function m(t){var e={};return t=t.trim().replace(/^(\?|#|&)/,""),t?(t.split("&").forEach((function(t){var n=t.replace(/\+/g," ").split("="),r=p(n.shift()),i=n.length>0?p(n.join("=")):null;void 0===e[r]?e[r]=i:Array.isArray(e[r])?e[r].push(i):e[r]=[e[r],i]})),e):e}function y(t){var e=t?Object.keys(t).map((function(e){var n=t[e];if(void 0===n)return"";if(null===n)return f(e);if(Array.isArray(n)){var r=[];return n.forEach((function(t){void 0!==t&&(null===t?r.push(f(e)):r.push(f(e)+"="+f(t)))})),r.join("&")}return f(e)+"="+f(n)})).filter((function(t){return t.length>0})).join("&"):null;return e?"?"+e:""}var g=/\/?$/;function v(t,e,n,r){var i=r&&r.options.stringifyQuery,o=e.query||{};try{o=b(o)}catch(s){}var a={name:e.name||t&&t.name,meta:t&&t.meta||{},path:e.path||"/",hash:e.hash||"",query:o,params:e.params||{},fullPath:T(e,i),matched:t?w(t):[]};return n&&(a.redirectedFrom=T(n,i)),Object.freeze(a)}function b(t){if(Array.isArray(t))return t.map(b);if(t&&"object"===typeof t){var e={};for(var n in t)e[n]=b(t[n]);return e}return t}var _=v(null,{path:"/"});function w(t){var e=[];while(t)e.unshift(t),t=t.parent;return e}function T(t,e){var n=t.path,r=t.query;void 0===r&&(r={});var i=t.hash;void 0===i&&(i="");var o=e||y;return(n||"/")+o(r)+i}function E(t,e){return e===_?t===e:!!e&&(t.path&&e.path?t.path.replace(g,"")===e.path.replace(g,"")&&t.hash===e.hash&&S(t.query,e.query):!(!t.name||!e.name)&&(t.name===e.name&&t.hash===e.hash&&S(t.query,e.query)&&S(t.params,e.params)))}function S(t,e){if(void 0===t&&(t={}),void 0===e&&(e={}),!t||!e)return t===e;var n=Object.keys(t),r=Object.keys(e);return n.length===r.length&&n.every((function(n){var r=t[n],i=e[n];return"object"===typeof r&&"object"===typeof i?S(r,i):String(r)===String(i)}))}function C(t,e){return 0===t.path.replace(g,"/").indexOf(e.path.replace(g,"/"))&&(!e.hash||t.hash===e.hash)&&I(t.query,e.query)}function I(t,e){for(var n in e)if(!(n in t))return!1;return!0}function A(t,e,n){var r=t.charAt(0);if("/"===r)return t;if("?"===r||"#"===r)return e+t;var i=e.split("/");n&&i[i.length-1]||i.pop();for(var o=t.replace(/^\//,"").split("/"),a=0;a<o.length;a++){var s=o[a];".."===s?i.pop():"."!==s&&i.push(s)}return""!==i[0]&&i.unshift(""),i.join("/")}function N(t){var e="",n="",r=t.indexOf("#");r>=0&&(e=t.slice(r),t=t.slice(0,r));var i=t.indexOf("?");return i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),{path:t,query:n,hash:e}}function k(t){return t.replace(/\/\//g,"/")}var D=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)},x=$,O=F,R=U,M=B,P=Y,L=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function F(t,e){var n,r=[],i=0,o=0,a="",s=e&&e.delimiter||"/";while(null!=(n=L.exec(t))){var u=n[0],c=n[1],h=n.index;if(a+=t.slice(o,h),o=h+u.length,c)a+=c[1];else{var l=t[o],f=n[2],p=n[3],d=n[4],m=n[5],y=n[6],g=n[7];a&&(r.push(a),a="");var v=null!=f&&null!=l&&l!==f,b="+"===y||"*"===y,_="?"===y||"*"===y,w=n[2]||s,T=d||m;r.push({name:p||i++,prefix:f||"",delimiter:w,optional:_,repeat:b,partial:v,asterisk:!!g,pattern:T?W(T):g?".*":"[^"+j(w)+"]+?"})}}return o<t.length&&(a+=t.substr(o)),a&&r.push(a),r}function U(t,e){return B(F(t,e))}function q(t){return encodeURI(t).replace(/[\/?#]/g,(function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()}))}function V(t){return encodeURI(t).replace(/[?#]/g,(function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()}))}function B(t){for(var e=new Array(t.length),n=0;n<t.length;n++)"object"===typeof t[n]&&(e[n]=new RegExp("^(?:"+t[n].pattern+")$"));return function(n,r){for(var i="",o=n||{},a=r||{},s=a.pretty?q:encodeURIComponent,u=0;u<t.length;u++){var c=t[u];if("string"!==typeof c){var h,l=o[c.name];if(null==l){if(c.optional){c.partial&&(i+=c.prefix);continue}throw new TypeError('Expected "'+c.name+'" to be defined')}if(D(l)){if(!c.repeat)throw new TypeError('Expected "'+c.name+'" to not repeat, but received `'+JSON.stringify(l)+"`");if(0===l.length){if(c.optional)continue;throw new TypeError('Expected "'+c.name+'" to not be empty')}for(var f=0;f<l.length;f++){if(h=s(l[f]),!e[u].test(h))throw new TypeError('Expected all "'+c.name+'" to match "'+c.pattern+'", but received `'+JSON.stringify(h)+"`");i+=(0===f?c.prefix:c.delimiter)+h}}else{if(h=c.asterisk?V(l):s(l),!e[u].test(h))throw new TypeError('Expected "'+c.name+'" to match "'+c.pattern+'", but received "'+h+'"');i+=c.prefix+h}}else i+=c}return i}}function j(t){return t.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function W(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function K(t,e){return t.keys=e,t}function z(t){return t.sensitive?"":"i"}function G(t,e){var n=t.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)e.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return K(t,e)}function Q(t,e,n){for(var r=[],i=0;i<t.length;i++)r.push($(t[i],e,n).source);var o=new RegExp("(?:"+r.join("|")+")",z(n));return K(o,e)}function H(t,e,n){return Y(F(t,n),e,n)}function Y(t,e,n){D(e)||(n=e||n,e=[]),n=n||{};for(var r=n.strict,i=!1!==n.end,o="",a=0;a<t.length;a++){var s=t[a];if("string"===typeof s)o+=j(s);else{var u=j(s.prefix),c="(?:"+s.pattern+")";e.push(s),s.repeat&&(c+="(?:"+u+c+")*"),c=s.optional?s.partial?u+"("+c+")?":"(?:"+u+"("+c+"))?":u+"("+c+")",o+=c}}var h=j(n.delimiter||"/"),l=o.slice(-h.length)===h;return r||(o=(l?o.slice(0,-h.length):o)+"(?:"+h+"(?=$))?"),o+=i?"$":r&&l?"":"(?="+h+"|$)",K(new RegExp("^"+o,z(n)),e)}function $(t,e,n){return D(e)||(n=e||n,e=[]),n=n||{},t instanceof RegExp?G(t,e):D(t)?Q(t,e,n):H(t,e,n)}x.parse=O,x.compile=R,x.tokensToFunction=M,x.tokensToRegExp=P;var X=Object.create(null);function J(t,e,n){e=e||{};try{var r=X[t]||(X[t]=x.compile(t));return e.pathMatch&&(e[0]=e.pathMatch),r(e,{pretty:!0})}catch(i){return""}finally{delete e[0]}}function Z(t,e,n,r){var i="string"===typeof t?{path:t}:t;if(i._normalized)return i;if(i.name)return a({},t);if(!i.path&&i.params&&e){i=a({},i),i._normalized=!0;var o=a(a({},e.params),i.params);if(e.name)i.name=e.name,i.params=o;else if(e.matched.length){var s=e.matched[e.matched.length-1].path;i.path=J(s,o,"path "+e.path)}else 0;return i}var u=N(i.path||""),c=e&&e.path||"/",h=u.path?A(u.path,c,n||i.append):c,l=d(u.query,i.query,r&&r.options.parseQuery),f=i.hash||u.hash;return f&&"#"!==f.charAt(0)&&(f="#"+f),{_normalized:!0,path:h,query:l,hash:f}}var tt,et=[String,Object],nt=[String,Array],rt=function(){},it={name:"RouterLink",props:{to:{type:et,required:!0},tag:{type:String,default:"a"},exact:Boolean,append:Boolean,replace:Boolean,activeClass:String,exactActiveClass:String,event:{type:nt,default:"click"}},render:function(t){var e=this,n=this.$router,r=this.$route,i=n.resolve(this.to,r,this.append),o=i.location,s=i.route,u=i.href,c={},h=n.options.linkActiveClass,l=n.options.linkExactActiveClass,f=null==h?"router-link-active":h,p=null==l?"router-link-exact-active":l,d=null==this.activeClass?f:this.activeClass,m=null==this.exactActiveClass?p:this.exactActiveClass,y=s.redirectedFrom?v(null,Z(s.redirectedFrom),null,n):s;c[m]=E(r,y),c[d]=this.exact?c[m]:C(r,y);var g=function(t){ot(t)&&(e.replace?n.replace(o,rt):n.push(o,rt))},b={click:ot};Array.isArray(this.event)?this.event.forEach((function(t){b[t]=g})):b[this.event]=g;var _={class:c},w=!this.$scopedSlots.$hasNormal&&this.$scopedSlots.default&&this.$scopedSlots.default({href:u,route:s,navigate:g,isActive:c[d],isExactActive:c[m]});if(w){if(1===w.length)return w[0];if(w.length>1||!w.length)return 0===w.length?t():t("span",{},w)}if("a"===this.tag)_.on=b,_.attrs={href:u};else{var T=at(this.$slots.default);if(T){T.isStatic=!1;var S=T.data=a({},T.data);for(var I in S.on=S.on||{},S.on){var A=S.on[I];I in b&&(S.on[I]=Array.isArray(A)?A:[A])}for(var N in b)N in S.on?S.on[N].push(b[N]):S.on[N]=g;var k=T.data.attrs=a({},T.data.attrs);k.href=u}else _.on=b}return t(this.tag,_,this.$slots.default)}};function ot(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&(void 0===t.button||0===t.button)){if(t.currentTarget&&t.currentTarget.getAttribute){var e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function at(t){if(t)for(var e,n=0;n<t.length;n++){if(e=t[n],"a"===e.tag)return e;if(e.children&&(e=at(e.children)))return e}}function st(t){if(!st.installed||tt!==t){st.installed=!0,tt=t;var e=function(t){return void 0!==t},n=function(t,n){var r=t.$options._parentVnode;e(r)&&e(r=r.data)&&e(r=r.registerRouteInstance)&&r(t,n)};t.mixin({beforeCreate:function(){e(this.$options.router)?(this._routerRoot=this,this._router=this.$options.router,this._router.init(this),t.util.defineReactive(this,"_route",this._router.history.current)):this._routerRoot=this.$parent&&this.$parent._routerRoot||this,n(this,this)},destroyed:function(){n(this)}}),Object.defineProperty(t.prototype,"$router",{get:function(){return this._routerRoot._router}}),Object.defineProperty(t.prototype,"$route",{get:function(){return this._routerRoot._route}}),t.component("RouterView",s),t.component("RouterLink",it);var r=t.config.optionMergeStrategies;r.beforeRouteEnter=r.beforeRouteLeave=r.beforeRouteUpdate=r.created}}var ut="undefined"!==typeof window;function ct(t,e,n,r){var i=e||[],o=n||Object.create(null),a=r||Object.create(null);t.forEach((function(t){ht(i,o,a,t)}));for(var s=0,u=i.length;s<u;s++)"*"===i[s]&&(i.push(i.splice(s,1)[0]),u--,s--);return{pathList:i,pathMap:o,nameMap:a}}function ht(t,e,n,r,i,o){var a=r.path,s=r.name;var u=r.pathToRegexpOptions||{},c=ft(a,i,u.strict);"boolean"===typeof r.caseSensitive&&(u.sensitive=r.caseSensitive);var h={path:c,regex:lt(c,u),components:r.components||{default:r.component},instances:{},name:s,parent:i,matchAs:o,redirect:r.redirect,beforeEnter:r.beforeEnter,meta:r.meta||{},props:null==r.props?{}:r.components?r.props:{default:r.props}};if(r.children&&r.children.forEach((function(r){var i=o?k(o+"/"+r.path):void 0;ht(t,e,n,r,h,i)})),e[h.path]||(t.push(h.path),e[h.path]=h),void 0!==r.alias)for(var l=Array.isArray(r.alias)?r.alias:[r.alias],f=0;f<l.length;++f){var p=l[f];0;var d={path:p,children:r.children};ht(t,e,n,d,i,h.path||"/")}s&&(n[s]||(n[s]=h))}function lt(t,e){var n=x(t,[],e);return n}function ft(t,e,n){return n||(t=t.replace(/\/$/,"")),"/"===t[0]?t:null==e?t:k(e.path+"/"+t)}function pt(t,e){var n=ct(t),r=n.pathList,i=n.pathMap,o=n.nameMap;function a(t){ct(t,r,i,o)}function s(t,n,a){var s=Z(t,n,!1,e),u=s.name;if(u){var c=o[u];if(!c)return h(null,s);var l=c.regex.keys.filter((function(t){return!t.optional})).map((function(t){return t.name}));if("object"!==typeof s.params&&(s.params={}),n&&"object"===typeof n.params)for(var f in n.params)!(f in s.params)&&l.indexOf(f)>-1&&(s.params[f]=n.params[f]);return s.path=J(c.path,s.params,'named route "'+u+'"'),h(c,s,a)}if(s.path){s.params={};for(var p=0;p<r.length;p++){var d=r[p],m=i[d];if(dt(m.regex,s.path,s.params))return h(m,s,a)}}return h(null,s)}function u(t,n){var r=t.redirect,i="function"===typeof r?r(v(t,n,null,e)):r;if("string"===typeof i&&(i={path:i}),!i||"object"!==typeof i)return h(null,n);var a=i,u=a.name,c=a.path,l=n.query,f=n.hash,p=n.params;if(l=a.hasOwnProperty("query")?a.query:l,f=a.hasOwnProperty("hash")?a.hash:f,p=a.hasOwnProperty("params")?a.params:p,u){o[u];return s({_normalized:!0,name:u,query:l,hash:f,params:p},void 0,n)}if(c){var d=mt(c,t),m=J(d,p,'redirect route with path "'+d+'"');return s({_normalized:!0,path:m,query:l,hash:f},void 0,n)}return h(null,n)}function c(t,e,n){var r=J(n,e.params,'aliased route with path "'+n+'"'),i=s({_normalized:!0,path:r});if(i){var o=i.matched,a=o[o.length-1];return e.params=i.params,h(a,e)}return h(null,e)}function h(t,n,r){return t&&t.redirect?u(t,r||n):t&&t.matchAs?c(t,n,t.matchAs):v(t,n,r,e)}return{match:s,addRoutes:a}}function dt(t,e,n){var r=e.match(t);if(!r)return!1;if(!n)return!0;for(var i=1,o=r.length;i<o;++i){var a=t.keys[i-1],s="string"===typeof r[i]?decodeURIComponent(r[i]):r[i];a&&(n[a.name||"pathMatch"]=s)}return!0}function mt(t,e){return A(t,e.parent?e.parent.path:"/",!0)}var yt=ut&&window.performance&&window.performance.now?window.performance:Date;function gt(){return yt.now().toFixed(3)}var vt=gt();function bt(){return vt}function _t(t){return vt=t}var wt=Object.create(null);function Tt(){var t=window.location.protocol+"//"+window.location.host,e=window.location.href.replace(t,"");window.history.replaceState({key:bt()},"",e),window.addEventListener("popstate",(function(t){St(),t.state&&t.state.key&&_t(t.state.key)}))}function Et(t,e,n,r){if(t.app){var i=t.options.scrollBehavior;i&&t.app.$nextTick((function(){var o=Ct(),a=i.call(t,e,n,r?o:null);a&&("function"===typeof a.then?a.then((function(t){Ot(t,o)})).catch((function(t){0})):Ot(a,o))}))}}function St(){var t=bt();t&&(wt[t]={x:window.pageXOffset,y:window.pageYOffset})}function Ct(){var t=bt();if(t)return wt[t]}function It(t,e){var n=document.documentElement,r=n.getBoundingClientRect(),i=t.getBoundingClientRect();return{x:i.left-r.left-e.x,y:i.top-r.top-e.y}}function At(t){return Dt(t.x)||Dt(t.y)}function Nt(t){return{x:Dt(t.x)?t.x:window.pageXOffset,y:Dt(t.y)?t.y:window.pageYOffset}}function kt(t){return{x:Dt(t.x)?t.x:0,y:Dt(t.y)?t.y:0}}function Dt(t){return"number"===typeof t}var xt=/^#\d/;function Ot(t,e){var n="object"===typeof t;if(n&&"string"===typeof t.selector){var r=xt.test(t.selector)?document.getElementById(t.selector.slice(1)):document.querySelector(t.selector);if(r){var i=t.offset&&"object"===typeof t.offset?t.offset:{};i=kt(i),e=It(r,i)}else At(t)&&(e=Nt(t))}else n&&At(t)&&(e=Nt(t));e&&window.scrollTo(e.x,e.y)}var Rt=ut&&function(){var t=window.navigator.userAgent;return(-1===t.indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&(window.history&&"pushState"in window.history)}();function Mt(t,e){St();var n=window.history;try{e?n.replaceState({key:bt()},"",t):n.pushState({key:_t(gt())},"",t)}catch(r){window.location[e?"replace":"assign"](t)}}function Pt(t){Mt(t,!0)}function Lt(t,e,n){var r=function(i){i>=t.length?n():t[i]?e(t[i],(function(){r(i+1)})):r(i+1)};r(0)}function Ft(t){return function(e,n,r){var o=!1,a=0,s=null;Ut(t,(function(t,e,n,u){if("function"===typeof t&&void 0===t.cid){o=!0,a++;var c,h=jt((function(e){Bt(e)&&(e=e.default),t.resolved="function"===typeof e?e:tt.extend(e),n.components[u]=e,a--,a<=0&&r()})),l=jt((function(t){var e="Failed to resolve async component "+u+": "+t;s||(s=i(t)?t:new Error(e),r(s))}));try{c=t(h,l)}catch(p){l(p)}if(c)if("function"===typeof c.then)c.then(h,l);else{var f=c.component;f&&"function"===typeof f.then&&f.then(h,l)}}})),o||r()}}function Ut(t,e){return qt(t.map((function(t){return Object.keys(t.components).map((function(n){return e(t.components[n],t.instances[n],t,n)}))})))}function qt(t){return Array.prototype.concat.apply([],t)}var Vt="function"===typeof Symbol&&"symbol"===typeof Symbol.toStringTag;function Bt(t){return t.__esModule||Vt&&"Module"===t[Symbol.toStringTag]}function jt(t){var e=!1;return function(){var n=[],r=arguments.length;while(r--)n[r]=arguments[r];if(!e)return e=!0,t.apply(this,n)}}var Wt=function(t){function e(e){t.call(this),this.name=this._name="NavigationDuplicated",this.message='Navigating to current location ("'+e.fullPath+'") is not allowed',Object.defineProperty(this,"stack",{value:(new t).stack,writable:!0,configurable:!0})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error);Wt._name="NavigationDuplicated";var Kt=function(t,e){this.router=t,this.base=zt(e),this.current=_,this.pending=null,this.ready=!1,this.readyCbs=[],this.readyErrorCbs=[],this.errorCbs=[]};function zt(t){if(!t)if(ut){var e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^https?:\/\/[^\/]+/,"")}else t="/";return"/"!==t.charAt(0)&&(t="/"+t),t.replace(/\/$/,"")}function Gt(t,e){var n,r=Math.max(t.length,e.length);for(n=0;n<r;n++)if(t[n]!==e[n])break;return{updated:e.slice(0,n),activated:e.slice(n),deactivated:t.slice(n)}}function Qt(t,e,n,r){var i=Ut(t,(function(t,r,i,o){var a=Ht(t,e);if(a)return Array.isArray(a)?a.map((function(t){return n(t,r,i,o)})):n(a,r,i,o)}));return qt(r?i.reverse():i)}function Ht(t,e){return"function"!==typeof t&&(t=tt.extend(t)),t.options[e]}function Yt(t){return Qt(t,"beforeRouteLeave",Xt,!0)}function $t(t){return Qt(t,"beforeRouteUpdate",Xt)}function Xt(t,e){if(e)return function(){return t.apply(e,arguments)}}function Jt(t,e,n){return Qt(t,"beforeRouteEnter",(function(t,r,i,o){return Zt(t,i,o,e,n)}))}function Zt(t,e,n,r,i){return function(o,a,s){return t(o,a,(function(t){"function"===typeof t&&r.push((function(){te(t,e.instances,n,i)})),s(t)}))}}function te(t,e,n,r){e[n]&&!e[n]._isBeingDestroyed?t(e[n]):r()&&setTimeout((function(){te(t,e,n,r)}),16)}Kt.prototype.listen=function(t){this.cb=t},Kt.prototype.onReady=function(t,e){this.ready?t():(this.readyCbs.push(t),e&&this.readyErrorCbs.push(e))},Kt.prototype.onError=function(t){this.errorCbs.push(t)},Kt.prototype.transitionTo=function(t,e,n){var r=this,i=this.router.match(t,this.current);this.confirmTransition(i,(function(){r.updateRoute(i),e&&e(i),r.ensureURL(),r.ready||(r.ready=!0,r.readyCbs.forEach((function(t){t(i)})))}),(function(t){n&&n(t),t&&!r.ready&&(r.ready=!0,r.readyErrorCbs.forEach((function(e){e(t)})))}))},Kt.prototype.confirmTransition=function(t,e,n){var a=this,s=this.current,u=function(t){!o(Wt,t)&&i(t)&&(a.errorCbs.length?a.errorCbs.forEach((function(e){e(t)})):(r(!1,"uncaught error during route navigation:"),console.error(t))),n&&n(t)};if(E(t,s)&&t.matched.length===s.matched.length)return this.ensureURL(),u(new Wt(t));var c=Gt(this.current.matched,t.matched),h=c.updated,l=c.deactivated,f=c.activated,p=[].concat(Yt(l),this.router.beforeHooks,$t(h),f.map((function(t){return t.beforeEnter})),Ft(f));this.pending=t;var d=function(e,n){if(a.pending!==t)return u();try{e(t,s,(function(t){!1===t||i(t)?(a.ensureURL(!0),u(t)):"string"===typeof t||"object"===typeof t&&("string"===typeof t.path||"string"===typeof t.name)?(u(),"object"===typeof t&&t.replace?a.replace(t):a.push(t)):n(t)}))}catch(r){u(r)}};Lt(p,d,(function(){var n=[],r=function(){return a.current===t},i=Jt(f,n,r),o=i.concat(a.router.resolveHooks);Lt(o,d,(function(){if(a.pending!==t)return u();a.pending=null,e(t),a.router.app&&a.router.app.$nextTick((function(){n.forEach((function(t){t()}))}))}))}))},Kt.prototype.updateRoute=function(t){var e=this.current;this.current=t,this.cb&&this.cb(t),this.router.afterHooks.forEach((function(n){n&&n(t,e)}))};var ee=function(t){function e(e,n){var r=this;t.call(this,e,n);var i=e.options.scrollBehavior,o=Rt&&i;o&&Tt();var a=ne(this.base);window.addEventListener("popstate",(function(t){var n=r.current,i=ne(r.base);r.current===_&&i===a||r.transitionTo(i,(function(t){o&&Et(e,t,n,!0)}))}))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.go=function(t){window.history.go(t)},e.prototype.push=function(t,e,n){var r=this,i=this,o=i.current;this.transitionTo(t,(function(t){Mt(k(r.base+t.fullPath)),Et(r.router,t,o,!1),e&&e(t)}),n)},e.prototype.replace=function(t,e,n){var r=this,i=this,o=i.current;this.transitionTo(t,(function(t){Pt(k(r.base+t.fullPath)),Et(r.router,t,o,!1),e&&e(t)}),n)},e.prototype.ensureURL=function(t){if(ne(this.base)!==this.current.fullPath){var e=k(this.base+this.current.fullPath);t?Mt(e):Pt(e)}},e.prototype.getCurrentLocation=function(){return ne(this.base)},e}(Kt);function ne(t){var e=decodeURI(window.location.pathname);return t&&0===e.indexOf(t)&&(e=e.slice(t.length)),(e||"/")+window.location.search+window.location.hash}var re=function(t){function e(e,n,r){t.call(this,e,n),r&&ie(this.base)||oe()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setupListeners=function(){var t=this,e=this.router,n=e.options.scrollBehavior,r=Rt&&n;r&&Tt(),window.addEventListener(Rt?"popstate":"hashchange",(function(){var e=t.current;oe()&&t.transitionTo(ae(),(function(n){r&&Et(t.router,n,e,!0),Rt||ce(n.fullPath)}))}))},e.prototype.push=function(t,e,n){var r=this,i=this,o=i.current;this.transitionTo(t,(function(t){ue(t.fullPath),Et(r.router,t,o,!1),e&&e(t)}),n)},e.prototype.replace=function(t,e,n){var r=this,i=this,o=i.current;this.transitionTo(t,(function(t){ce(t.fullPath),Et(r.router,t,o,!1),e&&e(t)}),n)},e.prototype.go=function(t){window.history.go(t)},e.prototype.ensureURL=function(t){var e=this.current.fullPath;ae()!==e&&(t?ue(e):ce(e))},e.prototype.getCurrentLocation=function(){return ae()},e}(Kt);function ie(t){var e=ne(t);if(!/^\/#/.test(e))return window.location.replace(k(t+"/#"+e)),!0}function oe(){var t=ae();return"/"===t.charAt(0)||(ce("/"+t),!1)}function ae(){var t=window.location.href,e=t.indexOf("#");if(e<0)return"";t=t.slice(e+1);var n=t.indexOf("?");if(n<0){var r=t.indexOf("#");t=r>-1?decodeURI(t.slice(0,r))+t.slice(r):decodeURI(t)}else n>-1&&(t=decodeURI(t.slice(0,n))+t.slice(n));return t}function se(t){var e=window.location.href,n=e.indexOf("#"),r=n>=0?e.slice(0,n):e;return r+"#"+t}function ue(t){Rt?Mt(se(t)):window.location.hash=t}function ce(t){Rt?Pt(se(t)):window.location.replace(se(t))}var he=function(t){function e(e,n){t.call(this,e,n),this.stack=[],this.index=-1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e,n){var r=this;this.transitionTo(t,(function(t){r.stack=r.stack.slice(0,r.index+1).concat(t),r.index++,e&&e(t)}),n)},e.prototype.replace=function(t,e,n){var r=this;this.transitionTo(t,(function(t){r.stack=r.stack.slice(0,r.index).concat(t),e&&e(t)}),n)},e.prototype.go=function(t){var e=this,n=this.index+t;if(!(n<0||n>=this.stack.length)){var r=this.stack[n];this.confirmTransition(r,(function(){e.index=n,e.updateRoute(r)}),(function(t){o(Wt,t)&&(e.index=n)}))}},e.prototype.getCurrentLocation=function(){var t=this.stack[this.stack.length-1];return t?t.fullPath:"/"},e.prototype.ensureURL=function(){},e}(Kt),le=function(t){void 0===t&&(t={}),this.app=null,this.apps=[],this.options=t,this.beforeHooks=[],this.resolveHooks=[],this.afterHooks=[],this.matcher=pt(t.routes||[],this);var e=t.mode||"hash";switch(this.fallback="history"===e&&!Rt&&!1!==t.fallback,this.fallback&&(e="hash"),ut||(e="abstract"),this.mode=e,e){case"history":this.history=new ee(this,t.base);break;case"hash":this.history=new re(this,t.base,this.fallback);break;case"abstract":this.history=new he(this,t.base);break;default:0}},fe={currentRoute:{configurable:!0}};function pe(t,e){return t.push(e),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}function de(t,e,n){var r="hash"===n?"#"+e:e;return t?k(t+"/"+r):r}le.prototype.match=function(t,e,n){return this.matcher.match(t,e,n)},fe.currentRoute.get=function(){return this.history&&this.history.current},le.prototype.init=function(t){var e=this;if(this.apps.push(t),t.$once("hook:destroyed",(function(){var n=e.apps.indexOf(t);n>-1&&e.apps.splice(n,1),e.app===t&&(e.app=e.apps[0]||null)})),!this.app){this.app=t;var n=this.history;if(n instanceof ee)n.transitionTo(n.getCurrentLocation());else if(n instanceof re){var r=function(){n.setupListeners()};n.transitionTo(n.getCurrentLocation(),r,r)}n.listen((function(t){e.apps.forEach((function(e){e._route=t}))}))}},le.prototype.beforeEach=function(t){return pe(this.beforeHooks,t)},le.prototype.beforeResolve=function(t){return pe(this.resolveHooks,t)},le.prototype.afterEach=function(t){return pe(this.afterHooks,t)},le.prototype.onReady=function(t,e){this.history.onReady(t,e)},le.prototype.onError=function(t){this.history.onError(t)},le.prototype.push=function(t,e,n){var r=this;if(!e&&!n&&"undefined"!==typeof Promise)return new Promise((function(e,n){r.history.push(t,e,n)}));this.history.push(t,e,n)},le.prototype.replace=function(t,e,n){var r=this;if(!e&&!n&&"undefined"!==typeof Promise)return new Promise((function(e,n){r.history.replace(t,e,n)}));this.history.replace(t,e,n)},le.prototype.go=function(t){this.history.go(t)},le.prototype.back=function(){this.go(-1)},le.prototype.forward=function(){this.go(1)},le.prototype.getMatchedComponents=function(t){var e=t?t.matched?t:this.resolve(t).route:this.currentRoute;return e?[].concat.apply([],e.matched.map((function(t){return Object.keys(t.components).map((function(e){return t.components[e]}))}))):[]},le.prototype.resolve=function(t,e,n){e=e||this.history.current;var r=Z(t,e,n,this),i=this.match(r,e),o=i.redirectedFrom||i.fullPath,a=this.history.base,s=de(a,o,this.mode);return{location:r,route:i,href:s,normalizedTo:r,resolved:i}},le.prototype.addRoutes=function(t){this.matcher.addRoutes(t),this.history.current!==_&&this.history.transitionTo(this.history.getCurrentLocation())},Object.defineProperties(le.prototype,fe),le.install=st,le.version="3.1.3",ut&&window.Vue&&window.Vue.use(le),e["a"]=le},"8df4":function(t,e,n){"use strict";var r=n("7a77");function i(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;t((function(t){n.reason||(n.reason=new r(t),e(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var t,e=new i((function(e){t=e}));return{token:e,cancel:t}},t.exports=i},"8e60":function(t,e,n){t.exports=!n("294c")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},"8f60":function(t,e,n){"use strict";var r=n("a159"),i=n("aebd"),o=n("45f2"),a={};n("35e8")(a,n("5168")("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=r(a,{next:i(1,n)}),o(t,e+" Iterator")}},9003:function(t,e,n){var r=n("6b4c");t.exports=Array.isArray||function(t){return"Array"==r(t)}},9093:function(t,e,n){var r=n("ce10"),i=n("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},9138:function(t,e,n){t.exports=n("35e8")},"95d5":function(t,e,n){var r=n("40c3"),i=n("5168")("iterator"),o=n("481b");t.exports=n("584a").isIterable=function(t){var e=Object(t);return void 0!==e[i]||"@@iterator"in e||o.hasOwnProperty(r(e))}},"9ab4":function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",(function(){return i})),n.d(e,"__assign",(function(){return o})),n.d(e,"__rest",(function(){return a})),n.d(e,"__decorate",(function(){return s})),n.d(e,"__param",(function(){return u})),n.d(e,"__metadata",(function(){return c})),n.d(e,"__awaiter",(function(){return h})),n.d(e,"__generator",(function(){return l})),n.d(e,"__exportStar",(function(){return f})),n.d(e,"__values",(function(){return p})),n.d(e,"__read",(function(){return d})),n.d(e,"__spread",(function(){return m})),n.d(e,"__spreadArrays",(function(){return y})),n.d(e,"__await",(function(){return g})),n.d(e,"__asyncGenerator",(function(){return v})),n.d(e,"__asyncDelegator",(function(){return b})),n.d(e,"__asyncValues",(function(){return _})),n.d(e,"__makeTemplateObject",(function(){return w})),n.d(e,"__importStar",(function(){return T})),n.d(e,"__importDefault",(function(){return E}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},r(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},o.apply(this,arguments)};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)}function h(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function l(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function f(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function p(t){var e="function"===typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function d(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a}function m(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function g(t){return this instanceof g?(this.v=t,this):new g(t)}function v(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||s(t,e)}))})}function s(t,e){try{u(i[t](e))}catch(n){l(o[0][3],n)}}function u(t){t.value instanceof g?Promise.resolve(t.value.v).then(c,h):l(o[0][2],t)}function c(t){s("next",t)}function h(t){s("throw",t)}function l(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function b(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:g(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function _(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t="function"===typeof p?p(t):t[Symbol.iterator](),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,o){e=t[n](e),i(r,o,e.done,e.value)}))}}function i(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function T(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function E(t){return t&&t.__esModule?t:{default:t}}},"9b43":function(t,e,n){var r=n("d8e8");t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},"9c6c":function(t,e,n){var r=n("2b4c")("unscopables"),i=Array.prototype;void 0==i[r]&&n("32e9")(i,r,{}),t.exports=function(t){i[r][t]=!0}},"9c80":function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(e){return{e:!0,v:e}}}},"9dbb":function(t,e,n){(function(t,n){n(e)})(0,(function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,o=new Promise((function(o,a){i=t[e].apply(t,r),n(i).then(o,a)}));return o.request=i,o}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new h(t,i.request)}))}function o(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function a(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function s(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function u(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function c(t){this._index=t}function h(t,e){this._cursor=t,this._request=e}function l(t){this._store=t}function f(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function p(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new f(n)}function d(t){this._db=t}function m(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){n&&n(new p(o.result,t.oldVersion,o.transaction))}),i.then((function(t){return new d(t)}))}function y(t){return r(indexedDB,"deleteDatabase",[t])}o(c,"_index",["name","keyPath","multiEntry","unique"]),a(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(h,"_cursor",["direction","key","primaryKey","value"]),a(h,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(h.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new h(t,e._request)}))}))})})),l.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},l.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(l,"_store",["name","keyPath","indexNames","autoIncrement"]),a(l,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(l,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(l,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new l(this._tx.objectStore.apply(this._tx,arguments))},o(f,"_tx",["objectStoreNames","mode"]),s(f,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new l(this._db.createObjectStore.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),s(p,"_db",IDBDatabase,["deleteObjectStore","close"]),d.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},o(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[l,c].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[c,l].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=m,t.deleteDb=y,Object.defineProperty(t,"__esModule",{value:!0})}))},"9def":function(t,e,n){var r=n("4588"),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},"9e1e":function(t,e,n){t.exports=!n("79e5")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},a159:function(t,e,n){var r=n("e4ae"),i=n("7e90"),o=n("1691"),a=n("5559")("IE_PROTO"),s=function(){},u="prototype",c=function(){var t,e=n("1ec9")("iframe"),r=o.length,i="<",a=">";e.style.display="none",n("32fc").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(i+"script"+a+"document.F=Object"+i+"/script"+a),t.close(),c=t.F;while(r--)delete c[u][o[r]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(s[u]=r(t),n=new s,s[u]=null,n[a]=t):n=c(),void 0===e?n:i(n,e)}},a25f:function(t,e,n){var r=n("7726"),i=r.navigator;t.exports=i&&i.userAgent||""},a5b8:function(t,e,n){"use strict";var r=n("d8e8");function i(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r})),this.resolve=r(e),this.reject=r(n)}t.exports.f=function(t){return new i(t)}},a69f:function(t,e,n){var r=n("5ca1");r(r.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},a745:function(t,e,n){t.exports=n("f410")},aa77:function(t,e,n){var r=n("5ca1"),i=n("be13"),o=n("79e5"),a=n("fdef"),s="["+a+"]",u="​",c=RegExp("^"+s+s+"*"),h=RegExp(s+s+"*$"),l=function(t,e,n){var i={},s=o((function(){return!!a[t]()||u[t]()!=u})),c=i[t]=s?e(f):a[t];n&&(i[n]=c),r(r.P+r.F*s,"String",i)},f=l.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(h,"")),t};t.exports=l},abfd:function(t,e,n){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */n.r(e),n.d(e,"LogLevel",(function(){return i})),n.d(e,"Logger",(function(){return u})),n.d(e,"setLogLevel",(function(){return c}));var i,o=[];(function(t){t[t["DEBUG"]=0]="DEBUG",t[t["VERBOSE"]=1]="VERBOSE",t[t["INFO"]=2]="INFO",t[t["WARN"]=3]="WARN",t[t["ERROR"]=4]="ERROR",t[t["SILENT"]=5]="SILENT"})(i||(i={}));var a=i.INFO,s=function(t,e){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];if(!(e<t.logLevel)){var a=(new Date).toISOString();switch(e){case i.DEBUG:console.log.apply(console,r(["["+a+"]  "+t.name+":"],n));break;case i.VERBOSE:console.log.apply(console,r(["["+a+"]  "+t.name+":"],n));break;case i.INFO:console.info.apply(console,r(["["+a+"]  "+t.name+":"],n));break;case i.WARN:console.warn.apply(console,r(["["+a+"]  "+t.name+":"],n));break;case i.ERROR:console.error.apply(console,r(["["+a+"]  "+t.name+":"],n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}},u=function(){function t(t){this.name=t,this._logLevel=a,this._logHandler=s,o.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in i))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,r([this,i.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,r([this,i.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,r([this,i.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,r([this,i.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,r([this,i.ERROR],t))},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function c(t){o.forEach((function(e){e.logLevel=t}))}},ac6a:function(t,e,n){for(var r=n("cadf"),i=n("0d58"),o=n("2aba"),a=n("7726"),s=n("32e9"),u=n("84f2"),c=n("2b4c"),h=c("iterator"),l=c("toStringTag"),f=u.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=i(p),m=0;m<d.length;m++){var y,g=d[m],v=p[g],b=a[g],_=b&&b.prototype;if(_&&(_[h]||s(_,h,f),_[l]||s(_,l,g),u[g]=f,v))for(y in r)_[y]||o(_,y,r[y],!0)}},aebd:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},b0dc:function(t,e,n){var r=n("e4ae");t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(a){var o=t["return"];throw void 0!==o&&r(o.call(t)),a}}},b447:function(t,e,n){var r=n("3a38"),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},b50d:function(t,e,n){"use strict";var r=n("c532"),i=n("467f"),o=n("30b5"),a=n("c345"),s=n("3934"),u=n("2d83");t.exports=function(t){return new Promise((function(e,c){var h=t.data,l=t.headers;r.isFormData(h)&&delete l["Content-Type"];var f=new XMLHttpRequest;if(t.auth){var p=t.auth.username||"",d=t.auth.password||"";l.Authorization="Basic "+btoa(p+":"+d)}if(f.open(t.method.toUpperCase(),o(t.url,t.params,t.paramsSerializer),!0),f.timeout=t.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in f?a(f.getAllResponseHeaders()):null,r=t.responseType&&"text"!==t.responseType?f.response:f.responseText,o={data:r,status:f.status,statusText:f.statusText,headers:n,config:t,request:f};i(e,c,o),f=null}},f.onabort=function(){f&&(c(u("Request aborted",t,"ECONNABORTED",f)),f=null)},f.onerror=function(){c(u("Network Error",t,null,f)),f=null},f.ontimeout=function(){c(u("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",f)),f=null},r.isStandardBrowserEnv()){var m=n("7aac"),y=(t.withCredentials||s(t.url))&&t.xsrfCookieName?m.read(t.xsrfCookieName):void 0;y&&(l[t.xsrfHeaderName]=y)}if("setRequestHeader"in f&&r.forEach(l,(function(t,e){"undefined"===typeof h&&"content-type"===e.toLowerCase()?delete l[e]:f.setRequestHeader(e,t)})),t.withCredentials&&(f.withCredentials=!0),t.responseType)try{f.responseType=t.responseType}catch(g){if("json"!==t.responseType)throw g}"function"===typeof t.onDownloadProgress&&f.addEventListener("progress",t.onDownloadProgress),"function"===typeof t.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){f&&(f.abort(),c(t),f=null)})),void 0===h&&(h=null),f.send(h)}))}},b7aa:function(t,e,n){"use strict";n.r(e),function(t){var e=n("c23d"),r=n.n(e);(function(){var e,n="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},i="undefined"!=typeof window&&window===this?this:"undefined"!=typeof t&&null!=t?t:this;function o(t,e){if(e){var r=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in r||(r[a]={}),r=r[a]}t=t[t.length-1],o=r[t],e=e(o),e!=o&&null!=e&&n(r,t,{configurable:!0,writable:!0,value:e})}}function a(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function s(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:a(t)}}o("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var o=i.setTimeout;n.prototype.c=function(t){o(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(r){this.f(r)}}}this.a=null},n.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.o(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.u(t):this.h(t)}},e.prototype.u=function(t){var e=void 0;try{e=t.then}catch(n){return void this.g(n)}"function"==typeof e?this.v(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)a.b(this.a[t]);this.a=null}};var a=new n;return e.prototype.o=function(t){var e=this.f();t.La(e.resolve,e.reject)},e.prototype.v=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(r){n.reject(r)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(n){o(n)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.La(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.La=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?a.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var i=s(t),o=i.next();!o.done;o=i.next())r(o.value).La(e,n)}))},e.all=function(t){var n=s(t),i=n.next();return i.done?r([]):new e((function(t,e){function o(e){return function(n){a[e]=n,s--,0==s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).La(o(a.length-1),e),i=n.next()}while(!i.done)}))},e}));var u=u||{},c=this||self;function h(t){return"string"==typeof t}function l(t){return"boolean"==typeof t}var f=/^[\w+/_-]+[=]{0,2}$/,p=null;function d(){}function m(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&"undefined"==typeof t.call)return"object";return e}function y(t){return null===t}function g(t){return"array"==m(t)}function v(t){var e=m(t);return"array"==e||"object"==e&&"number"==typeof t.length}function b(t){return"function"==m(t)}function _(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var w="closure_uid_"+(1e9*Math.random()>>>0),T=0;function E(t,e,n){return t.call.apply(t.bind,arguments)}function S(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function C(t,e,n){return C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?E:S,C.apply(null,arguments)}function I(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var A=Date.now||function(){return+new Date};function N(t,e){function n(){}n.prototype=e.prototype,t.qb=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.gd=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function k(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function D(t){if(Error.captureStackTrace)Error.captureStackTrace(this,D);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function x(t,e){t=t.split("%s");for(var n="",r=t.length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");D.call(this,n+t[r])}function O(t,e){throw new x("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function R(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function M(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function P(){this.b=this.a=null}N(D,Error),D.prototype.name="CustomError",N(x,D),x.prototype.name="AssertionError",R.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var L=new R((function(){return new U}),(function(t){t.reset()}));function F(){var t=$t,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function U(){this.next=this.b=this.a=null}function q(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if(r=r||c,r.Element&&r.Location){var i=r;break t}}catch(a){}i=null}if(i&&"undefined"!=typeof i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(_(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(a){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;O("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}P.prototype.add=function(t,e){var n=L.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},U.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},U.prototype.reset=function(){this.next=this.b=this.a=null};var V=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(h(t))return h(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=h(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function j(t,e){for(var n=h(t)?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}var W=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i=h(t)?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},K=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=h(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function z(t){t:{for(var e=Va,n=t.length,r=h(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:h(t)?t.charAt(e):t[e]}function G(t,e){return 0<=V(t,e)}function Q(t,e){var n;return e=V(t,e),(n=0<=e)&&Array.prototype.splice.call(t,e,1),n}function H(t,e){j(t,(function(n,r){e.call(void 0,n,r,t)&&1==Array.prototype.splice.call(t,r,1).length&&0}))}function Y(t){return Array.prototype.concat.apply([],arguments)}function $(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function X(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function J(t){for(var e in t)return!1;return!0}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(var o=0;o<tt.length;o++)n=tt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function nt(t,e){this.a=t===ot&&e||"",this.b=it}function rt(t){return t instanceof nt&&t.constructor===nt&&t.b===it?t.a:(O("expected object of type Const, got '"+t+"'"),"type_error:Const")}nt.prototype.qa=!0,nt.prototype.pa=function(){return this.a},nt.prototype.toString=function(){return"Const{"+this.a+"}"};var it={},ot={},at=new nt(ot,"");function st(){this.a="",this.b=ft}function ut(t){return t instanceof st&&t.constructor===st&&t.b===ft?t.a:(O("expected object of type TrustedResourceUrl, got '"+t+"' of type "+m(t)),"type_error:TrustedResourceUrl")}function ct(t,e){var n=rt(t);if(!lt.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return t=n.replace(ht,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return t=e[r],t instanceof nt?rt(t):encodeURIComponent(String(t))})),pt(t)}st.prototype.qa=!0,st.prototype.pa=function(){return this.a.toString()},st.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var ht=/%{(\w+)}/g,lt=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,ft={};function pt(t){var e=new st;return e.a=t,e}var dt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},mt=/&/g,yt=/</g,gt=/>/g,vt=/"/g,bt=/'/g,_t=/\x00/g,wt=/[\x00&<>"']/;function Tt(t,e){return-1!=t.indexOf(e)}function Et(t,e){return t<e?-1:t>e?1:0}function St(){this.a="",this.b=kt}function Ct(t){return t instanceof St&&t.constructor===St&&t.b===kt?t.a:(O("expected object of type SafeUrl, got '"+t+"' of type "+m(t)),"type_error:SafeUrl")}St.prototype.qa=!0,St.prototype.pa=function(){return this.a.toString()},St.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var It=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function At(t){return t instanceof St?t:(t="object"==typeof t&&t.qa?t.pa():String(t),It.test(t)||(t="about:invalid#zClosurez"),Dt(t))}var Nt,kt={};function Dt(t){var e=new St;return e.a=t,e}Dt("about:blank");t:{var xt=c.navigator;if(xt){var Ot=xt.userAgent;if(Ot){Nt=Ot;break t}}Nt=""}function Rt(t){return Tt(Nt,t)}function Mt(){this.a="",this.b=Lt}function Pt(t){return t instanceof Mt&&t.constructor===Mt&&t.b===Lt?t.a:(O("expected object of type SafeHtml, got '"+t+"' of type "+m(t)),"type_error:SafeHtml")}Mt.prototype.qa=!0,Mt.prototype.pa=function(){return this.a.toString()},Mt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Lt={};function Ft(t){var e=new Mt;return e.a=t,e}Ft("<!DOCTYPE html>");var Ut,qt,Vt=Ft("");function Bt(t){var e=pt(rt(at));q(t,"HTMLIFrameElement"),t.src=ut(e).toString()}function jt(t,e){q(t,"HTMLScriptElement"),t.src=ut(e),null===p&&(e=c.document,p=(e=e.querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&f.test(e)?e:""),e=p,e&&t.setAttribute("nonce",e)}function Wt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Kt(t){return wt.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(mt,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(yt,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(gt,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(vt,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(bt,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(_t,"&#0;"))),t}function zt(t){c.setTimeout((function(){throw t}),0)}function Gt(){var t=c.MessageChannel;if("undefined"===typeof t&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!Rt("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",Bt(t),document.documentElement.appendChild(t);var e=t.contentWindow;t=e.document,t.open(),t.write(Pt(Vt)),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=C((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),"undefined"!==typeof t&&!Rt("Trident")&&!Rt("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){n=n.next;var t=n.yb;n.yb=null,t()}},function(t){r.next={yb:t},r=r.next,e.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){c.setTimeout(t,0)}}function Qt(t,e){qt||Ht(),Yt||(qt(),Yt=!0),$t.add(t,e)}function Ht(){if(c.Promise&&c.Promise.resolve){var t=c.Promise.resolve(void 0);qt=function(){t.then(Xt)}}else qt=function(){var t=Xt;!b(c.setImmediate)||c.Window&&c.Window.prototype&&!Rt("Edge")&&c.Window.prototype.setImmediate==c.setImmediate?(Ut||(Ut=Gt()),Ut(t)):c.setImmediate(t)}}Ft("<br>");var Yt=!1,$t=new P;function Xt(){for(var t;t=F();){try{t.a.call(t.b)}catch(e){zt(e)}M(L,t)}Yt=!1}function Jt(t,e){if(this.a=Zt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=d)try{var n=this;t.call(e,(function(t){pe(n,te,t)}),(function(t){if(!(t instanceof Te))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(e){}pe(n,ee,t)}))}catch(r){pe(this,ee,r)}}var Zt=0,te=2,ee=3;function ne(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}ne.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var re=new R((function(){return new ne}),(function(t){t.reset()}));function ie(t,e,n){var r=re.get();return r.g=t,r.b=e,r.f=n,r}function oe(t){if(t instanceof Jt)return t;var e=new Jt(d);return pe(e,te,t),e}function ae(t){return new Jt((function(e,n){n(t)}))}function se(t,e,n){de(t,e,n,null)||Qt(I(e,t))}function ue(t){return new Jt((function(e,n){var r=t.length,i=[];if(r)for(var o,a=function(t,n){r--,i[t]=n,0==r&&e(i)},s=function(t){n(t)},u=0;u<t.length;u++)o=t[u],se(o,I(a,u),s);else e(i)}))}function ce(t){return new Jt((function(e){var n=t.length,r=[];if(n)for(var i,o=function(t,i,o){n--,r[t]=i?{Gb:!0,value:o}:{Gb:!1,reason:o},0==n&&e(r)},a=0;a<t.length;a++)i=t[a],se(i,I(o,a,!0),I(o,a,!1));else e(r)}))}function he(t,e){if(t.a==Zt)if(t.c){var n=t.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==t&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==Zt&&1==r?he(n,e):(o?(r=o,r.next==n.f&&(n.f=r),r.next=r.next.next):ge(n),ve(n,i,ee,e)))}t.c=null}else pe(t,ee,e)}function le(t,e){t.b||t.a!=te&&t.a!=ee||ye(t),t.f?t.f.next=e:t.b=e,t.f=e}function fe(t,e,n,r){var i=ie(null,null,null);return i.a=new Jt((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(a){o(a)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof Te?o(e):t(i)}catch(a){o(a)}}:o})),i.a.c=t,le(t,i),i.a}function pe(t,e,n){t.a==Zt&&(t===n&&(e=ee,n=new TypeError("Promise cannot resolve to itself")),t.a=1,de(n,t.Oc,t.Pc,t)||(t.i=n,t.a=e,t.c=null,ye(t),e!=ee||n instanceof Te||_e(t,n)))}function de(t,e,n,r){if(t instanceof Jt)return le(t,ie(e||d,n||null,r)),!0;if(k(t))return t.then(e,n,r),!0;if(_(t))try{var i=t.then;if(b(i))return me(t,i,e,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function me(t,e,n,r,i){function o(t){s||(s=!0,r.call(i,t))}function a(t){s||(s=!0,n.call(i,t))}var s=!1;try{e.call(t,a,o)}catch(u){o(u)}}function ye(t){t.h||(t.h=!0,Qt(t.Zb,t))}function ge(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function ve(t,e,n,r){if(n==ee&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,be(e,n,r);else try{e.c?e.g.call(e.f):be(e,n,r)}catch(i){we.call(null,i)}M(re,e)}function be(t,e,n){e==te?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}function _e(t,e){t.g=!0,Qt((function(){t.g&&we.call(null,e)}))}Jt.prototype.then=function(t,e,n){return fe(this,b(t)?t:null,b(e)?e:null,n)},Jt.prototype.$goog_Thenable=!0,e=Jt.prototype,e.ka=function(t,e){return t=ie(t,t,e),t.c=!0,le(this,t),this},e.s=function(t,e){return fe(this,null,t,e)},e.cancel=function(t){this.a==Zt&&Qt((function(){var e=new Te(t);he(this,e)}),this)},e.Oc=function(t){this.a=Zt,pe(this,te,t)},e.Pc=function(t){this.a=Zt,pe(this,ee,t)},e.Zb=function(){for(var t;t=ge(this);)ve(this,t,this.a,this.i);this.h=!1};var we=zt;function Te(t){D.call(this,t)}function Ee(){0!=Se&&(Ce[this[w]||(this[w]=++T)]=this),this.va=this.va,this.la=this.la}N(Te,D),Te.prototype.name="cancel";var Se=0,Ce={};function Ie(t){if(!t.va&&(t.va=!0,t.za(),0!=Se)){var e=t[w]||(t[w]=++T);if(0!=Se&&t.la&&0<t.la.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Ce[e]}}function Ae(t){return Ae[" "](t),t}function Ne(t,e){var n=Be;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}Ee.prototype.va=!1,Ee.prototype.za=function(){if(this.la)for(;this.la.length;)this.la.shift()()},Ae[" "]=d;var ke,De=Rt("Opera"),xe=Rt("Trident")||Rt("MSIE"),Oe=Rt("Edge"),Re=Oe||xe,Me=Rt("Gecko")&&!(Tt(Nt.toLowerCase(),"webkit")&&!Rt("Edge"))&&!(Rt("Trident")||Rt("MSIE"))&&!Rt("Edge"),Pe=Tt(Nt.toLowerCase(),"webkit")&&!Rt("Edge");function Le(){var t=c.document;return t?t.documentMode:void 0}t:{var Fe="",Ue=function(){var t=Nt;return Me?/rv:([^\);]+)(\)|;)/.exec(t):Oe?/Edge\/([\d\.]+)/.exec(t):xe?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Pe?/WebKit\/(\S+)/.exec(t):De?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(Ue&&(Fe=Ue?Ue[1]:""),xe){var qe=Le();if(null!=qe&&qe>parseFloat(Fe)){ke=String(qe);break t}}ke=Fe}var Ve,Be={};function je(t){return Ne(t,(function(){for(var e=0,n=dt(String(ke)).split("."),r=dt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=Et(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||Et(0==a[2].length,0==s[2].length)||Et(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}Ve=c.document&&xe?Le():void 0;var We=Object.freeze||function(t){return t},Ke=!xe||9<=Number(Ve),ze=xe&&!je("9"),Ge=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{c.addEventListener("test",d,e),c.removeEventListener("test",d,e)}catch(n){}return t}();function Qe(t,e){this.type=t,this.b=this.target=e,this.Mb=!0}function He(t,e){if(Qe.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Me){t:{try{Ae(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=h(t.pointerType)?t.pointerType:Ye[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Qe.prototype.preventDefault=function(){this.Mb=!1},N(He,Qe);var Ye=We({2:"touch",3:"pen",4:"mouse"});He.prototype.preventDefault=function(){He.qb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ze)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},He.prototype.f=function(){return this.a};var $e="closure_listenable_"+(1e6*Math.random()|0),Xe=0;function Je(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Pa=i,this.key=++Xe,this.ta=this.Ka=!1}function Ze(t){t.ta=!0,t.listener=null,t.proxy=null,t.src=null,t.Pa=null}function tn(t){this.src=t,this.a={},this.b=0}function en(t,e){var n=e.type;n in t.a&&Q(t.a[n],e)&&(Ze(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function nn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ta&&o.listener==e&&o.capture==!!n&&o.Pa==r)return i}return-1}tn.prototype.add=function(t,e,n,r,i){var o=t.toString();t=this.a[o],t||(t=this.a[o]=[],this.b++);var a=nn(t,e,r,i);return-1<a?(e=t[a],n||(e.Ka=!1)):(e=new Je(e,this.src,o,!!r,i),e.Ka=n,t.push(e)),e};var rn="closure_lm_"+(1e6*Math.random()|0),on={};function an(t,e,n,r,i){if(r&&r.once)cn(t,e,n,r,i);else if(g(e))for(var o=0;o<e.length;o++)an(t,e[o],n,r,i);else n=vn(n),t&&t[$e]?_n(t,e,n,_(r)?!!r.capture:!!r,i):sn(t,e,n,!1,r,i)}function sn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=_(i)?!!i.capture:!!i,s=yn(t);if(s||(t[rn]=s=new tn(t)),n=s.add(e,n,r,a,o),!n.proxy){if(r=un(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Ge||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(fn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}0}}function un(){var t=mn,e=Ke?function(n){return t.call(e.src,e.listener,n)}:function(n){if(n=t.call(e.src,e.listener,n),!n)return n};return e}function cn(t,e,n,r,i){if(g(e))for(var o=0;o<e.length;o++)cn(t,e[o],n,r,i);else n=vn(n),t&&t[$e]?wn(t,e,n,_(r)?!!r.capture:!!r,i):sn(t,e,n,!0,r,i)}function hn(t,e,n,r,i){if(g(e))for(var o=0;o<e.length;o++)hn(t,e[o],n,r,i);else r=_(r)?!!r.capture:!!r,n=vn(n),t&&t[$e]?(t=t.u,e=String(e).toString(),e in t.a&&(o=t.a[e],n=nn(o,n,r,i),-1<n&&(Ze(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=yn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=nn(e,n,r,i)),(n=-1<t?e[t]:null)&&ln(n))}function ln(t){if("number"!=typeof t&&t&&!t.ta){var e=t.src;if(e&&e[$e])en(e.u,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(fn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=yn(e))?(en(n,t),0==n.b&&(n.src=null,e[rn]=null)):Ze(t)}}}function fn(t){return t in on?on[t]:on[t]="on"+t}function pn(t,e,n,r){var i=!0;if((t=yn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.ta&&(o=dn(o,r),i=i&&!1!==o)}return i}function dn(t,e){var n=t.listener,r=t.Pa||t.src;return t.Ka&&ln(t),n.call(r,e)}function mn(t,e){if(t.ta)return!0;if(!Ke){if(!e)t:{e=["window","event"];for(var n=c,r=0;r<e.length;r++)if(n=n[e[r]],null==n){e=null;break t}e=n}if(r=e,e=new He(r,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(a){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=pn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=pn(r[i],t,!1,e),n=n&&o}return n}return dn(t,new He(e,this))}function yn(t){return t=t[rn],t instanceof tn?t:null}var gn="__closure_events_fn_"+(1e9*Math.random()>>>0);function vn(t){return b(t)?t:(t[gn]||(t[gn]=function(e){return t.handleEvent(e)}),t[gn])}function bn(){Ee.call(this),this.u=new tn(this),this.Sb=this,this.Xa=null}function _n(t,e,n,r,i){t.u.add(String(e),n,!1,r,i)}function wn(t,e,n,r,i){t.u.add(String(e),n,!0,r,i)}function Tn(t,e,n,r){if(e=t.u.a[String(e)],!e)return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.ta&&a.capture==n){var s=a.listener,u=a.Pa||a.src;a.Ka&&en(t.u,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Mb}function En(t,e,n){if(b(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:c.setTimeout(t,e||0)}function Sn(t){var e=null;return new Jt((function(n,r){e=En((function(){n(void 0)}),t),-1==e&&r(Error("Failed to schedule timer."))})).s((function(t){throw c.clearTimeout(e),t}))}function Cn(t){if(t.U&&"function"==typeof t.U)return t.U();if(h(t))return t.split("");if(v(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function In(t){if(t.X&&"function"==typeof t.X)return t.X();if(!t.U||"function"!=typeof t.U){if(v(t)||h(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function An(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(v(t)||h(t))B(t,e,void 0);else for(var n=In(t),r=Cn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}function Nn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Nn)for(n=t.X(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function kn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Dn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r=t.a[e],Dn(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Dn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}N(bn,Ee),bn.prototype[$e]=!0,bn.prototype.addEventListener=function(t,e,n,r){an(this,t,e,n,r)},bn.prototype.removeEventListener=function(t,e,n,r){hn(this,t,e,n,r)},bn.prototype.dispatchEvent=function(t){var e,n=this.Xa;if(n)for(e=[];n;n=n.Xa)e.push(n);n=this.Sb;var r=t.type||t;if(h(t))t=new Qe(t,n);else if(t instanceof Qe)t.target=t.target||n;else{var i=t;t=new Qe(r,n),et(t,i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=Tn(a,r,!0,t)&&i}if(a=t.b=n,i=Tn(a,r,!0,t)&&i,i=Tn(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)a=t.b=e[o],i=Tn(a,r,!1,t)&&i;return i},bn.prototype.za=function(){if(bn.qb.za.call(this),this.u){var t,e=this.u;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Ze(n[r]);delete e.a[t],e.b--}}this.Xa=null},e=Nn.prototype,e.U=function(){kn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},e.X=function(){return kn(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0},e.get=function(t,e){return Dn(this.b,t)?this.b[t]:e},e.set=function(t,e){Dn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},e.forEach=function(t,e){for(var n=this.X(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var xn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function On(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Rn(t,e){var n;this.b=this.i=this.f="",this.l=null,this.g=this.c="",this.h=!1,t instanceof Rn?(this.h=void 0!==e?e:t.h,Mn(this,t.f),this.i=t.i,this.b=t.b,Pn(this,t.l),this.c=t.c,Ln(this,er(t.a)),this.g=t.g):t&&(n=String(t).match(xn))?(this.h=!!e,Mn(this,n[1]||"",!0),this.i=Bn(n[2]||""),this.b=Bn(n[3]||"",!0),Pn(this,n[4]),this.c=Bn(n[5]||"",!0),Ln(this,n[6]||"",!0),this.g=Bn(n[7]||"")):(this.h=!!e,this.a=new Yn(null,this.h))}function Mn(t,e,n){t.f=n?Bn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Pn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.l=e}else t.l=null}function Ln(t,e,n){e instanceof Yn?(t.a=e,rr(t.a,t.h)):(n||(e=jn(e,Qn)),t.a=new Yn(e,t.h))}function Fn(t,e,n){t.a.set(e,n)}function Un(t,e){return t.a.get(e)}function qn(t){return t instanceof Rn?new Rn(t):new Rn(t,void 0)}function Vn(t,e){var n=new Rn(null,void 0);return Mn(n,"https"),t&&(n.b=t),e&&(n.c=e),n}function Bn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function jn(t,e,n){return h(t)?(t=encodeURI(t).replace(e,Wn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Wn(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)}Rn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(jn(e,Kn,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.i)&&t.push(jn(e,Kn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.l,null!=n&&t.push(":",String(n))),(n=this.c)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(jn(n,"/"==n.charAt(0)?Gn:zn,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.g)&&t.push("#",jn(n,Hn)),t.join("")},Rn.prototype.resolve=function(t){var e=new Rn(this),n=!!t.f;n?Mn(e,t.f):n=!!t.i,n?e.i=t.i:n=!!t.b,n?e.b=t.b:n=null!=t.l;var r=t.c;if(n)Pn(e,t.l);else if(n=!!t.c){if("/"!=r.charAt(0))if(this.b&&!this.c)r="/"+r;else{var i=e.c.lastIndexOf("/");-1!=i&&(r=e.c.substr(0,i+1)+r)}if(i=r,".."==i||"."==i)r="";else if(Tt(i,"./")||Tt(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.c=r:n=""!==t.a.toString(),n?Ln(e,er(t.a)):n=!!t.g,n&&(e.g=t.g),e};var Kn=/[#\/\?@]/g,zn=/[#\?:]/g,Gn=/[#\?]/g,Qn=/[#\?@]/g,Hn=/#/g;function Yn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function $n(t){t.a||(t.a=new Nn,t.b=0,t.c&&On(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Xn(t){var e=In(t);if("undefined"==typeof e)throw Error("Keys are undefined");var n=new Yn(null,void 0);t=Cn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];g(o)?tr(n,i,o):n.add(i,o)}return n}function Jn(t,e){$n(t),e=nr(t,e),Dn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,t=t.a,Dn(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&kn(t)))}function Zn(t,e){return $n(t),e=nr(t,e),Dn(t.a.b,e)}function tr(t,e,n){Jn(t,e),0<n.length&&(t.c=null,t.a.set(nr(t,e),$(n)),t.b+=n.length)}function er(t){var e=new Yn;return e.c=t.c,t.a&&(e.a=new Nn(t.a),e.b=t.b),e}function nr(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function rr(t,e){e&&!t.f&&($n(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Jn(this,e),tr(this,n,t))}),t)),t.f=e}e=Yn.prototype,e.add=function(t,e){$n(this),this.c=null,t=nr(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},e.clear=function(){this.a=this.c=null,this.b=0},e.forEach=function(t,e){$n(this),this.a.forEach((function(n,r){B(n,(function(n){t.call(e,n,r,this)}),this)}),this)},e.X=function(){$n(this);for(var t=this.a.U(),e=this.a.X(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},e.U=function(t){$n(this);var e=[];if(h(t))Zn(this,t)&&(e=Y(e,this.a.get(nr(this,t))));else{t=this.a.U();for(var n=0;n<t.length;n++)e=Y(e,t[n])}return e},e.set=function(t,e){return $n(this),this.c=null,t=nr(this,t),Zn(this,t)&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},e.get=function(t,e){return t?(t=this.U(t),0<t.length?String(t[0]):e):e},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.X(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.U(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var ir=!xe||9<=Number(Ve);function or(t){var e=document;return h(t)?e.getElementById(t):t}function ar(t,e){X(e,(function(e,n){e&&"object"==typeof e&&e.qa&&(e=e.pa()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:sr.hasOwnProperty(n)?t.setAttribute(sr[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var sr={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ur(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!ir&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Kt(a.name),'"'),a.type){o.push(' type="',Kt(a.type),'"');var s={};et(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=i.createElement(o),a&&(h(a)?o.className=a:g(a)?o.className=a.join(" "):ar(o,a)),2<r.length&&cr(i,o,r),o}function cr(t,e,n){function r(n){n&&e.appendChild(h(n)?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];!v(o)||_(o)&&0<o.nodeType?r(o):B(hr(o)?$(o):o,r)}}function hr(t){if(t&&"number"==typeof t.length){if(_(t))return"function"==typeof t.item||"string"==typeof t.item;if(b(t))return"function"==typeof t.item}return!1}function lr(t){var e=[];return pr(new fr,t,e),e.join("")}function fr(){}function pr(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(g(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),pr(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){for(r in n.push("{"),i="",e)Object.prototype.hasOwnProperty.call(e,r)&&(o=e[r],"function"!=typeof o&&(n.push(i),yr(r,n),n.push(":"),pr(t,o,n),i=","));return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":yr(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}var dr={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},mr=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function yr(t,e){e.push('"',t.replace(mr,(function(t){var e=dr[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),dr[t]=e),e})),'"')}function gr(){var t=Br();return xe&&!!Ve&&11==Ve||/Edge\/\d+/.test(t)}function vr(){return c.window&&c.window.location.href||self&&self.location&&self.location.href||""}function br(t,e){e=e||c.window;var n="about:blank";t&&(n=Ct(At(t)).toString()),e.location.href=n}function _r(t,e){var n,r=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?r.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<_r(t[n],e[n]).length&&r.push(n):t[n]!==e[n]&&r.push(n):r.push(n);for(n in e)n in t||r.push(n);return r}function wr(){var t=Br();return t=Ur(t)!=Fr?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null,!(t&&30>t)&&(!xe||!Ve||9<Ve)}function Tr(t){return t=(t||Br()).toLowerCase(),!!(t.match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function Er(t){t=t||c.window;try{t.close()}catch(e){}}function Sr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Br().toLowerCase(),r&&(e.target=r,Tt(n,"crios/")&&(e.target="_blank")),Ur(Br())==Lr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof St?n:At("undefined"!=typeof n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((Rt("iPhone")&&!Rt("iPod")&&!Rt("iPad")||Rt("iPad")||Rt("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(a=r.document.createElement("A"),q(a,"HTMLAnchorElement"),e instanceof St||e instanceof St||(e="object"==typeof e&&e.qa?e.pa():String(e),It.test(e)||(e="about:invalid#zClosurez"),e=Dt(e)),a.href=Ct(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),t=document.createEvent("MouseEvent"),t.initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=r.open("",n,a),t=Ct(e).toString(),a&&(Re&&Tt(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t=Ft('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Kt(t)+'">'),a.document.write(Pt(t)),a.document.close())):(a=r.open(Ct(e).toString(),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}function Cr(t){return new Jt((function(e){function n(){Sn(2e3).then((function(){if(t&&!t.closed)return n();e()}))}return n()}))}var Ir=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ar=/^[^@]+@[^@]+$/;function Nr(){var t=null;return new Jt((function(e){"complete"==c.document.readyState?e():(t=function(){e()},cn(window,"load",t))})).s((function(e){throw hn(window,"load",t),e}))}function kr(){return Dr(void 0)?Nr().then((function(){return new Jt((function(t,e){var n=c.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):ae(Error("Cordova must run in an Android or iOS file scheme."))}function Dr(t){return t=t||Br(),!("file:"!==Gr()&&"ionic:"!==Gr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function xr(){var t=c.window;try{return!(!t||t==t.top)}catch(e){return!1}}function Or(){return"undefined"!==typeof c.WorkerGlobalScope&&"function"===typeof c.importScripts}function Rr(){return r.a.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":r.a.INTERNAL.hasOwnProperty("node")?"Node":Or()?"Worker":"Browser"}function Mr(){var t=Rr();return"ReactNative"===t||"Node"===t}function Pr(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}var Lr="Firefox",Fr="Chrome";function Ur(t){var e=t.toLowerCase();return Tt(e,"opera/")||Tt(e,"opr/")||Tt(e,"opios/")?"Opera":Tt(e,"iemobile")?"IEMobile":Tt(e,"msie")||Tt(e,"trident/")?"IE":Tt(e,"edge/")?"Edge":Tt(e,"firefox/")?Lr:Tt(e,"silk/")?"Silk":Tt(e,"blackberry")?"Blackberry":Tt(e,"webos")?"Webos":!Tt(e,"safari/")||Tt(e,"chrome/")||Tt(e,"crios/")||Tt(e,"android")?!Tt(e,"chrome/")&&!Tt(e,"crios/")||Tt(e,"edge/")?Tt(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":Fr:"Safari"}var qr={Wc:"FirebaseCore-web",Yc:"FirebaseUI-web"};function Vr(t,e){e=e||[];var n,r=[],i={};for(n in qr)i[qr[n]]=!0;for(n=0;n<e.length;n++)"undefined"!==typeof i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),e=r,e.length||(e=["FirebaseCore-web"]),r=Rr(),"Browser"===r?(i=Br(),r=Ur(i)):"Worker"===r&&(i=Br(),r=Ur(i)+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function Br(){return c.navigator&&c.navigator.userAgent||""}function jr(t,e){t=t.split("."),e=e||c;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Wr(){try{var t=c.localStorage,e=Xr();if(t)return t.setItem(e,"1"),t.removeItem(e),!gr()||!!c.indexedDB}catch(n){return Or()&&!!c.indexedDB}return!1}function Kr(){return(zr()||"chrome-extension:"===Gr()||Dr())&&!Mr()&&Wr()&&!Or()}function zr(){return"http:"===Gr()||"https:"===Gr()}function Gr(){return c.location&&c.location.protocol||null}function Qr(t){return t=t||Br(),!Tr(t)&&Ur(t)!=Lr}function Hr(t){return"undefined"===typeof t?null:lr(t)}function Yr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function $r(t){if(null!==t)return JSON.parse(t)}function Xr(t){return t||Math.floor(1e9*Math.random()).toString()}function Jr(t){return t=t||Br(),"Safari"!=Ur(t)&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Zr(){var t=c.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function ti(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=Br(),e=Rr(),this.b=Tr(t)||"ReactNative"===e}function ei(){var t=c.document;return!t||"undefined"===typeof t.visibilityState||"visible"==t.visibilityState}function ni(){var t=c.document,e=null;return ei()||!t?oe():new Jt((function(n){e=function(){ei()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).s((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}function ri(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function ii(){return!(!jr("fireauth.oauthhelper",c)&&!jr("fireauth.iframe",c))}function oi(){var t=c.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}function ai(){var t=c.navigator;return t&&t.serviceWorker?oe().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).s((function(){return null})):oe(null)}ti.prototype.get=function(){var t=c.navigator;return!t||"boolean"!==typeof t.onLine||!zr()&&"chrome-extension:"!==Gr()&&"undefined"===typeof t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var si,ui={};function ci(t){ui[t]||(ui[t]=!0,"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn(t))}try{var hi={};Object.defineProperty(hi,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(hi,"abcd",{configurable:!0,enumerable:!0,value:2}),si=2==hi.abcd}catch(ep){si=!1}function li(t,e,n){si?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function fi(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&li(t,n,e[n])}function pi(t){var e={};return fi(e,t),e}function di(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function mi(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(void 0===r||null===r||""===r)return!1}return!0}function yi(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)li(e,n,yi(t[n]));return e}function gi(t){var e={},n=t[bi],r=t[_i];if(t=t[wi],!t||t!=vi&&!n)throw Error("Invalid provider user info!");e[Ei]=r||null,e[Ti]=n||null,li(this,Ci,t),li(this,Si,yi(e))}var vi="EMAIL_SIGNIN",bi="email",_i="newEmail",wi="requestType",Ti="email",Ei="fromEmail",Si="data",Ci="operation";function Ii(t,e){this.code=Ni+t,this.message=e||ki[t]||""}function Ai(t){var e=t&&t.code;return e?new Ii(e.substring(Ni.length),t.message):null}N(Ii,Error),Ii.prototype.A=function(){return{code:this.code,message:this.message}},Ii.prototype.toJSON=function(){return this.A()};var Ni="auth/",ki={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function Di(t){t=qn(t);var e=Un(t,xi)||null,n=Un(t,Oi)||null,r=Un(t,Pi)||null;if(r=r&&Fi[r]||null,!e||!n||!r)throw new Ii("argument-error",xi+", "+Oi+"and "+Pi+" are required in a valid action code URL.");fi(this,{apiKey:e,operation:r,code:n,continueUrl:Un(t,Ri)||null,languageCode:Un(t,Mi)||null,tenantId:Un(t,Li)||null})}var xi="apiKey",Oi="oobCode",Ri="continueUrl",Mi="languageCode",Pi="mode",Li="tenantId",Fi={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",signIn:vi,verifyEmail:"VERIFY_EMAIL"};function Ui(t){try{return new Di(t)}catch(e){return null}}function qi(t){var e=t[Ki];if("undefined"===typeof e)throw new Ii("missing-continue-uri");if("string"!==typeof e||"string"===typeof e&&!e.length)throw new Ii("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Vi];if(n&&"object"===typeof n){e=n[Qi];var r=n[zi];if(n=n[Gi],"string"===typeof e&&e.length){if(this.a=e,"undefined"!==typeof r&&"boolean"!==typeof r)throw new Ii("argument-error",zi+" property must be a boolean when specified.");if(this.g=!!r,"undefined"!==typeof n&&("string"!==typeof n||"string"===typeof n&&!n.length))throw new Ii("argument-error",Gi+" property must be a non empty string when specified.");this.b=n||null}else{if("undefined"!==typeof e)throw new Ii("argument-error",Qi+" property must be a non empty string when specified.");if("undefined"!==typeof r||"undefined"!==typeof n)throw new Ii("missing-android-pkg-name")}}else if("undefined"!==typeof n)throw new Ii("argument-error",Vi+" property must be a non null object when specified.");if(this.f=null,(e=t[Wi])&&"object"===typeof e){if(e=e[Hi],"string"===typeof e&&e.length)this.f=e;else if("undefined"!==typeof e)throw new Ii("argument-error",Hi+" property must be a non empty string when specified.")}else if("undefined"!==typeof e)throw new Ii("argument-error",Wi+" property must be a non null object when specified.");if(e=t[ji],"undefined"!==typeof e&&"boolean"!==typeof e)throw new Ii("argument-error",ji+" property must be a boolean when specified.");if(this.c=!!e,t=t[Bi],"undefined"!==typeof t&&("string"!==typeof t||"string"===typeof t&&!t.length))throw new Ii("argument-error",Bi+" property must be a non empty string when specified.");this.i=t||null}var Vi="android",Bi="dynamicLinkDomain",ji="handleCodeInApp",Wi="iOS",Ki="url",zi="installApp",Gi="minimumVersion",Qi="packageName",Hi="bundleId";function Yi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}function $i(t){return W(t,(function(t){return t=t.toString(16),1<t.length?t:"0"+t})).join("")}var Xi=null,Ji=null;function Zi(t){var e="";return to(t,(function(t){e+=String.fromCharCode(t)})),e}function to(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Ji[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}eo();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}function eo(){if(!Xi){Xi={},Ji={};for(var t=0;65>t;t++)Xi[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),Ji[Xi[t]]=t,62<=t&&(Ji["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}function no(t){this.f=t.sub,A(),this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.c=t.firebase&&t.firebase.tenant||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function ro(t){return(t=io(t))&&t.sub&&t.iss&&t.aud&&t.exp?new no(t):null}function io(t){if(!t)return null;if(t=t.split("."),3!=t.length)return null;t=t[1];for(var e=(4-t.length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(Zi(t))}catch(r){}return null}no.prototype.R=function(){return this.c},no.prototype.g=function(){return this.b};var oo,ao={bd:{cb:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://securetoken.googleapis.com/v1/token",id:"p"},dd:{cb:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},ed:{cb:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ib:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function so(t){for(var e in ao)if(ao[e].id===t)return t=ao[e],{firebaseEndpoint:t.cb,secureTokenEndpoint:t.ib};return null}oo=so("__EID__")?"__EID__":void 0;var uo="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),co=["client_id","response_type","scope","redirect_uri","state"],ho={Xc:{Ea:"locale",sa:700,ra:600,Fa:"facebook.com",Qa:co},Zc:{Ea:null,sa:500,ra:750,Fa:"github.com",Qa:co},$c:{Ea:"hl",sa:515,ra:680,Fa:"google.com",Qa:co},fd:{Ea:"lang",sa:485,ra:705,Fa:"twitter.com",Qa:uo},Vc:{Ea:"locale",sa:600,ra:600,Fa:"apple.com",Qa:[]}};function lo(t){for(var e in ho)if(ho[e].Fa==t)return ho[e];return null}function fo(t){var e={};e["facebook.com"]=vo,e["google.com"]=_o,e["github.com"]=bo,e["twitter.com"]=wo;var n=t&&t[mo];try{if(n)return e[n]?new e[n](t):new go(t);if("undefined"!==typeof t[po])return new yo(t)}catch(r){}return null}var po="idToken",mo="providerId";function yo(t){var e=t[mo];if(!e&&t[po]){var n=ro(t[po]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,"undefined"!==typeof t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),li(this,"providerId",e),li(this,"isNewUser",n)}function go(t){yo.call(this,t),t=$r(t.rawUserInfo||"{}"),li(this,"profile",yi(t||{}))}function vo(t){if(go.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function bo(t){if(go.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");li(this,"username",this.profile&&this.profile.login||null)}function _o(t){if(go.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function wo(t){if(go.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");li(this,"username",t.screenName||null)}function To(t){var e=qn(t),n=Un(e,"link"),r=Un(qn(n),"link");return e=Un(e,"deep_link_id"),Un(qn(e),"link")||e||r||n||t}function Eo(){}function So(t,e){return t.then((function(t){if(t[gs]){var n=ro(t[gs]);if(!n||e!=n.f)throw new Ii("user-mismatch");return t}throw new Ii("user-mismatch")})).s((function(t){throw t&&t.code&&t.code==Ni+"user-not-found"?new Ii("user-mismatch"):t}))}function Co(t,e){if(!e)throw new Ii("internal-error","failed to construct a credential");this.a=e,li(this,"providerId",t),li(this,"signInMethod",t)}function Io(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function Ao(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new Co(t.providerId,t.pendingToken)}catch(e){}return null}function No(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&li(this,"idToken",e.idToken),e.accessToken&&li(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&li(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new Ii("internal-error","failed to construct a credential");li(this,"accessToken",e.oauthToken),li(this,"secret",e.oauthTokenSecret)}li(this,"providerId",t),li(this,"signInMethod",n)}function ko(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Xn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function Do(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new No(t.providerId,e,t.signInMethod)}catch(n){}}return null}function xo(t,e){this.Fc=e||[],fi(this,{providerId:t,isOAuthProvider:!0}),this.zb={},this.eb=(lo(t)||{}).Ea||null,this.bb=null}function Oo(t){if("string"!==typeof t||0!=t.indexOf("saml."))throw new Ii("argument-error",'SAML provider IDs must be prefixed with "saml."');xo.call(this,t,[])}function Ro(t){xo.call(this,t,co),this.a=[]}function Mo(){Ro.call(this,"facebook.com")}function Po(t){if(!t)throw new Ii("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return _(t)&&(e=t.accessToken),(new Mo).credential({accessToken:e})}function Lo(){Ro.call(this,"github.com")}function Fo(t){if(!t)throw new Ii("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return _(t)&&(e=t.accessToken),(new Lo).credential({accessToken:e})}function Uo(){Ro.call(this,"google.com"),this.ya("profile")}function qo(t,e){var n=t;return _(t)&&(n=t.idToken,e=t.accessToken),(new Uo).credential({idToken:n,accessToken:e})}function Vo(){xo.call(this,"twitter.com",uo)}function Bo(t,e){var n=t;if(_(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new Ii("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new No("twitter.com",n,"twitter.com")}function jo(t,e,n){this.a=t,this.c=e,li(this,"providerId","password"),li(this,"signInMethod",n===Ko.EMAIL_LINK_SIGN_IN_METHOD?Ko.EMAIL_LINK_SIGN_IN_METHOD:Ko.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Wo(t){return t&&t.email&&t.password?new jo(t.email,t.password,t.signInMethod):null}function Ko(){fi(this,{providerId:"password",isOAuthProvider:!1})}function zo(t,e){if(e=Go(e),!e)throw new Ii("argument-error","Invalid email link!");return new jo(t,e.code,Ko.EMAIL_LINK_SIGN_IN_METHOD)}function Go(t){return t=To(t),(t=Ui(t))&&t.operation===vi?t:null}function Qo(t){if(!(t.Va&&t.Ua||t.Ha&&t.ba))throw new Ii("internal-error");this.a=t,li(this,"providerId","phone"),li(this,"signInMethod","phone")}function Ho(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return B(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new Qo(e)}return null}function Yo(t){return t.a.Ha&&t.a.ba?{temporaryProof:t.a.Ha,phoneNumber:t.a.ba}:{sessionInfo:t.a.Va,code:t.a.Ua}}function $o(t){try{this.a=t||r.a.auth()}catch(e){throw new Ii("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}fi(this,{providerId:"phone",isOAuthProvider:!1})}function Xo(t,e){if(!t)throw new Ii("missing-verification-id");if(!e)throw new Ii("missing-verification-code");return new Qo({Va:t,Ua:e})}function Jo(t){if(t.temporaryProof&&t.phoneNumber)return new Qo({Ha:t.temporaryProof,ba:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return qo(o,n);case"facebook.com":return Po(n);case"github.com":return Fo(n);case"twitter.com":return Bo(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new Co(e,a):new No(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new Ro(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(s){return null}}function Zo(t){if(!t.isOAuthProvider)throw new Ii("invalid-oauth-provider")}function ta(t,e,n,r,i,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new Ii("invalid-auth-event");if(this.g&&this.a)throw new Ii("invalid-auth-event");if(this.g&&!this.f)throw new Ii("invalid-auth-event")}function ea(t){return t=t||{},t.type?new ta(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&Ai(t.error),t.postBody,t.tenantId):null}function na(){this.b=null,this.a=[]}N(go,yo),N(vo,go),N(bo,go),N(_o,go),N(wo,go),Co.prototype.na=function(t){return js(t,Io(this))},Co.prototype.b=function(t,e){var n=Io(this);return n.idToken=e,Ws(t,n)},Co.prototype.f=function(t,e){return So(Ks(t,Io(this)),e)},Co.prototype.A=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},No.prototype.na=function(t){return js(t,ko(this))},No.prototype.b=function(t,e){var n=ko(this);return n.idToken=e,Ws(t,n)},No.prototype.f=function(t,e){var n=ko(this);return So(Ks(t,n),e)},No.prototype.A=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},xo.prototype.Ga=function(t){return this.zb=Z(t),this},N(Oo,xo),N(Ro,xo),Ro.prototype.ya=function(t){return G(this.a,t)||this.a.push(t),this},Ro.prototype.Hb=function(){return $(this.a)},Ro.prototype.credential=function(t,e){var n;if(n=_(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null},!n.idToken&&!n.accessToken)throw new Ii("argument-error","credential failed: must provide the ID token and/or the access token.");return new No(this.providerId,n,this.providerId)},N(Mo,Ro),li(Mo,"PROVIDER_ID","facebook.com"),li(Mo,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),N(Lo,Ro),li(Lo,"PROVIDER_ID","github.com"),li(Lo,"GITHUB_SIGN_IN_METHOD","github.com"),N(Uo,Ro),li(Uo,"PROVIDER_ID","google.com"),li(Uo,"GOOGLE_SIGN_IN_METHOD","google.com"),N(Vo,xo),li(Vo,"PROVIDER_ID","twitter.com"),li(Vo,"TWITTER_SIGN_IN_METHOD","twitter.com"),jo.prototype.na=function(t){return this.signInMethod==Ko.EMAIL_LINK_SIGN_IN_METHOD?bu(t,Js,{email:this.a,oobCode:this.c}):bu(t,mu,{email:this.a,password:this.c})},jo.prototype.b=function(t,e){return this.signInMethod==Ko.EMAIL_LINK_SIGN_IN_METHOD?bu(t,Zs,{idToken:e,email:this.a,oobCode:this.c}):bu(t,cu,{idToken:e,email:this.a,password:this.c})},jo.prototype.f=function(t,e){return So(this.na(t),e)},jo.prototype.A=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},fi(Ko,{PROVIDER_ID:"password"}),fi(Ko,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),fi(Ko,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Qo.prototype.na=function(t){return t.Wa(Yo(this))},Qo.prototype.b=function(t,e){var n=Yo(this);return n.idToken=e,bu(t,gu,n)},Qo.prototype.f=function(t,e){var n=Yo(this);return n.operation="REAUTH",t=bu(t,vu,n),So(t,e)},Qo.prototype.A=function(){var t={providerId:"phone"};return this.a.Va&&(t.verificationId=this.a.Va),this.a.Ua&&(t.verificationCode=this.a.Ua),this.a.Ha&&(t.temporaryProof=this.a.Ha),this.a.ba&&(t.phoneNumber=this.a.ba),t},$o.prototype.Wa=function(t,e){var n=this.a.b;return oe(e.verify()).then((function(r){if(!h(r))throw new Ii("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":return Fs(n,{phoneNumber:t,recaptchaToken:r}).then((function(t){return"function"===typeof e.reset&&e.reset(),t}),(function(t){throw"function"===typeof e.reset&&e.reset(),t}));default:throw new Ii("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},fi($o,{PROVIDER_ID:"phone"}),fi($o,{PHONE_SIGN_IN_METHOD:"phone"}),ta.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},ta.prototype.R=function(){return this.h},ta.prototype.A=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.A()}};var ra,ia=null;function oa(t){var e=ia;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},t=jr("universalLinks.subscribe",c),"function"===typeof t&&t(null,e.b))}function aa(t){var e="unauthorized-domain",n=void 0,r=qn(t);t=r.b,r=r.f,"chrome-extension"==r?n=Wt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=Wt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",Ii.call(this,e,n)}function sa(t,e,n){Ii.call(this,t,n),t=e||{},t.Ab&&li(this,"email",t.Ab),t.ba&&li(this,"phoneNumber",t.ba),t.credential&&li(this,"credential",t.credential),t.Qb&&li(this,"tenantId",t.Qb)}function ua(t){if(t.code){var e=t.code||"";0==e.indexOf(Ni)&&(e=e.substring(Ni.length));var n={credential:Jo(t),Qb:t.tenantId};if(t.email)n.Ab=t.email;else if(t.phoneNumber)n.ba=t.phoneNumber;else if(!n.credential)return new Ii(e,t.message||void 0);return new sa(e,n,t.message)}return null}function ca(){}function ha(t){return t.c||(t.c=t.b())}function la(){}function fa(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(i){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function pa(){}function da(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=C(this.fc,this),this.a.onerror=C(this.Ib,this),this.a.onprogress=C(this.gc,this),this.a.ontimeout=C(this.kc,this)}function ma(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function ya(t,e,n){this.reset(t,e,n,void 0,void 0)}N(aa,Ii),N(sa,Ii),sa.prototype.A=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.A();return e&&et(t,e),t},sa.prototype.toJSON=function(){return this.A()},ca.prototype.c=null,N(la,ca),la.prototype.a=function(){var t=fa(this);return t?new ActiveXObject(t):new XMLHttpRequest},la.prototype.b=function(){var t={};return fa(this)&&(t[0]=!0,t[1]=!0),t},ra=new la,N(pa,ca),pa.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new da;throw Error("Unsupported browser")},pa.prototype.b=function(){return{}},e=da.prototype,e.open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},e.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},e.fc=function(){this.status=200,this.response=this.responseText=this.a.responseText,ma(this,4)},e.Ib=function(){this.status=500,this.response=this.responseText="",ma(this,4)},e.kc=function(){this.Ib()},e.gc=function(){this.status=200,ma(this,1)},e.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},ya.prototype.a=null;function ga(t){this.f=t,this.b=this.c=this.a=null}function va(t,e){this.name=t,this.value=e}ya.prototype.reset=function(t,e,n,r,i){"number"==typeof i||0,r||A(),delete this.a},va.prototype.toString=function(){return this.name};var ba=new va("SEVERE",1e3),_a=new va("WARNING",900),wa=new va("CONFIG",700),Ta=new va("FINE",500);function Ea(t){return t.c?t.c:t.a?Ea(t.a):(O("Root logger has no level set."),null)}ga.prototype.log=function(t,e,n){if(t.value>=Ea(this).value)for(b(e)&&(e=e()),t=new ya(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var Sa={},Ca=null;function Ia(t){var e;if(Ca||(Ca=new ga(""),Sa[""]=Ca,Ca.c=wa),!(e=Sa[t])){e=new ga(t);var n=t.lastIndexOf("."),r=t.substr(n+1);n=Ia(t.substr(0,n)),n.b||(n.b={}),n.b[r]=e,e.a=n,Sa[t]=e}return e}function Aa(t,e){t&&t.log(Ta,e,void 0)}function Na(t){this.f=t}function ka(t){bn.call(this),this.o=t,this.readyState=Da,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=Ia("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}N(Na,ca),Na.prototype.a=function(){return new ka(this.f)},Na.prototype.b=function(t){return function(){return t}}({}),N(ka,bn);var Da=0;function xa(t){t.c.read().then(t.ec.bind(t)).catch(t.Oa.bind(t))}function Oa(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,Ra(t)}function Ra(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Ma(t){bn.call(this),this.headers=new Nn,this.B=t||null,this.c=!1,this.w=this.a=null,this.h=this.O=this.l="",this.f=this.J=this.i=this.I=!1,this.g=0,this.o=null,this.m=Pa,this.v=this.P=!1}e=ka.prototype,e.open=function(t,e){if(this.readyState!=Da)throw this.abort(),Error("Error reopening a connection");this.m=t,this.g=e,this.readyState=1,Ra(this)},e.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.m,credentials:void 0,cache:void 0};t&&(e.body=t),this.o.fetch(new Request(this.g,e)).then(this.jc.bind(this),this.Oa.bind(this))},e.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Oa(this,!1)),this.readyState=Da},e.jc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,Ra(this)),this.a&&(this.readyState=3,Ra(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.hc.bind(this),this.Oa.bind(this)):"undefined"!==typeof c.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,xa(this)):t.text().then(this.ic.bind(this),this.Oa.bind(this)))))},e.ec=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?Oa(this,!0):Ra(this),3==this.readyState&&xa(this)}},e.ic=function(t){this.a&&(this.response=this.responseText=t,Oa(this,!0))},e.hc=function(t){this.a&&(this.response=t,Oa(this,!0))},e.Oa=function(t){var e=this.h;e&&e.log(_a,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&Oa(this,!0)},e.setRequestHeader=function(t,e){this.i.append(t,e)},e.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(_a,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},e.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(_a,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},N(Ma,bn);var Pa="";Ma.prototype.b=Ia("goog.net.XhrIo");var La=/^https?$/i,Fa=["POST","PUT"];function Ua(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.O=n,t.I=!1,t.c=!0,t.a=t.B?t.B.a():ra.a(),t.w=t.B?ha(t.B):ha(ra),t.a.onreadystatechange=C(t.Lb,t);try{Aa(t.b,Ya(t,"Opening Xhr")),t.J=!0,t.a.open(n,String(e),!0),t.J=!1}catch(a){return Aa(t.b,Ya(t,"Error opening Xhr: "+a.message)),void Ba(t,a)}e=r||"";var o=new Nn(t.headers);i&&An(i,(function(t,e){o.set(e,t)})),i=z(o.X()),r=c.FormData&&e instanceof c.FormData,!G(Fa,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.P&&(t.a.withCredentials=t.P);try{za(t),0<t.g&&(t.v=qa(t.a),Aa(t.b,Ya(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.v)),t.v?(t.a.timeout=t.g,t.a.ontimeout=C(t.Ia,t)):t.o=En(t.Ia,t.g,t)),Aa(t.b,Ya(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(a){Aa(t.b,Ya(t,"Send error: "+a.message)),Ba(t,a)}}function qa(t){return xe&&je(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function Va(t){return"content-type"==t.toLowerCase()}function Ba(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,ja(t),Ka(t)}function ja(t){t.I||(t.I=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Wa(t){if(t.c&&"undefined"!=typeof u)if(t.w[1]&&4==Ga(t)&&2==Qa(t))Aa(t.b,Ya(t,"Local request error detected and ignored"));else if(t.i&&4==Ga(t))En(t.Lb,0,t);else if(t.dispatchEvent("readystatechange"),4==Ga(t)){Aa(t.b,Ya(t,"Request complete")),t.c=!1;try{var e,n=Qa(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(xn)[1]||null;if(!o&&c.self&&c.self.location){var a=c.self.location.protocol;o=a.substr(0,a.length-1)}i=!La.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var s=2<Ga(t)?t.a.statusText:""}catch(h){Aa(t.b,"Can not get status: "+h.message),s=""}t.h=s+" ["+Qa(t)+"]",ja(t)}}finally{Ka(t)}}}function Ka(t,e){if(t.a){za(t);var n=t.a,r=t.w[0]?d:null;t.a=null,t.w=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){(t=t.b)&&t.log(ba,"Problem encountered resetting onreadystatechange: "+i.message,void 0)}}}function za(t){t.a&&t.v&&(t.a.ontimeout=null),t.o&&(c.clearTimeout(t.o),t.o=null)}function Ga(t){return t.a?t.a.readyState:0}function Qa(t){try{return 2<Ga(t)?t.a.status:-1}catch(e){return-1}}function Ha(t){try{return t.a?t.a.responseText:""}catch(e){return Aa(t.b,"Can not get responseText: "+e.message),""}}function Ya(t,e){return e+" ["+t.O+" "+t.l+" "+Qa(t)+"]"}function $a(t){var e=cs;this.g=[],this.v=e,this.o=t||null,this.f=this.a=!1,this.c=void 0,this.u=this.w=this.i=!1,this.h=0,this.b=null,this.l=0}function Xa(t,e,n){t.a=!0,t.c=n,t.f=!e,ns(t)}function Ja(t){if(t.a){if(!t.u)throw new rs(t);t.u=!1}}function Za(t,e){ts(t,null,e,void 0)}function ts(t,e,n,r){t.g.push([e,n,r]),t.a&&ns(t)}function es(t){return K(t.g,(function(t){return b(t[1])}))}function ns(t){if(t.h&&t.a&&es(t)){var e=t.h,n=as[e];n&&(c.clearTimeout(n.a),delete as[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var s=o.call(i||t.o,e);void 0!==s&&(t.f=t.f&&(s==e||s instanceof Error),t.c=e=s),(k(e)||"function"===typeof c.Promise&&e instanceof c.Promise)&&(r=!0,t.i=!0)}catch(u){e=u,t.f=!0,es(t)||(n=!0)}}t.c=e,r&&(s=C(t.m,t,!0),r=C(t.m,t,!1),e instanceof $a?(ts(e,s,r),e.w=!0):e.then(s,r)),n&&(e=new os(e),as[e.a]=e,t.h=e.a)}function rs(){D.call(this)}function is(){D.call(this)}function os(t){this.a=c.setTimeout(C(this.c,this),0),this.b=t}e=Ma.prototype,e.Ia=function(){"undefined"!=typeof u&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Aa(this.b,Ya(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(){this.a&&this.c&&(Aa(this.b,Ya(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Ka(this))},e.za=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Ka(this,!0)),Ma.qb.za.call(this)},e.Lb=function(){this.va||(this.J||this.i||this.f?Wa(this):this.yc())},e.yc=function(){Wa(this)},e.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case Pa:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(ba,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return Aa(this.b,"Can not get response: "+e.message),null}},$a.prototype.cancel=function(t){if(this.a)this.c instanceof $a&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.v?this.v.call(this.o,this):this.u=!0,this.a||(t=new is(this),Ja(this),Xa(this,!1,t))}},$a.prototype.m=function(t,e){this.i=!1,Xa(this,t,e)},$a.prototype.then=function(t,e,n){var r,i,o=new Jt((function(t,e){r=t,i=e}));return ts(this,r,(function(t){t instanceof is?o.cancel():i(t)})),o.then(t,e,n)},$a.prototype.$goog_Thenable=!0,N(rs,D),rs.prototype.message="Deferred has already fired",rs.prototype.name="AlreadyCalledError",N(is,D),is.prototype.message="Deferred was canceled",is.prototype.name="CanceledError",os.prototype.c=function(){throw delete as[this.a],this.b};var as={};function ss(t){var e={},n=e.document||document,r=ut(t).toString(),i=document.createElement("SCRIPT"),o={Nb:i,Ia:void 0},a=new $a(o),s=null,u=null!=e.timeout?e.timeout:5e3;return 0<u&&(s=window.setTimeout((function(){hs(i,!0);var t=new ps(fs,"Timeout reached for loading script "+r);Ja(a),Xa(a,!1,t)}),u),o.Ia=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(hs(i,e.hd||!1,s),Ja(a),Xa(a,!0,null))},i.onerror=function(){hs(i,!0,s);var t=new ps(ls,"Error while loading script "+r);Ja(a),Xa(a,!1,t)},o=e.attributes||{},et(o,{type:"text/javascript",charset:"UTF-8"}),ar(i,o),jt(i,t),us(n).appendChild(i),a}function us(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}function cs(){if(this&&this.Nb){var t=this.Nb;t&&"SCRIPT"==t.tagName&&hs(t,!0,this.Ia)}}function hs(t,e,n){null!=n&&c.clearTimeout(n),t.onload=d,t.onerror=d,t.onreadystatechange=d,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var ls=0,fs=1;function ps(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),D.call(this,n),this.code=t}function ds(t){this.f=t}function ms(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.u=t.secureTokenTimeout||vs,this.g=Z(t.secureTokenHeaders||bs),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.firebaseTimeout||_s,this.a=Z(t.firebaseHeaders||ws),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==Rr(),n=c.XMLHttpRequest||n&&r.a.INTERNAL.node&&r.a.INTERNAL.node.XMLHttpRequest,!n&&!Or())throw new Ii("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,Or()?this.f=new Na(self):Mr()?this.f=new ds(n):this.f=new pa,this.b=null}N(ps,D),N(ds,ca),ds.prototype.a=function(){return new this.f},ds.prototype.b=function(){return{}};var ys,gs="idToken",vs=new ti(3e4,6e4),bs={"Content-Type":"application/x-www-form-urlencoded"},_s=new ti(3e4,6e4),ws={"Content-Type":"application/json"};function Ts(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Es(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function Ss(t,e,n,r,i,o,a){wr()||Or()?t=C(t.o,t):(ys||(ys=new Jt((function(t,e){As(t,e)}))),t=C(t.m,t)),t(e,n,r,i,o,a)}ms.prototype.R=function(){return this.b},ms.prototype.o=function(t,e,n,r,i,o){if(Or()&&("undefined"===typeof c.fetch||"undefined"===typeof c.Headers||"undefined"===typeof c.Request))throw new Ii("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new Ma(this.f);if(o){a.g=Math.max(0,o);var s=setTimeout((function(){a.dispatchEvent("timeout")}),o)}_n(a,"complete",(function(){s&&clearTimeout(s);var t=null;try{t=JSON.parse(Ha(this))||null}catch(n){t=null}e&&e(t)})),wn(a,"ready",(function(){s&&clearTimeout(s),Ie(this)})),wn(a,"timeout",(function(){s&&clearTimeout(s),Ie(this),e&&e(null)})),Ua(a,t,n,r,i)};var Cs=new nt(ot,"https://apis.google.com/js/client.js?onload=%{onload}"),Is="__fcb"+Math.floor(1e6*Math.random()).toString();function As(t,e){if(((window.gapi||{}).client||{}).request)t();else{c[Is]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};var n=ct(Cs,{onload:Is});Za(ss(n),(function(){e(Error("CORS_UNSUPPORTED"))}))}}function Ns(t,e){return new Jt((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?Ss(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(wu(t)):t.access_token&&t.refresh_token?n(t):r(new Ii("internal-error")):r(new Ii("network-request-failed"))}),"POST",Xn(e).toString(),t.g,t.u.get()):r(new Ii("internal-error"))}))}function ks(t,e,n,r,i,o){var a=qn(t.h+e);Fn(a,"key",t.c),o&&Fn(a,"cb",A().toString());var s="GET"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&Fn(a,u,r[u]);return new Jt((function(e,o){Ss(t,a.toString(),(function(t){t?t.error?o(wu(t,i||{})):e(t):o(new Ii("network-request-failed"))}),n,s?void 0:lr(Yr(r)),t.a,t.i.get())}))}function Ds(t){if(t=t.email,!h(t)||!Ar.test(t))throw new Ii("invalid-email")}function xs(t){"email"in t&&Ds(t)}function Os(t,e){return bu(t,Ys,{identifier:e,continueUri:zr()?vr():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}function Rs(t){return bu(t,iu,{}).then((function(t){return t.authorizedDomains||[]}))}function Ms(t){if(!t[gs])throw new Ii("internal-error")}function Ps(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new Ii("internal-error")}else{if(!t.sessionInfo)throw new Ii("missing-verification-id");if(!t.code)throw new Ii("missing-verification-code")}}ms.prototype.m=function(t,e,n,r,i){var o=this;ys.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})})).s((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},ms.prototype.ob=function(){return bu(this,hu,{})},ms.prototype.rb=function(t,e){return bu(this,uu,{idToken:t,email:e})},ms.prototype.sb=function(t,e){return bu(this,cu,{idToken:t,password:e})};var Ls={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function Fs(t,e){return bu(t,su,e)}function Us(t,e,n){return bu(t,Xs,{idToken:e,deleteProvider:n})}function qs(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new Ii("internal-error")}function Vs(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(t=new Yn(t.postBody),Zn(t,"nonce")&&(e.nonce=t.get("nonce")))),e}function Bs(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=ua(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=ua(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=ua(t)):t.errorMessage&&(e=_u(t.errorMessage)),e)throw e;if(!t[gs])throw new Ii("internal-error")}function js(t,e){return e.returnIdpCredential=!0,bu(t,lu,e)}function Ws(t,e){return e.returnIdpCredential=!0,bu(t,pu,e)}function Ks(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,bu(t,fu,e)}function zs(t){if(!t.oobCode)throw new Ii("invalid-action-code")}e=ms.prototype,e.tb=function(t,e){var n={idToken:t},r=[];return X(Ls,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),bu(this,uu,n)},e.kb=function(t,e){return t={requestType:"PASSWORD_RESET",email:t},et(t,e),bu(this,ru,t)},e.lb=function(t,e){return t={requestType:"EMAIL_SIGNIN",email:t},et(t,e),bu(this,eu,t)},e.jb=function(t,e){return t={requestType:"VERIFY_EMAIL",idToken:t},et(t,e),bu(this,nu,t)},e.Wa=function(t){return bu(this,yu,t)},e.ab=function(t,e){return bu(this,au,{oobCode:t,newPassword:e})},e.Ma=function(t){return bu(this,Qs,{oobCode:t})},e.Ya=function(t){return bu(this,Gs,{oobCode:t})};var Gs={endpoint:"setAccountInfo",D:zs,fa:"email",F:!0},Qs={endpoint:"resetPassword",D:zs,K:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e)throw new Ii("internal-error")},F:!0},Hs={endpoint:"signupNewUser",D:function(t){if(Ds(t),!t.password)throw new Ii("weak-password")},K:Ms,T:!0,F:!0},Ys={endpoint:"createAuthUri",F:!0},$s={endpoint:"deleteAccount",V:["idToken"]},Xs={endpoint:"setAccountInfo",V:["idToken","deleteProvider"],D:function(t){if(!g(t.deleteProvider))throw new Ii("internal-error")}},Js={endpoint:"emailLinkSignin",V:["email","oobCode"],D:Ds,K:Ms,T:!0,F:!0},Zs={endpoint:"emailLinkSignin",V:["idToken","email","oobCode"],D:Ds,K:Ms,T:!0},tu={endpoint:"getAccountInfo"},eu={endpoint:"getOobConfirmationCode",V:["requestType"],D:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new Ii("internal-error");Ds(t)},fa:"email",F:!0},nu={endpoint:"getOobConfirmationCode",V:["idToken","requestType"],D:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new Ii("internal-error")},fa:"email",F:!0},ru={endpoint:"getOobConfirmationCode",V:["requestType"],D:function(t){if("PASSWORD_RESET"!=t.requestType)throw new Ii("internal-error");Ds(t)},fa:"email",F:!0},iu={wb:!0,endpoint:"getProjectConfig",Kb:"GET"},ou={wb:!0,endpoint:"getRecaptchaParam",Kb:"GET",K:function(t){if(!t.recaptchaSiteKey)throw new Ii("internal-error")}},au={endpoint:"resetPassword",D:zs,fa:"email",F:!0},su={endpoint:"sendVerificationCode",V:["phoneNumber","recaptchaToken"],fa:"sessionInfo",F:!0},uu={endpoint:"setAccountInfo",V:["idToken"],D:xs,T:!0},cu={endpoint:"setAccountInfo",V:["idToken"],D:function(t){if(xs(t),!t.password)throw new Ii("weak-password")},K:Ms,T:!0},hu={endpoint:"signupNewUser",K:Ms,T:!0,F:!0},lu={endpoint:"verifyAssertion",D:qs,Ra:Vs,K:Bs,T:!0,F:!0},fu={endpoint:"verifyAssertion",D:qs,Ra:Vs,K:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new Ii("user-not-found");if(t.errorMessage)throw _u(t.errorMessage);if(!t[gs])throw new Ii("internal-error")},T:!0,F:!0},pu={endpoint:"verifyAssertion",D:function(t){if(qs(t),!t.idToken)throw new Ii("internal-error")},Ra:Vs,K:Bs,T:!0},du={endpoint:"verifyCustomToken",D:function(t){if(!t.token)throw new Ii("invalid-custom-token")},K:Ms,T:!0,F:!0},mu={endpoint:"verifyPassword",D:function(t){if(Ds(t),!t.password)throw new Ii("wrong-password")},K:Ms,T:!0,F:!0},yu={endpoint:"verifyPhoneNumber",D:Ps,K:Ms,F:!0},gu={endpoint:"verifyPhoneNumber",D:function(t){if(!t.idToken)throw new Ii("internal-error");Ps(t)},K:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",ua(t);Ms(t)}},vu={Yb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",D:Ps,K:Ms,F:!0};function bu(t,e,n){if(!mi(n,e.V))return ae(new Ii("internal-error"));var r,i=e.Kb||"POST";return oe(n).then(e.D).then((function(){return e.T&&(n.returnSecureToken=!0),e.F&&t.b&&"undefined"===typeof n.tenantId&&(n.tenantId=t.b),ks(t,e.endpoint,i,n,e.Yb,e.wb||!1)})).then((function(t){return r=t,e.Ra?e.Ra(n,r):r})).then(e.K).then((function(){if(!e.fa)return r;if(!(e.fa in r))throw new Ii("internal-error");return r[e.fa]}))}function _u(t){return wu({error:{errors:[{message:t}],code:400,message:t}})}function wu(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new Ii(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation"},et(r,e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new Ii(r[i],e);return!e&&t&&(e=Hr(t)),new Ii("internal-error",e)}function Tu(t){this.b=t,this.a=null,this.gb=Eu(this)}function Eu(t){return Du().then((function(){return new Jt((function(e,n){jr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:jr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),Nu.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}function Su(t,e){return t.gb.then((function(){return new Jt((function(n){t.a.send(e.type,e,n,jr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}function Cu(t,e){t.gb.then((function(){t.a.register("authEvent",e,jr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}var Iu=new nt(ot,"https://apis.google.com/js/api.js?onload=%{onload}"),Au=new ti(3e4,6e4),Nu=new ti(5e3,15e3),ku=null;function Du(){return ku||(ku=new Jt((function(t,e){function n(){Zr(),jr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Zr(),e(Error("Network Error"))},timeout:Au.get()})}if(jr("gapi.iframes.Iframe"))t();else if(jr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();c[r]=function(){jr("gapi.load")?n():e(Error("Network Error"))},r=ct(Iu,{onload:r}),oe(ss(r)).s((function(){e(Error("Network Error"))}))}})).s((function(t){throw ku=null,t})))}function xu(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=Vn(this.i,"/__/auth/iframe"),Fn(this.a,"apiKey",this.g),Fn(this.a,"appName",this.h),this.b=null,this.c=[]}function Ou(t,e,n,r,i){this.o=t,this.m=e,this.c=n,this.u=r,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function Ru(t){try{return r.a.app(t).auth().Ca()}catch(e){return[]}}function Mu(t,e,n,r,i){this.u=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.m=this.o=this.v=null,this.g=[],this.l=this.a=null}function Pu(t){var e=vr();return Rs(t).then((function(t){t:{var n=qn(e),r=n.f;n=n.b;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=qn(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:Ir.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new aa(vr())}))}function Lu(t){return t.l?t.l:(t.l=Nr().then((function(){if(!t.o){var e=t.c,n=t.h,r=Ru(t.b),i=new xu(t.u,t.f,t.b);i.f=e,i.b=n,i.c=$(r||[]),t.o=i.toString()}t.i=new Tu(t.o),qu(t)})),t.l)}function Fu(t){return t.m||(t.v=t.c?Vr(t.c,Ru(t.b)):null,t.m=new ms(t.f,so(t.h),t.v)),t.m}function Uu(t,e,n,r,i,o,a,s,u,c,h){return t=new Ou(t,e,n,r,i),t.l=o,t.g=a,t.i=s,t.b=Z(u||null),t.f=c,t.nb(h).toString()}function qu(t){if(!t.i)throw Error("IfcHandler must be initialized!");Cu(t.i,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=ea(e.authEvent),n=0;n<t.g.length;n++)r=t.g[n](e)||r;return n={},n.status=r?"ACK":"ERROR",oe(n)}return n.status="ERROR",oe(n)}))}function Vu(t){var e={type:"webStorageSupport"};return Lu(t).then((function(){return Su(t.i,e)})).then((function(t){if(t&&t.length&&"undefined"!==typeof t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))}function Bu(t){if(this.a=t||r.a.INTERNAL.reactNative&&r.a.INTERNAL.reactNative.AsyncStorage,!this.a)throw new Ii("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function ju(t){this.b=t,this.a={},this.f=C(this.c,this)}xu.prototype.toString=function(){return this.f?Fn(this.a,"v",this.f):Jn(this.a.a,"v"),this.b?Fn(this.a,"eid",this.b):Jn(this.a.a,"eid"),this.c.length?Fn(this.a,"fw",this.c.join(",")):Jn(this.a.a,"fw"),this.a.toString()},Ou.prototype.nb=function(t){return this.h=t,this},Ou.prototype.toString=function(){var t=Vn(this.o,"/__/auth/handler");if(Fn(t,"apiKey",this.m),Fn(t,"appName",this.c),Fn(t,"authType",this.u),this.a.isOAuthProvider){var e=this.a;try{var n=r.a.app(this.c).auth().ha()}catch(u){n=null}for(var i in e.bb=n,Fn(t,"providerId",this.a.providerId),e=this.a,n=Yr(e.zb),n)n[i]=n[i].toString();i=e.Fc,n=Z(n);for(var o=0;o<i.length;o++){var a=i[o];a in n&&delete n[a]}e.eb&&e.bb&&!n[e.eb]&&(n[e.eb]=e.bb),J(n)||Fn(t,"customParameters",Hr(n))}if("function"===typeof this.a.Hb&&(e=this.a.Hb(),e.length&&Fn(t,"scopes",e.join(","))),this.l?Fn(t,"redirectUrl",this.l):Jn(t.a,"redirectUrl"),this.g?Fn(t,"eventId",this.g):Jn(t.a,"eventId"),this.i?Fn(t,"v",this.i):Jn(t.a,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!Un(t,s)&&Fn(t,s,this.b[s]);return this.h?Fn(t,"tid",this.h):Jn(t.a,"tid"),this.f?Fn(t,"eid",this.f):Jn(t.a,"eid"),s=Ru(this.c),s.length&&Fn(t,"fw",s.join(",")),t.toString()},e=Mu.prototype,e.Fb=function(t,e,n){var r=new Ii("popup-closed-by-user"),i=new Ii("web-storage-unsupported"),o=this,a=!1;return this.ia().then((function(){Vu(o).then((function(n){n||(t&&Er(t),e(i),a=!0)}))})).s((function(){})).then((function(){if(!a)return Cr(t)})).then((function(){if(!a)return Sn(n).then((function(){e(r)}))}))},e.Ob=function(){var t=Br();return!Qr(t)&&!Jr(t)},e.Jb=function(){return!1},e.Db=function(t,e,n,r,i,o,a,s){if(!t)return ae(new Ii("popup-blocked"));if(a&&!Qr())return this.ia().s((function(e){Er(t),i(e)})),r(),oe();this.a||(this.a=Pu(Fu(this)));var u=this;return this.a.then((function(){var e=u.ia().s((function(e){throw Er(t),i(e),e}));return r(),e})).then((function(){if(Zo(n),!a){var r=Uu(u.u,u.f,u.b,e,n,null,o,u.c,void 0,u.h,s);br(r,t)}})).s((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},e.Eb=function(t,e,n,r){this.a||(this.a=Pu(Fu(this)));var i=this;return this.a.then((function(){Zo(e);var o=Uu(i.u,i.f,i.b,t,e,vr(),n,i.c,void 0,i.h,r);br(o)})).s((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},e.ia=function(){var t=this;return Lu(this).then((function(){return t.i.gb})).s((function(){throw t.a=null,new Ii("network-request-failed")}))},e.Rb=function(){return!0},e.Aa=function(t){this.g.push(t)},e.Na=function(t){H(this.g,(function(e){return e==t}))},e=Bu.prototype,e.get=function(t){return oe(this.a.getItem(t)).then((function(t){return t&&$r(t)}))},e.set=function(t,e){return oe(this.a.setItem(t,Hr(e)))},e.S=function(t){return oe(this.a.removeItem(t))},e.$=function(){},e.ea=function(){};var Wu,Ku=[];function zu(){var t=Or()?self:null;if(B(Ku,(function(n){n.b==t&&(e=n)})),!e){var e=new ju(t);Ku.push(e)}return e}function Gu(t,e,n){J(t.a)&&t.b.addEventListener("message",t.f),"undefined"===typeof t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function Qu(t){this.a=t}function Hu(t){this.c=t,this.b=!1,this.a=[]}function Yu(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return ae(Error("connection_unavailable"));var h=r?800:50,l="undefined"!==typeof MessageChannel?new MessageChannel:null;return new Jt((function(n,r){l?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),h),o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(s),"undefined"!==typeof t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))},c={messageChannel:l,onMessage:o},t.a.push(c),l.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[l.port2])):r(Error("connection_unavailable"))})).then((function(e){return $u(t,c),e})).s((function(e){throw $u(t,c),e}))}function $u(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),H(t.a,(function(t){return t==e}))}}function Xu(){if(!ec())throw new Ii("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.u=c.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.o=!1,this.h=null;var t=this;Or()&&self?(this.l=zu(),Gu(this.l,"keyChanged",(function(e,n){return ac(t).then((function(e){return 0<e.length&&B(t.a,(function(t){t(e)})),{keyProcessed:G(e,n.key)}}))})),Gu(this.l,"ping",(function(){return oe(["keyChanged"])}))):ai().then((function(e){(t.h=e)&&(t.g=new Hu(new Qu(e)),Yu(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&G(e[0].value,"keyChanged")&&(t.o=!0)})).s((function(){})))}))}function Ju(t){return new Jt((function(e,n){var r=t.u.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}function Zu(t){return new Jt((function(e,n){var r=t.u.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(e){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},r.onsuccess=function(r){r=r.target.result,r.objectStoreNames.contains("firebaseLocalStorage")?e(r):Ju(t).then((function(){return Zu(t)})).then((function(t){e(t)})).s((function(t){n(t)}))}}))}function tc(t){return t.m||(t.m=Zu(t)),t.m}function ec(){try{return!!c.indexedDB}catch(ep){return!1}}function nc(t){return t.objectStore("firebaseLocalStorage")}function rc(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function ic(t){return new Jt((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function oc(t,e){return t.g&&t.h&&oi()===t.h?Yu(t.g,"keyChanged",{key:e},t.o).then((function(){})).s((function(){})):oe()}function ac(t){return tc(t).then((function(t){var e=nc(rc(t,!1));return e.getAll?ic(e.getAll()):new Jt((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e["continue"]()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=_r(t.c,n),t.c=n}return r}))}function sc(t){function e(){t.f=setTimeout((function(){t.i=ac(t).then((function(e){0<e.length&&B(t.a,(function(t){t(e)}))})).then((function(){e()})).s((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}uc(t),e()}function uc(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function cc(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=oe().then((function(){if(ec()){var t=Xr(),r="__sak"+t;return Wu||(Wu=new Xu),n=Wu,n.set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.S(r)})).then((function(){return n})).s((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.$((function(t){B(e.a,(function(e){e(t)}))})),t}))}function hc(){this.a={},this.type="inMemory"}function lc(){if(!pc()){if("Node"==Rr())throw new Ii("internal-error","The LocalStorage compatibility library was not found.");throw new Ii("web-storage-unsupported")}this.a=fc()||r.a.INTERNAL.node.localStorage,this.type="localStorage"}function fc(){try{var t=c.localStorage,e=Xr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function pc(){var t="Node"==Rr();if(t=fc()||t&&r.a.INTERNAL.node&&r.a.INTERNAL.node.localStorage,!t)return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}function dc(){this.type="nullStorage"}function mc(){if(!gc()){if("Node"==Rr())throw new Ii("internal-error","The SessionStorage compatibility library was not found.");throw new Ii("web-storage-unsupported")}this.a=yc()||r.a.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function yc(){try{var t=c.sessionStorage,e=Xr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function gc(){var t="Node"==Rr();if(t=yc()||t&&r.a.INTERNAL.node&&r.a.INTERNAL.node.sessionStorage,!t)return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}function vc(){var t={};t.Browser=wc,t.Node=Tc,t.ReactNative=Ec,t.Worker=Sc,this.a=t[Rr()]}ju.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];B(r,(function(e){i.push(oe().then((function(){return e(t.origin,t.data.data)})))})),ce(i).then((function(r){var i=[];B(r,(function(t){i.push({fulfilled:t.Gb,value:t.value,reason:t.reason?t.reason.message:void 0})})),B(i,(function(t){for(var e in t)"undefined"===typeof t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},Qu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Hu.prototype.close=function(){for(;0<this.a.length;)$u(this,this.a[0]);this.b=!0},e=Xu.prototype,e.set=function(t,e){var n,r=!1,i=this;return tc(this).then((function(e){return n=e,e=nc(rc(n,!0)),ic(e.get(t))})).then((function(o){var a=nc(rc(n,!0));return o?(o.value=e,ic(a.put(o))):(i.b++,r=!0,o={},o.fbase_key=t,o.value=e,ic(a.add(o)))})).then((function(){return i.c[t]=e,oc(i,t)})).ka((function(){r&&i.b--}))},e.get=function(t){return tc(this).then((function(e){return ic(nc(rc(e,!1)).get(t))})).then((function(t){return t&&t.value}))},e.S=function(t){var e=!1,n=this;return tc(this).then((function(r){return e=!0,n.b++,ic(nc(rc(r,!0))["delete"](t))})).then((function(){return delete n.c[t],oc(n,t)})).ka((function(){e&&n.b--}))},e.$=function(t){0==this.a.length&&sc(this),this.a.push(t)},e.ea=function(t){H(this.a,(function(e){return e==t})),0==this.a.length&&uc(this)},e=cc.prototype,e.get=function(t){return this.b.then((function(e){return e.get(t)}))},e.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},e.S=function(t){return this.b.then((function(e){return e.S(t)}))},e.$=function(t){this.a.push(t)},e.ea=function(t){H(this.a,(function(e){return e==t}))},e=hc.prototype,e.get=function(t){return oe(this.a[t])},e.set=function(t,e){return this.a[t]=e,oe()},e.S=function(t){return delete this.a[t],oe()},e.$=function(){},e.ea=function(){},e=lc.prototype,e.get=function(t){var e=this;return oe().then((function(){var n=e.a.getItem(t);return $r(n)}))},e.set=function(t,e){var n=this;return oe().then((function(){var r=Hr(e);null===r?n.S(t):n.a.setItem(t,r)}))},e.S=function(t){var e=this;return oe().then((function(){e.a.removeItem(t)}))},e.$=function(t){c.window&&an(c.window,"storage",t)},e.ea=function(t){c.window&&hn(c.window,"storage",t)},e=dc.prototype,e.get=function(){return oe(null)},e.set=function(){return oe()},e.S=function(){return oe()},e.$=function(){},e.ea=function(){},e=mc.prototype,e.get=function(t){var e=this;return oe().then((function(){var n=e.a.getItem(t);return $r(n)}))},e.set=function(t,e){var n=this;return oe().then((function(){var r=Hr(e);null===r?n.S(t):n.a.setItem(t,r)}))},e.S=function(t){var e=this;return oe().then((function(){e.a.removeItem(t)}))},e.$=function(){},e.ea=function(){};var bc,_c,wc={C:lc,Ta:mc},Tc={C:lc,Ta:mc},Ec={C:Bu,Ta:dc},Sc={C:lc,Ta:dc},Cc={ad:"local",NONE:"none",cd:"session"};function Ic(t){var e=new Ii("invalid-persistence-type"),n=new Ii("unsupported-persistence-type");t:{for(r in Cc)if(Cc[r]==t){var r=!0;break t}r=!1}if(!r||"string"!==typeof t)throw e;switch(Rr()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!Wr()&&"none"!==t)throw n}}function Ac(){var t=!(Jr(Br())||!xr()),e=Qr(),n=Wr();this.m=t,this.h=e,this.l=n,this.a={},bc||(bc=new vc),t=bc;try{this.g=!gr()&&ii()||!c.indexedDB?new t.a.C:new cc(Or()?new hc:new t.a.C)}catch(r){this.g=new hc,this.h=!0}try{this.i=new t.a.Ta}catch(r){this.i=new hc}this.u=new hc,this.f=C(this.Pb,this),this.b={}}function Nc(){return _c||(_c=new Ac),_c}function kc(t,e){switch(e){case"session":return t.i;case"none":return t.u;default:return t.g}}function Dc(t,e){return"firebase:"+t.name+(e?":"+e:"")}function xc(t,e,n){var r=Dc(e,n),i=kc(t,e.C);return t.get(e,n).then((function(o){var a=null;try{a=$r(c.localStorage.getItem(r))}catch(s){}if(a&&!o)return c.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&c.localStorage.removeItem(r)}))}function Oc(t,e,n){return n=Dc(e,n),"local"==e.C&&(t.b[n]=null),kc(t,e.C).S(n)}function Rc(t){Mc(t),t.c=setInterval((function(){for(var e in t.a){var n=c.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new He({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Pb(n))}}),1e3)}function Mc(t){t.c&&(clearInterval(t.c),t.c=null)}function Pc(t){this.a=t,this.b=Nc()}e=Ac.prototype,e.get=function(t,e){return kc(this,t.C).get(Dc(t,e))},e.set=function(t,e,n){var r=Dc(t,n),i=this,o=kc(this,t.C);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.C&&(i.b[r]=e)}))},e.addListener=function(t,e,n){t=Dc(t,e),this.l&&(this.b[t]=c.localStorage.getItem(t)),J(this.a)&&(kc(this,"local").$(this.f),this.h||(gr()||!ii())&&c.indexedDB||!this.l||Rc(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},e.removeListener=function(t,e,n){t=Dc(t,e),this.a[t]&&(H(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),J(this.a)&&(kc(this,"local").ea(this.f),Mc(this))},e.Pb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];"undefined"===typeof r&&(r=null);var i=c.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.$a(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if("undefined"!==typeof t.a.a?kc(this,"local").ea(this.f):Mc(this),this.m)if(n=c.localStorage.getItem(e),r=t.a.newValue,r!==n)null!==r?c.localStorage.setItem(e,r):c.localStorage.removeItem(e);else if(this.b[e]===r&&"undefined"===typeof t.a.a)return;var o=this;n=function(){"undefined"===typeof t.a.a&&o.b[e]===c.localStorage.getItem(e)||(o.b[e]=c.localStorage.getItem(e),o.$a(e))},xe&&Ve&&10==Ve&&c.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else B(t,C(this.$a,this))},e.$a=function(t){this.a[t]&&B(this.a[t],(function(t){t()}))};var Lc,Fc={name:"authEvent",C:"local"};function Uc(t){return t.b.get(Fc,t.a).then((function(t){return ea(t)}))}function qc(){this.a=Nc()}function Vc(){this.b=-1}function Bc(t,e){this.b=jc,this.f=c.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=c.Int32Array?new Int32Array(64):Array(64),void 0!==Lc||(Lc=c.Int32Array?new Int32Array(Yc):Yc),this.reset()}N(Bc,Vc);for(var jc=64,Wc=jc-1,Kc=[],zc=0;zc<Wc;zc++)Kc[zc]=0;var Gc=Y(128,Kc);function Qc(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=c&h^~c&l,o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0,a=a+(0|Lc[e])|0,a=o+(a+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function Hc(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if(h(e))for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(Qc(t),i=0);else{if(!v(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(Qc(t),i=0)}}t.c=i,t.g+=n}Bc.prototype.reset=function(){this.g=this.c=0,this.a=c.Int32Array?new Int32Array(this.h):$(this.h)};var Yc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function $c(){Bc.call(this,8,Xc)}N($c,Bc);var Xc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Jc(t,e,n,r,i){this.u=t,this.i=e,this.l=n,this.m=r||null,this.o=i||null,this.h=e+":"+n,this.v=new qc,this.g=new Pc(this.h),this.f=null,this.b=[],this.a=this.c=null}function Zc(t){return new Ii("invalid-cordova-configuration",t)}function th(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}function eh(t){var e=new $c;Hc(e,t),t=[];var n=8*e.g;56>e.c?Hc(e,Gc,56-e.c):Hc(e,Gc,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(Qc(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return $i(t)}function nh(t,e,n,r,i){var o=th(),a=new ta(e,r,null,o,new Ii("no-auth-event"),null,i),s=jr("BuildInfo.packageName",c);if("string"!==typeof s)throw new Ii("invalid-cordova-configuration");var u=jr("BuildInfo.displayName",c),h={};if(Br().toLowerCase().match(/iphone|ipad|ipod/))h.ibi=s;else{if(!Br().toLowerCase().match(/android/))return ae(new Ii("operation-not-supported-in-this-environment"));h.apn=s}u&&(h.appDisplayName=u),o=eh(o),h.sessionId=o;var l=Uu(t.u,t.i,t.l,e,n,null,r,t.m,h,t.o,i);return t.ia().then((function(){var e=t.h;return t.v.a.set(Fc,a.A(),e)})).then((function(){var e=jr("cordova.plugins.browsertab.isAvailable",c);if("function"!==typeof e)throw new Ii("invalid-cordova-configuration");var n=null;e((function(e){if(e){if(n=jr("cordova.plugins.browsertab.openUrl",c),"function"!==typeof n)throw new Ii("invalid-cordova-configuration");n(l)}else{if(n=jr("cordova.InAppBrowser.open",c),"function"!==typeof n)throw new Ii("invalid-cordova-configuration");e=Br(),t.a=n(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}function rh(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(r){}}function ih(t){return t.f||(t.f=t.ia().then((function(){return new Jt((function(e){function n(r){return e(r),t.Na(n),!1}t.Aa(n),ah(t)}))}))),t.f}function oh(t){var e=null;return Uc(t.g).then((function(n){return e=n,n=t.g,Oc(n.b,Fc,n.a)})).then((function(){return e}))}function ah(t){function e(e){r=!0,i&&i.cancel(),oh(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;i=To(e.url),-1!=i.indexOf("/__/auth/callback")&&(o=qn(i),o=$r(Un(o,"firebaseError")||null),o=(o="object"===typeof o?Ai(o):null)?new ta(r.c,r.b,null,null,o,null,r.R()):new ta(r.c,r.b,i,r.f,null,null,r.R())),i=o||n}rh(t,i)}))}var n=new ta("unknown",null,null,null,new Ii("no-auth-event")),r=!1,i=Sn(500).then((function(){return oh(t).then((function(){r||rh(t,n)}))})),o=c.handleOpenURL;c.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(jr("BuildInfo.packageName",c).toLowerCase()+"://")&&e({url:t}),"function"===typeof o)try{o(t)}catch(n){console.error(n)}},ia||(ia=new na),oa(e)}function sh(t){this.a=t,this.b=Nc()}e=Jc.prototype,e.ia=function(){return this.Da?this.Da:this.Da=kr().then((function(){if("function"!==typeof jr("universalLinks.subscribe",c))throw Zc("cordova-universal-links-plugin-fix is not installed");if("undefined"===typeof jr("BuildInfo.packageName",c))throw Zc("cordova-plugin-buildinfo is not installed");if("function"!==typeof jr("cordova.plugins.browsertab.openUrl",c))throw Zc("cordova-plugin-browsertab is not installed");if("function"!==typeof jr("cordova.InAppBrowser.open",c))throw Zc("cordova-plugin-inappbrowser is not installed")}),(function(){throw new Ii("cordova-not-ready")}))},e.Fb=function(t,e){return e(new Ii("operation-not-supported-in-this-environment")),oe()},e.Db=function(){return ae(new Ii("operation-not-supported-in-this-environment"))},e.Rb=function(){return!1},e.Ob=function(){return!0},e.Jb=function(){return!0},e.Eb=function(t,e,n,r){if(this.c)return ae(new Ii("redirect-operation-pending"));var i=this,o=c.document,a=null,s=null,u=null,h=null;return this.c=oe().then((function(){return Zo(e),ih(i)})).then((function(){return nh(i,t,e,n,r)})).then((function(){return new Jt((function(t,e){s=function(){var e=jr("cordova.plugins.browsertab.close",c);return t(),"function"===typeof e&&e(),i.a&&"function"===typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Aa(s),u=function(){a||(a=Sn(2e3).then((function(){e(new Ii("redirect-cancelled-by-user"))})))},h=function(){ei()&&u()},o.addEventListener("resume",u,!1),Br().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",h,!1)})).s((function(t){return oh(i).then((function(){throw t}))}))})).ka((function(){u&&o.removeEventListener("resume",u,!1),h&&o.removeEventListener("visibilitychange",h,!1),a&&a.cancel(),s&&i.Na(s),i.c=null}))},e.Aa=function(t){this.b.push(t),ih(this).s((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new ta("unknown",null,null,null,new Ii("no-auth-event")),t(e))}))},e.Na=function(t){H(this.b,(function(e){return e==t}))};var uh={name:"pendingRedirect",C:"session"};function ch(t){return t.b.set(uh,"pending",t.a)}function hh(t){return Oc(t.b,uh,t.a)}function lh(t){return t.b.get(uh,t.a).then((function(t){return"pending"==t}))}function fh(t,e,n){this.i={},this.v=0,this.B=t,this.u=e,this.m=n,this.h=[],this.f=!1,this.l=C(this.o,this),this.b=new Ih,this.w=new Mh,this.g=new sh(this.u+":"+this.m),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.w,this.c.linkViaPopup=this.w,this.c.reauthViaPopup=this.w,this.a=ph(this.B,this.u,this.m,oo)}function ph(t,e,n,i){var o=r.a.SDK_VERSION||null;return Dr()?new Jc(t,e,n,o,i):new Mu(t,e,n,o,i)}function dh(t){t.f||(t.f=!0,t.a.Aa(t.l));var e=t.a;return t.a.ia().s((function(n){throw t.a==e&&t.reset(),n}))}function mh(t){t.a.Ob()&&dh(t).s((function(e){var n=new ta("unknown",null,null,null,new Ii("operation-not-supported-in-this-environment"));wh(e)&&t.o(n)})),t.a.Jb()||Ah(t.b)}function yh(t,e){G(t.h,e)||t.h.push(e),t.f||lh(t.g).then((function(e){e?hh(t.g).then((function(){dh(t).s((function(e){var n=new ta("unknown",null,null,null,new Ii("operation-not-supported-in-this-environment"));wh(e)&&t.o(n)}))})):mh(t)})).s((function(){mh(t)}))}function gh(t,e){H(t.h,(function(t){return t==e}))}fh.prototype.reset=function(){this.f=!1,this.a.Na(this.l),this.a=ph(this.B,this.u,this.m),this.i={}},fh.prototype.o=function(t){if(!t)throw new Ii("invalid-auth-event");if(6e5<=A()-this.v&&(this.i={},this.v=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.xb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.v=A())),e=!0;break}}return Ah(this.b),e};var vh=new ti(2e3,1e4),bh=new ti(3e4,6e4);function _h(t,e,n,r,i,o,a){return t.a.Db(e,n,r,(function(){t.f||(t.f=!0,t.a.Aa(t.l))}),(function(){t.reset()}),i,o,a)}function wh(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Th(t,e,n,r,i){var o;return ch(t.g).then((function(){return t.a.Eb(e,n,r,i).s((function(e){if(wh(e))throw new Ii("operation-not-supported-in-this-environment");return o=e,hh(t.g).then((function(){throw o}))})).then((function(){return t.a.Rb()?new Jt((function(){})):hh(t.g).then((function(){return t.oa()})).then((function(){})).s((function(){}))}))}))}function Eh(t,e,n,r,i){return t.a.Fb(r,(function(t){e.ja(n,null,t,i)}),vh.get())}fh.prototype.oa=function(){return this.b.oa()};var Sh={};function Ch(t,e,n){var r=e+":"+n;return Sh[r]||(Sh[r]=new fh(t,e,n)),Sh[r]}function Ih(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Ah(t){t.g||(t.g=!0,Oh(t,!1,null,null))}function Nh(t){t.g&&!t.i&&Oh(t,!1,null,null)}function kh(t,e,n){n=n.Ba(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.R(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then((function(e){Oh(t,s,e,null)})).s((function(e){Oh(t,s,null,e)}))}function Dh(t,e){if(t.b=function(){return ae(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}function xh(t,e){if(t.b=function(){return oe(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Oh(t,e,n,r){e?r?Dh(t,r):xh(t,n):xh(t,{user:null}),t.f=[],t.c=[]}function Rh(t){var e=new Ii("timeout");t.a&&t.a.cancel(),t.a=Sn(bh.get()).then((function(){t.b||(t.g=!0,Oh(t,!0,null,e))}))}function Mh(){}function Ph(t,e){var n=t.b,r=t.c;e.Ba(r,n)(t.g,t.f,t.R(),t.i).then((function(t){e.ja(r,t,null,n)})).s((function(t){e.ja(r,null,t,n)}))}function Lh(){this.vb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.vb},set:function(t){this.vb=t},enumerable:!1})}function Fh(t,e){this.a=e,li(this,"verificationId",t)}function Uh(t,e,n,r){return new $o(t).Wa(e,n).then((function(t){return new Fh(t,r)}))}function qh(t){var e=io(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new Ii("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");fi(this,{token:t,expirationTime:ri(1e3*e.exp),authTime:ri(1e3*e.auth_time),issuedAtTime:ri(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}function Vh(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function Bh(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}function jh(t,e){t.stop(),t.b=Sn(Bh(t,e)).then((function(){return ni()})).then((function(){return t.h()})).then((function(){jh(t,!0)})).s((function(e){t.i(e)&&jh(t,!1)}))}function Wh(t){this.f=t,this.b=this.a=null,this.c=0}function Kh(t,e){var n=e[gs],r=e.refreshToken;e=Gh(e.expiresIn),t.b=n,t.c=e,t.a=r}function zh(t,e){t.b=e.b,t.a=e.a,t.c=e.c}function Gh(t){return A()+1e3*parseInt(t,10)}function Qh(t,e){return Ns(t.f,e).then((function(e){return t.b=e.access_token,t.c=Gh(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}})).s((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}function Hh(t,e){this.a=t||null,this.b=e||null,fi(this,{lastSignInTime:ri(e||null),creationTime:ri(t||null)})}function Yh(t){return new Hh(t.a,t.b)}function $h(t,e,n,r,i,o){fi(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function Xh(t,e){for(var n in Qe.call(this,t),e)this[n]=e[n]}function Jh(t,e,n){this.I=[],this.l=t.apiKey,this.m=t.appName,this.o=t.authDomain||null,t=r.a.SDK_VERSION?Vr(r.a.SDK_VERSION):null,this.a=new ms(this.l,so(oo),t),this.b=new Wh(this.a),al(this,e[gs]),Kh(this.b,e),li(this,"refreshToken",this.b.a),hl(this,n||{}),bn.call(this),this.J=!1,this.o&&Kr()&&(this.i=Ch(this.o,this.l,this.m)),this.O=[],this.h=null,this.w=rl(this),this.W=C(this.Ja,this);var i=this;this.ga=null,this.xa=function(t){i.ua(t.g)},this.Z=null,this.P=[],this.wa=function(t){tl(i,t.c)},this.Y=null}function Zh(t,e){t.Z&&hn(t.Z,"languageCodeChanged",t.xa),(t.Z=e)&&an(e,"languageCodeChanged",t.xa)}function tl(t,e){t.P=e,Es(t.a,r.a.SDK_VERSION?Vr(r.a.SDK_VERSION,t.P):null)}function el(t,e){t.Y&&hn(t.Y,"frameworkChanged",t.wa),(t.Y=e)&&an(e,"frameworkChanged",t.wa)}function nl(t){try{return r.a.app(t.m).auth()}catch(e){throw new Ii("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function rl(t){return new Vh((function(){return t.G(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.b.c-A()-3e5;return 0<e?e:0}))}function il(t){t.B||t.w.b||(t.w.start(),hn(t,"tokenChanged",t.W),an(t,"tokenChanged",t.W))}function ol(t){hn(t,"tokenChanged",t.W),t.w.stop()}function al(t,e){t.ma=e,li(t,"_lat",e)}function sl(t,e){H(t.O,(function(t){return t==e}))}function ul(t){for(var e=[],n=0;n<t.O.length;n++)e.push(t.O[n](t));return ce(e).then((function(){return t}))}function cl(t){t.i&&!t.J&&(t.J=!0,yh(t.i,t))}function hl(t,e){fi(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new Hh(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function ll(){}function fl(t){return oe().then((function(){if(t.B)throw new Ii("app-deleted")}))}function pl(t){return W(t.providerData,(function(t){return t.providerId}))}function dl(t,e){e&&(ml(t,e.providerId),t.providerData.push(e))}function ml(t,e){H(t.providerData,(function(t){return t.providerId==e}))}function yl(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&li(t,e,n)}function gl(t,e){t!=e&&(fi(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?li(t,"metadata",Yh(e.metadata)):li(t,"metadata",new Hh),B(e.providerData,(function(e){dl(t,e)})),zh(t.b,e.b),li(t,"refreshToken",t.b.a))}function vl(t){return t.G().then((function(e){var n=t.isAnonymous;return _l(t,e).then((function(){return n||yl(t,"isAnonymous",!1),e}))}))}function bl(t,e){e[gs]&&t.ma!=e[gs]&&(Kh(t.b,e),t.dispatchEvent(new Xh("tokenChanged")),al(t,e[gs]),yl(t,"refreshToken",t.b.a))}function _l(t,e){return bu(t.a,tu,{idToken:e}).then(C(t.zc,t))}function wl(t){return(t=t.providerUserInfo)&&t.length?W(t,(function(t){return new $h(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}function Tl(t,e){return vl(t).then((function(){if(G(pl(t),e))return ul(t).then((function(){throw new Ii("provider-already-linked")}))}))}function El(t,e,n){var r=Jo(e);return e=fo(e),pi({user:t,credential:r,additionalUserInfo:e,operationType:n})}function Sl(t,e){return bl(t,e),t.reload().then((function(){return t}))}function Cl(t,e,n,i,o){if(!Kr())return ae(new Ii("operation-not-supported-in-this-environment"));if(t.h&&!o)return ae(t.h);var a=lo(n.providerId),s=Xr(t.uid+":::"),u=null;(!Qr()||xr())&&t.o&&n.isOAuthProvider&&(u=Uu(t.o,t.l,t.m,e,n,null,s,r.a.SDK_VERSION||null,null,null,t.tenantId));var c=Sr(u,a&&a.sa,a&&a.ra);return i=i().then((function(){if(Al(t),!o)return t.G().then((function(){}))})).then((function(){return _h(t.i,c,e,n,s,!!u,t.tenantId)})).then((function(){return new Jt((function(n,r){t.ja(e,null,new Ii("cancelled-popup-request"),t.g||null),t.f=n,t.v=r,t.g=s,t.c=Eh(t.i,t,e,c,s)}))})).then((function(t){return c&&Er(c),t?pi(t):null})).s((function(t){throw c&&Er(c),t})),Nl(t,i,o)}function Il(t,e,n,r,i){if(!Kr())return ae(new Ii("operation-not-supported-in-this-environment"));if(t.h&&!i)return ae(t.h);var o=null,a=Xr(t.uid+":::");return r=r().then((function(){if(Al(t),!i)return t.G().then((function(){}))})).then((function(){return t.ca=a,ul(t)})).then((function(e){return t.da&&(e=t.da,e=e.b.set(Ml,t.A(),e.a)),e})).then((function(){return Th(t.i,e,n,a,t.tenantId)})).s((function(e){if(o=e,t.da)return Pl(t.da);throw o})).then((function(){if(o)throw o})),Nl(t,r,i)}function Al(t){if(!t.i||!t.J){if(t.i&&!t.J)throw new Ii("internal-error");throw new Ii("auth-domain-config-required")}}function Nl(t,e,n){var r=kl(t,e,n);return t.I.push(r),r.ka((function(){Q(t.I,r)})),r}function kl(t,e,n){return t.h&&!n?(e.cancel(),ae(t.h)):e.s((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.h||t.dispatchEvent(new Xh("userInvalidated")),t.h=e),e}))}function Dl(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[gs]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-A())/1e3;var r=new Jh(e,n,t);return t.providerData&&B(t.providerData,(function(t){t&&dl(r,pi(t))})),t.redirectEventId&&(r.ca=t.redirectEventId),r}function xl(t,e,n,r){var i=new Jh(t,e);return n&&(i.da=n),r&&tl(i,r),i.reload().then((function(){return i}))}function Ol(t,e,n,r){e=e||{apiKey:t.l,authDomain:t.o,appName:t.m};var i=t.b,o={};return o[gs]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-A())/1e3,e=new Jh(e,o),n&&(e.da=n),r&&tl(e,r),gl(e,t),e}function Rl(t){this.a=t,this.b=Nc()}Ih.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Ih.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(Oh(this,!0,null,t.a),oe()):e.Ba(n,r)?kh(this,t,e):ae(new Ii("invalid-auth-event")):(Oh(this,!1,null,null),oe())}else ae(new Ii("invalid-auth-event"))},Ih.prototype.oa=function(){var t=this;return new Jt((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),Rh(t))}))},Mh.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.ja(t.c,null,t.a,t.b),oe()):e.Ba(n,r)?Ph(t,e):ae(new Ii("invalid-auth-event"))}else ae(new Ii("invalid-auth-event"))},Fh.prototype.confirm=function(t){return t=Xo(this.verificationId,t),this.a(t)},Vh.prototype.start=function(){this.a=this.c,jh(this,!0)},Vh.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},Wh.prototype.A=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},Wh.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?ae(new Ii("user-token-expired")):t||!this.b||A()>this.c-3e4?this.a?Qh(this,{grant_type:"refresh_token",refresh_token:this.a}):oe(null):oe({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},Hh.prototype.A=function(){return{lastLoginAt:this.b,createdAt:this.a}},N(Xh,Qe),N(Jh,bn),Jh.prototype.ua=function(t){this.ga=t,Ts(this.a,t)},Jh.prototype.ha=function(){return this.ga},Jh.prototype.Ca=function(){return $(this.P)},Jh.prototype.Ja=function(){this.w.b&&(this.w.stop(),this.w.start())},li(Jh.prototype,"providerId","firebase"),e=Jh.prototype,e.reload=function(){var t=this;return Nl(this,fl(this).then((function(){return vl(t).then((function(){return ul(t)})).then(ll)})))},e.dc=function(t){return this.G(t).then((function(t){return new qh(t)}))},e.G=function(t){var e=this;return Nl(this,fl(this).then((function(){return e.b.getToken(t)})).then((function(t){if(!t)throw new Ii("internal-error");return t.accessToken!=e.ma&&(al(e,t.accessToken),e.dispatchEvent(new Xh("tokenChanged"))),yl(e,"refreshToken",t.refreshToken),t.accessToken})))},e.zc=function(t){if(t=t.users,!t||!t.length)throw new Ii("internal-error");t=t[0],hl(this,{uid:t.localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=wl(t),n=0;n<e.length;n++)dl(this,e[n]);yl(this,"isAnonymous",!(this.email&&t.passwordHash)&&!(this.providerData&&this.providerData.length))},e.Ac=function(t){return ci("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.hb(t)},e.hb=function(t){var e=this,n=null;return Nl(this,t.f(this.a,this.uid).then((function(t){return bl(e,t),n=El(e,t,"reauthenticate"),e.h=null,e.reload()})).then((function(){return n})),!0)},e.rc=function(t){return ci("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.fb(t)},e.fb=function(t){var e=this,n=null;return Nl(this,Tl(this,t.providerId).then((function(){return e.G()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=El(e,t,"link"),Sl(e,t)})).then((function(){return n})))},e.sc=function(t,e){var n=this;return Nl(this,Tl(this,"phone").then((function(){return Uh(nl(n),t,e,C(n.fb,n))})))},e.Bc=function(t,e){var n=this;return Nl(this,oe().then((function(){return Uh(nl(n),t,e,C(n.hb,n))})),!0)},e.rb=function(t){var e=this;return Nl(this,this.G().then((function(n){return e.a.rb(n,t)})).then((function(t){return bl(e,t),e.reload()})))},e.Sc=function(t){var e=this;return Nl(this,this.G().then((function(n){return t.b(e.a,n)})).then((function(t){return bl(e,t),e.reload()})))},e.sb=function(t){var e=this;return Nl(this,this.G().then((function(n){return e.a.sb(n,t)})).then((function(t){return bl(e,t),e.reload()})))},e.tb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return fl(this);var e=this;return Nl(this,this.G().then((function(n){return e.a.tb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return bl(e,t),yl(e,"displayName",t.displayName||null),yl(e,"photoURL",t.photoUrl||null),B(e.providerData,(function(t){"password"===t.providerId&&(li(t,"displayName",e.displayName),li(t,"photoURL",e.photoURL))})),ul(e)})).then(ll))},e.Qc=function(t){var e=this;return Nl(this,vl(this).then((function(n){return G(pl(e),t)?Us(e.a,n,[t]).then((function(t){var n={};return B(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),B(pl(e),(function(t){n[t]||ml(e,t)})),n[$o.PROVIDER_ID]||li(e,"phoneNumber",null),ul(e)})):ul(e).then((function(){throw new Ii("no-such-provider")}))})))},e.delete=function(){var t=this;return Nl(this,this.G().then((function(e){return bu(t.a,$s,{idToken:e})})).then((function(){t.dispatchEvent(new Xh("userDeleted"))}))).then((function(){for(var e=0;e<t.I.length;e++)t.I[e].cancel("app-deleted");Zh(t,null),el(t,null),t.I=[],t.B=!0,ol(t),li(t,"refreshToken",null),t.i&&gh(t.i,t)}))},e.xb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ca||null)==e||"reauthViaRedirect"==t&&(this.ca||null)==e)},e.ja=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},e.Ba=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?C(this.Bb,this):"reauthViaPopup"==t&&e==(this.g||null)?C(this.Cb,this):"linkViaRedirect"==t&&(this.ca||null)==e?C(this.Bb,this):"reauthViaRedirect"==t&&(this.ca||null)==e?C(this.Cb,this):null},e.tc=function(t){var e=this;return Cl(this,"linkViaPopup",t,(function(){return Tl(e,t.providerId).then((function(){return ul(e)}))}),!1)},e.Cc=function(t){return Cl(this,"reauthViaPopup",t,(function(){return oe()}),!0)},e.uc=function(t){var e=this;return Il(this,"linkViaRedirect",t,(function(){return Tl(e,t.providerId)}),!1)},e.Dc=function(t){return Il(this,"reauthViaRedirect",t,(function(){return oe()}),!0)},e.Bb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return n=this.G().then((function(n){return Ws(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=El(i,t,"link"),Sl(i,t)})).then((function(){return o})),Nl(this,n)},e.Cb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null,a=oe().then((function(){return So(Ks(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=El(i,t,"reauthenticate"),bl(i,t),i.h=null,i.reload()})).then((function(){return o}));return Nl(this,a,!0)},e.jb=function(t){var e=this,n=null;return Nl(this,this.G().then((function(e){return n=e,"undefined"===typeof t||J(t)?{}:Yi(new qi(t))})).then((function(t){return e.a.jb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},e.toJSON=function(){return this.A()},e.A=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.o,stsTokenManager:this.b.A(),redirectEventId:this.ca||null};return this.metadata&&et(t,this.metadata.A()),B(this.providerData,(function(e){t.providerData.push(di(e))})),t};var Ml={name:"redirectUser",C:"session"};function Pl(t){return Oc(t.b,Ml,t.a)}function Ll(t,e){return t.b.get(Ml,t.a).then((function(t){return t&&e&&(t.authDomain=e),Dl(t||{})}))}function Fl(t){this.a=t,this.b=Nc(),this.c=null,this.f=ql(this),this.b.addListener(Bl("local"),this.a,C(this.g,this))}function Ul(t,e){var n,r=[];for(n in Cc)Cc[n]!==e&&r.push(Oc(t.b,Bl(Cc[n]),t.a));return r.push(Oc(t.b,Vl,t.a)),ue(r)}function ql(t){var e=Bl("local"),n=Bl("session"),r=Bl("none");return xc(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(Vl,t.a).then((function(t){return t?Bl(t):e}))}))}))})).then((function(e){return t.c=e,Ul(t,e.C)})).s((function(){t.c||(t.c=e)}))}Fl.prototype.g=function(){var t=this,e=Bl("local");Gl(this,(function(){return oe().then((function(){return t.c&&"local"!=t.c.C?t.b.get(e,t.a):null})).then((function(n){if(n)return Ul(t,"local").then((function(){t.c=e}))}))}))};var Vl={name:"persistence",C:"session"};function Bl(t){return{name:"authUser",C:t}}function jl(t){return Gl(t,(function(){return t.b.set(Vl,t.c.C,t.a)}))}function Wl(t,e){return Gl(t,(function(){return t.b.set(t.c,e.A(),t.a)}))}function Kl(t){return Gl(t,(function(){return Oc(t.b,t.c,t.a)}))}function zl(t,e){return Gl(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),Dl(t||{})}))}))}function Gl(t,e){return t.f=t.f.then(e,e),t.f}function Ql(t){if(this.l=!1,li(this,"settings",new Lh),li(this,"app",t),!sf(this).options||!sf(this).options.apiKey)throw new Ii("invalid-api-key");t=r.a.SDK_VERSION?Vr(r.a.SDK_VERSION):null,this.b=new ms(sf(this).options&&sf(this).options.apiKey,so(oo),t),this.O=[],this.m=[],this.J=[],this.Ub=r.a.INTERNAL.createSubscribe(C(this.oc,this)),this.W=void 0,this.Vb=r.a.INTERNAL.createSubscribe(C(this.pc,this)),ef(this,null),this.h=new Fl(sf(this).options.apiKey+":"+sf(this).name),this.w=new Rl(sf(this).options.apiKey+":"+sf(this).name),this.Y=ff(this,rf(this)),this.i=ff(this,of(this)),this.ga=!1,this.ma=C(this.Nc,this),this.ub=C(this.aa,this),this.wa=C(this.bc,this),this.xa=C(this.mc,this),this.Ja=C(this.nc,this),this.a=null,Jl(this),this.INTERNAL={},this.INTERNAL["delete"]=C(this.delete,this),this.INTERNAL.logFramework=C(this.vc,this),this.o=0,bn.call(this),$l(this),this.I=[]}function Hl(t){Qe.call(this,"languageCodeChanged"),this.g=t}function Yl(t){Qe.call(this,"frameworkChanged"),this.c=t}function $l(t){Object.defineProperty(t,"lc",{get:function(){return this.ha()},set:function(t){this.ua(t)},enumerable:!1}),t.Z=null,Object.defineProperty(t,"ti",{get:function(){return this.R()},set:function(t){this.nb(t)},enumerable:!1}),t.P=null}function Xl(t){return t.Tb||ae(new Ii("auth-domain-config-required"))}function Jl(t){var e=sf(t).options.authDomain,n=sf(t).options.apiKey;e&&Kr()&&(t.Tb=t.Y.then((function(){if(!t.l){if(t.a=Ch(e,n,sf(t).name),yh(t.a,t),uf(t)&&cl(uf(t)),t.B){cl(t.B);var r=t.B;r.ua(t.ha()),Zh(r,t),r=t.B,tl(r,t.I),el(r,t),t.B=null}return t.a}})))}function Zl(t){if(!Kr())return ae(new Ii("operation-not-supported-in-this-environment"));var e=Xl(t).then((function(){return t.a.oa()})).then((function(t){return t?pi(t):null}));return ff(t,e)}function tf(t,e){var n={};return n.apiKey=sf(t).options.apiKey,n.authDomain=sf(t).options.authDomain,n.appName=sf(t).name,t.Y.then((function(){return xl(n,e,t.w,t.Ca())})).then((function(e){return uf(t)&&e.uid==uf(t).uid?(gl(uf(t),e),t.aa(e)):(ef(t,e),cl(e),t.aa(e))})).then((function(){hf(t)}))}function ef(t,e){uf(t)&&(sl(uf(t),t.ub),hn(uf(t),"tokenChanged",t.wa),hn(uf(t),"userDeleted",t.xa),hn(uf(t),"userInvalidated",t.Ja),ol(uf(t))),e&&(e.O.push(t.ub),an(e,"tokenChanged",t.wa),an(e,"userDeleted",t.xa),an(e,"userInvalidated",t.Ja),0<t.o&&il(e)),li(t,"currentUser",e),e&&(e.ua(t.ha()),Zh(e,t),tl(e,t.I),el(e,t))}function nf(t){var e=Ll(t.w,sf(t).options.authDomain).then((function(e){return(t.B=e)&&(e.da=t.w),Pl(t.w)}));return ff(t,e)}function rf(t){var e=sf(t).options.authDomain,n=nf(t).then((function(){return zl(t.h,e)})).then((function(e){return e?(e.da=t.w,t.B&&(t.B.ca||null)==(e.ca||null)?e:e.reload().then((function(){return Wl(t.h,e).then((function(){return e}))})).s((function(n){return"auth/network-request-failed"==n.code?e:Kl(t.h)}))):null})).then((function(e){ef(t,e||null)}));return ff(t,n)}function of(t){return t.Y.then((function(){return Zl(t)})).s((function(){})).then((function(){if(!t.l)return t.ma()})).s((function(){})).then((function(){if(!t.l){t.ga=!0;var e=t.h;e.b.addListener(Bl("local"),e.a,t.ma)}}))}function af(t,e){var n=null,r=null;return ff(t,e.then((function(e){return n=Jo(e),r=fo(e),tf(t,e)})).then((function(){return pi({user:uf(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function sf(t){return t.app}function uf(t){return t.currentUser}function cf(t){return uf(t)&&uf(t)._lat||null}function hf(t){if(t.ga){for(var e=0;e<t.m.length;e++)t.m[e]&&t.m[e](cf(t));if(t.W!==t.getUid()&&t.J.length)for(t.W=t.getUid(),e=0;e<t.J.length;e++)t.J[e]&&t.J[e](cf(t))}}function lf(t,e){t.J.push(e),ff(t,t.i.then((function(){!t.l&&G(t.J,e)&&t.W!==t.getUid()&&(t.W=t.getUid(),e(cf(t)))})))}function ff(t,e){return t.O.push(e),e.ka((function(){Q(t.O,e)})),e}function pf(){}function df(){this.a={},this.b=1e12}Fl.prototype.mb=function(t){var e=null,n=this;return Ic(t),Gl(this,(function(){return t!=n.c.C?n.b.get(n.c,n.a).then((function(r){return e=r,Ul(n,t)})).then((function(){if(n.c=Bl(t),e)return n.b.set(n.c,e,n.a)})):oe()}))},N(Ql,bn),N(Hl,Qe),N(Yl,Qe),e=Ql.prototype,e.mb=function(t){return t=this.h.mb(t),ff(this,t)},e.ua=function(t){this.Z===t||this.l||(this.Z=t,Ts(this.b,this.Z),this.dispatchEvent(new Hl(this.ha())))},e.ha=function(){return this.Z},e.Tc=function(){var t=c.navigator;this.ua(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},e.vc=function(t){this.I.push(t),Es(this.b,r.a.SDK_VERSION?Vr(r.a.SDK_VERSION,this.I):null),this.dispatchEvent(new Yl(this.I))},e.Ca=function(){return $(this.I)},e.nb=function(t){this.P===t||this.l||(this.P=t,this.b.b=this.P)},e.R=function(){return this.P},e.toJSON=function(){return{apiKey:sf(this).options.apiKey,authDomain:sf(this).options.authDomain,appName:sf(this).name,currentUser:uf(this)&&uf(this).A()}},e.xb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},e.ja=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},e.Ba=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?C(this.ac,this):null},e.ac=function(t,e,n,r){var i=this;t={requestUri:t,postBody:r,sessionId:e,tenantId:n},this.c&&(this.c.cancel(),this.c=null);var o=null,a=null,s=js(i.b,t).then((function(t){return o=Jo(t),a=fo(t),t}));return t=i.Y.then((function(){return s})).then((function(t){return tf(i,t)})).then((function(){return pi({user:uf(i),credential:o,additionalUserInfo:a,operationType:"signIn"})})),ff(this,t)},e.Lc=function(t){if(!Kr())return ae(new Ii("operation-not-supported-in-this-environment"));var e=this,n=lo(t.providerId),i=Xr(),o=null;(!Qr()||xr())&&sf(this).options.authDomain&&t.isOAuthProvider&&(o=Uu(sf(this).options.authDomain,sf(this).options.apiKey,sf(this).name,"signInViaPopup",t,null,i,r.a.SDK_VERSION||null,null,null,this.R()));var a=Sr(o,n&&n.sa,n&&n.ra);return n=Xl(this).then((function(n){return _h(n,a,"signInViaPopup",t,i,!!o,e.R())})).then((function(){return new Jt((function(t,n){e.ja("signInViaPopup",null,new Ii("cancelled-popup-request"),e.g),e.f=t,e.v=n,e.g=i,e.c=Eh(e.a,e,"signInViaPopup",a,i)}))})).then((function(t){return a&&Er(a),t?pi(t):null})).s((function(t){throw a&&Er(a),t})),ff(this,n)},e.Mc=function(t){if(!Kr())return ae(new Ii("operation-not-supported-in-this-environment"));var e=this,n=Xl(this).then((function(){return jl(e.h)})).then((function(){return Th(e.a,"signInViaRedirect",t,void 0,e.R())}));return ff(this,n)},e.oa=function(){var t=this;return Zl(this).then((function(e){return t.a&&Nh(t.a.b),e})).s((function(e){throw t.a&&Nh(t.a.b),e}))},e.Rc=function(t){if(!t)return ae(new Ii("null-user"));if(this.P!=t.tenantId)return ae(new Ii("tenant-id-mismatch"));var e=this,n={};n.apiKey=sf(this).options.apiKey,n.authDomain=sf(this).options.authDomain,n.appName=sf(this).name;var r=Ol(t,n,e.w,e.Ca());return ff(this,this.i.then((function(){if(sf(e).options.apiKey!=t.l)return r.reload()})).then((function(){return uf(e)&&t.uid==uf(e).uid?(gl(uf(e),t),e.aa(t)):(ef(e,r),cl(r),e.aa(r))})).then((function(){hf(e)})))},e.pb=function(){var t=this,e=this.i.then((function(){return t.a&&Nh(t.a.b),uf(t)?(ef(t,null),Kl(t.h).then((function(){hf(t)}))):oe()}));return ff(this,e)},e.Nc=function(){var t=this;return zl(this.h,sf(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=uf(t)&&e){n=uf(t).uid;var r=e.uid;n=void 0!==n&&null!==n&&""!==n&&void 0!==r&&null!==r&&""!==r&&n==r}if(n)return gl(uf(t),e),uf(t).G();(uf(t)||e)&&(ef(t,e),e&&(cl(e),e.da=t.w),t.a&&yh(t.a,t),hf(t))}}))},e.aa=function(t){return Wl(this.h,t)},e.bc=function(){hf(this),this.aa(uf(this))},e.mc=function(){this.pb()},e.nc=function(){this.pb()},e.oc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(uf(e))}))},e.pc=function(t){var e=this;lf(this,(function(){t.next(uf(e))}))},e.xc=function(t,e,n){var r=this;return this.ga&&Promise.resolve().then((function(){b(t)?t(uf(r)):b(t.next)&&t.next(uf(r))})),this.Ub(t,e,n)},e.wc=function(t,e,n){var r=this;return this.ga&&Promise.resolve().then((function(){r.W=r.getUid(),b(t)?t(uf(r)):b(t.next)&&t.next(uf(r))})),this.Vb(t,e,n)},e.cc=function(t){var e=this,n=this.i.then((function(){return uf(e)?uf(e).G(t).then((function(t){return{accessToken:t}})):null}));return ff(this,n)},e.Hc=function(t){var e=this;return this.i.then((function(){return af(e,bu(e.b,du,{token:t}))})).then((function(t){var n=t.user;return yl(n,"isAnonymous",!1),e.aa(n),t}))},e.Ic=function(t,e){var n=this;return this.i.then((function(){return af(n,bu(n.b,mu,{email:t,password:e}))}))},e.Xb=function(t,e){var n=this;return this.i.then((function(){return af(n,bu(n.b,Hs,{email:t,password:e}))}))},e.Sa=function(t){var e=this;return this.i.then((function(){return af(e,t.na(e.b))}))},e.Gc=function(t){return ci("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Sa(t)},e.ob=function(){var t=this;return this.i.then((function(){var e=uf(t);if(e&&e.isAnonymous){var n=pi({providerId:null,isNewUser:!1});return pi({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return af(t,t.b.ob()).then((function(e){var n=e.user;return yl(n,"isAnonymous",!0),t.aa(n),e}))}))},e.getUid=function(){return uf(this)&&uf(this).uid||null},e.Wb=function(t){this.addAuthTokenListener(t),this.o++,0<this.o&&uf(this)&&il(uf(this))},e.Ec=function(t){var e=this;B(this.m,(function(n){n==t&&e.o--})),0>this.o&&(this.o=0),0==this.o&&uf(this)&&ol(uf(this)),this.removeAuthTokenListener(t)},e.addAuthTokenListener=function(t){var e=this;this.m.push(t),ff(this,this.i.then((function(){e.l||G(e.m,t)&&t(cf(e))})))},e.removeAuthTokenListener=function(t){H(this.m,(function(e){return e==t}))},e.delete=function(){this.l=!0;for(var t=0;t<this.O.length;t++)this.O[t].cancel("app-deleted");return this.O=[],this.h&&(t=this.h,t.b.removeListener(Bl("local"),t.a,this.ma)),this.a&&(gh(this.a,this),Nh(this.a.b)),Promise.resolve()},e.$b=function(t){return ff(this,Os(this.b,t))},e.qc=function(t){return!!Go(t)},e.lb=function(t,e){var n=this;return ff(this,oe().then((function(){var t=new qi(e);if(!t.c)throw new Ii("argument-error",ji+" must be true when sending sign in link to email");return Yi(t)})).then((function(e){return n.b.lb(t,e)})).then((function(){})))},e.Uc=function(t){return this.Ma(t).then((function(t){return t.data.email}))},e.ab=function(t,e){return ff(this,this.b.ab(t,e).then((function(){})))},e.Ma=function(t){return ff(this,this.b.Ma(t).then((function(t){return new gi(t)})))},e.Ya=function(t){return ff(this,this.b.Ya(t).then((function(){})))},e.kb=function(t,e){var n=this;return ff(this,oe().then((function(){return"undefined"===typeof e||J(e)?{}:Yi(new qi(e))})).then((function(e){return n.b.kb(t,e)})).then((function(){})))},e.Kc=function(t,e){return ff(this,Uh(this,t,e,C(this.Sa,this)))},e.Jc=function(t,e){var n=this;return ff(this,oe().then((function(){var r=e||vr(),i=zo(t,r);if(r=Go(r),!r)throw new Ii("argument-error","Invalid email link!");if(r.tenantId!==n.R())throw new Ii("tenant-id-mismatch");return n.Sa(i)})))},pf.prototype.render=function(){},pf.prototype.reset=function(){},pf.prototype.getResponse=function(){},pf.prototype.execute=function(){};var mf=null;function yf(t,e){return(e=gf(e))&&t.a[e]||null}function gf(t){return(t="undefined"===typeof t?1e12:t)?t.toString():null}function vf(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=or(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():an(this.f,"click",this.i)}function bf(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function _f(){}df.prototype.render=function(t,e){return this.a[this.b.toString()]=new vf(t,e),this.b++},df.prototype.reset=function(t){var e=yf(this,t);t=gf(t),e&&t&&(e.delete(),delete this.a[t])},df.prototype.getResponse=function(t){return(t=yf(this,t))?t.getResponse():null},df.prototype.execute=function(t){(t=yf(this,t))&&t.execute()},vf.prototype.getResponse=function(){return bf(this),this.b},vf.prototype.execute=function(){bf(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=Pr();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(r){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(r){}t.h&&t.execute()}),6e4)}),500))},vf.prototype.delete=function(){bf(this),this.g=!0,clearTimeout(this.a),this.a=null,hn(this.f,"click",this.i)},_f.prototype.g=function(){return mf||(mf=new df),oe(mf)},_f.prototype.c=function(){};var wf=null;function Tf(){this.b=c.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Ef=new nt(ot,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Sf=new ti(3e4,6e4);Tf.prototype.g=function(t){var e=this;return new Jt((function(n,r){var i=setTimeout((function(){r(new Ii("network-request-failed"))}),Sf.get());if(!c.grecaptcha||t!==e.f&&!e.b){c[e.a]=function(){if(c.grecaptcha){e.f=t;var o=c.grecaptcha.render;c.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(c.grecaptcha)}else clearTimeout(i),r(new Ii("internal-error"));delete c[e.a]};var o=ct(Ef,{onload:e.a,hl:t||""});oe(ss(o)).s((function(){clearTimeout(i),r(new Ii("internal-error","Unable to load external reCAPTCHA dependencies!"))}))}else clearTimeout(i),n(c.grecaptcha)}))},Tf.prototype.c=function(){this.b--};var Cf=null;function If(t,e,n,r,i,o,a){if(li(this,"type","recaptcha"),this.c=this.f=null,this.B=!1,this.u=e,this.g=null,a?(wf||(wf=new _f),a=wf):(Cf||(Cf=new Tf),a=Cf),this.m=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[kf])throw new Ii("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Df],!c.document)throw new Ii("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!or(e)||!this.i&&or(e).hasChildNodes())throw new Ii("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.o=new ms(t,o||null,i||null),this.v=r||function(){return null};var s=this;this.l=[];var u=this.a[Af];this.a[Af]=function(t){if(xf(s,t),"function"===typeof u)u(t);else if("string"===typeof u){var e=jr(u,c);"function"===typeof e&&e(t)}};var h=this.a[Nf];this.a[Nf]=function(){if(xf(s,null),"function"===typeof h)h();else if("string"===typeof h){var t=jr(h,c);"function"===typeof t&&t()}}}var Af="callback",Nf="expired-callback",kf="sitekey",Df="size";function xf(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(r){}}function Of(t,e){H(t.l,(function(t){return t==e}))}function Rf(t,e){return t.h.push(e),e.ka((function(){Q(t.h,e)})),e}function Mf(t){if(t.B)throw new Ii("internal-error","RecaptchaVerifier instance has been destroyed.")}function Pf(t,e,n){var i=!1;try{this.b=n||r.a.app()}catch(s){throw new Ii("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new Ii("invalid-api-key");n=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().Ca()}catch(s){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(s){}a=r.a.SDK_VERSION?Vr(r.a.SDK_VERSION,a):null,If.call(this,n,t,e,(function(){try{var t=o.b.auth().ha()}catch(e){t=null}return t}),a,so(oo),i)}function Lf(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new Ii("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].N(n[i])&&!o){if(e=e[i],0>i||i>=Ff.length)throw new Ii("internal-error","Argument validator received an unsupported number of arguments.");n=Ff[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.M+".";break t}r=null}}if(r)throw new Ii("argument-error",t+" failed: "+r)}e=If.prototype,e.Da=function(){var t=this;return this.f?this.f:this.f=Rf(this,oe().then((function(){if(zr()&&!Or())return Nr();throw new Ii("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.v())})).then((function(e){return t.g=e,bu(t.o,ou,{})})).then((function(e){t.a[kf]=e.recaptchaSiteKey})).s((function(e){throw t.f=null,e})))},e.render=function(){Mf(this);var t=this;return Rf(this,this.Da().then((function(){if(null===t.c){var e=t.u;if(!t.i){var n=or(e);e=ur("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},e.verify=function(){Mf(this);var t=this;return Rf(this,this.render().then((function(e){return new Jt((function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(Of(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}}))})))},e.reset=function(){Mf(this),null!==this.c&&this.g.reset(this.c)},e.clear=function(){Mf(this),this.B=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=or(this.u);for(var e;e=t.firstChild;)t.removeChild(e)}},N(Pf,If);var Ff="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Uf(t,e){return{name:t||"",M:"a valid string",optional:!!e,N:h}}function qf(t,e){return{name:t||"",M:"a boolean",optional:!!e,N:l}}function Vf(t,e){return{name:t||"",M:"a valid object",optional:!!e,N:_}}function Bf(t,e){return{name:t||"",M:"a function",optional:!!e,N:b}}function jf(t,e){return{name:t||"",M:"null",optional:!!e,N:y}}function Wf(){return{name:"",M:"an HTML element",optional:!1,N:function(t){return!!(t&&t instanceof Element)}}}function Kf(){return{name:"auth",M:"an instance of Firebase Auth",optional:!0,N:function(t){return!!(t&&t instanceof Ql)}}}function zf(){return{name:"app",M:"an instance of Firebase App",optional:!0,N:function(t){return!!(t&&t instanceof r.a.app.App)}}}function Gf(t){return{name:t?t+"Credential":"credential",M:t?"a valid "+t+" credential":"a valid credential",optional:!1,N:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.na||!n)}}}function Qf(){return{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}}function Hf(){return{name:"applicationVerifier",M:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,N:function(t){return!!(t&&h(t.type)&&b(t.verify))}}}function Yf(t,e,n,r){return{name:n||"",M:t.M+" or "+e.M,optional:!!r,N:function(n){return t.N(n)||e.N(n)}}}function $f(t,e){for(var n in e){var r=e[n].name;t[r]=Zf(r,t[n],e[n].j)}}function Xf(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:I((function(t){return this[t]}),n),set:I((function(t,e,n,r){Lf(t,[n],[r],!0),this[e]=r}),r,n,e[n].Za),enumerable:!0})}}function Jf(t,e,n,r){t[e]=Zf(e,n,r)}function Zf(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Lf(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=tp(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}function tp(t){return t=t.split("."),t[t.length-1]}$f(Ql.prototype,{Ya:{name:"applyActionCode",j:[Uf("code")]},Ma:{name:"checkActionCode",j:[Uf("code")]},ab:{name:"confirmPasswordReset",j:[Uf("code"),Uf("newPassword")]},Xb:{name:"createUserWithEmailAndPassword",j:[Uf("email"),Uf("password")]},$b:{name:"fetchSignInMethodsForEmail",j:[Uf("email")]},oa:{name:"getRedirectResult",j:[]},qc:{name:"isSignInWithEmailLink",j:[Uf("emailLink")]},wc:{name:"onAuthStateChanged",j:[Yf(Vf(),Bf(),"nextOrObserver"),Bf("opt_error",!0),Bf("opt_completed",!0)]},xc:{name:"onIdTokenChanged",j:[Yf(Vf(),Bf(),"nextOrObserver"),Bf("opt_error",!0),Bf("opt_completed",!0)]},kb:{name:"sendPasswordResetEmail",j:[Uf("email"),Yf(Vf("opt_actionCodeSettings",!0),jf(null,!0),"opt_actionCodeSettings",!0)]},lb:{name:"sendSignInLinkToEmail",j:[Uf("email"),Vf("actionCodeSettings")]},mb:{name:"setPersistence",j:[Uf("persistence")]},Gc:{name:"signInAndRetrieveDataWithCredential",j:[Gf()]},ob:{name:"signInAnonymously",j:[]},Sa:{name:"signInWithCredential",j:[Gf()]},Hc:{name:"signInWithCustomToken",j:[Uf("token")]},Ic:{name:"signInWithEmailAndPassword",j:[Uf("email"),Uf("password")]},Jc:{name:"signInWithEmailLink",j:[Uf("email"),Uf("emailLink",!0)]},Kc:{name:"signInWithPhoneNumber",j:[Uf("phoneNumber"),Hf()]},Lc:{name:"signInWithPopup",j:[Qf()]},Mc:{name:"signInWithRedirect",j:[Qf()]},Rc:{name:"updateCurrentUser",j:[Yf(function(t){return{name:"user",M:"an instance of Firebase User",optional:!!t,N:function(t){return!!(t&&t instanceof Jh)}}}(),jf(),"user")]},pb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Uf(null,!0)]},Tc:{name:"useDeviceLanguage",j:[]},Uc:{name:"verifyPasswordResetCode",j:[Uf("code")]}}),Xf(Ql.prototype,{lc:{name:"languageCode",Za:Yf(Uf(),jf(),"languageCode")},ti:{name:"tenantId",Za:Yf(Uf(),jf(),"tenantId")}}),Ql.Persistence=Cc,Ql.Persistence.LOCAL="local",Ql.Persistence.SESSION="session",Ql.Persistence.NONE="none",$f(Jh.prototype,{delete:{name:"delete",j:[]},dc:{name:"getIdTokenResult",j:[qf("opt_forceRefresh",!0)]},G:{name:"getIdToken",j:[qf("opt_forceRefresh",!0)]},rc:{name:"linkAndRetrieveDataWithCredential",j:[Gf()]},fb:{name:"linkWithCredential",j:[Gf()]},sc:{name:"linkWithPhoneNumber",j:[Uf("phoneNumber"),Hf()]},tc:{name:"linkWithPopup",j:[Qf()]},uc:{name:"linkWithRedirect",j:[Qf()]},Ac:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Gf()]},hb:{name:"reauthenticateWithCredential",j:[Gf()]},Bc:{name:"reauthenticateWithPhoneNumber",j:[Uf("phoneNumber"),Hf()]},Cc:{name:"reauthenticateWithPopup",j:[Qf()]},Dc:{name:"reauthenticateWithRedirect",j:[Qf()]},reload:{name:"reload",j:[]},jb:{name:"sendEmailVerification",j:[Yf(Vf("opt_actionCodeSettings",!0),jf(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Uf(null,!0)]},Qc:{name:"unlink",j:[Uf("provider")]},rb:{name:"updateEmail",j:[Uf("email")]},sb:{name:"updatePassword",j:[Uf("password")]},Sc:{name:"updatePhoneNumber",j:[Gf("phone")]},tb:{name:"updateProfile",j:[Vf("profile")]}}),$f(df.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),$f(pf.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),$f(Jt.prototype,{ka:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),Xf(Lh.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",Za:qf("appVerificationDisabledForTesting")}}),$f(Fh.prototype,{confirm:{name:"confirm",j:[Uf("verificationCode")]}}),Jf(Eo,"fromJSON",(function(t){t=h(t)?JSON.parse(t):t;for(var e,n=[Do,Wo,Ho,Ao],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[Yf(Uf(),Vf(),"json")]),Jf(Ko,"credential",(function(t,e){return new jo(t,e)}),[Uf("email"),Uf("password")]),$f(jo.prototype,{A:{name:"toJSON",j:[Uf(null,!0)]}}),$f(Mo.prototype,{ya:{name:"addScope",j:[Uf("scope")]},Ga:{name:"setCustomParameters",j:[Vf("customOAuthParameters")]}}),Jf(Mo,"credential",Po,[Yf(Uf(),Vf(),"token")]),Jf(Ko,"credentialWithLink",zo,[Uf("email"),Uf("emailLink")]),$f(Lo.prototype,{ya:{name:"addScope",j:[Uf("scope")]},Ga:{name:"setCustomParameters",j:[Vf("customOAuthParameters")]}}),Jf(Lo,"credential",Fo,[Yf(Uf(),Vf(),"token")]),$f(Uo.prototype,{ya:{name:"addScope",j:[Uf("scope")]},Ga:{name:"setCustomParameters",j:[Vf("customOAuthParameters")]}}),Jf(Uo,"credential",qo,[Yf(Uf(),Yf(Vf(),jf()),"idToken"),Yf(Uf(),jf(),"accessToken",!0)]),$f(Vo.prototype,{Ga:{name:"setCustomParameters",j:[Vf("customOAuthParameters")]}}),Jf(Vo,"credential",Bo,[Yf(Uf(),Vf(),"token"),Uf("secret",!0)]),$f(Ro.prototype,{ya:{name:"addScope",j:[Uf("scope")]},credential:{name:"credential",j:[Yf(Uf(),Yf(Vf(),jf()),"optionsOrIdToken"),Yf(Uf(),jf(),"accessToken",!0)]},Ga:{name:"setCustomParameters",j:[Vf("customOAuthParameters")]}}),$f(No.prototype,{A:{name:"toJSON",j:[Uf(null,!0)]}}),$f(Co.prototype,{A:{name:"toJSON",j:[Uf(null,!0)]}}),Jf($o,"credential",Xo,[Uf("verificationId"),Uf("verificationCode")]),$f($o.prototype,{Wa:{name:"verifyPhoneNumber",j:[Uf("phoneNumber"),Hf()]}}),$f(Qo.prototype,{A:{name:"toJSON",j:[Uf(null,!0)]}}),$f(Ii.prototype,{toJSON:{name:"toJSON",j:[Uf(null,!0)]}}),$f(sa.prototype,{toJSON:{name:"toJSON",j:[Uf(null,!0)]}}),$f(aa.prototype,{toJSON:{name:"toJSON",j:[Uf(null,!0)]}}),$f(Pf.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Jf(Di,"parseLink",Ui,[Uf("link")]),function(){if("undefined"===typeof r.a||!r.a.INTERNAL||!r.a.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:vi,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:Ql,AuthCredential:Eo,Error:Ii};Jf(t,"EmailAuthProvider",Ko,[]),Jf(t,"FacebookAuthProvider",Mo,[]),Jf(t,"GithubAuthProvider",Lo,[]),Jf(t,"GoogleAuthProvider",Uo,[]),Jf(t,"TwitterAuthProvider",Vo,[]),Jf(t,"OAuthProvider",Ro,[Uf("providerId")]),Jf(t,"SAMLAuthProvider",Oo,[Uf("providerId")]),Jf(t,"PhoneAuthProvider",$o,[Kf()]),Jf(t,"RecaptchaVerifier",Pf,[Yf(Uf(),Wf(),"recaptchaContainer"),Vf("recaptchaParameters",!0),zf()]),Jf(t,"ActionCodeURL",Di,[]),r.a.INTERNAL.registerService("auth",(function(t,e){return t=new Ql(t),e({INTERNAL:{getUid:C(t.getUid,t),getToken:C(t.cc,t),addAuthTokenListener:C(t.Wb,t),removeAuthTokenListener:C(t.Ec,t)}}),t}),t,(function(t,e){if("create"===t)try{e.auth()}catch(n){}})),r.a.INTERNAL.extendNamespace({User:Jh})}()}).apply("undefined"!==typeof t?t:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})}.call(this,n("c8ba"))},b8e3:function(t,e){t.exports=!0},bc3a:function(t,e,n){t.exports=n("cee4")},bcaa:function(t,e,n){var r=n("cb7c"),i=n("d3f4"),o=n("a5b8");t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t),a=n.resolve;return a(e),n.promise}},be13:function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},c23d:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n("9ab4"),o=n("cd51"),a=n("abfd"),s=(r={},r["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r),u=new o.ErrorFactory("app","Firebase",s),c="[DEFAULT]",h=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.services_={},this.tokenListeners_=[],this.analyticsEventRequests_=[],this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=o.deepCopy(t);var i=this;this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){r.tokenListeners_.push(t),setTimeout((function(){return t(null)}),0)},removeAuthTokenListener:function(t){r.tokenListeners_=r.tokenListeners_.filter((function(e){return e!==t}))},analytics:{logEvent:function(){i.analyticsEventRequests_.push(arguments)}}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){t.firebase_.INTERNAL.removeApp(t.name_);for(var e=[],n=0,r=Object.keys(t.services_);n<r.length;n++)for(var i=r[n],o=0,a=Object.keys(t.services_[i]);o<a.length;o++){var s=a[o];e.push(t.services_[i][s])}return Promise.all(e.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))})).then((function(){t.isDeleted_=!0,t.services_={}}))},t.prototype._getService=function(t,e){if(void 0===e&&(e=c),this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){var n=e!==c?e:void 0,r=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=r}return this.services_[t][e]},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=c),this.services_[t]&&this.services_[t][e]&&delete this.services_[t][e]},t.prototype.extendApp=function(t){if(o.deepExtend(this,t),t.INTERNAL){if(t.INTERNAL.addAuthTokenListener){for(var e=0,n=this.tokenListeners_;e<n.length;e++){var r=n[e];this.INTERNAL.addAuthTokenListener(r)}this.tokenListeners_=[]}if(t.INTERNAL.analytics){for(var i=0,a=this.analyticsEventRequests_;i<a.length;i++){var s=a[i];this.INTERNAL.analytics.logEvent.apply(void 0,s)}this.analyticsEventRequests_=[]}}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw u.create("app-deleted",{appName:this.name_})},t}();h.prototype.name&&h.prototype.options||h.prototype.delete||console.log("dc");var l="7.4.0",f=new a.Logger("@firebase/app");
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function p(t){var e={},n={},r={},i={__esModule:!0,initializeApp:h,app:s,apps:null,SDK_VERSION:l,INTERNAL:{registerService:d,removeApp:a,factories:n,useAsService:y}};function a(t){var n=e[t];m(n,"delete"),delete e[t]}function s(t){if(t=t||c,!o.contains(e,t))throw u.create("no-app",{appName:t});return e[t]}function h(n,r){if(void 0===r&&(r={}),"object"!==typeof r||null===r){var a=r;r={name:a}}var s=r;void 0===s.name&&(s.name=c);var h=s.name;if("string"!==typeof h||!h)throw u.create("bad-app-name",{appName:String(h)});if(o.contains(e,h))throw u.create("duplicate-app",{appName:h});var l=new t(n,s,i);return e[h]=l,m(l,"create"),l}function p(){return Object.keys(e).map((function(t){return e[t]}))}function d(e,a,c,h,l){if(void 0===l&&(l=!1),n[e])return f.debug("There were multiple attempts to register service "+e+"."),i[e];function d(t){if(void 0===t&&(t=s()),"function"!==typeof t[e])throw u.create("invalid-app-argument",{appName:e});return t[e]()}return n[e]=a,h&&(r[e]=h,p().forEach((function(t){h("create",t)}))),void 0!==c&&o.deepExtend(d,c),i[e]=d,t.prototype[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this._getService.bind(this,e);return r.apply(this,l?t:[])},d}function m(t,e){for(var i=0,o=Object.keys(n);i<o.length;i++){var a=o[i],s=y(t,a);if(null===s)return;r[s]&&r[s](e,t)}}function y(t,e){if("serverAuth"===e)return null;var n=e;return n}return(i["default"]=i,Object.defineProperty(i,"apps",{get:p}),s["App"]=t,i)}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d(){var t=p(h);function e(e){o.deepExtend(t,e)}return t.INTERNAL=i.__assign(i.__assign({},t.INTERNAL),{createFirebaseNamespace:d,extendNamespace:e,createSubscribe:o.createSubscribe,ErrorFactory:o.ErrorFactory,deepExtend:o.deepExtend}),t}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(o.isBrowser()&&void 0!==self.firebase){f.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var m=self.firebase.SDK_VERSION;m&&m.indexOf("LITE")>=0&&f.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var y=d(),g=y.initializeApp;y.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.isNode()&&f.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),g.apply(void 0,t)};var v=y;e.default=v,e.firebase=v},c345:function(t,e,n){"use strict";var r=n("c532"),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,o,a={};return t?(r.forEach(t.split("\n"),(function(t){if(o=t.indexOf(":"),e=r.trim(t.substr(0,o)).toLowerCase(),n=r.trim(t.substr(o+1)),e){if(a[e]&&i.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([n]):a[e]?a[e]+", "+n:n}})),a):a}},c366:function(t,e,n){var r=n("6821"),i=n("9def"),o=n("77f1");t.exports=function(t){return function(e,n,a){var s,u=r(e),c=i(u.length),h=o(a,c);if(t&&n!=n){while(c>h)if(s=u[h++],s!=s)return!0}else for(;c>h;h++)if((t||h in u)&&u[h]===n)return t||h||0;return!t&&-1}}},c367:function(t,e,n){"use strict";var r=n("8436"),i=n("50ed"),o=n("481b"),a=n("36c3");t.exports=n("30f1")(Array,"Array",(function(t,e){this._t=a(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},c3a1:function(t,e,n){var r=n("e6f3"),i=n("1691");t.exports=Object.keys||function(t){return r(t,i)}},c401:function(t,e,n){"use strict";var r=n("c532");t.exports=function(t,e,n){return r.forEach(n,(function(n){t=n(t,e)})),t}},c532:function(t,e,n){"use strict";var r=n("1d2b"),i=n("c7ce"),o=Object.prototype.toString;function a(t){return"[object Array]"===o.call(t)}function s(t){return"[object ArrayBuffer]"===o.call(t)}function u(t){return"undefined"!==typeof FormData&&t instanceof FormData}function c(t){var e;return e="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer,e}function h(t){return"string"===typeof t}function l(t){return"number"===typeof t}function f(t){return"undefined"===typeof t}function p(t){return null!==t&&"object"===typeof t}function d(t){return"[object Date]"===o.call(t)}function m(t){return"[object File]"===o.call(t)}function y(t){return"[object Blob]"===o.call(t)}function g(t){return"[object Function]"===o.call(t)}function v(t){return p(t)&&g(t.pipe)}function b(t){return"undefined"!==typeof URLSearchParams&&t instanceof URLSearchParams}function _(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}function w(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)}function T(t,e){if(null!==t&&"undefined"!==typeof t)if("object"!==typeof t&&(t=[t]),a(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}function E(){var t={};function e(e,n){"object"===typeof t[n]&&"object"===typeof e?t[n]=E(t[n],e):t[n]=e}for(var n=0,r=arguments.length;n<r;n++)T(arguments[n],e);return t}function S(){var t={};function e(e,n){"object"===typeof t[n]&&"object"===typeof e?t[n]=S(t[n],e):t[n]="object"===typeof e?S({},e):e}for(var n=0,r=arguments.length;n<r;n++)T(arguments[n],e);return t}function C(t,e,n){return T(e,(function(e,i){t[i]=n&&"function"===typeof e?r(e,n):e})),t}t.exports={isArray:a,isArrayBuffer:s,isBuffer:i,isFormData:u,isArrayBufferView:c,isString:h,isNumber:l,isObject:p,isUndefined:f,isDate:d,isFile:m,isBlob:y,isFunction:g,isStream:v,isURLSearchParams:b,isStandardBrowserEnv:w,forEach:T,merge:E,deepMerge:S,extend:C,trim:_}},c5f6:function(t,e,n){"use strict";var r=n("7726"),i=n("69a8"),o=n("2d95"),a=n("5dbc"),s=n("6a99"),u=n("79e5"),c=n("9093").f,h=n("11e9").f,l=n("86cc").f,f=n("aa77").trim,p="Number",d=r[p],m=d,y=d.prototype,g=o(n("2aeb")(y))==p,v="trim"in String.prototype,b=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){e=v?e.trim():f(e,3);var n,r,i,o=e.charCodeAt(0);if(43===o||45===o){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+e}for(var a,u=e.slice(2),c=0,h=u.length;c<h;c++)if(a=u.charCodeAt(c),a<48||a>i)return NaN;return parseInt(u,r)}}return+e};if(!d(" 0o1")||!d("0b1")||d("+0x1")){d=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof d&&(g?u((function(){y.valueOf.call(n)})):o(n)!=p)?a(new m(b(e)),n,d):b(e)};for(var _,w=n("9e1e")?c(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),T=0;w.length>T;T++)i(m,_=w[T])&&!i(d,_)&&l(d,_,h(m,_));d.prototype=y,y.constructor=d,n("2aba")(r,p,d)}},c69a:function(t,e,n){t.exports=!n("9e1e")&&!n("79e5")((function(){return 7!=Object.defineProperty(n("230e")("div"),"a",{get:function(){return 7}}).a}))},c7b2:function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"ErrorCode",(function(){return Nr})),n.d(e,"EventType",(function(){return kr})),n.d(e,"WebChannel",(function(){return Dr})),n.d(e,"XhrIo",(function(){return xr})),n.d(e,"createWebChannelTransport",(function(){return Ar}));var r,i="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{},o=o||{},a=i;function s(t){return"string"==typeof t}function u(t){return"number"==typeof t}function c(t,e){t=t.split("."),e=e||a;for(var n=0;n<t.length;n++)if(e=e[t[n]],null==e)return null;return e}function h(){}function l(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&"undefined"==typeof t.call)return"object";return e}function f(t){return"array"==l(t)}function p(t){var e=l(t);return"array"==e||"object"==e&&"number"==typeof t.length}function d(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var m="closure_uid_"+(1e9*Math.random()>>>0),y=0;function g(t,e,n){return t.call.apply(t.bind,arguments)}function v(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function b(t,e,n){return b=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?g:v,b.apply(null,arguments)}function _(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var w=Date.now||function(){return+new Date};function T(t,e){function n(){}n.prototype=e.prototype,t.N=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.yb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function E(){this.j=this.j,this.i=this.i}var S=0;E.prototype.j=!1,E.prototype.la=function(){if(!this.j&&(this.j=!0,this.G(),0!=S))this[m]||(this[m]=++y)},E.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var C=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(s(t))return s(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},I=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=s(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function A(t){t:{for(var e=zn,n=t.length,r=s(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:s(t)?t.charAt(e):t[e]}function N(t){return Array.prototype.concat.apply([],arguments)}function k(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function D(t){return/^[\s\xa0]*$/.test(t)}var x,O=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function R(t,e){return-1!=t.indexOf(e)}function M(t,e){return t<e?-1:t>e?1:0}t:{var P=a.navigator;if(P){var L=P.userAgent;if(L){x=L;break t}}x=""}function F(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function U(t){var e,n={};for(e in t)n[e]=t[e];return n}var q="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(var o=0;o<q.length;o++)n=q[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function B(t){return B[" "](t),t}function j(t,e){var n=et;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}B[" "]=h;var W,K=R(x,"Opera"),z=R(x,"Trident")||R(x,"MSIE"),G=R(x,"Edge"),Q=G||z,H=R(x,"Gecko")&&!(R(x.toLowerCase(),"webkit")&&!R(x,"Edge"))&&!(R(x,"Trident")||R(x,"MSIE"))&&!R(x,"Edge"),Y=R(x.toLowerCase(),"webkit")&&!R(x,"Edge");function $(){var t=a.document;return t?t.documentMode:void 0}t:{var X="",J=function(){var t=x;return H?/rv:([^\);]+)(\)|;)/.exec(t):G?/Edge\/([\d\.]+)/.exec(t):z?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Y?/WebKit\/(\S+)/.exec(t):K?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(J&&(X=J?J[1]:""),z){var Z=$();if(null!=Z&&Z>parseFloat(X)){W=String(Z);break t}}W=X}var tt,et={};function nt(t){return j(t,(function(){for(var e=0,n=O(String(W)).split("."),r=O(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=M(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||M(0==a[2].length,0==s[2].length)||M(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}var rt=a.document;tt=rt&&z?$()||("CSS1Compat"==rt.compatMode?parseInt(W,10):5):void 0;var it=!z||9<=Number(tt),ot=z&&!nt("9"),at=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{a.addEventListener("test",h,e),a.removeEventListener("test",h,e)}catch(n){}return t}();function st(t,e){this.type=t,this.a=this.target=e,this.Ja=!0}function ut(t,e){if(st.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(H){t:{try{B(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=s(t.pointerType)?t.pointerType:ct[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}st.prototype.b=function(){this.Ja=!1},T(ut,st);var ct={2:"touch",3:"pen",4:"mouse"};ut.prototype.b=function(){ut.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ot)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var ht="closure_listenable_"+(1e6*Math.random()|0),lt=0;function ft(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++lt,this.X=this.Z=!1}function pt(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function dt(t){this.src=t,this.a={},this.b=0}function mt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=C(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(pt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function yt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}dt.prototype.add=function(t,e,n,r,i){var o=t.toString();t=this.a[o],t||(t=this.a[o]=[],this.b++);var a=yt(t,e,r,i);return-1<a?(e=t[a],n||(e.Z=!1)):(e=new ft(e,this.src,o,!!r,i),e.Z=n,t.push(e)),e};var gt="closure_lm_"+(1e6*Math.random()|0),vt={};function bt(t,e,n,r,i){if(r&&r.once)return Tt(t,e,n,r,i);if(f(e)){for(var o=0;o<e.length;o++)bt(t,e[o],n,r,i);return null}return n=Dt(n),t&&t[ht]?t.Aa(e,n,d(r)?!!r.capture:!!r,i):_t(t,e,n,!1,r,i)}function _t(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=d(i)?!!i.capture:!!i;if(a&&!it)return null;var s=Nt(t);if(s||(t[gt]=s=new dt(t)),n=s.add(e,n,r,a,o),n.proxy)return n;if(r=wt(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)at||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ct(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function wt(){var t=At,e=it?function(n){return t.call(e.src,e.listener,n)}:function(n){if(n=t.call(e.src,e.listener,n),!n)return n};return e}function Tt(t,e,n,r,i){if(f(e)){for(var o=0;o<e.length;o++)Tt(t,e[o],n,r,i);return null}return n=Dt(n),t&&t[ht]?t.Ba(e,n,d(r)?!!r.capture:!!r,i):_t(t,e,n,!0,r,i)}function Et(t,e,n,r,i){if(f(e))for(var o=0;o<e.length;o++)Et(t,e[o],n,r,i);else r=d(r)?!!r.capture:!!r,n=Dt(n),t&&t[ht]?(t=t.c,e=String(e).toString(),e in t.a&&(o=t.a[e],n=yt(o,n,r,i),-1<n&&(pt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=Nt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=yt(e,n,r,i)),(n=-1<t?e[t]:null)&&St(n))}function St(t){if(!u(t)&&t&&!t.X){var e=t.src;if(e&&e[ht])mt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ct(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Nt(e))?(mt(n,t),0==n.b&&(n.src=null,e[gt]=null)):pt(t)}}}function Ct(t){return t in vt?vt[t]:vt[t]="on"+t}function It(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&St(t),n.call(r,e)}function At(t,e){return!!t.X||(it?It(t,new ut(e,this)):(e=new ut(e||c("window.event"),this),It(t,e)))}function Nt(t){return t=t[gt],t instanceof dt?t:null}var kt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Dt(t){return"function"==l(t)?t:(t[kt]||(t[kt]=function(e){return t.handleEvent(e)}),t[kt])}function xt(){E.call(this),this.c=new dt(this),this.J=this,this.B=null}function Ot(t,e,n,r){if(e=t.c.a[String(e)],!e)return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.X&&a.capture==n){var s=a.listener,u=a.da||a.src;a.Z&&mt(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Ja}T(xt,E),xt.prototype[ht]=!0,r=xt.prototype,r.addEventListener=function(t,e,n,r){bt(this,t,e,n,r)},r.removeEventListener=function(t,e,n,r){Et(this,t,e,n,r)},r.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var r=t.type||t;if(s(t))t=new st(t,n);else if(t instanceof st)t.target=t.target||n;else{var i=t;t=new st(r,n),V(t,i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.a=e[o];i=Ot(a,r,!0,t)&&i}if(a=t.a=n,i=Ot(a,r,!0,t)&&i,i=Ot(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)a=t.a=e[o],i=Ot(a,r,!1,t)&&i;return i},r.G=function(){if(xt.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)pt(n[r]);delete e.a[t],e.b--}}this.B=null},r.Aa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},r.Ba=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Rt=a.JSON.stringify;function Mt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Pt(){this.b=this.a=null}Mt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Lt,Ft=new Mt((function(){return new qt}),(function(t){t.reset()}));function Ut(){var t=Kt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function qt(){this.next=this.b=this.a=null}function Vt(t){a.setTimeout((function(){throw t}),0)}function Bt(t,e){Lt||jt(),Wt||(Lt(),Wt=!0),Kt.add(t,e)}function jt(){var t=a.Promise.resolve(void 0);Lt=function(){t.then(zt)}}Pt.prototype.add=function(t,e){var n=Ft.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},qt.prototype.reset=function(){this.next=this.b=this.a=null};var Wt=!1,Kt=new Pt;function zt(){for(var t;t=Ut();){try{t.a.call(t.b)}catch(n){Vt(n)}var e=Ft;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Wt=!1}function Gt(t,e){xt.call(this),this.b=t||1,this.a=e||a,this.f=b(this.gb,this),this.g=w()}function Qt(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function Ht(t,e,n){if("function"==l(t))n&&(t=b(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=b(t.handleEvent,t)}return 2147483647<Number(e)?-1:a.setTimeout(t,e||0)}function Yt(t,e,n){E.call(this),this.f=null!=n?b(t,n):t,this.c=e,this.b=b(this.ab,this),this.a=[]}function $t(t){t.U=Ht(t.b,t.c),t.f.apply(null,t.a)}function Xt(t){E.call(this),this.b=t,this.a={}}T(Gt,xt),r=Gt.prototype,r.ba=!1,r.L=null,r.gb=function(){if(this.ba){var t=w()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(Qt(this),this.start()))}},r.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=w())},r.G=function(){Gt.N.G.call(this),Qt(this),delete this.a},T(Yt,E),r=Yt.prototype,r.ea=!1,r.U=null,r.Ua=function(t){this.a=arguments,this.U?this.ea=!0:$t(this)},r.G=function(){Yt.N.G.call(this),this.U&&(a.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},r.ab=function(){this.U=null,this.ea&&(this.ea=!1,$t(this))},T(Xt,E);var Jt=[];function Zt(t,e,n,r){f(n)||(n&&(Jt[0]=n.toString()),n=Jt);for(var i=0;i<n.length;i++){var o=bt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function te(t){F(t.a,(function(t,e){this.a.hasOwnProperty(e)&&St(t)}),t),t.a={}}function ee(){}Xt.prototype.G=function(){Xt.N.G.call(this),te(this)},Xt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ne=new xt;function re(t){st.call(this,"serverreachability",t)}function ie(t){ne.dispatchEvent(new re(ne,t))}function oe(t){st.call(this,"statevent",t)}function ae(t){ne.dispatchEvent(new oe(ne,t))}function se(t){st.call(this,"timingevent",t)}function ue(t,e){if("function"!=l(t))throw Error("Fn must not be null and must be a function");return a.setTimeout((function(){t()}),e)}T(re,st),T(oe,st),T(se,st);var ce={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,Ma:7,TIMEOUT:8,sb:9},he={jb:"complete",wb:"success",Na:"error",Ma:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function le(){}function fe(t){var e;return(e=t.a)||(e=t.a={}),e}function pe(){}le.prototype.a=null;var de,me={OPEN:"a",ib:"b",Na:"c",rb:"d"};function ye(){st.call(this,"d")}function ge(){st.call(this,"c")}function ve(){}function be(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new Xt(this),this.O=_e,t=Q?125:void 0,this.P=new Gt(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}T(ye,st),T(ge,st),T(ve,le),de=new ve;var _e=45e3,we={},Te={};function Ee(t,e,n){t.F=1,t.f=Xe(Ke(e)),t.l=n,t.H=!0,Ce(t,null)}function Se(t,e,n,r){t.F=1,t.f=Xe(Ke(e)),t.l=null,t.H=n,Ce(t,r)}function Ce(t,e){t.v=w(),Ne(t),t.D=Ke(t.f),$e(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new Yt(b(t.Ka,t,t.a),t.J)),Zt(t.I,t.a,"readystatechange",t.eb),e=t.h?U(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),ie(1)}function Ie(t,e,n){for(var r=!0;!t.m&&t.A<n.length;){var i=Ae(t,n);if(i==Te){4==e&&(t.c=4,ae(14),r=!1);break}if(i==we){t.c=4,ae(15),r=!1;break}Re(t,i)}4==e&&0==n.length&&(t.c=1,ae(16),r=!1),t.b=t.b&&r,r||(Oe(t),xe(t))}function Ae(t,e){var n=t.A,r=e.indexOf("\n",n);return-1==r?Te:(n=Number(e.substring(n,r)),isNaN(n)?we:(r+=1,r+n>e.length?Te:(e=e.substr(r,n),t.A=r+n,e)))}function Ne(t){t.R=w()+t.O,ke(t,t.O)}function ke(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=ue(b(t.bb,t),e)}function De(t){t.i&&(a.clearTimeout(t.i),t.i=null)}function xe(t){t.g.Da()||t.m||t.g.na(t)}function Oe(t){De(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,Qt(t.P),te(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Re(t,e){try{t.g.Ga(t,e),ie(4)}catch(n){}}function Me(t){if(t.C&&"function"==typeof t.C)return t.C();if(s(t))return t.split("");if(p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Pe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||s(t))I(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(p(t)||s(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;r=Me(t),i=r.length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Le(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Le)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Fe(t){t.b={},t.a.length=0,t.c=0}function Ue(t,e){Ve(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&qe(t))}function qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ve(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r=t.a[e],Ve(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Ve(t,e){return Object.prototype.hasOwnProperty.call(t,e)}r=be.prototype,r.setTimeout=function(t){this.O=t},r.eb=function(t){t=t.target;var e=this.B;e&&3==Xn(t)?e.Ua():this.Ka(t)},r.Ka=function(t){try{if(t==this.a)t:{var e=Xn(this.a),n=this.a.ya(),r=this.a.T();if(!(3>e||3==e&&!Q&&!this.a.aa())){this.m||4!=e||7==n||ie(8==n||0>=r?3:2),De(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var a=Jn(this.a,"X-HTTP-Initial-Response");if(a&&!D(a)){var s=a;break e}}s=null}if(!s){this.b=!1,this.c=3,ae(12),Oe(this),xe(this);break t}this.s=!0,Re(this,s)}this.H?(Ie(this,e,o),Q&&this.b&&3==e&&(Zt(this.I,this.P,"tick",this.cb),this.P.start())):Re(this,o),4==e&&Oe(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,Ne(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,ae(12)):(this.c=0,ae(13)),Oe(this),xe(this)}}}catch(u){}},r.cb=function(){if(this.a){var t=Xn(this.a),e=this.a.aa();this.A<e.length&&(De(this),Ie(this,t,e),this.b&&4!=t&&Ne(this))}},r.cancel=function(){this.m=!0,Oe(this)},r.bb=function(){this.i=null;var t=w();0<=t-this.R?(2!=this.F&&(ie(3),ae(17)),Oe(this),this.c=2,xe(this)):ke(this,this.R-t)},r=Le.prototype,r.C=function(){qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},r.K=function(){return qe(this),this.a.concat()},r.get=function(t,e){return Ve(this.b,t)?this.b[t]:e},r.set=function(t,e){Ve(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},r.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Be=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function je(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function We(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof We?(this.h=void 0!==e?e:t.h,ze(this,t.f),this.j=t.j,Ge(this,t.b),Qe(this,t.i),this.a=t.a,He(this,dn(t.c)),this.g=t.g):t&&(n=String(t).match(Be))?(this.h=!!e,ze(this,n[1]||"",!0),this.j=tn(n[2]||""),Ge(this,n[3]||"",!0),Qe(this,n[4]),this.a=tn(n[5]||"",!0),He(this,n[6]||"",!0),this.g=tn(n[7]||"")):(this.h=!!e,this.c=new cn(null,this.h))}function Ke(t){return new We(t)}function ze(t,e,n){t.f=n?tn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ge(t,e,n){t.b=n?tn(e,!0):e}function Qe(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function He(t,e,n){e instanceof cn?(t.c=e,yn(t.c,t.h)):(n||(e=en(e,sn)),t.c=new cn(e,t.h))}function Ye(t,e,n){t.c.set(e,n)}function $e(t,e,n){f(n)||(n=[String(n)]),pn(t.c,e,n)}function Xe(t){return Ye(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^w()).toString(36)),t}function Je(t){return t instanceof We?Ke(t):new We(t,void 0)}function Ze(t,e,n,r){var i=new We(null,void 0);return t&&ze(i,t),e&&Ge(i,e),n&&Qe(i,n),r&&(i.a=r),i}function tn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function en(t,e,n){return s(t)?(t=encodeURI(t).replace(e,nn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function nn(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(en(e,rn,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(en(e,rn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.i,null!=n&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(en(n,"/"==n.charAt(0)?an:on,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",en(n,un)),t.join("")},We.prototype.resolve=function(t){var e=Ke(this),n=!!t.f;n?ze(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?Ge(e,t.b):n=null!=t.i;var r=t.a;if(n)Qe(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(i=r,".."==i||"."==i)r="";else if(R(i,"./")||R(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?He(e,dn(t.c)):n=!!t.g,n&&(e.g=t.g),e};var rn=/[#\/\?@]/g,on=/[#\?:]/g,an=/[#\?]/g,sn=/[#\?@]/g,un=/#/g;function cn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function hn(t){t.a||(t.a=new Le,t.b=0,t.c&&je(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function ln(t,e){hn(t),e=mn(t,e),Ve(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ue(t.a,e))}function fn(t,e){return hn(t),e=mn(t,e),Ve(t.a.b,e)}function pn(t,e,n){ln(t,e),0<n.length&&(t.c=null,t.a.set(mn(t,e),k(n)),t.b+=n.length)}function dn(t){var e=new cn;return e.c=t.c,t.a&&(e.a=new Le(t.a),e.b=t.b),e}function mn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function yn(t,e){e&&!t.f&&(hn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(ln(this,e),pn(this,n,t))}),t)),t.f=e}function gn(){}function vn(){}function bn(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function _n(t){var e=t.a.F.a;if(null!=e)ae(4),e?(ae(10),fr(t.a,t,!1)):(ae(11),fr(t.a,t,!0));else{t.b=new be(t,void 0,void 0),t.b.h=t.h,e=t.a,e=gr(e,e.Y()?t.f:null,t.i),ae(4),$e(e,"TYPE","xmlhttp");var n=t.a.j,r=t.a.I;n&&r&&Ye(e,n,r),Se(t.b,e,!1,t.f)}}function wn(){this.a=this.b=null}function Tn(){this.a=new Le}function En(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[m]||(t[m]=++y)):e.charAt(0)+t}function Sn(t,e){this.b=t,this.a=e}function Cn(t){this.g=t||In,a.PerformanceNavigationTiming?(t=a.performance.getEntriesByType("navigation"),t=0<t.length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol)):t=!!(a.ka&&a.ka.Ea&&a.ka.Ea()&&a.ka.Ea().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Tn),this.b=null,this.c=[]}r=cn.prototype,r.add=function(t,e){hn(this),this.c=null,t=mn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},r.forEach=function(t,e){hn(this),this.a.forEach((function(n,r){I(n,(function(n){t.call(e,n,r,this)}),this)}),this)},r.K=function(){hn(this);for(var t=this.a.C(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},r.C=function(t){hn(this);var e=[];if(s(t))fn(this,t)&&(e=N(e,this.a.get(mn(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=N(e,t[n])}return e},r.set=function(t,e){return hn(this),this.c=null,t=mn(this,t),fn(this,t)&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},r.get=function(t,e){return t?(t=this.C(t),0<t.length?String(t[0]):e):e},r.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")},T(vn,gn),r=bn.prototype,r.M=null,r.$=function(t){return this.a.$(t)},r.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},r.Da=function(){return!1},r.Ga=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=Jn(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=Jn(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var r=this.a.ja.a.parse(e)}catch(i){return e=this.a,e.m=this.c,void mr(e,2)}this.f=r[0]}else e=this.a,e.m=this.c,mr(e,2)}else 1==this.M&&(this.g?ae(6):"11111"==e?(ae(5),this.g=!0,(!z||10<=Number(tt))&&(this.c=200,this.b.cancel(),ae(11),fr(this.a,this,!0))):(ae(7),this.g=!1))},r.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,_n(this)):1==this.M&&(this.g?(ae(11),fr(this.a,this,!0)):(ae(10),fr(this.a,this,!1)));else{0==this.M?ae(8):1==this.M&&ae(9);var t=this.a;t.m=this.c,mr(t,2)}},r.Y=function(){return this.a.Y()},r.ma=function(){return this.a.ma()},Tn.prototype.add=function(t){this.a.set(En(t),t)},Tn.prototype.C=function(){return this.a.C()};var In=10;function An(t,e){!t.a&&(R(e,"spdy")||R(e,"quic")||R(e,"h2"))&&(t.f=t.g,t.a=new Tn,t.b&&(xn(t,t.b),t.b=null))}function Nn(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function kn(t){return t.b?1:t.a?t.a.a.c:0}function Dn(t,e){return t.b?t=t.b==e:t.a?(e=En(e),t=Ve(t.a.a.b,e)):t=!1,t}function xn(t,e){t.a?t.a.add(e):t.b=e}function On(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=En(e),n=Ve(t.a.a.b,n)),n&&Ue(t.a.a,En(e)))}function Rn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null!=t.a&&0!=t.a.a.c){var e=t.c;return I(t.a.C(),(function(t){e=e.concat(t.j)})),e}return k(t.c)}function Mn(){}function Pn(){this.a=new Mn}function Ln(t,e,n){var r=n||"";try{Pe(t,(function(t,n){var i=t;d(t)&&(i=Rt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Fn(t,e){var n=new ee;if(a.Image){var r=new Image;r.onload=_(Un,n,r,"TestLoadImage: loaded",!0,e),r.onerror=_(Un,n,r,"TestLoadImage: error",!1,e),r.onabort=_(Un,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=_(Un,n,r,"TestLoadImage: timeout",!1,e),a.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}function Un(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}Cn.prototype.cancel=function(){this.c=Rn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(I(this.a.C(),(function(t){t.cancel()})),Fe(this.a.a))},Mn.prototype.stringify=function(t){return a.JSON.stringify(t,void 0)},Mn.prototype.parse=function(t){return a.JSON.parse(t,void 0)};var qn=a.JSON.parse;function Vn(t){xt.call(this),this.headers=new Le,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Bn,this.D=this.F=!1}T(Vn,xt);var Bn="",jn=/^https?$/i,Wn=["POST","PUT"];function Kn(t){return z&&nt(9)&&u(t.timeout)&&void 0!==t.ontimeout}function zn(t){return"content-type"==t.toLowerCase()}function Gn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Qn(t),Yn(t)}function Qn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Hn(t){if(t.b&&"undefined"!=typeof o&&(!t.s[1]||4!=Xn(t)||2!=t.T()))if(t.l&&4==Xn(t))Ht(t.Fa,0,t);else if(t.dispatchEvent("readystatechange"),4==Xn(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var s=String(t.A).match(Be)[1]||null;if(!s&&a.self&&a.self.location){var u=a.self.location.protocol;s=u.substr(0,u.length-1)}i=!jn.test(s?s.toLowerCase():"")}e=i}e?(t.dispatchEvent("complete"),t.dispatchEvent("success")):(t.h=6,t.f=t.za()+" ["+t.T()+"]",Qn(t))}finally{Yn(t)}}}function Yn(t,e){if(t.a){$n(t);var n=t.a,r=t.s[0]?h:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function $n(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(a.clearTimeout(t.m),t.m=null)}function Xn(t){return t.a?t.a.readyState:0}function Jn(t,e){return t.a?t.a.getResponseHeader(e):null}function Zn(t){var e="";return F(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function tr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=Zn(n),s(t)){if(e=encodeURIComponent(String(e)),n=null!=n?"="+encodeURIComponent(String(n)):"",e+=n){if(n=t.indexOf("#"),0>n&&(n=t.length),r=t.indexOf("?"),0>r||r>n){r=n;var i=""}else i=t.substring(r+1,n);t=[t.substr(0,r),i,t.substr(n)],n=t[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return Ye(t,e,n),t}function er(t){this.f=[],this.F=new wn,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Ra=this.P=0,this.Pa=!!c("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Oa=c("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Sa=c("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Qa=c("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=c("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.La=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new Cn(t&&t.concurrentRequestLimit),this.ja=new Pn,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function nr(t){if(rr(t),3==t.u){var e=t.P++,n=Ke(t.B);Ye(n,"SID",t.H),Ye(n,"RID",e),Ye(n,"TYPE","terminate"),ur(t,n),e=new be(t,e,void 0),e.F=2,e.f=Xe(Ke(n)),n=!1,a.navigator&&a.navigator.sendBeacon&&(n=a.navigator.sendBeacon(e.f.toString(),"")),!n&&a.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=w(),Ne(e)}yr(t)}function rr(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(a.clearTimeout(t.l),t.l=null),pr(t),t.b.cancel(),t.h&&(u(t.h)&&a.clearTimeout(t.h),t.h=null)}function ir(t,e){t.f.push(new Sn(t.Ra++,e)),3==t.u&&or(t)}function or(t){Nn(t.b)||t.h||(t.h=!0,Bt(t.Ia,t),t.A=0)}function ar(t,e){return!(kn(t.b)>=t.b.f-(t.h?1:0))&&(t.h?(t.f=e.j.concat(t.f),!0):!(1==t.u||2==t.u||t.A>=(t.Pa?0:t.Qa))&&(t.h=ue(b(t.Ia,t,e),dr(t,t.A)),t.A++,!0))}function sr(t,e){var n;n=e?e.W:t.P++;var r=Ke(t.B);Ye(r,"SID",t.H),Ye(r,"RID",n),Ye(r,"AID",t.O),ur(t,r),t.g&&t.i&&tr(r,t.g,t.i),n=new be(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=cr(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),xn(t.b,n),Ee(n,r,e)}function ur(t,e){t.c&&Pe({},(function(t,n){Ye(e,n,t)}))}function cr(t,e,n){n=Math.min(t.f.length,n);var r=t.c?b(t.c.Ta,t.c,t):null;t:for(var i=t.f,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(c-=o,0>c)o=Math.max(0,i[u].b-100),s=!1;else try{Ln(h,a,"req"+c+"_")}catch(l){r&&r(h)}}if(s){r=a.join("&");break t}}return t=t.f.splice(0,n),e.j=t,r}function hr(t){t.a||t.l||(t.S=1,Bt(t.Ha,t),t.v=0)}function lr(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=ue(b(t.Ha,t),dr(t,t.v)),t.v++,!0)}function fr(t,e,n){var r=e.l;r&&An(t.b,r),t.ia=t.oa&&n,t.m=e.c,t.B=gr(t,null,t.ha),or(t)}function pr(t){null!=t.s&&(a.clearTimeout(t.s),t.s=null)}function dr(t,e){var n=t.Oa+Math.floor(Math.random()*t.Sa);return t.ma()||(n*=2),n*e}function mr(t,e){if(2==e){var n=null;t.c&&(n=null);var r=b(t.fb,t);n||(n=new We("//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||ze(n,"https"),Xe(n)),Fn(n.toString(),r)}else ae(2);t.u=0,t.c&&t.c.ta(e),yr(t),rr(t)}function yr(t){t.u=0,t.m=-1,t.c&&(0==Rn(t.b).length&&0==t.f.length||(t.b.c.length=0,k(t.f),t.f.length=0),t.c.sa())}function gr(t,e,n){var r=Je(n);if(""!=r.b)e&&Ge(r,e+"."+r.b),Qe(r,r.i);else{var i,o=a.location;i=e?e+"."+o.hostname:o.hostname,r=Ze(o.protocol,i,+o.port,n)}return t.V&&F(t.V,(function(t,e){Ye(r,e,t)})),e=t.j,n=t.I,e&&n&&Ye(r,e,n),Ye(r,"VER",t.wa),ur(t,r),r}function vr(){}function br(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r,i=arguments[n];if(0==i.lastIndexOf("/",0))e=i;else(r=""==e)||(r=e.length-1,r=0<=r&&e.indexOf("/",r)==r),e+=r?i:"/"+i}return e}function _r(){if(z&&!(10<=Number(tt)))throw Error("Environmental error: no available transport.")}function wr(t,e){xt.call(this),this.a=new er(e),this.g=t,this.m=e&&e.testUrl?e.testUrl:br(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!D(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!D(e)&&(this.a.j=e,t=this.b,null!==t&&e in t&&(t=this.b,e in t&&delete t[e])),this.f=new Sr(this)}function Tr(t){ye.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Er(){ge.call(this),this.status=1}function Sr(t){this.a=t}r=Vn.prototype,r.ca=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?fe(this.H):fe(de),this.a.onreadystatechange=b(this.Fa,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(o){return void Gn(this,o)}t=n||"";var i=new Le(this.headers);r&&Pe(r,(function(t,e){i.set(e,t)})),r=A(i.K()),n=a.FormData&&t instanceof a.FormData,!(0<=C(Wn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{$n(this),0<this.o&&((this.D=Kn(this.a))?(this.a.timeout=this.o,this.a.ontimeout=b(this.Ca,this)):this.m=Ht(this.Ca,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){Gn(this,o)}},r.Ca=function(){"undefined"!=typeof o&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},r.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Yn(this))},r.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Yn(this,!0)),Vn.N.G.call(this)},r.Fa=function(){this.j||(this.w||this.l||this.g?Hn(this):this.$a())},r.$a=function(){Hn(this)},r.T=function(){try{return 2<Xn(this)?this.a.status:-1}catch(t){return-1}},r.za=function(){try{return 2<Xn(this)?this.a.statusText:""}catch(t){return""}},r.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},r.Va=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),qn(e)}},r.ya=function(){return this.h},r.Ya=function(){return s(this.f)?this.f:String(this.f)},r=er.prototype,r.wa=8,r.u=1,r.Da=function(){return 0==this.u},r.Ia=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random()),t=this.P++;var e,n=new be(this,t,void 0),r=this.i;if(this.J&&(r?(r=U(r),V(r,this.J)):r=this.J),null===this.g&&(n.h=r),this.W)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(o="__data__"in o.a&&(o=o.a.__data__,s(o))?o.length:void 0,void 0===o)break;if(e+=o,4096<e){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=cr(this,n,e),i=Ke(this.B),Ye(i,"RID",t),Ye(i,"CVER",22),this.o&&this.j&&Ye(i,"X-HTTP-Session-Id",this.j),ur(this,i),this.g&&r&&tr(i,this.g,r),xn(this.b,n),this.W?(Ye(i,"$req",e),Ye(i,"SID","null"),n.S=!0,Ee(n,i,null)):Ee(n,i,e),this.u=2}}else 3==this.u&&(t?sr(this,t):0==this.f.length||Nn(this.b)||sr(this))},r.Ha=function(){this.l=null,this.a=new be(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=Ke(this.pa);Ye(t,"RID","rpc"),Ye(t,"SID",this.H),Ye(t,"CI",this.ia?"0":"1"),Ye(t,"AID",this.O),ur(this,t),Ye(t,"TYPE","xmlhttp"),this.g&&this.i&&tr(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),Se(this.a,t,!0,this.ga)},r.Ga=function(t,e){if(0!=this.u&&(this.a==t||Dn(this.b,t)))if(this.m=t.o,!t.s&&Dn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(o){n=null}if(f(n)&&3==n.length){if(e=n,0==e[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;pr(this),this.a.cancel(),this.a=null}lr(this),ae(18)}}else this.ra=e[1],0<this.ra-this.O&&37500>e[2]&&this.ia&&0==this.v&&!this.s&&(this.s=ue(b(this.Za,this),6e3));if(1>=kn(this.b)&&this.fa){try{this.fa()}catch(o){}this.fa=void 0}}else mr(this,11)}else if((t.s||this.a==t)&&pr(this),!D(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var r=e[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),r=r[5],null!=r&&u(r)&&0<r&&(this.D=1.5*r),this.o&&(r=t.a)&&((i=Jn(r,"X-Client-Wire-Protocol"))&&An(this.b,i),this.j&&(r=Jn(r,"X-HTTP-Session-Id")))&&(this.I=r,Ye(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=t,this.pa=gr(this,this.Y()?this.ga:null,this.ha),r.s?(On(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(De(r),Ne(r)),this.a=r):hr(this),0<this.f.length&&or(this)}else"stop"!=r[0]&&"close"!=r[0]||mr(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?mr(this,7):nr(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},r.Za=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,lr(this),ae(19))},r.na=function(t){var e=null;if(this.a==t){pr(this),this.a=null;var n=2}else{if(!Dn(this.b,t))return;e=t.j,On(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=w()-t.v,ne.dispatchEvent(new se(ne,t.l?t.l.length:0,e,this.A)),or(this)):hr(this);else{var r=t.c;if(3==r||0==r&&0<this.m||!(1==n&&ar(this,t)||2==n&&lr(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),r){case 1:mr(this,5);break;case 4:mr(this,10);break;case 3:mr(this,6);break;default:mr(this,2)}}},r.fb=function(t){ae(t?2:1)},r.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return t=new Vn(this.La),t.F=this.R,t},r.ma=function(){return!!this.c&&!0},r.Y=function(){return this.R},r=vr.prototype,r.va=function(){},r.ua=function(){},r.ta=function(){},r.sa=function(){},r.Ta=function(){},_r.prototype.a=function(t,e){return new wr(t,e)},T(wr,xt),r=wr.prototype,r.addEventListener=function(t,e,n,r){wr.N.addEventListener.call(this,t,e,n,r)},r.removeEventListener=function(t,e,n,r){wr.N.removeEventListener.call(this,t,e,n,r)},r.Wa=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,r=this.b||void 0;ae(0),t.ha=n,t.V=r||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new bn(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=tr(e,t.g,t.i)),t=t.w,t.i=n,e=gr(t.a,null,t.i),ae(3),n=t.a.F.b,null!=n?(t.f=n[0],t.M=1,_n(t)):($e(e,"MODE","init"),!t.a.o&&t.a.j&&$e(e,"X-HTTP-Session-Id",t.a.j),t.b=new be(t,void 0,void 0),t.b.h=t.h,Se(t.b,e,!1,null),t.M=0)},r.close=function(){nr(this.a)},r.Xa=function(t){if(s(t)){var e={};e.__data__=t,ir(this.a,e)}else this.h?(e={},e.__data__=Rt(t),ir(this.a,e)):ir(this.a,t)},r.G=function(){this.a.c=null,delete this.f,nr(this.a),delete this.a,wr.N.G.call(this)},T(Tr,ye),T(Er,ge),T(Sr,vr),Sr.prototype.va=function(){this.a.dispatchEvent("a")},Sr.prototype.ua=function(t){this.a.dispatchEvent(new Tr(t))},Sr.prototype.ta=function(t){this.a.dispatchEvent(new Er(t))},Sr.prototype.sa=function(){this.a.dispatchEvent("b")};var Cr=_((function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r}),_r);_r.prototype.createWebChannel=_r.prototype.a,wr.prototype.send=wr.prototype.Xa,wr.prototype.open=wr.prototype.Wa,wr.prototype.close=wr.prototype.close,ce.NO_ERROR=0,ce.TIMEOUT=8,ce.HTTP_ERROR=6,he.COMPLETE="complete",pe.EventType=me,me.OPEN="a",me.CLOSE="b",me.ERROR="c",me.MESSAGE="d",xt.prototype.listen=xt.prototype.Aa,Vn.prototype.listenOnce=Vn.prototype.Ba,Vn.prototype.getLastError=Vn.prototype.Ya,Vn.prototype.getLastErrorCode=Vn.prototype.ya,Vn.prototype.getStatus=Vn.prototype.T,Vn.prototype.getStatusText=Vn.prototype.za,Vn.prototype.getResponseJson=Vn.prototype.Va,Vn.prototype.getResponseText=Vn.prototype.aa,Vn.prototype.send=Vn.prototype.ca;var Ir={createWebChannelTransport:Cr,ErrorCode:ce,EventType:he,WebChannel:pe,XhrIo:Vn},Ar=Ir.createWebChannelTransport,Nr=Ir.ErrorCode,kr=Ir.EventType,Dr=Ir.WebChannel,xr=Ir.XhrIo;e["default"]=Ir}.call(this,n("c8ba"))},c7ce:function(t,e){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&null!=t.constructor&&"function"===typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}},c8af:function(t,e,n){"use strict";var r=n("c532");t.exports=function(t,e){r.forEach(t,(function(n,r){r!==e&&r.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[r])}))}},c8ba:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}t.exports=n},c8bb:function(t,e,n){t.exports=n("54a1")},ca5a:function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},cadf:function(t,e,n){"use strict";var r=n("9c6c"),i=n("d53b"),o=n("84f2"),a=n("6821");t.exports=n("01f9")(Array,"Array",(function(t,e){this._t=a(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},cb7c:function(t,e,n){var r=n("d3f4");t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},cd51:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=n("9ab4"),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw a(e)},a=function(t){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},s=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296===(64512&i)&&r+1<t.length&&56320===(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},u=function(t){var e=[],n=0,r=0;while(n<t.length){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){o=t[n++];var a=t[n++],s=t[n++],u=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&s)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(1023&u))}else{o=t[n++],a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,p=63&c;u||(p=64,a||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):u(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length,s=a?n[t.charAt(i)]:0;++i;var u=i<t.length,c=u?n[t.charAt(i)]:64;++i;var h=i<t.length,l=h?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==c||null==l)throw Error();var f=o<<2|s>>4;if(r.push(f),64!==c){var p=s<<4&240|c>>2;if(r.push(p),64!==l){var d=c<<6&192|l;r.push(d)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},h=function(t){var e=s(t);return c.encodeByteArray(e,!0)},l=function(t){try{return c.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function f(t){return p(void 0,t)}function p(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:var n=e;return new Date(n.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var r in e)e.hasOwnProperty(r)&&(t[r]=p(t[r],e[r]));return t}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var d=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"===typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m(){return"undefined"!==typeof navigator&&"string"===typeof navigator["userAgent"]?navigator["userAgent"]:""}function y(){return"undefined"!==typeof window&&!!(window["cordova"]||window["phonegap"]||window["PhoneGap"])&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(m())}function g(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(e){return!1}}function v(){return"object"===typeof self&&self.self===self}function b(){return"object"===typeof navigator&&"ReactNative"===navigator["product"]}function _(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var w="FirebaseError",T=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name=w,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,E.prototype.create),i}return r.__extends(e,t),e}(Error),E=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?S(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new T(i,s),c=0,h=Object.keys(r);c<h.length;c++){var l=h[c];"_"!==l.slice(-1)&&(l in u&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),u[l]=r[l])}return u},t}();function S(t,e){return t.replace(C,(function(t,n){var r=e[n];return null!=r?r.toString():"<"+n+"?>"}))}var C=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I(t){return JSON.parse(t)}function A(t){return JSON.stringify(t)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var N=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=I(l(o[0])||""),n=I(l(o[1])||""),i=o[2],r=n["d"]||{},delete n["d"]}catch(a){}return{header:e,claims:n,data:r,signature:i}},k=function(t){var e=N(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"===typeof e&&(e.hasOwnProperty("nbf")?r=e["nbf"]:e.hasOwnProperty("iat")&&(r=e["iat"]),i=e.hasOwnProperty("exp")?e["exp"]:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},D=function(t){var e=N(t).claims;return"object"===typeof e&&e.hasOwnProperty("iat")?e["iat"]:null},x=function(t){var e=N(t),n=e.claims;return!!n&&"object"===typeof n&&n.hasOwnProperty("iat")},O=function(t){var e=N(t).claims;return"object"===typeof e&&!0===e["admin"]};
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function R(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function M(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function P(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function L(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r],a=o[0],s=o[1];n(a,s)}return e.length?"&"+e.join("&"):""}function U(t){var e={},n=t.replace(/^\?/,"").split("&");return n.forEach((function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}})),e}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var q=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"===typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=h^u&(c^h),a=1518500249):(o=u^c^h,a=1859775393):r<60?(o=u&c|h&(u|c),a=2400959708):(o=u^c^h,a=3395469782);i=(s<<5|s>>>27)+o+l+a+n[r]&4294967295;l=h,h=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;while(r<e){if(0===o)while(r<=n)this.compress_(t,r),r+=this.blockSize;if("string"===typeof t){while(r<e)if(i[o]=t.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else while(r<e)if(i[o]=t[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function V(t,e){var n=new B(t,e);return n.subscribe.bind(n)}var B=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");r=W(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===r.next&&(r.next=K),void 0===r.error&&(r.error=K),void 0===r.complete&&(r.complete=K);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function j(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){t.apply(void 0,n)})).catch((function(t){e&&e(t)}))}}function W(t,e){if("object"!==typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"===typeof t[i])return!0}return!1}function K(){}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var z=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i){var o=t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".";throw new Error(o)}};function G(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=t+" failed: ";return i+=r+" argument ",i}function Q(t,e,n,r){if((!r||n)&&"string"!==typeof n)throw new Error(G(t,e,r)+"must be a valid firebase namespace.")}function H(t,e,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(G(t,e,r)+"must be a valid function.")}function Y(t,e,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(G(t,e,r)+"must be a valid context object.")}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,o(r<t.length,"Surrogate pair missing trail surrogate.");var s=t.charCodeAt(r)-56320;i=65536+(a<<10)+s}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},X=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};e.CONSTANTS=i,e.Deferred=d,e.ErrorFactory=E,e.FirebaseError=T,e.Sha1=q,e.assert=o,e.assertionError=a,e.async=j,e.base64=c,e.base64Decode=l,e.base64Encode=h,e.contains=R,e.createSubscribe=V,e.decode=N,e.deepCopy=f,e.deepExtend=p,e.errorPrefix=G,e.getUA=m,e.isAdmin=O,e.isBrowser=v,e.isEmpty=P,e.isMobileCordova=y,e.isNode=g,e.isNodeSdk=_,e.isReactNative=b,e.isValidFormat=x,e.isValidTimestamp=k,e.issuedAtTime=D,e.jsonEval=I,e.map=L,e.querystring=F,e.querystringDecode=U,e.safeGet=M,e.stringLength=X,e.stringToByteArray=$,e.stringify=A,e.validateArgCount=z,e.validateCallback=H,e.validateContextObject=Y,e.validateNamespace=Q}).call(this,n("c8ba"))},ce10:function(t,e,n){var r=n("69a8"),i=n("6821"),o=n("c366")(!1),a=n("613b")("IE_PROTO");t.exports=function(t,e){var n,s=i(t),u=0,c=[];for(n in s)n!=a&&r(s,n)&&c.push(n);while(e.length>u)r(s,n=e[u++])&&(~o(c,n)||c.push(n));return c}},cee4:function(t,e,n){"use strict";var r=n("c532"),i=n("1d2b"),o=n("0a06"),a=n("4a7b"),s=n("2444");function u(t){var e=new o(t),n=i(o.prototype.request,e);return r.extend(n,o.prototype,e),r.extend(n,e),n}var c=u(s);c.Axios=o,c.create=function(t){return u(a(c.defaults,t))},c.Cancel=n("7a77"),c.CancelToken=n("8df4"),c.isCancel=n("2e67"),c.all=function(t){return Promise.all(t)},c.spread=n("0df6"),t.exports=c,t.exports.default=c},cffa:function(t,e,n){"use strict";function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function i(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}
/*!
 * GSAP 3.0.2
 * https://greensock.com
 *
 * @license Copyright 2008-2019, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var o,a,s,u,c,h,l,f={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},p={duration:.5,overwrite:!1,delay:0},d=1e8,m=1/d,y=2*Math.PI,g=y/4,v=0,b=Math.sqrt,_=Math.cos,w=Math.sin,T=function(t){return"string"===typeof t},E=function(t){return"function"===typeof t},S=function(t){return"number"===typeof t},C=function(t){return"undefined"===typeof t},I=function(t){return"object"===typeof t},A=function(t){return!1!==t},N=function(){return"undefined"!==typeof window},k=function(t){return E(t)||T(t)},D=Array.isArray,x=/(?:-?\.?\d|\.)+/gi,O=/[-+=\.]*\d+[\.e\-\+]*\d*[e\-\+]*\d*/gi,R=/[-+=\.]*\d+(?:\.|e-|e)*\d*/gi,M=/\(([^()]+)\)/i,P=/[\+-]=-?[\.\d]+/,L=/[#\-+\.]*\b[a-z\d-=+%.]+/gi,F={},U={},q=function(t){return(U=lt(t,F))&&en},V=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},B=function(t,e){return!e&&console.warn(t)},j=function(t,e){return t&&(F[t]=e)&&U&&(U[t]=e)||F},W=function(){return 0},K={},z=[],G={},Q={},H={},Y=30,$=[],X="onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",J=function(t){var e,n,r=t[0];if(I(r)||E(r)||(t=[t]),!(e=(r._gsap||{}).harness)){n=$.length;while(n--&&!$[n].targetTest(r));e=$[n]}n=t.length;while(n--)t[n]&&(t[n]._gsap||(t[n]._gsap=new Ee(t[n],e)))||t.splice(n,1);return t},Z=function(t){return t._gsap||J(Ut(t))[0]._gsap},tt=function(t,e){var n=t[e];return E(n)?t[e]():C(n)&&t.getAttribute(e)||n},et=function(t,e){return(t=t.split(",")).forEach(e)||t},nt=function(t){return Math.round(1e4*t)/1e4},rt=function(t,e){for(var n=e.length,r=0;t.indexOf(e[r])<0&&++r<n;);return r<n},it=function(t,e,n){var r,i=S(t[1]),o=(i?2:1)+(e<2?0:1),a=t[o];return i&&(a.duration=t[1]),1===e?(a.runBackwards=1,a.immediateRender=A(a.immediateRender)):2===e&&(r=t[o-1],a.startAt=r,a.immediateRender=A(a.immediateRender)),a.parent=n,a},ot=function(){var t,e,n=z.length,r=z.slice(0);for(G={},z.length=0,t=0;t<n;t++)e=r[t],e&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)},at=function(t,e,n,r){z.length&&ot(),t.render(e,n,r),z.length&&ot()},st=function(t){var e=parseFloat(t);return e||0===e?e:t},ut=function(t){return t},ct=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},ht=function(t,e){for(var n in e)n in t||"duration"===n||"ease"===n||(t[n]=e[n])},lt=function(t,e){for(var n in e)t[n]=e[n];return t},ft=function t(e,n){for(var r in n)e[r]=I(n[r])?t(e[r]||(e[r]={}),n[r]):n[r];return e},pt=function(t,e){var n,r={};for(n in t)n in e||(r[n]=t[n]);return r},dt=function(t){var e=t.parent||o,n=t.keyframes?ht:ct;if(A(t.inherit))while(e)n(t,e.vars.defaults),e=e.parent;return t},mt=function(t,e){var n=t.length,r=n===e.length;while(r&&n--&&t[n]===e[n]);return n<0},yt=function(t,e,n,r,i){void 0===n&&(n="_first"),void 0===r&&(r="_last");var o,a=t[r];if(i){o=e[i];while(a&&a[i]>o)a=a._prev}return a?(e._next=a._next,a._next=e):(e._next=t[n],t[n]=e),e._next?e._next._prev=e:t[r]=e,e._prev=a,e.parent=t,e},gt=function(t,e,n,r){void 0===n&&(n="_first"),void 0===r&&(r="_last");var i=e._prev,o=e._next;i?i._next=o:t[n]===e&&(t[n]=o),o?o._prev=i:t[r]===e&&(t[r]=i),e._dp=t,e._next=e._prev=e.parent=null},vt=function(t,e){!t.parent||e&&!t.parent.autoRemoveChildren||t.parent.remove(t),t._act=0},bt=function(t){var e=t;while(e)e._dirty=1,e=e.parent;return t},_t=function(t){var e=t.parent;while(e&&e.parent)e._dirty=1,e.totalDuration(),e=e.parent;return t},wt=function t(e){return!e||e._ts&&t(e.parent)},Tt=function(t){return t._repeat?~~(t._tTime/(t=t.duration()+t._rDelay))*t:0},Et=function(t,e){return e._ts>0?(t-e._start)*e._ts:(e._dirty?e.totalDuration():e._tDur)+(t-e._start)*e._ts},St=function(t,e,n){if(e.parent&&vt(e),e._start=n+e._delay,e._end=e._start+(e.totalDuration()/e._ts||0),yt(t,e,"_first","_last",t._sort?"_start":0),t._recent=e,e._time||!e._dur&&e._initted){var r=(t.rawTime()-e._start)*e._ts;(!e._dur||Ot(0,e.totalDuration(),r)-e._tTime>m)&&e.render(r,!0)}if(bt(t),t._dp&&t._time>=t._dur&&t._ts&&t._dur<t.duration()){var i=t;while(i._dp)i.totalTime(i._tTime,!0),i=i._dp}return t},Ct=function(t,e,n,r){return xe(t,e),t._initted?!n&&t._pt&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)?(z.push(t),t._lazy=[e,r],1):void 0:1},It=function(t,e,n,r){var i,o,a,s=t._zTime<0?0:1,u=e<0?0:1,c=t._rDelay,h=0;if(c&&t._repeat&&(h=Ot(0,t._tDur,e),o=~~(h/c),o&&o===h/c&&o--,a=~~(t._tTime/c),a&&a===t._tTime/c&&a--,o!==a&&(s=1-u,t.vars.repeatRefresh&&t._initted&&t.invalidate())),(t._initted||!Ct(t,e,r,n))&&(u!==s||r||t._zTime===m||!e&&t._zTime)){t._zTime=e||(n?m:0),t.ratio=u,t._from&&(u=1-u),t._time=0,t._tTime=h,n||Zt(t,"onStart"),i=t._pt;while(i)i.r(u,i.d),i=i._next;!u&&t._startAt&&!t._onUpdate&&t._start&&t._startAt.render(e,!0,r),t._onUpdate&&!n&&Zt(t,"onUpdate"),h&&t._repeat&&!n&&t.parent&&Zt(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===u&&(t.ratio&&vt(t,1),n||(Zt(t,t.ratio?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}},At=function(t,e,n){var r;if(n>e){r=t._first;while(r&&r._start<=n){if(!r._dur&&"isPause"===r.data&&r._start>e)return r;r=r._next}}else{r=t._last;while(r&&r._start>=n){if(!r._dur&&"isPause"===r.data&&r._start<e)return r;r=r._prev}}},Nt=function(t){if(t instanceof Ce)return bt(t);var e=t._repeat;return t._tDur=e?e<0?1e20:nt(t._dur*(e+1)+t._rDelay*e):t._dur,bt(t.parent),t},kt={_start:0,endTime:W},Dt=function t(e,n,r){var i,o,a=e.labels,s=e._recent||kt,u=e.duration()>=d?s.endTime(!1):e._dur;return T(n)&&(isNaN(n)||n in a)?(i=n.charAt(0),"<"===i||">"===i?("<"===i?s._start:s.endTime(s._repeat>=0))+(parseFloat(n.substr(1))||0):(i=n.indexOf("="),i<0?(n in a||(a[n]=u),a[n]):(o=+(n.charAt(i-1)+n.substr(i+1)),i>1?t(e,n.substr(0,i-1))+o:u+o))):null==n?u:+n},xt=function(t,e){return t||0===t?e(t):e},Ot=function(t,e,n){return n<t?t:n>e?e:n},Rt=function(t){return(t+"").substr((parseFloat(t)+"").length)},Mt=function(t,e,n){return xt(n,(function(n){return Ot(t,e,n)}))},Pt=[].slice,Lt=function(t){return t&&I(t)&&"length"in t&&t.length-1 in t&&I(t[0])&&!t.nodeType&&t!==a},Ft=function(t,e,n){return void 0===n&&(n=[]),t.forEach((function(t){var r;return T(t)&&!e||Lt(t)?(r=n).push.apply(r,Ut(t)):n.push(t)}))||n},Ut=function(t,e){return!T(t)||e||!s&&le()?D(t)?Ft(t,e):Lt(t)?Pt.call(t,0):t?[t]:[]:Pt.call(u.querySelectorAll(t),0)},qt=function(t){if(E(t))return t;var e=I(t)?t:{each:t},n=ve(e.ease),r=e.from||0,i=parseFloat(e.base)||0,o={},a=r>0&&r<1,s=isNaN(r)||a,u=e.axis,c=r,h=r;return T(r)?c=h={center:.5,edges:.5,end:1}[r]||0:!a&&s&&(c=r[0],h=r[1]),function(t,a,l){var f,p,m,y,g,v,_,w,T,E=(l||e).length,S=o[E];if(!S){if(T="auto"===e.grid?0:(e.grid||[1,d])[1],!T){_=-d;while(_<(_=l[T++].getBoundingClientRect().left)&&T<E);T--}for(S=o[E]=[],f=s?Math.min(T,E)*c-.5:r%T,p=s?E*h/T-.5:r/T|0,_=0,w=d,v=0;v<E;v++)m=v%T-f,y=p-(v/T|0),S[v]=g=u?Math.abs("y"===u?y:m):b(m*m+y*y),g>_&&(_=g),g<w&&(w=g);S.max=_-w,S.min=w,S.v=E=(parseFloat(e.amount)||parseFloat(e.each)*(T>E?E-1:u?"y"===u?E/T:T:Math.max(T,E/T))||0)*("edges"===r?-1:1),S.b=E<0?i-E:i,S.u=Rt(e.amount||e.each)||0,n=n&&E<0?ge(n):n}return E=(S[t]-S.min)/S.max||0,nt(S.b+(n?n(E):E)*S.v)+S.u}},Vt=function(t){var e=t<1?Math.pow(10,(t+"").length-2):1;return function(n){return~~(Math.round(parseFloat(n)/t)*t*e)/e+(S(n)?0:Rt(n))}},Bt=function(t,e){var n,r,i=D(t);return!i&&I(t)&&(n=i=t.radius||d,t=Ut(t.values),(r=!S(t[0]))&&(n*=n)),xt(e,i?function(e){var i,o,a=parseFloat(r?e.x:e),s=parseFloat(r?e.y:0),u=d,c=0,h=t.length;while(h--)r?(i=t[h].x-a,o=t[h].y-s,i=i*i+o*o):i=Math.abs(t[h]-a),i<u&&(u=i,c=h);return c=!n||u<=n?t[c]:e,r||c===e||S(e)?c:c+Rt(e)}:Vt(t))},jt=function(t,e,n,r){return xt(D(t)?!e:!r,(function(){return D(t)?t[~~(Math.random()*t.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&~~(Math.round((t+Math.random()*(e-t))/n)*n*r)/r}))},Wt=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduce((function(t,e){return e(t)}),t)}},Kt=function(t,e){return function(n){return t(parseFloat(n))+(e||Rt(n))}},zt=function(t,e,n){return $t(t,e,0,1,n)},Gt=function(t,e,n){return xt(n,(function(n){return t[~~e(n)]}))},Qt=function t(e,n,r){var i=n-e;return D(e)?Gt(e,t(0,e.length),n):xt(r,(function(t){return(i+(t-e)%i)%i+e}))},Ht=function t(e,n,r){var i=n-e,o=2*i;return D(e)?Gt(e,t(0,e.length-1),n):xt(r,(function(t){return t=(o+(t-e)%o)%o,e+(t>i?o-t:t)}))},Yt=function(t){var e,n,r,i,o=0,a="";while(~(e=t.indexOf("random(",o)))r=t.indexOf(")",e),i="["===t.charAt(e+7),n=t.substr(e+7,r-e-7).match(i?L:x),a+=t.substr(o,e-o)+jt(i?n:+n[0],+n[1],+n[2]||1e-5),o=r+1;return a+t.substr(o,t.length-o)},$t=function(t,e,n,r,i){var o=e-t,a=r-n;return xt(i,(function(e){return n+(e-t)/o*a}))},Xt=function t(e,n,r,i){var o=isNaN(e+n)?0:function(t){return(1-t)*e+t*n};if(!o){var a,s,u,c,h,l=T(e),f={};if(!0===r&&(i=1)&&(r=null),l)e={p:e},n={p:n};else if(D(e)&&!D(n)){for(u=[],c=e.length,h=c-2,s=1;s<c;s++)u.push(t(e[s-1],e[s]));c--,o=function(t){t*=c;var e=Math.min(h,~~t);return u[e](t-e)},r=n}else i||(e=lt(D(e)?[]:{},e));if(!u){for(a in n)Ne.call(f,e,a,"get",n[a]);o=function(t){return ze(t,f)||(l?e.p:e)}}}return xt(r,o)},Jt=function(t,e,n){var r,i,o,a=t.labels,s=d;for(r in a)i=a[r]-e,i<0===!!n&&i&&s>(i=Math.abs(i))&&(o=r,s=i);return o},Zt=function(t,e,n){var r,i,o=t.vars,a=o[e];if(a)return r=o[e+"Params"],i=o.callbackScope||t,n&&z.length&&ot(),r?a.apply(i,r):a.call(i)},te=function(t){return vt(t),t.progress()<1&&Zt(t,"onInterrupt"),t},ee=function(t){t=!t.name&&t["default"]||t;var e=t.name,n=E(t),r=e&&!n&&t.init?function(){this._props=[]}:t,i={init:W,render:ze,add:Ne,kill:Qe,modifier:Ge,rawVars:0},o={targetTest:0,get:0,getSetter:Be,aliases:{},register:0};if(le(),t!==r){if(Q[e])return;ct(r,ct(pt(t,i),o)),lt(r.prototype,lt(i,pt(t,o))),Q[r.prop=e]=r,t.targetTest&&($.push(r),K[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}j(e,r),t.register&&t.register(en,r,$e)},ne=255,re={aqua:[0,ne,ne],lime:[0,ne,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,ne],navy:[0,0,128],white:[ne,ne,ne],olive:[128,128,0],yellow:[ne,ne,0],orange:[ne,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[ne,0,0],pink:[ne,192,203],cyan:[0,ne,ne],transparent:[ne,ne,ne,0]},ie=function(t,e,n){return t=t<0?t+1:t>1?t-1:t,(6*t<1?e+(n-e)*t*6:t<.5?n:3*t<2?e+(n-e)*(2/3-t)*6:e)*ne+.5|0},oe=function(t,e){var n,r,i,o,a,s,u,c,h,l,f=t?S(t)?[t>>16,t>>8&ne,t&ne]:0:re.black;if(!f){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),re[t])f=re[t];else if("#"===t.charAt(0))4===t.length&&(n=t.charAt(1),r=t.charAt(2),i=t.charAt(3),t="#"+n+n+r+r+i+i),t=parseInt(t.substr(1),16),f=[t>>16,t>>8&ne,t&ne];else if("hsl"===t.substr(0,3))if(f=l=t.match(x),e){if(~t.indexOf("="))return t.match(O)}else o=+f[0]%360/360,a=+f[1]/100,s=+f[2]/100,r=s<=.5?s*(a+1):s+a-s*a,n=2*s-r,f.length>3&&(f[3]*=1),f[0]=ie(o+1/3,n,r),f[1]=ie(o,n,r),f[2]=ie(o-1/3,n,r);else f=t.match(x)||re.transparent;f=f.map(Number)}return e&&!l&&(n=f[0]/ne,r=f[1]/ne,i=f[2]/ne,u=Math.max(n,r,i),c=Math.min(n,r,i),s=(u+c)/2,u===c?o=a=0:(h=u-c,a=s>.5?h/(2-u-c):h/(u+c),o=u===n?(r-i)/h+(r<i?6:0):u===r?(i-n)/h+2:(n-r)/h+4,o*=60),f[0]=o+.5|0,f[1]=100*a+.5|0,f[2]=100*s+.5|0),f},ae=function(t,e){var n,r,i,o=(t+"").match(se),a=0,s="";if(!o)return t;for(n=0;n<o.length;n++)r=o[n],i=t.substr(a,t.indexOf(r,a)-a),a+=i.length+r.length,r=oe(r,e),3===r.length&&r.push(1),s+=i+(e?"hsla("+r[0]+","+r[1]+"%,"+r[2]+"%,"+r[3]:"rgba("+r.join(","))+")";return s+t.substr(a)},se=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b";for(t in re)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),ue=/hsl[a]?\(/,ce=function(t){var e,n=t.join(" ");se.lastIndex=0,se.test(n)&&(e=ue.test(n),t[0]=ae(t[0],e),t[1]=ae(t[1],e))},he=function(){var t,e,n,r,i=Date.now,o=500,h=33,f=i(),p=f,d=1/60,y=d,g=[],v=function n(a){var s,u,c=i()-p,l=!0===a;c>o&&(f+=c-h),p+=c,r.time=(p-f)/1e3,s=r.time-y,(s>0||l)&&(r.frame++,y+=s+(s>=d?.004:d-s),u=1),l||(t=e(n)),u&&g.forEach((function(t){return t(r.time,c,r.frame,a)}))};return r={time:0,frame:0,tick:function(){v(!0)},wake:function(){c&&(!s&&N()&&(a=s=window,u=a.document||{},F.gsap=en,(a.gsapVersions||(a.gsapVersions=[])).push(en.version),q(U||a.GreenSockGlobals||!a.gsap&&a||{}),n=a.requestAnimationFrame),t&&r.sleep(),e=n||function(t){return setTimeout(t,1e3*(y-r.time)+1|0)},l=1,v(2))},sleep:function(){(n?a.cancelAnimationFrame:clearTimeout)(t),l=0,e=W},lagSmoothing:function(t,e){o=t||1/m,h=Math.min(e,o,0)},fps:function(t){d=1/(t||60),y=r.time+d},add:function(t){g.indexOf(t)<0&&g.push(t),le()},remove:function(t){var e;~(e=g.indexOf(t))&&g.splice(e,1)},_listeners:g},r}(),le=function(){return!l&&he.wake()},fe={},pe=/^[\d.\-M][\d.\-,\s]/,de=/["']/g,me=function(t){for(var e,n,r,i={},o=t.substr(1,t.length-3).split(":"),a=o[0],s=1,u=o.length;s<u;s++)n=o[s],e=s!==u-1?n.lastIndexOf(","):n.length,r=n.substr(0,e),i[a]=isNaN(r)?r.replace(de,"").trim():+r,a=n.substr(e+1).trim();return i},ye=function(t){var e=(t+"").split("("),n=fe[e[0]];return n&&e.length>1&&n.config?n.config.apply(null,~t.indexOf("{")?[me(e[1])]:M.exec(t)[1].split(",").map(st)):fe._CE&&pe.test(t)?fe._CE("",t):n},ge=function(t){return function(e){return 1-t(1-e)}},ve=function(t,e){return t&&(E(t)?t:fe[t]||ye(t))||e},be=function(t,e,n,r){void 0===n&&(n=function(t){return 1-e(1-t)}),void 0===r&&(r=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var i,o={easeIn:e,easeOut:n,easeInOut:r};return et(t,(function(t){for(var e in fe[t]=F[t]=o,fe[i=t.toLowerCase()]=n,o)fe[i+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=fe[t+"."+e]=o[e]})),o},_e=function(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}},we=function t(e,n,r){var i=n>=1?n:1,o=(r||(e?.3:.45))/(n<1?n:1),a=o/y*(Math.asin(1/i)||0),s=function(t){return 1===t?1:i*Math.pow(2,-10*t)*w((t-a)*o)+1},u="out"===e?s:"in"===e?function(t){return 1-s(1-t)}:_e(s);return o=y/o,u.config=function(n,r){return t(e,n,r)},u},Te=function t(e,n){void 0===n&&(n=1.70158);var r=function(t){return--t*t*((n+1)*t+n)+1},i="out"===e?r:"in"===e?function(t){return 1-r(1-t)}:_e(r);return i.config=function(n){return t(e,n)},i};et("Linear,Quad,Cubic,Quart,Quint,Strong",(function(t,e){var n=e<5?e+1:e;be(t+",Power"+(n-1),e?function(t){return Math.pow(t,n)}:function(t){return t},(function(t){return 1-Math.pow(1-t,n)}),(function(t){return t<.5?Math.pow(2*t,n)/2:1-Math.pow(2*(1-t),n)/2}))})),fe.Linear.easeNone=fe.none=fe.Linear.easeIn,be("Elastic",we("in"),we("out"),we()),function(t,e){var n=1/e,r=2*n,i=2.5*n,o=function(o){return o<n?t*o*o:o<r?t*Math.pow(o-1.5/e,2)+.75:o<i?t*(o-=2.25/e)*o+.9375:t*Math.pow(o-2.625/e,2)+.984375};be("Bounce",(function(t){return 1-o(1-t)}),o)}(7.5625,2.75),be("Expo",(function(t){return t?Math.pow(2,10*(t-1)):0})),be("Circ",(function(t){return-(b(1-t*t)-1)})),be("Sine",(function(t){return 1-_(t*g)})),be("Back",Te("in"),Te("out"),Te()),fe.SteppedEase=fe.steps=F.SteppedEase={config:function(t,e){void 0===t&&(t=1);var n=1/t,r=t+(e?0:1),i=e?1:0,o=1-m;return function(t){return((r*Ot(0,o,t)|0)+i)*n}}},p.ease=fe["quad.out"];var Ee=function(t,e){this.id=v++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:tt,this.set=e?e.getSetter:Be},Se=function(){function t(t,e){var n=t.parent||o;this.vars=t,this._dur=this._tDur=+t.duration||0,this._delay=+t.delay||0,(this._repeat=t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase,Nt(this)),this._ts=1,this.data=t.data,l||he.wake(),n&&St(n,this,e||0===e?e:n._time),t.reversed&&this.reversed(!0),t.paused&&this.paused(!0)}var e=t.prototype;return e.delay=function(t){return t||0===t?(this._delay=t,this):this._delay},e.duration=function(t){var e=arguments.length,n=this._repeat,r=n>0?n*((e?t:this._dur)+this._rDelay):0;return e?this.totalDuration(n<0?t:t+r):this.totalDuration()&&this._dur},e.totalDuration=function(t){if(!arguments.length)return this._tDur;var e=this._repeat,n=(t||this._rDelay)&&e<0;return this._tDur=n?1e20:t,this._dur=n?t:(t-e*this._rDelay)/(e+1),this._dirty=0,bt(this.parent),this},e.totalTime=function(t,e){if(le(),!arguments.length)return this._tTime;var n,r=this.parent||this._dp;if(r&&r.smoothChildTiming&&this._ts){n=this._start,this._start=r._time-(this._ts>0?t/this._ts:((this._dirty?this.totalDuration():this._tDur)-t)/-this._ts),this._end+=this._start-n,r._dirty||bt(r);while(r.parent)r.parent._time!==r._start+(r._ts>0?r._tTime/r._ts:(r.totalDuration()-r._tTime)/-r._ts)&&r.totalTime(r._tTime,!0),r=r.parent;this.parent||St(this._dp,this,this._start-this._delay)}return this._tTime===t&&this._dur||(this._ts||(this._pTime=t),at(this,t,e)),this},e.time=function(t,e){return arguments.length?this.totalTime((t+Tt(this))%this.duration()||(t?this._dur:0),e):this._time},e.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this._tTime/this.totalDuration()},e.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+Tt(this),e):this.duration()?this._time/this._dur:this.ratio},e.iteration=function(t,e){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*n,e):this._repeat?1+~~(this._tTime/n):1},e.timeScale=function(t){var e=this._ts;return arguments.length?e?(this._end=this._start+this._tDur/(this._ts=t||m),_t(this).totalTime(this._tTime,!0)):(this._pauseTS=t,this):e||this._pauseTS},e.paused=function(t){var e=!this._ts;return arguments.length?(e!==t&&(t?(this._pauseTS=this._ts,this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(this._ts=this._pauseTS,t=this._tTime||this._pTime,1===this.progress()&&(this._tTime-=m),this.totalTime(t,!0))),this):e},e.startTime=function(t){return arguments.length?(this.parent&&this.parent._sort&&St(this.parent,this,t-this._delay),this):this._start},e.endTime=function(t){return this._start+(A(t)?this.totalDuration():this.duration())/Math.abs(this._ts)},e.rawTime=function(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Et(e.rawTime(t),this):this._tTime:this._tTime},e.repeat=function(t){return arguments.length?(this._repeat=t,Nt(this)):this._repeat},e.repeatDelay=function(t){return arguments.length?(this._rDelay=t,Nt(this)):this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,e){return this.totalTime(Dt(this,t),A(e))},e.restart=function(t,e){return this.play().totalTime(t?-this._delay:0,A(e))},e.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},e.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},e.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){var e=this._ts||this._pauseTS;return arguments.length?(t!==this.reversed()&&(this[this._ts?"_ts":"_pauseTS"]=Math.abs(e)*(t?-1:1),this.totalTime(this._tTime,!0)),this):e<0},e.invalidate=function(){return this._initted=0,this},e.isActive=function(t){var e,n=this.parent||this._dp,r=this._start;return!n||this._ts&&(this._initted||!t)&&n.isActive(t)&&(e=n.rawTime(!0))>=r&&e<this.endTime(!0)-m},e.eventCallback=function(t,e,n){var r=this.vars;return arguments.length>1?(e?(r[t]=e,n&&(r[t+"Params"]=n),"onUpdate"===t&&(this._onUpdate=e)):delete r[t],this):r[t]},e.then=function(t){var e=this;return new Promise((function(n){var r=t||ut,i=function(){var t=e.then;e.then=null,r=r(e),r&&(r.then||r===e)&&(e._prom=r,e.then=t),n(r),e.then=t};e._initted&&1===e.totalProgress()&&e._ts>=0||!e._tTime&&e._ts<0?i():e._prom=i}))},e.kill=function(){te(this)},t}();ct(Se.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:0,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-m,_prom:0});var Ce=function(t){function e(e,n){var r;return void 0===e&&(e={}),r=t.call(this,e,n)||this,r.labels={},r.smoothChildTiming=A(e.smoothChildTiming),r.autoRemoveChildren=!!e.autoRemoveChildren,r._sort=A(e.sortChildren),r}i(e,t);var n=e.prototype;return n.to=function(t,e,n){return new Le(t,it(arguments,0,this),Dt(this,S(e)?arguments[3]:n)),this},n.from=function(t,e,n){return new Le(t,it(arguments,1,this),Dt(this,S(e)?arguments[3]:n)),this},n.fromTo=function(t,e,n,r){return new Le(t,it(arguments,2,this),Dt(this,S(e)?arguments[4]:r)),this},n.set=function(t,e,n){return e.duration=0,e.parent=this,e.repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new Le(t,e,Dt(this,n)),this},n.call=function(t,e,n){return St(this,Le.delayedCall(0,t,e),Dt(this,n))},n.staggerTo=function(t,e,n,r,i,o,a){return n.duration=e,n.stagger=n.stagger||r,n.onComplete=o,n.onCompleteParams=a,n.parent=this,new Le(t,n,Dt(this,i)),this},n.staggerFrom=function(t,e,n,r,i,o,a){return n.runBackwards=1,n.immediateRender=A(n.immediateRender),this.staggerTo(t,e,n,r,i,o,a)},n.staggerFromTo=function(t,e,n,r,i,o,a,s){return r.startAt=n,r.immediateRender=A(r.immediateRender),this.staggerTo(t,e,r,i,o,a,s)},n.render=function(t,e,n){var r,i,a,s,u,c,h,l,f,p,d,y=this._time,g=this._dirty?this.totalDuration():this._tDur,v=this._dur,b=t>g-m&&t>=0&&this!==o?g:t<m?0:t,_=this._zTime<0!==t<0&&(this._initted||!v);if(b!==this._tTime||n||_){if(_&&(v||(y=this._zTime),!t&&e||(this._zTime=t)),r=b,f=this._start,l=this._ts,c=0===l,y!==this._time&&v&&(r+=this._time-y),this._repeat&&(d=this._yoyo,u=v+this._rDelay,r=nt(b%u),(r>v||g===b)&&(r=v),s=~~(b/u),s&&s===b/u&&(r=v,s--),p=~~(this._tTime/u),p&&p===this._tTime/u&&p--,d&&1&s&&(r=v-r,1),s!==p&&!this._lock)){var w=d&&1&p,T=w===(d&&1&s);if(s<p&&(w=!w),y=w?0:v,this._lock=1,this.render(y,e,!v)._lock=0,!e&&this.parent&&Zt(this,"onRepeat"),y!==this._time||c!==!this._ts)return this;if(T&&(this._lock=2,y=w?v+1e-4:-1e-4,this.render(y,!0)),this._lock=0,!this._ts&&!c)return this}if(this._hasPause&&!this._forcing&&this._lock<2&&(h=At(this,nt(y),nt(r)),h&&(b-=r-(r=h._start))),this._tTime=b,this._time=r,this._act=!l,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1),y||!r||e||Zt(this,"onStart"),r>=y&&t>=0){i=this._first;while(i){if(a=i._next,(i._act||r>=i._start)&&i._ts&&h!==i){if(i.parent!==this)return this.render(t,e,n);if(i.render(i._ts>0?(r-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(r-i._start)*i._ts,e,n),r!==this._time||!this._ts&&!c){h=0;break}}i=a}}else{i=this._last;var E=t<0?t:r;while(i){if(a=i._prev,(i._act||E<=i._end)&&i._ts&&h!==i){if(i.parent!==this)return this.render(t,e,n);if(i.render(i._ts>0?(E-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(E-i._start)*i._ts,e,n),r!==this._time||!this._ts&&!c){h=0;break}}i=a}}if(h&&!e&&(this.pause(),h.render(r>=y?0:-m)._zTime=r>=y?1:-1,this._ts))return this._start=f,this.render(t,e,n);this._onUpdate&&!e&&Zt(this,"onUpdate",!0),(b===g||!b&&this._ts<0)&&(f!==this._start&&Math.abs(l)===Math.abs(this._ts)||(!r||g>=this.totalDuration())&&((t||!v)&&vt(this,1),e||t<0&&!y||(Zt(this,b===g?"onComplete":"onReverseComplete",!0),this._prom&&this._prom())))}return this},n.add=function(t,e){var n=this;if(S(e)||(e=Dt(this,e)),!(t instanceof Se)){if(D(t))return t.forEach((function(t){return n.add(t,e)})),bt(this);if(T(t))return this.addLabel(t,e);if(!E(t))return this;t=Le.delayedCall(0,t)}return this!==t?St(this,t,e):this},n.getChildren=function(t,e,n,r){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===r&&(r=-d);var i=[],o=this._first;while(o)o._start>=r&&(o instanceof Le?e&&i.push(o):(n&&i.push(o),t&&i.push.apply(i,o.getChildren(!0,e,n)))),o=o._next;return i},n.getById=function(t){var e=this.getChildren(1,1,1),n=e.length;while(n--)if(e[n].vars.id===t)return e[n]},n.remove=function(t){return T(t)?this.removeLabel(t):E(t)?this.killTweensOf(t):(gt(this,t),t===this._recent&&(this._recent=this._last),bt(this))},n.totalTime=function(e,n){return arguments.length?(this._forcing=1,this.parent||this._dp||!this._ts||(this._start=he.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts)),t.prototype.totalTime.call(this,e,n),this._forcing=0,this):this._tTime},n.addLabel=function(t,e){return this.labels[t]=Dt(this,e),this},n.removeLabel=function(t){return delete this.labels[t],this},n.addPause=function(t,e,n){var r=Le.delayedCall(0,e||W,n);return r.data="isPause",this._hasPause=1,St(this,r,Dt(this,t))},n.removePause=function(t){var e=this._first;t=Dt(this,t);while(e)e._start===t&&"isPause"===e.data&&vt(e),e=e._next},n.killTweensOf=function(t,e,n){var r=this.getTweensOf(t,n),i=r.length;while(i--)Ie!==r[i]&&r[i].kill(t,e);return this},n.getTweensOf=function(t,e){var n,r=[],i=Ut(t),o=this._first;while(o)o instanceof Le?!rt(o._targets,i)||e&&!o.isActive("started"===e)||r.push(o):(n=o.getTweensOf(i,e)).length&&r.push.apply(r,n),o=o._next;return r},n.tweenTo=function(t,e){var n=this,r=Dt(n,t),i=e&&e.startAt,o=Le.to(n,ct({ease:"none",lazy:!1,time:r,duration:Math.abs(r-(i&&"time"in i?i.time:n._time))/n.timeScale()||m,onStart:function(){n.pause();var t=Math.abs(r-n._time)/n.timeScale();o._dur!==t&&(o._dur=t,o.render(o._time,!0,!0)),e&&e.onStart&&e.onStart.apply(o,e.onStartParams||[])}},e));return o},n.tweenFromTo=function(t,e,n){return this.tweenTo(e,ct({startAt:{time:Dt(this,t)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(t){return void 0===t&&(t=this._time),Jt(this,Dt(this,t))},n.previousLabel=function(t){return void 0===t&&(t=this._time),Jt(this,Dt(this,t),1)},n.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+m)},n.shiftChildren=function(t,e,n){void 0===n&&(n=0);var r,i=this._first,o=this.labels;while(i)i._start>=n&&(i._start+=t),i=i._next;if(e)for(r in o)o[r]>=n&&(o[r]+=t);return bt(this)},n.invalidate=function(){var e=this._first;this._lock=0;while(e)e.invalidate(),e=e._next;return t.prototype.invalidate.call(this)},n.clear=function(t){void 0===t&&(t=!0);var e,n=this._first;while(n)e=n._next,this.remove(n),n=e;return this._time=this._tTime=0,t&&(this.labels={}),bt(this)},n.totalDuration=function(t){var e,n,r=0,i=this,a=i._last,s=d,u=i._repeat,c=u*i._rDelay||0,h=u<0;if(!arguments.length){if(i._dirty){while(a)e=a._prev,a._dirty&&a.totalDuration(),a._start>s&&i._sort&&a._ts&&!i._lock?(i._lock=1,St(i,a,a._start-a._delay),i._lock=0):s=a._start,a._start<0&&a._ts&&(r-=a._start,(!i.parent&&!i._dp||i.parent&&i.parent.smoothChildTiming)&&(i._start+=a._start/i._ts,i._time-=a._start,i._tTime-=a._start),i.shiftChildren(-a._start,!1,-d),s=0),n=a._end=a._start+a._tDur/Math.abs(a._ts||a._pauseTS),n>r&&a._ts&&(r=nt(n)),a=e;i._dur=i===o&&i._time>r?i._time:Math.min(d,r),i._tDur=h&&(i._dur||c)?1e20:Math.min(d,r*(u+1)+c),i._end=i._start+(i._tDur/Math.abs(i._ts||i._pauseTS)||0),i._dirty=0}return i._tDur}return h?i:i.timeScale(i.totalDuration()/t)},e.updateRoot=function(t){if(o._ts&&at(o,Et(t,o)),he.frame>=Y){Y+=f.autoSleep||120;var e=o._first;if((!e||!e._ts)&&f.autoSleep&&he._listeners.length<2){while(e&&!e._ts)e=e._next;e||he.sleep()}}},e}(Se);ct(Ce.prototype,{_lock:0,_hasPause:0,_forcing:0});var Ie,Ae=function(t,e,n,r,i,o,a){var s,u,c,h,l,f,p,d,m=new $e(this._pt,t,e,0,1,Ke,null,i),y=0,g=0;m.b=n,m.e=r,n+="",r+="",(p=~r.indexOf("random("))&&(r=Yt(r)),o&&(d=[n,r],o(d,t,e),n=d[0],r=d[1]),u=n.match(R)||[];while(s=R.exec(r))h=s[0],l=r.substring(y,s.index),c?c=(c+1)%5:"rgba("===l.substr(-5)&&(c=1),h!==u[g++]&&(f=parseFloat(u[g-1]),m._pt={_next:m._pt,p:l||1===g?l:",",s:f,c:"="===h.charAt(1)?parseFloat(h.substr(2))*("-"===h.charAt(0)?-1:1):parseFloat(h)-f,m:c&&c<4?Math.round:0},y=R.lastIndex);return m.c=y<r.length?r.substring(y,r.length):"",m.fp=a,(P.test(r)||p)&&(m.e=0),this._pt=m,m},Ne=function(t,e,n,r,i,o,a,s,u){E(r)&&(r=r(i||0,t,o));var c,h=t[e],l="get"!==n?n:E(h)?u?t[e.indexOf("set")||!E(t["get"+e.substr(3)])?e:"get"+e.substr(3)](u):t[e]():h,p=E(h)?u?qe:Ue:Fe;if(T(r)&&(~r.indexOf("random(")&&(r=Yt(r)),"="===r.charAt(1)&&(r=parseFloat(l)+parseFloat(r.substr(2))*("-"===r.charAt(0)?-1:1)+(Rt(l)||0))),l!==r)return isNaN(l+r)?(!h&&!(e in t)&&V(e,r),Ae.call(this,t,e,l,r,p,s||f.stringFilter,u)):(c=new $e(this._pt,t,e,+l||0,r-(l||0),"boolean"===typeof h?We:je,0,p),u&&(c.fp=u),a&&c.modifier(a,this,t),this._pt=c)},ke=function(t,e,n,r,i){if(E(t)&&(t=Re(t,i,e,n,r)),!I(t)||t.style&&t.nodeType||D(t))return T(t)?Re(t,i,e,n,r):t;var o,a={};for(o in t)a[o]=Re(t[o],i,e,n,r);return a},De=function(t,e,n,r,i,o){var a,s,u,c;if(Q[t]&&!1!==(a=new Q[t]).init(i,a.rawVars?e[t]:ke(e[t],r,i,o,n),n,r,o)&&(n._pt=s=new $e(n._pt,i,t,0,1,a.render,a,0,a.priority),n!==h)){u=n._ptLookup[n._targets.indexOf(i)],c=a._props.length;while(c--)u[a._props[c]]=s}return a},xe=function t(e,n){var r,i,a,s,u,c,h,l,f,d,y,g,v=e.vars,b=v.ease,_=v.startAt,w=v.immediateRender,T=v.lazy,E=v.onUpdate,S=v.onUpdateParams,C=v.callbackScope,I=v.runBackwards,N=v.yoyoEase,k=v.keyframes,D=v.autoRevert,x=e._dur,O=e._startAt,R=e._targets,M=e.parent,P=M&&"nested"===M.data?M.parent._targets:R,L="auto"===e._overwrite,F=e.timeline;if(!F||k&&b||(b="none"),e._ease=ve(b,p.ease),e._yEase=N?ge(ve(!0===N?b:N,p.ease)):0,N&&e._yoyo&&!e._repeat&&(N=e._yEase,e._yEase=e._ease,e._ease=N),!F){if(O&&O.render(-1,!0).kill(),_){if(vt(e._startAt=Le.set(R,ct({data:"isStart",overwrite:!1,parent:M,immediateRender:!0,lazy:A(T),startAt:null,delay:0,onUpdate:E,onUpdateParams:S,callbackScope:C,stagger:0},_))),w)if(n>0)!D&&(e._startAt=0);else if(x)return}else if(I&&x)if(O)!D&&(e._startAt=0);else if(n&&(w=!1),vt(e._startAt=Le.set(R,lt(pt(v,K),{overwrite:!1,data:"isFromStart",lazy:w&&A(T),immediateRender:w,stagger:0,parent:M}))),w){if(!n)return}else t(e._startAt,m);for(r=pt(v,K),e._pt=0,l=R[0]?Z(R[0]).harness:0,g=l&&v[l.prop],T=x&&A(T)||T&&!x,i=0;i<R.length;i++){if(u=R[i],h=u._gsap||J(R)[i]._gsap,e._ptLookup[i]=d={},G[h.id]&&ot(),y=P===R?i:P.indexOf(u),l&&!1!==(f=new l).init(u,g||r,e,y,P)&&(e._pt=s=new $e(e._pt,u,f.name,0,1,f.render,f,0,f.priority),f._props.forEach((function(t){d[t]=s})),f.priority&&(c=1)),!l||g)for(a in r)Q[a]&&(f=De(a,r,e,y,u,P))?f.priority&&(c=1):d[a]=s=Ne.call(e,u,a,"get",r[a],y,P,0,v.stringFilter);e._op&&e._op[i]&&e.kill(u,e._op[i]),L&&(Ie=e,o.killTweensOf(u,d,"started"),Ie=0),e._pt&&T&&(G[h.id]=1)}c&&Ye(e),e._onInit&&e._onInit(e)}e._from=!F&&!!v.runBackwards,e._onUpdate=E,e._initted=1},Oe=function(t,e){var n,r,i,o,a=t[0]?Z(t[0]).harness:0,s=a&&a.aliases;if(!s)return e;for(r in n=lt({},e),s)if(r in n){o=s[r].split(","),i=o.length;while(i--)n[o[i]]=n[r]}return n},Re=function(t,e,n,r,i){return E(t)?t.call(e,n,r,i):T(t)&&~t.indexOf("random(")?Yt(t):t},Me=X+",repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",Pe=(Me+",id,stagger,delay,duration,paused").split(","),Le=function(t){function e(e,n,i){var a;"number"===typeof n&&(i.duration=n,n=i,i=null),a=t.call(this,dt(n),i)||this;var s,u,c,h,l,p,d,y,g=a.vars,v=g.duration,b=g.delay,_=g.immediateRender,w=g.stagger,T=g.overwrite,E=g.keyframes,C=g.defaults,N=D(e)&&S(e[0])?[e]:Ut(e);if(a._targets=N.length?J(N):B("GSAP target "+e+" not found. https://greensock.com",!f.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=T,E||w||k(v)||k(b)){if(n=a.vars,s=a.timeline=new Ce({data:"nested",defaults:C||{}}),s.kill(),s.parent=r(a),E)ct(s.vars.defaults,{ease:"none"}),E.forEach((function(t){return s.to(N,t,">")}));else{if(h=N.length,d=w?qt(w):W,I(w))for(l in w)~Me.indexOf(l)&&(y||(y={}),y[l]=w[l]);for(u=0;u<h;u++){for(l in c={},n)Pe.indexOf(l)<0&&(c[l]=n[l]);c.stagger=0,y&&lt(c,y),n.yoyoEase&&!n.repeat&&(c.yoyoEase=n.yoyoEase),p=N[u],c.duration=+Re(v,r(a),u,p,N),c.delay=(+Re(b,r(a),u,p,N)||0)-a._delay,!w&&1===h&&c.delay&&(a._delay=b=c.delay,a._start+=b,c.delay=0),s.to(p,c,d(u,p,N))}v=b=0}v||a.duration(v=s.duration())}else a.timeline=0;return!0===T&&(Ie=r(a),o.killTweensOf(N),Ie=0),(_||!v&&!E&&a._start===a.parent._time&&A(_)&&wt(r(a))&&"nested"!==a.parent.data)&&(a._tTime=-m,a.render(Math.max(0,-b))),a}i(e,t);var n=e.prototype;return n.render=function(t,e,n){var r,i,o,a,s,u,c,h,l,f=this._time,p=this._tDur,d=this._dur,y=t>p-m&&t>=0?p:t<m?0:t;if(d){if(y!==this._tTime||!t||n||this._startAt&&this._zTime<0!==t<0){if(r=y,h=this.timeline,this._repeat){if(a=d+this._rDelay,r=nt(y%a),r>d&&(r=d),o=~~(y/a),o&&o===y/a&&(r=d,o--),u=this._yoyo&&1&o,u&&(l=this._yEase,r=d-r),s=~~(this._tTime/a),s&&s===this._tTime/a&&s--,r===f&&!n&&this._initted)return this;o!==s&&this.vars.repeatRefresh&&!this._lock&&(this._lock=n=1,this.render(a*o,!0).invalidate()._lock=0)}if(!this._initted&&Ct(this,r,n,e))return this;this._tTime=y,this._time=r,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=c=(l||this._ease)(r/d),this._from&&(this.ratio=c=1-c),f||!r||e||Zt(this,"onStart"),i=this._pt;while(i)i.r(c,i.d),i=i._next;h&&h.render(t<0?t:!r&&u?-m:h._dur*c,e,n)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(t<0&&this._startAt&&this._startAt.render(t,!0,n),Zt(this,"onUpdate")),this._repeat&&o!==s&&this.vars.onRepeat&&!e&&this.parent&&Zt(this,"onRepeat"),y!==p&&y||this._tTime!==y||(t<0&&this._startAt&&!this._onUpdate&&this._startAt.render(t,!0,n),(t||!d)&&(y||this._ts<0)&&vt(this,1),e||t<0&&!f||(Zt(this,y===p?"onComplete":"onReverseComplete",!0),this._prom&&this._prom()))}}else It(this,t,e,n);return this},n.targets=function(){return this._targets},n.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._act=this._lazy=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),t.prototype.invalidate.call(this)},n.kill=function(t,e){if(void 0===e&&(e="all"),!t&&(!e||"all"===e)&&(this._lazy=0,this.parent))return te(this);if(this.timeline)return this.timeline.killTweensOf(t,e,!!Ie),this;var n,r,i,o,a,s,u,c=this._targets,h=t?Ut(t):c,l=this._ptLookup,f=this._pt;if((!e||"all"===e)&&mt(c,h))return te(this);n=this._op=this._op||[],"all"!==e&&(T(e)&&(a={},et(e,(function(t){return a[t]=1})),e=a),e=Oe(c,e)),u=c.length;while(u--)if(~h.indexOf(c[u]))for(a in r=l[u],"all"===e?(n[u]=e,o=r,i={}):(i=n[u]=n[u]||{},o=e),o)s=r&&r[a],s&&("kill"in s.d&&!0!==s.d.kill(a)||(gt(this,s,"_pt"),delete r[a])),"all"!==i&&(i[a]=1);return this._initted&&!this._pt&&f&&te(this),this},e.to=function(t,n){return new e(t,n,arguments[2])},e.from=function(t,n){return new e(t,it(arguments,1))},e.delayedCall=function(t,n,r,i){return new e(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:n,onReverseComplete:n,onCompleteParams:r,onReverseCompleteParams:r,callbackScope:i})},e.fromTo=function(t,n,r){return new e(t,it(arguments,2))},e.set=function(t,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new e(t,n)},e.killTweensOf=function(t,e,n){return o.killTweensOf(t,e,n)},e}(Se);ct(Le.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),et("staggerTo,staggerFrom,staggerFromTo",(function(t){Le[t]=function(){var e=new Ce,n=Ut(arguments);return n.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,n)}}));var Fe=function(t,e,n){return t[e]=n},Ue=function(t,e,n){return t[e](n)},qe=function(t,e,n,r){return t[e](r.fp,n)},Ve=function(t,e,n){return t.setAttribute(e,n)},Be=function(t,e){return E(t[e])?Ue:C(t[e])&&t.setAttribute?Ve:Fe},je=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4,e)},We=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},Ke=function(t,e){var n=e._pt,r="";if(!t&&e.b)r=e.b;else if(1===t&&e.e)r=e.e;else{while(n)r=n.p+(n.m?n.m(n.s+n.c*t):Math.round(1e4*(n.s+n.c*t))/1e4)+r,n=n._next;r+=e.c}e.set(e.t,e.p,r,e)},ze=function(t,e){var n=e._pt;while(n)n.r(t,n.d),n=n._next},Ge=function(t,e,n,r){var i,o=this._pt;while(o)i=o._next,o.p===r&&o.modifier(t,e,n),o=i},Qe=function(t){var e,n,r=this._pt;while(r)n=r._next,r.p===t&&!r.op||r.op===t?gt(this,r,"_pt"):r.dep||(e=1),r=n;return!e},He=function(t,e,n,r){r.mSet(t,e,r.m.call(r.tween,n,r.mt),r)},Ye=function(t){var e,n,r,i,o=t._pt;while(o){e=o._next,n=r;while(n&&n.pr>o.pr)n=n._next;(o._prev=n?n._prev:i)?o._prev._next=o:r=o,(o._next=n)?n._prev=o:i=o,o=e}t._pt=r},$e=function(){function t(t,e,n,r,i,o,a,s,u){this.t=e,this.s=r,this.c=i,this.p=n,this.r=o||je,this.d=a||this,this.set=s||Fe,this.pr=u||0,this._next=t,t&&(t._prev=this)}var e=t.prototype;return e.modifier=function(t,e,n){this.mSet=this.mSet||this.set,this.set=He,this.m=t,this.mt=n,this.tween=e},t}();et(X+",parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert",(function(t){K[t]=1,"on"===t.substr(0,2)&&(K[t+"Params"]=1)})),F.TweenMax=F.TweenLite=Le,F.TimelineLite=F.TimelineMax=Ce,o=new Ce({sortChildren:!1,defaults:p,autoRemoveChildren:!0,id:"root"}),f.stringFilter=ce;var Xe={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach((function(t){return ee(t)}))},timeline:function(t){return new Ce(t)},getTweensOf:function(t,e){return o.getTweensOf(t,e)},getProperty:function(t,e,n,r){T(t)&&(t=Ut(t)[0]);var i=Z(t||{}).get,o=n?ut:st;return"native"===n&&(n=""),t?e?o((Q[e]&&Q[e].get||i)(t,e,n,r)):function(e,n,r){return o((Q[e]&&Q[e].get||i)(t,e,n,r))}:t},quickSetter:function(t,e,n){if(t=Ut(t),t.length>1){var r=t.map((function(t){return en.quickSetter(t,e,n)})),i=r.length;return function(t){var e=i;while(e--)r[e](t)}}t=t[0]||{};var o=Q[e],a=Z(t),s=o?function(e){var r=new o;h._pt=0,r.init(t,n?e+n:e,h,0,[t]),r.render(1,r),h._pt&&ze(1,h)}:a.set(t,e);return o?s:function(r){return s(t,e,n?r+n:r,a,1)}},isTweening:function(t){return o.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=ve(t.ease,p.ease)),ft(p,t||{})},config:function(t){return ft(f,t||{})},registerEffect:function(t){var e=t.name,n=t.effect,r=t.plugins,i=t.defaults,o=t.extendTimeline;(r||"").split(",").forEach((function(t){return t&&!Q[t]&&!F[t]&&B(e+" effect requires "+t+" plugin.")})),H[e]=function(t,e){return n(Ut(t),ct(e||{},i))},o&&(Ce.prototype[e]=function(t,n,r){return this.add(H[e](t,I(n)?n:(r=n)&&{}),r)})},registerEase:function(t,e){fe[t]=ve(e)},parseEase:function(t,e){return arguments.length?ve(t,e):fe},getById:function(t){return o.getById(t)},exportRoot:function(t,e){void 0===t&&(t={});var n,r,i=new Ce(t);i.smoothChildTiming=A(t.smoothChildTiming),o.remove(i),i._dp=0,i._time=i._tTime=o._time,n=o._first;while(n)r=n._next,!e&&!n._dur&&n instanceof Le&&n.vars.onComplete===n._targets[0]||St(i,n,n._start-n._delay),n=r;return St(o,i,0),i},utils:{wrap:Qt,wrapYoyo:Ht,distribute:qt,random:jt,snap:Bt,normalize:zt,getUnit:Rt,clamp:Mt,splitColor:oe,toArray:Ut,mapRange:$t,pipe:Wt,unitize:Kt,interpolate:Xt},install:q,effects:H,ticker:he,updateRoot:Ce.updateRoot,plugins:Q,globalTimeline:o,core:{PropTween:$e,globals:j,Tween:Le,Timeline:Ce,Animation:Se,getCache:Z}};et("to,from,fromTo,delayedCall,set,killTweensOf",(function(t){return Xe[t]=Le[t]})),he.add(Ce.updateRoot),h=Xe.to({},{duration:0});var Je=function(t,e){var n=t._pt;while(n&&n.p!==e&&n.op!==e&&n.fp!==e)n=n._next;return n},Ze=function(t,e){var n,r,i,o=t._targets;for(n in e){r=o.length;while(r--)i=t._ptLookup[r][n],i&&(i=i.d)&&(i._pt&&(i=Je(i,n)),i&&i.modifier&&i.modifier(e[n],t,o[r],n))}},tn=function(t,e){return{name:t,rawVars:1,init:function(t,n,r){r._onInit=function(t){var r,i;if(T(n)&&(r={},et(n,(function(t){return r[t]=1})),n=r),e){for(i in r={},n)r[i]=e(n[i]);n=r}Ze(t,n)}}}},en=Xe.registerPlugin({name:"attr",init:function(t,e,n,r,i){for(var o in e)this.add(t,"setAttribute",(t.getAttribute(o)||0)+"",e[o],r,i,0,0,o),this._props.push(o)}},{name:"endArray",init:function(t,e){var n=e.length;while(n--)this.add(t,n,t[n]||0,e[n])}},tn("roundProps",Vt),tn("modifiers"),tn("snap",Bt))||Xe;Le.version=Ce.version=en.version="3.0.2",c=1,N()&&le();fe.Power0,fe.Power1,fe.Power2,fe.Power3,fe.Power4,fe.Linear,fe.Quad,fe.Cubic,fe.Quart,fe.Quint,fe.Strong,fe.Elastic,fe.Back,fe.SteppedEase,fe.Bounce,fe.Sine,fe.Expo,fe.Circ;
/*!
 * CSSPlugin 3.0.2
 * https://greensock.com
 *
 * Copyright 2008-2019, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var nn,rn,on,an,sn,un,cn,hn,ln=function(){return"undefined"!==typeof window},fn={},pn=180/Math.PI,dn=Math.PI/180,mn=Math.atan2,yn=1e8,gn=/([A-Z])/g,vn=/[-+=\.]*\d+[\.e-]*\d*[a-z%]*/g,bn=/(?:left|right|width|margin|padding|x)/i,_n=/[\s,\(]\S/,wn={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Tn=function(t,e){return e.set(e.t,e.p,~~(1e3*(e.s+e.c*t))/1e3+e.u,e)},En=function(t,e){return e.set(e.t,e.p,1===t?e.e:~~(1e3*(e.s+e.c*t))/1e3+e.u,e)},Sn=function(t,e){return e.set(e.t,e.p,t?~~(1e3*(e.s+e.c*t))/1e3+e.u:e.b,e)},Cn=function(t,e){var n=e.s+e.c*t;e.set(e.t,e.p,~~(n+(n<0?-.5:.5))+e.u,e)},In=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},An=function(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)},Nn=function(t,e,n){return t.style[e]=n},kn=function(t,e,n){return t.style.setProperty(e,n)},Dn=function(t,e,n){return t._gsap[e]=n},xn=function(t,e,n){return t._gsap.scaleX=t._gsap.scaleY=n},On=function(t,e,n,r,i){var o=t._gsap;o.scaleX=o.scaleY=n,o.renderTransform(i,o)},Rn=function(t,e,n,r,i){var o=t._gsap;o[e]=n,o.renderTransform(i,o)},Mn="transform",Pn=Mn+"Origin",Ln=function(t,e){var n=rn.createElementNS?rn.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):rn.createElement(t);return n.style?n:rn.createElement(t)},Fn=function t(e,n,r){var i=getComputedStyle(e);return i[n]||i.getPropertyValue(n.replace(gn,"-$1").toLowerCase())||i.getPropertyValue(n)||!r&&t(e,qn(n)||n,1)||""},Un="O,Moz,ms,Ms,Webkit".split(","),qn=function(t,e){var n=e||sn,r=n.style,i=5;if(t in r)return t;t=t.charAt(0).toUpperCase()+t.substr(1);while(i--&&!(Un[i]+t in r));return i<0?null:(3===i?"ms":i>=0?Un[i]:"")+t},Vn=function(){ln()&&(nn=window,rn=nn.document,on=rn.documentElement,sn=Ln("div")||{style:{}},un=Ln("div"),Mn=qn(Mn),Pn=qn(Pn),sn.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",hn=!!qn("perspective"),an=1)},Bn=function t(e){var n,r=Ln("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,o=this.nextSibling,a=this.style.cssText;if(on.appendChild(r),r.appendChild(this),this.style.display="block",e)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=t}catch(s){}else this._gsapBBox&&(n=this._gsapBBox());return o?i.insertBefore(this,o):i.appendChild(this),on.removeChild(r),this.style.cssText=a,n},jn=function(t,e){var n=e.length;while(n--)if(t.hasAttribute(e[n]))return t.getAttribute(e[n])},Wn=function(t){var e;try{e=t.getBBox()}catch(n){e=Bn.call(t,!0)}return!e||e.width||e.x||e.y?e:{x:+jn(t,["x","cx","x1"])||0,y:+jn(t,["y","cy","y1"])||0,width:0,height:0}},Kn=function(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!Wn(t))},zn=function(t,e){if(e){var n=t.style;e in fn&&(e=Mn),n.removeProperty?("ms"!==e.substr(0,2)&&"webkit"!==e.substr(0,6)||(e="-"+e),n.removeProperty(e.replace(gn,"-$1").toLowerCase())):n.removeAttribute(e)}},Gn=function(t,e,n,r,i,o){var a=new $e(t._pt,e,n,0,1,o?An:In);return t._pt=a,a.b=r,a.e=i,t._props.push(n),a},Qn={deg:1,rad:1,turn:1},Hn=function(t,e,n,r){var i,o,a,s,u=parseFloat(n),c=(n+"").substr((u+"").length)||"px",h=sn.style,l=bn.test(e),f="svg"===t.tagName.toLowerCase(),p=(f?"client":"offset")+(l?"Width":"Height"),d=100,m="px"===r;return r===c||Qn[r]||Qn[c]?u:(s=t.getCTM&&Kn(t),"%"===r&&fn[e]?nt(u/(s?t.getBBox()[l?"width":"height"]:t[p])*d):(h[l?"width":"height"]=d+(m?c:r),o="em"===r&&t.appendChild&&!f?t:t.parentNode,s&&(o=(t.ownerSVGElement||{}).parentNode),o&&o!==rn&&o.appendChild||(o=rn.body),a=o._gsap,a&&"%"===r&&a.width&&l&&a.time===he.time?i=a.width*u/d:(o.appendChild(sn),i=sn[p],o.removeChild(sn),l&&"%"===r&&(a=Z(o),a.time=he.time,a.width=i/u*d)),nt(m?i*u/d:d/i*u)))},Yn=function(t,e,n,r){var i;return an||Vn(),e in wn&&(e=wn[e],~e.indexOf(",")&&(e=e.split(",")[0])),fn[e]?(i=sr(t,r),i="transformOrigin"!==e?i[e]:ur(Fn(t,Pn))+i.zOrigin+"px"):(i=t.style[e],(!i||"auto"===i||r||~i.indexOf("calc("))&&(i=Fn(t,e)||tt(t,e))),n?Hn(t,e,i,n)+n:i},$n=function(t,e,n,r){var i,o,a,s,u,c,h,l,p,d,m,y,g,v=new $e(this._pt,t.style,e,0,1,Ke),b=0,_=0;if(v.b=n,v.e=r,n+="",r+="","auto"===r&&(t.style[e]=r,r=Fn(t,e)||r,t.style[e]=n),i=[n,r],ce(i),n=i[0],r=i[1],a=n.match(vn)||[],g=r.match(vn)||[],g.length){while(o=vn.exec(r))h=o[0],p=r.substring(b,o.index),u?u=(u+1)%5:"rgba("===p.substr(-5)&&(u=1),h!==(c=a[_++]||"")&&(s=parseFloat(c)||0,m=c.substr((s+"").length),y="="===h.charAt(1)?+(h.charAt(0)+"1"):0,y&&(h=h.substr(2)),l=parseFloat(h),d=h.substr((l+"").length),b=vn.lastIndex-d.length,d||(d=d||f.units[e]||m,b===r.length&&(r+=d,v.e+=d)),m!==d&&(s=Hn(t,e,c,d)||0),v._pt={_next:v._pt,p:p||1===_?p:",",s:s,c:y?y*l:l-s,m:u&&u<4?Math.round:0});v.c=b<r.length?r.substring(b,r.length):""}else v.r="display"===e&&"none"===r?An:In;return P.test(r)&&(v.e=0),this._pt=v,v},Xn={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Jn=function(t){var e=t.split(" "),n=e[0],r=e[1]||"50%";return"top"!==n&&"bottom"!==n&&"left"!==r&&"right"!==r||(t=n,n=r,r=t),e[0]=Xn[n]||n,e[1]=Xn[r]||r,e.join(" ")},Zn=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var n,r,i,o=e.t,a=o.style,s=e.u;if("all"===s||!0===s)a.cssText="",r=1;else{s=s.split(","),i=s.length;while(--i>-1)n=s[i],fn[n]&&(r=1,n="transformOrigin"===n?Pn:Mn),zn(o,n)}r&&(zn(o,Mn),r=o._gsap,r&&(r.svg&&o.removeAttribute("transform"),r.uncache=1))}},tr={clearProps:function(t,e,n,r,i){if("isFromStart"!==i.data){var o=t._pt=new $e(t._pt,e,n,0,0,Zn);return o.u=r,o.pr=-10,o.tween=i,t._props.push(n),1}}},er=[1,0,0,1,0,0],nr={},rr=function(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t},ir=function(t){var e=Fn(t,Mn);return rr(e)?er:e.substr(7).match(O).map(nt)},or=function(t,e){var n,r,i,o,a=t._gsap,s=t.style,u=ir(t);return a.svg&&t.getAttribute("transform")?(i=t.transform.baseVal.consolidate().matrix,u=[i.a,i.b,i.c,i.d,i.e,i.f],"1,0,0,1,0,0"===u.join(",")?er:u):(u!==er||t.offsetParent||t===on||a.svg||(i=s.display,s.display="block",n=t.parentNode,n&&t.offsetParent||(o=1,r=t.nextSibling,on.appendChild(t)),u=ir(t),i?s.display=i:zn(t,"display"),o&&(r?n.insertBefore(t,r):n?n.appendChild(t):on.removeChild(t))),e&&u.length>6?[u[0],u[1],u[4],u[5],u[12],u[13]]:u)},ar=function(t,e,n,r,i,o){var a,s,u,c,h=t._gsap,l=i||or(t,!0),f=h.xOrigin||0,p=h.yOrigin||0,d=h.xOffset||0,m=h.yOffset||0,y=l[0],g=l[1],v=l[2],b=l[3],_=l[4],w=l[5],T=e.split(" "),E=parseFloat(T[0])||0,S=parseFloat(T[1])||0;n?l!==er&&(s=y*b-g*v)&&(u=E*(b/s)+S*(-v/s)+(v*w-b*_)/s,c=E*(-g/s)+S*(y/s)-(y*w-g*_)/s,E=u,S=c):(a=Wn(t),E=a.x+(~T[0].indexOf("%")?E/100*a.width:E),S=a.y+(~(T[1]||T[0]).indexOf("%")?S/100*a.height:S)),r||!1!==r&&h.smooth?(_=E-f,w=S-p,h.xOffset=d+(_*y+w*v)-_,h.yOffset=m+(_*g+w*b)-w):h.xOffset=h.yOffset=0,h.xOrigin=E,h.yOrigin=S,h.smooth=!!r,h.origin=e,h.originIsAbsolute=!!n,t.style[Pn]="0px 0px",o&&(Gn(o,h,"xOrigin",f,E),Gn(o,h,"yOrigin",p,S),Gn(o,h,"xOffset",d,h.xOffset),Gn(o,h,"yOffset",m,h.yOffset))},sr=function(t,e){var n=t._gsap||new Ee(t);if("x"in n&&!e&&!n.uncache)return n;var r,i,o,a,s,u,c,h,l,p,d,m,y,g,v,b,_,w,T,E,S,C,I,A,N,k,D,x,O,R,M=t.style,P=n.scaleX<0,L=n.xOrigin||0,F=n.yOrigin||0,U="px",q="deg",V=Fn(t,Pn)||"0";return r=i=o=u=c=h=l=p=d=0,a=s=1,n.svg=!(!t.getCTM||!Kn(t)),m=or(t,n.svg),n.svg&&ar(t,V,n.originIsAbsolute,!1!==n.smooth,m),m!==er&&(b=m[0],_=m[1],w=m[2],T=m[3],r=E=m[4],i=S=m[5],6===m.length?(a=Math.sqrt(b*b+_*_),s=Math.sqrt(T*T+w*w),u=b||_?mn(_,b)*pn:n.rotation||0,l=w||T?mn(w,T)*pn+u:n.skewX||0,n.svg&&(r-=L-(L*b+F*w),i-=F-(L*_+F*T))):(R=m[6],x=m[7],N=m[8],k=m[9],D=m[10],O=m[11],r=m[12],i=m[13],o=m[14],y=mn(R,D),c=y*pn,y&&(g=Math.cos(-y),v=Math.sin(-y),C=E*g+N*v,I=S*g+k*v,A=R*g+D*v,N=E*-v+N*g,k=S*-v+k*g,D=R*-v+D*g,O=x*-v+O*g,E=C,S=I,R=A),y=mn(-w,D),h=y*pn,y&&(g=Math.cos(-y),v=Math.sin(-y),C=b*g-N*v,I=_*g-k*v,A=w*g-D*v,O=T*v+O*g,b=C,_=I,w=A),y=mn(_,b),u=y*pn,y&&(g=Math.cos(y),v=Math.sin(y),C=b*g+_*v,I=E*g+S*v,_=_*g-b*v,S=S*g-E*v,b=C,E=I),c&&Math.abs(c)+Math.abs(u)>359.9&&(c=u=0,h=180-h),a=nt(Math.sqrt(b*b+_*_+w*w)),s=nt(Math.sqrt(S*S+R*R)),y=mn(E,S),l=Math.abs(y)>2e-4?y*pn:0,d=O?1/(O<0?-O:O):0),n.svg&&(m=t.getAttribute("transform"),n.forceCSS=t.setAttribute("transform","")||!rr(Fn(t,Mn)),m&&t.setAttribute("transform",m))),Math.abs(l)>90&&Math.abs(l)<270&&(P?(a*=-1,l+=u<=0?180:-180,u+=u<=0?180:-180):(s*=-1,l+=l<=0?180:-180)),n.x=((n.xPercent=r&&Math.round(t.offsetWidth/2)===Math.round(-r)?-50:0)?0:r)+U,n.y=((n.yPercent=i&&Math.round(t.offsetHeight/2)===Math.round(-i)?-50:0)?0:i)+U,n.z=o+U,n.scaleX=nt(a),n.scaleY=nt(s),n.rotation=nt(u)+q,n.rotationX=nt(c)+q,n.rotationY=nt(h)+q,n.skewX=l+q,n.skewY=p+q,n.transformPerspective=d+U,(n.zOrigin=parseFloat(V.split(" ")[2])||0)&&(M[Pn]=ur(V)),n.xOffset=n.yOffset=0,n.force3D=f.force3D,n.renderTransform=n.svg?mr:hn?dr:hr,n.uncache=0,n},ur=function(t){return(t=t.split(" "))[0]+" "+t[1]},cr=function(t,e,n){var r=Rt(e);return nt(parseFloat(e)+parseFloat(Hn(t,"x",n+"px",r)))+r},hr=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,dr(t,e)},lr="0deg",fr="0px",pr=") ",dr=function(t,e){var n=e||this,r=n.xPercent,i=n.yPercent,o=n.x,a=n.y,s=n.z,u=n.rotation,c=n.rotationY,h=n.rotationX,l=n.skewX,f=n.skewY,p=n.scaleX,d=n.scaleY,m=n.transformPerspective,y=n.force3D,g=n.target,v=n.zOrigin,b="",_="auto"===y&&t&&1!==t||!0===y;if(v&&(h!==lr||c!==lr)){var w,T=parseFloat(c)*dn,E=Math.sin(T),S=Math.cos(T);T=parseFloat(h)*dn,w=Math.cos(T),o=cr(g,o,E*w*-v),a=cr(g,a,-Math.sin(T)*-v),s=cr(g,s,S*w*-v+v)}(r||i)&&(b="translate("+r+"%, "+i+"%) "),(_||o!==fr||a!==fr||s!==fr)&&(b+=s!==fr||_?"translate3d("+o+", "+a+", "+s+") ":"translate("+o+", "+a+pr),m!==fr&&(b+="perspective("+m+pr),u!==lr&&(b+="rotate("+u+pr),c!==lr&&(b+="rotateY("+c+pr),h!==lr&&(b+="rotateX("+h+pr),l===lr&&f===lr||(b+="skew("+l+", "+f+pr),1===p&&1===d||(b+="scale("+p+", "+d+pr),g.style[Mn]=b||"translate(0, 0)"},mr=function(t,e){var n,r,i,o,a,s=e||this,u=s.xPercent,c=s.yPercent,h=s.x,l=s.y,f=s.rotation,p=s.skewX,d=s.skewY,m=s.scaleX,y=s.scaleY,g=s.target,v=s.xOrigin,b=s.yOrigin,_=s.xOffset,w=s.yOffset,T=s.forceCSS,E=parseFloat(h),S=parseFloat(l);f=parseFloat(f),p=parseFloat(p),d=parseFloat(d),d&&(d=parseFloat(d),p+=d,f+=d),f||p?(f*=dn,p*=dn,n=Math.cos(f)*m,r=Math.sin(f)*m,i=Math.sin(f-p)*-y,o=Math.cos(f-p)*y,p&&(d*=dn,a=Math.tan(p-d),a=Math.sqrt(1+a*a),i*=a,o*=a,d&&(a=Math.tan(d),a=Math.sqrt(1+a*a),n*=a,r*=a)),n=nt(n),r=nt(r),i=nt(i),o=nt(o)):(n=m,o=y,r=i=0),(E&&!~(h+"").indexOf("px")||S&&!~(l+"").indexOf("px"))&&(E=Hn(g,"x",h,"px"),S=Hn(g,"y",l,"px")),(v||b||_||w)&&(E=nt(E+v-(v*n+b*i)+_),S=nt(S+b-(v*r+b*o)+w)),(u||c)&&(a=g.getBBox(),E=nt(E+u/100*a.width),S=nt(S+c/100*a.height)),a="matrix("+n+","+r+","+i+","+o+","+E+","+S+")",g.setAttribute("transform",a),T&&(g.style[Mn]=a)},yr=function(t,e,n,r,i,o){var a,s,u=360,c=T(i),h=parseFloat(i)*(c&&~i.indexOf("rad")?pn:1),l=o?h*o:h-r,f=r+l+"deg";return c&&(a=i.split("_")[1],"short"===a&&(l%=u,l!==l%(u/2)&&(l+=l<0?u:-u)),"cw"===a&&l<0?l=(l+u*yn)%u-~~(l/u)*u:"ccw"===a&&l>0&&(l=(l-u*yn)%u-~~(l/u)*u)),t._pt=s=new $e(t._pt,e,n,r,l,En),s.e=f,s.u="deg",t._props.push(n),s},gr=function(t,e,n){var r,i,o,a,s,u,c,h,l=un.style,f=n._gsap;for(i in l.cssText=getComputedStyle(n).cssText+";position:absolute;display:block;",l[Mn]=e,rn.body.appendChild(un),r=sr(un,1),fn)o=f[i],a=r[i],o!==a&&"perspective"!==i&&(c=Rt(o),h=Rt(a),s=c!==h?Hn(n,i,o,h):parseFloat(o),u=parseFloat(a),t._pt=new $e(t._pt,f,i,s,u-s,Tn),t._pt.u=h,t._props.push(i));rn.body.removeChild(un)},vr={name:"css",register:Vn,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,n,r,i){var o,a,s,u,c,h,l,p,d,m,y,g,v,b,_,w=this._props,T=t.style;for(l in an||Vn(),e)if("autoRound"!==l&&(a=e[l],!Q[l]||!De(l,e,n,r,t,i)))if(c=typeof a,h=tr[l],"function"===c&&(a=a.call(n,r,t,i),c=typeof a),"string"===c&&~a.indexOf("random(")&&(a=Yt(a)),h)h(this,t,l,a,n)&&(_=1);else if("--"===l.substr(0,2))this.add(T,"setProperty",getComputedStyle(t).getPropertyValue(l)+"",a+"",r,i,0,0,l);else{if(o=Yn(t,l),u=parseFloat(o),m="string"===c&&"="===a.charAt(1)?+(a.charAt(0)+"1"):0,m&&(a=a.substr(2)),s=parseFloat(a),l in wn&&("autoAlpha"===l&&(1===u&&"hidden"===Yn(t,"visibility")&&s&&(u=0),Gn(this,T,"visibility",u?"inherit":"hidden",s?"inherit":"hidden",!s)),"scale"!==l&&(l=wn[l],~l.indexOf(",")&&(l=l.split(",")[0]))),y=l in fn,y)if(g||(v=t._gsap,b=!1!==e.smoothOrigin&&v.smooth,g=this._pt=new $e(this._pt,T,Mn,0,1,v.renderTransform,v,0,-1),g.dep=1),"scale"===l)this._pt=new $e(this._pt,v,"scaleY",v.scaleY,m?m*s:s-v.scaleY),w.push("scaleY",l),l+="X";else{if("transformOrigin"===l){a=Jn(a),v.svg?ar(t,a,0,b,0,this):(d=parseFloat(a.split(" ")[2]),d!==v.zOrigin&&Gn(this,v,"zOrigin",v.zOrigin,d),Gn(this,T,l,ur(o),ur(a)));continue}if("svgOrigin"===l){ar(t,a,1,b,0,this);continue}if(l in nr){yr(this,v,l,u,a,m);continue}if("smoothOrigin"===l){Gn(this,v,"smooth",v.smooth,a);continue}if("force3D"===l){v[l]=a;continue}if("transform"===l){gr(this,a,t);continue}}else l in T||(l=qn(l)||l);if(y||(s||0===s)&&(u||0===u)&&!_n.test(a)&&l in T)p=(o+"").substr((u+"").length),d=(a+"").substr((s+"").length)||(l in f.units?f.units[l]:p),p!==d&&(u=Hn(t,l,o,d)),this._pt=new $e(this._pt,y?v:T,l,u,m?m*s:s-u,"px"!==d||!1===e.autoRound||y?Tn:Cn),this._pt.u=d||0,p!==d&&(this._pt.b=o,this._pt.r=Sn);else if(l in T)$n.call(this,t,l,o,a);else{if(!(l in t)){V(l,a);continue}this.add(t,l,t[l],a,r,i)}w.push(l)}_&&Ye(this)},get:Yn,aliases:wn,getSetter:function(t,e,n){return e in fn&&e!==Pn&&(t._gsap.x||Yn(t,"x"))?n&&cn===n?"scale"===e?xn:Dn:(cn=n||{})&&("scale"===e?On:Rn):t.style&&!C(t.style[e])?Nn:~e.indexOf("-")?kn:Be(t,e)}};en.utils.checkPrefix=qn,function(t,e,n,r){var i=et(t+","+e+","+n,(function(t){fn[t]=1}));et(e,(function(t){f.units[t]="deg",nr[t]=1})),wn[i[13]]=t+","+e,et(r,(function(t){var e=t.split(":");wn[e[1]]=i[e[0]]}))}("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,9:rotateX,10:rotateY"),et("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(t){f.units[t]="px"})),en.registerPlugin(vr),n.d(e,"a",(function(){return br}));var br=en.registerPlugin(vr)||en},d2d5:function(t,e,n){n("1654"),n("549b"),t.exports=n("584a").Array.from},d3f4:function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},d53b:function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},d864:function(t,e,n){var r=n("79aa");t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},d8e8:function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},d925:function(t,e,n){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},d9f6:function(t,e,n){var r=n("e4ae"),i=n("794b"),o=n("1bc3"),a=Object.defineProperty;e.f=n("8e60")?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(s){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},dbdb:function(t,e,n){var r=n("584a"),i=n("e53d"),o="__core-js_shared__",a=i[o]||(i[o]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n("b8e3")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},dcaa:function(t,e,n){"use strict";n.r(e),n.d(e,"factory",(function(){return P})),n.d(e,"registerAnalytics",(function(){return F})),n.d(e,"resetGlobalVars",(function(){return R})),n.d(e,"settings",(function(){return M}));var r,i,o,a=n("c23d"),s=n.n(a),u=n("9ab4"),c=(n("7d28"),n("cd51")),h="measurementId",l="firebase_id",f="origin",p="https://www.googletagmanager.com/gtag/js";
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function d(t,e,n,i,o){var a=i||{};o&&o.global||(a=Object(u["__assign"])(Object(u["__assign"])({},i),{send_to:e})),t(r.EVENT,n,a||{})}function m(t,e,n,i){i&&i.global?t(r.SET,{screen_name:n}):t(r.CONFIG,e,{update:!0,screen_name:n})}function y(t,e,n,i){i&&i.global?t(r.SET,{user_id:n}):t(r.CONFIG,e,{update:!0,user_id:n})}function g(t,e,n,i){if(i&&i.global){for(var o={},a=0,s=Object.keys(n);a<s.length;a++){var u=s[a];o["user_properties."+u]=n[u]}t(r.SET,o)}else t(r.CONFIG,e,{update:!0,user_properties:n})}function v(t,e){window["ga-disable-"+t]=!e}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b(t,e){return Object(u["__awaiter"])(this,void 0,void 0,(function(){var n,i;return Object(u["__generator"])(this,(function(o){switch(o.label){case 0:return[4,t.installations().getId()];case 1:return n=o.sent(),e("js",new Date),e(r.CONFIG,t.options[h],(i={},i[l]=n,i[f]="firebase",i.update=!0,i)),[2]}}))}))}function _(t){var e=document.createElement("script");e.src=p+"?l="+t,e.async=!0,document.head.appendChild(e)}function w(t){var e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}function T(t,e){return function(n,i,o){if(n===r.EVENT){var a=[];if(o&&o["send_to"]){var s=o["send_to"];Array.isArray(s)||(s=[s]);for(var u=0,c=s;u<c.length;u++){var h=c[u],l=e[h];if(!l){a=[];break}a.push(l)}}if(0===a.length)for(var f=0,p=Object.values(e);f<p.length;f++){var d=p[f];a.push(d)}Promise.all(a).then((function(){return t(r.EVENT,i,o||{})})).catch((function(t){return console.error(t)}))}else if(n===r.CONFIG){var m=e[i]||Promise.resolve();m.then((function(){t(r.CONFIG,i,o)})).catch((function(t){return console.error(t)}))}else t(r.SET,i)}}function E(t,e,n){var r=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];window[e].push(arguments)};return window[n]&&"function"===typeof window[n]&&(r=window[n]),window[n]=T(r,t),{gtagCore:r,wrappedGtag:window[n]}}function S(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(p))return r}return null}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(t){t["EVENT"]="event",t["SET"]="set",t["CONFIG"]="config"})(r||(r={})),function(t){t["ADD_PAYMENT_INFO"]="add_payment_info",t["ADD_TO_CART"]="add_to_cart",t["ADD_TO_WISHLIST"]="add_to_wishlist",t["BEGIN_CHECKOUT"]="begin_checkout",t["CHECKOUT_PROGRESS"]="checkout_progress",t["EXCEPTION"]="exception",t["GENERATE_LEAD"]="generate_lead",t["LOGIN"]="login",t["PAGE_VIEW"]="page_view",t["PURCHASE"]="purchase",t["REFUND"]="refund",t["REMOVE_FROM_CART"]="remove_from_cart",t["SCREEN_VIEW"]="screen_view",t["SEARCH"]="search",t["SELECT_CONTENT"]="select_content",t["SET_CHECKOUT_OPTION"]="set_checkout_option",t["SHARE"]="share",t["SIGN_UP"]="sign_up",t["TIMING_COMPLETE"]="timing_complete",t["VIEW_ITEM"]="view_item",t["VIEW_ITEM_LIST"]="view_item_list",t["VIEW_PROMOTION"]="view_promotion",t["VIEW_SEARCH_RESULTS"]="view_search_results"}(i||(i={}));var C,I,A=(o={},o["no-ga-id"]='"'+h+'" field is empty in Firebase config. Firebase Analytics requires this field to contain a valid measurement ID.',o["already-exists"]="A Firebase Analytics instance with the measurement ID ${id}  already exists. Only one Firebase Analytics instance can be created for each measurement ID.",o["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",o),N=new c["ErrorFactory"]("analytics","Analytics",A),k={},D="dataLayer",x="gtag",O=!1;function R(t,e){void 0===t&&(t=!1),void 0===e&&(e={}),O=t,k=e,D="dataLayer",x="gtag"}function M(t){if(O)throw N.create("already-initialized");t.dataLayerName&&(D=t.dataLayerName),t.gtagName&&(x=t.gtagName)}function P(t,e){var n=t.options[h];if(!n)throw N.create("no-ga-id");if(null!=k[n])throw N.create("already-exists",{id:n});if(!O){S()||_(D),w(D);var r=E(k,D,x),i=r.wrappedGtag,o=r.gtagCore;I=i,C=o,O=!0}k[n]=b(t,C);var a={app:t,logEvent:function(t,e,r){return d(I,n,t,e,r)},setCurrentScreen:function(t,e){return m(I,n,t,e)},setUserId:function(t,e){return y(I,n,t,e)},setUserProperties:function(t,e){return g(I,n,t,e)},setAnalyticsCollectionEnabled:function(t){return v(n,t)}};return e({INTERNAL:{analytics:{logEvent:a.logEvent}}}),a}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var L="analytics";function F(t){t.INTERNAL.registerService(L,P,{settings:M,EventName:i},void 0,!1)}F(s.a)},dcbc:function(t,e,n){var r=n("2aba");t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},df7c:function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t){"string"!==typeof t&&(t+="");var e,n=0,r=-1,i=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!i){n=e+1;break}}else-1===r&&(i=!1,r=e+1);return-1===r?"":t.slice(n,r)}function i(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var a=o>=0?arguments[o]:t.cwd();if("string"!==typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(e=a+"/"+e,r="/"===a.charAt(0))}return e=n(i(e.split("/"),(function(t){return!!t})),!r).join("/"),(r?"/":"")+e||"."},e.normalize=function(t){var r=e.isAbsolute(t),a="/"===o(t,-1);return t=n(i(t.split("/"),(function(t){return!!t})),!r).join("/"),t||r||(t="."),t&&a&&(t+="/"),(r?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(i(t,(function(t,e){if("string"!==typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length;e++)if(""!==t[e])break;for(var n=t.length-1;n>=0;n--)if(""!==t[n])break;return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var i=r(t.split("/")),o=r(n.split("/")),a=Math.min(i.length,o.length),s=a,u=0;u<a;u++)if(i[u]!==o[u]){s=u;break}var c=[];for(u=s;u<i.length;u++)c.push("..");return c=c.concat(o.slice(s)),c.join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){if("string"!==typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),n=47===e,r=-1,i=!0,o=t.length-1;o>=1;--o)if(e=t.charCodeAt(o),47===e){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":t.slice(0,r)},e.basename=function(t,e){var n=r(t);return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){"string"!==typeof t&&(t+="");for(var e=-1,n=0,r=-1,i=!0,o=0,a=t.length-1;a>=0;--a){var s=t.charCodeAt(a);if(47!==s)-1===r&&(i=!1,r=a+1),46===s?-1===e?e=a:1!==o&&(o=1):-1!==e&&(o=-1);else if(!i){n=a+1;break}}return-1===e||-1===r||0===o||1===o&&e===r-1&&e===n+1?"":t.slice(e,r)};var o="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n("4362"))},e11e:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},e230:function(t,e){t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="fb15")}({"014b":function(t,e,n){"use strict";var r=n("e53d"),i=n("07e3"),o=n("8e60"),a=n("63b6"),s=n("9138"),u=n("ebfd").KEY,c=n("294c"),h=n("dbdb"),l=n("45f2"),f=n("62a0"),p=n("5168"),d=n("ccb9"),m=n("6718"),y=n("47ee"),g=n("9003"),v=n("e4ae"),b=n("f772"),_=n("36c3"),w=n("1bc3"),T=n("aebd"),E=n("a159"),S=n("0395"),C=n("bf0b"),I=n("d9f6"),A=n("c3a1"),N=C.f,k=I.f,D=S.f,x=r.Symbol,O=r.JSON,R=O&&O.stringify,M="prototype",P=p("_hidden"),L=p("toPrimitive"),F={}.propertyIsEnumerable,U=h("symbol-registry"),q=h("symbols"),V=h("op-symbols"),B=Object[M],j="function"==typeof x,W=r.QObject,K=!W||!W[M]||!W[M].findChild,z=o&&c((function(){return 7!=E(k({},"a",{get:function(){return k(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=N(B,e);r&&delete B[e],k(t,e,n),r&&t!==B&&k(B,e,r)}:k,G=function(t){var e=q[t]=E(x[M]);return e._k=t,e},Q=j&&"symbol"==typeof x.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof x},H=function(t,e,n){return t===B&&H(V,e,n),v(t),e=w(e,!0),v(n),i(q,e)?(n.enumerable?(i(t,P)&&t[P][e]&&(t[P][e]=!1),n=E(n,{enumerable:T(0,!1)})):(i(t,P)||k(t,P,T(1,{})),t[P][e]=!0),z(t,e,n)):k(t,e,n)},Y=function(t,e){v(t);var n,r=y(e=_(e)),i=0,o=r.length;while(o>i)H(t,n=r[i++],e[n]);return t},$=function(t,e){return void 0===e?E(t):Y(E(t),e)},X=function(t){var e=F.call(this,t=w(t,!0));return!(this===B&&i(q,t)&&!i(V,t))&&(!(e||!i(this,t)||!i(q,t)||i(this,P)&&this[P][t])||e)},J=function(t,e){if(t=_(t),e=w(e,!0),t!==B||!i(q,e)||i(V,e)){var n=N(t,e);return!n||!i(q,e)||i(t,P)&&t[P][e]||(n.enumerable=!0),n}},Z=function(t){var e,n=D(_(t)),r=[],o=0;while(n.length>o)i(q,e=n[o++])||e==P||e==u||r.push(e);return r},tt=function(t){var e,n=t===B,r=D(n?V:_(t)),o=[],a=0;while(r.length>a)!i(q,e=r[a++])||n&&!i(B,e)||o.push(q[e]);return o};j||(x=function(){if(this instanceof x)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(n){this===B&&e.call(V,n),i(this,P)&&i(this[P],t)&&(this[P][t]=!1),z(this,t,T(1,n))};return o&&K&&z(B,t,{configurable:!0,set:e}),G(t)},s(x[M],"toString",(function(){return this._k})),C.f=J,I.f=H,n("6abf").f=S.f=Z,n("355d").f=X,n("9aa9").f=tt,o&&!n("b8e3")&&s(B,"propertyIsEnumerable",X,!0),d.f=function(t){return G(p(t))}),a(a.G+a.W+a.F*!j,{Symbol:x});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)p(et[nt++]);for(var rt=A(p.store),it=0;rt.length>it;)m(rt[it++]);a(a.S+a.F*!j,"Symbol",{for:function(t){return i(U,t+="")?U[t]:U[t]=x(t)},keyFor:function(t){if(!Q(t))throw TypeError(t+" is not a symbol!");for(var e in U)if(U[e]===t)return e},useSetter:function(){K=!0},useSimple:function(){K=!1}}),a(a.S+a.F*!j,"Object",{create:$,defineProperty:H,defineProperties:Y,getOwnPropertyDescriptor:J,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),O&&a(a.S+a.F*(!j||c((function(){var t=x();return"[null]"!=R([t])||"{}"!=R({a:t})||"{}"!=R(Object(t))}))),"JSON",{stringify:function(t){var e,n,r=[t],i=1;while(arguments.length>i)r.push(arguments[i++]);if(n=e=r[1],(b(e)||void 0!==t)&&!Q(t))return g(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Q(e))return e}),r[1]=e,R.apply(O,r)}}),x[M][L]||n("35e8")(x[M],L,x[M].valueOf),l(x,"Symbol"),l(Math,"Math",!0),l(r.JSON,"JSON",!0)},"0395":function(t,e,n){var r=n("36c3"),i=n("6abf").f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return i(t)}catch(e){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?s(t):i(r(t))}},"07e3":function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},"0d58":function(t,e,n){var r=n("ce10"),i=n("e11e");t.exports=Object.keys||function(t){return r(t,i)}},"0fc9":function(t,e,n){var r=n("3a38"),i=Math.max,o=Math.min;t.exports=function(t,e){return t=r(t),t<0?i(t+e,0):o(t,e)}},"11e9":function(t,e,n){var r=n("52a7"),i=n("4630"),o=n("6821"),a=n("6a99"),s=n("69a8"),u=n("c69a"),c=Object.getOwnPropertyDescriptor;e.f=n("9e1e")?c:function(t,e){if(t=o(t),e=a(e,!0),u)try{return c(t,e)}catch(n){}if(s(t,e))return i(!r.f.call(t,e),t[e])}},1495:function(t,e,n){var r=n("86cc"),i=n("cb7c"),o=n("0d58");t.exports=n("9e1e")?Object.defineProperties:function(t,e){i(t);var n,a=o(e),s=a.length,u=0;while(s>u)r.f(t,n=a[u++],e[n]);return t}},1691:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},"1bc3":function(t,e,n){var r=n("f772");t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},"1ec9":function(t,e,n){var r=n("f772"),i=n("e53d").document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},"230e":function(t,e,n){var r=n("d3f4"),i=n("7726").document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},"241e":function(t,e,n){var r=n("25eb");t.exports=function(t){return Object(r(t))}},"25eb":function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},"268f":function(t,e,n){t.exports=n("fde4")},"294c":function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},"2aba":function(t,e,n){var r=n("7726"),i=n("32e9"),o=n("69a8"),a=n("ca5a")("src"),s=n("fa5b"),u="toString",c=(""+s).split(u);n("8378").inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var u="function"==typeof n;u&&(o(n,"name")||i(n,"name",e)),t[e]!==n&&(u&&(o(n,a)||i(n,a,t[e]?""+t[e]:c.join(String(e)))),t===r?t[e]=n:s?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,u,(function(){return"function"==typeof this&&this[a]||s.call(this)}))},"2aeb":function(t,e,n){var r=n("cb7c"),i=n("1495"),o=n("e11e"),a=n("613b")("IE_PROTO"),s=function(){},u="prototype",c=function(){var t,e=n("230e")("iframe"),r=o.length,i="<",a=">";e.style.display="none",n("fab2").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(i+"script"+a+"document.F=Object"+i+"/script"+a),t.close(),c=t.F;while(r--)delete c[u][o[r]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(s[u]=r(t),n=new s,s[u]=null,n[a]=t):n=c(),void 0===e?n:i(n,e)}},"2b4c":function(t,e,n){var r=n("5537")("wks"),i=n("ca5a"),o=n("7726").Symbol,a="function"==typeof o,s=t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))};s.store=r},"2d00":function(t,e){t.exports=!1},"2d95":function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},"32a6":function(t,e,n){var r=n("241e"),i=n("c3a1");n("ce7e")("keys",(function(){return function(t){return i(r(t))}}))},"32e9":function(t,e,n){var r=n("86cc"),i=n("4630");t.exports=n("9e1e")?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},"32fc":function(t,e,n){var r=n("e53d").document;t.exports=r&&r.documentElement},"335c":function(t,e,n){var r=n("6b4c");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},"355d":function(t,e){e.f={}.propertyIsEnumerable},"35e8":function(t,e,n){var r=n("d9f6"),i=n("aebd");t.exports=n("8e60")?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},"36bd":function(t,e,n){"use strict";var r=n("4bf8"),i=n("77f1"),o=n("9def");t.exports=function(t){var e=r(this),n=o(e.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),u=a>2?arguments[2]:void 0,c=void 0===u?n:i(u,n);while(c>s)e[s++]=t;return e}},"36c3":function(t,e,n){var r=n("335c"),i=n("25eb");t.exports=function(t){return r(i(t))}},"3a38":function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},"454f":function(t,e,n){n("46a7");var r=n("584a").Object;t.exports=function(t,e,n){return r.defineProperty(t,e,n)}},4588:function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},"45f2":function(t,e,n){var r=n("d9f6").f,i=n("07e3"),o=n("5168")("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},4630:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"46a7":function(t,e,n){var r=n("63b6");r(r.S+r.F*!n("8e60"),"Object",{defineProperty:n("d9f6").f})},"47ee":function(t,e,n){var r=n("c3a1"),i=n("9aa9"),o=n("355d");t.exports=function(t){var e=r(t),n=i.f;if(n){var a,s=n(t),u=o.f,c=0;while(s.length>c)u.call(t,a=s[c++])&&e.push(a)}return e}},"4a83":function(t,e,n){var r=n("df45").dispatch,i=Math.PI/180,o=64,a=2048;function s(t){return t.text}function u(){return"serif"}function c(){return"normal"}function h(t){return Math.sqrt(t.value)}function l(){return 30*(~~(6*Math.random())-3)}function f(){return 1}function p(t,e,n,r){if(!e.sprite){var s=t.context,u=t.ratio;s.clearRect(0,0,(o<<5)/u,a/u);var c=0,h=0,l=0,f=n.length;--r;while(++r<f){e=n[r],s.save(),s.font=e.style+" "+e.weight+" "+~~((e.size+1)/u)+"px "+e.font;var p=s.measureText(e.text+"m").width*u,d=e.size<<1;if(e.rotate){var m=Math.sin(e.rotate*i),y=Math.cos(e.rotate*i),g=p*y,v=p*m,b=d*y,_=d*m;p=Math.max(Math.abs(g+_),Math.abs(g-_))+31>>5<<5,d=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else p=p+31>>5<<5;if(d>l&&(l=d),c+p>=o<<5&&(c=0,h+=l,l=0),h+d>=a)break;s.translate((c+(p>>1))/u,(h+(d>>1))/u),e.rotate&&s.rotate(e.rotate*i),s.fillText(e.text,0,0),e.padding&&(s.lineWidth=2*e.padding,s.strokeText(e.text,0,0)),s.restore(),e.width=p,e.height=d,e.xoff=c,e.yoff=h,e.x1=p>>1,e.y1=d>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,c+=p}var w=s.getImageData(0,0,(o<<5)/u,a/u).data,T=[];while(--r>=0)if(e=n[r],e.hasText){p=e.width;for(var E=p>>5,S=(d=e.y1-e.y0,0);S<d*E;S++)T[S]=0;if(c=e.xoff,null==c)return;h=e.yoff;for(var C=0,I=-1,A=0;A<d;A++){for(S=0;S<p;S++){var N=E*A+(S>>5),k=w[(h+A)*(o<<5)+(c+S)<<2]?1<<31-S%32:0;T[N]|=k,C|=k}C?I=A:(e.y0++,d--,A--,h++)}e.y1=e.y0+I,e.sprite=T.slice(0,(e.y1-e.y0)*E)}}}function d(t,e,n){n>>=5;for(var r,i=t.sprite,o=t.width>>5,a=t.x-(o<<4),s=127&a,u=32-s,c=t.y1-t.y0,h=(t.y+t.y0)*n+(a>>5),l=0;l<c;l++){r=0;for(var f=0;f<=o;f++)if((r<<u|(f<o?(r=i[l*o+f])>>>s:0))&e[h+f])return!0;h+=n}return!1}function m(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function y(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function g(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function v(t){var e=4,n=e*t[0]/t[1],r=0,i=0;return function(t){var o=t<0?-1:1;switch(Math.sqrt(1+4*o*t)-o&3){case 0:r+=n;break;case 1:i+=e;break;case 2:r-=n;break;default:i-=e;break}return[r,i]}}function b(t){var e=[],n=-1;while(++n<t)e[n]=0;return e}function _(){return document.createElement("canvas")}function w(t){return"function"===typeof t?t:function(){return t}}t.exports=function(){var t=[256,256],e=s,n=u,i=h,v=c,E=c,S=l,C=f,I=g,A=[],N=1/0,k=r("word","end"),D=null,x=Math.random,O={},R=_;function M(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(o<<5)/e,t.height=a/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}function P(e,n,r){t[0],t[1];var i,o,a,s=n.x,u=n.y,c=Math.sqrt(t[0]*t[0]+t[1]*t[1]),h=I(t),l=x()<.5?1:-1,f=-l;while(i=h(f+=l)){if(o=~~i[0],a=~~i[1],Math.min(Math.abs(o),Math.abs(a))>=c)break;if(n.x=s+o,n.y=u+a,!(n.x+n.x0<0||n.y+n.y0<0||n.x+n.x1>t[0]||n.y+n.y1>t[1])&&(!r||!d(n,e,t[0]))&&(!r||y(n,r))){for(var p,m=n.sprite,g=n.width>>5,v=t[0]>>5,b=n.x-(g<<4),_=127&b,w=32-_,T=n.y1-n.y0,E=(n.y+n.y0)*v+(b>>5),S=0;S<T;S++){p=0;for(var C=0;C<=g;C++)e[E+C]|=p<<w|(C<g?(p=m[S*g+C])>>>_:0);E+=v}return delete n.sprite,!0}}return!1}return O.canvas=function(t){return arguments.length?(R=w(t),O):R},O.start=function(){var r=M(R()),o=b((t[0]>>5)*t[1]),a=null,s=A.length,u=-1,c=[],h=A.map((function(t,r){return t.text=e.call(this,t,r),t.font=n.call(this,t,r),t.style=v.call(this,t,r),t.weight=E.call(this,t,r),t.rotate=S.call(this,t,r),t.size=~~i.call(this,t,r),t.padding=C.call(this,t,r),t})).sort((function(t,e){return e.size-t.size}));return D&&clearInterval(D),D=setInterval(l,0),l(),O;function l(){var e=Date.now();while(Date.now()-e<N&&++u<s&&D){var n=h[u];n.x=t[0]*(x()+.5)>>1,n.y=t[1]*(x()+.5)>>1,p(r,n,h,u),n.hasText&&P(o,n,a)&&(c.push(n),k.call("word",O,n),a?m(a,n):a=[{x:n.x+n.x0,y:n.y+n.y0},{x:n.x+n.x1,y:n.y+n.y1}],n.x-=t[0]>>1,n.y-=t[1]>>1)}u>=s&&(O.stop(),k.call("end",O,c,a))}},O.stop=function(){return D&&(clearInterval(D),D=null),O},O.timeInterval=function(t){return arguments.length?(N=null==t?1/0:t,O):N},O.words=function(t){return arguments.length?(A=t,O):A},O.size=function(e){return arguments.length?(t=[+e[0],+e[1]],O):t},O.font=function(t){return arguments.length?(n=w(t),O):n},O.fontStyle=function(t){return arguments.length?(v=w(t),O):v},O.fontWeight=function(t){return arguments.length?(E=w(t),O):E},O.rotate=function(t){return arguments.length?(S=w(t),O):S},O.text=function(t){return arguments.length?(e=w(t),O):e},O.spiral=function(t){return arguments.length?(I=T[t]||t,O):I},O.fontSize=function(t){return arguments.length?(i=w(t),O):i},O.padding=function(t){return arguments.length?(C=w(t),O):C},O.random=function(t){return arguments.length?(x=t,O):x},O.on=function(){var t=k.on.apply(k,arguments);return t===k?O:t},O};var T={archimedean:g,rectangular:v}},"4bf8":function(t,e,n){var r=n("be13");t.exports=function(t){return Object(r(t))}},5168:function(t,e,n){var r=n("dbdb")("wks"),i=n("62a0"),o=n("e53d").Symbol,a="function"==typeof o,s=t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))};s.store=r},"52a7":function(t,e){e.f={}.propertyIsEnumerable},5537:function(t,e,n){var r=n("8378"),i=n("7726"),o="__core-js_shared__",a=i[o]||(i[o]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n("2d00")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},5559:function(t,e,n){var r=n("dbdb")("keys"),i=n("62a0");t.exports=function(t){return r[t]||(r[t]=i(t))}},"584a":function(t,e){var n=t.exports={version:"2.6.5"};"number"==typeof __e&&(__e=n)},"5b4e":function(t,e,n){var r=n("36c3"),i=n("b447"),o=n("0fc9");t.exports=function(t){return function(e,n,a){var s,u=r(e),c=i(u.length),h=o(a,c);if(t&&n!=n){while(c>h)if(s=u[h++],s!=s)return!0}else for(;c>h;h++)if((t||h in u)&&u[h]===n)return t||h||0;return!t&&-1}}},"5ca1":function(t,e,n){var r=n("7726"),i=n("8378"),o=n("32e9"),a=n("2aba"),s=n("9b43"),u="prototype",c=function(t,e,n){var h,l,f,p,d=t&c.F,m=t&c.G,y=t&c.S,g=t&c.P,v=t&c.B,b=m?r:y?r[e]||(r[e]={}):(r[e]||{})[u],_=m?i:i[e]||(i[e]={}),w=_[u]||(_[u]={});for(h in m&&(n=e),n)l=!d&&b&&void 0!==b[h],f=(l?b:n)[h],p=v&&l?s(f,r):g&&"function"==typeof f?s(Function.call,f):f,b&&a(b,h,f,t&c.U),_[h]!=f&&o(_,h,p),g&&w[h]!=f&&(w[h]=f)};r.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},"5dbc":function(t,e,n){var r=n("d3f4"),i=n("8b97").set;t.exports=function(t,e,n){var o,a=e.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(t,o),t}},"613b":function(t,e,n){var r=n("5537")("keys"),i=n("ca5a");t.exports=function(t){return r[t]||(r[t]=i(t))}},"626a":function(t,e,n){var r=n("2d95");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},"62a0":function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},"63b6":function(t,e,n){var r=n("e53d"),i=n("584a"),o=n("d864"),a=n("35e8"),s=n("07e3"),u="prototype",c=function(t,e,n){var h,l,f,p=t&c.F,d=t&c.G,m=t&c.S,y=t&c.P,g=t&c.B,v=t&c.W,b=d?i:i[e]||(i[e]={}),_=b[u],w=d?r:m?r[e]:(r[e]||{})[u];for(h in d&&(n=e),n)l=!p&&w&&void 0!==w[h],l&&s(b,h)||(f=l?w[h]:n[h],b[h]=d&&"function"!=typeof w[h]?n[h]:g&&l?o(f,r):v&&w[h]==f?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e[u]=t[u],e}(f):y&&"function"==typeof f?o(Function.call,f):f,y&&((b.virtual||(b.virtual={}))[h]=f,t&c.R&&_&&!_[h]&&a(_,h,f)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},6718:function(t,e,n){var r=n("e53d"),i=n("584a"),o=n("b8e3"),a=n("ccb9"),s=n("d9f6").f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},6821:function(t,e,n){var r=n("626a"),i=n("be13");t.exports=function(t){return r(i(t))}},"69a8":function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},"6a99":function(t,e,n){var r=n("d3f4");t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},"6abf":function(t,e,n){var r=n("e6f3"),i=n("1691").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},"6b4c":function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},"6c7b":function(t,e,n){var r=n("5ca1");r(r.P,"Array",{fill:n("36bd")}),n("9c6c")("fill")},7726:function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},"77f1":function(t,e,n){var r=n("4588"),i=Math.max,o=Math.min;t.exports=function(t,e){return t=r(t),t<0?i(t+e,0):o(t,e)}},"794b":function(t,e,n){t.exports=!n("8e60")&&!n("294c")((function(){return 7!=Object.defineProperty(n("1ec9")("div"),"a",{get:function(){return 7}}).a}))},"79aa":function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},"79e5":function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},"7e90":function(t,e,n){var r=n("d9f6"),i=n("e4ae"),o=n("c3a1");t.exports=n("8e60")?Object.defineProperties:function(t,e){i(t);var n,a=o(e),s=a.length,u=0;while(s>u)r.f(t,n=a[u++],e[n]);return t}},8378:function(t,e){var n=t.exports={version:"2.6.5"};"number"==typeof __e&&(__e=n)},"85f2":function(t,e,n){t.exports=n("454f")},"86cc":function(t,e,n){var r=n("cb7c"),i=n("c69a"),o=n("6a99"),a=Object.defineProperty;e.f=n("9e1e")?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(s){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},"8aae":function(t,e,n){n("32a6"),t.exports=n("584a").Object.keys},"8b97":function(t,e,n){var r=n("d3f4"),i=n("cb7c"),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{r=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),r(t,[]),e=!(t instanceof Array)}catch(i){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},"8e60":function(t,e,n){t.exports=!n("294c")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},9003:function(t,e,n){var r=n("6b4c");t.exports=Array.isArray||function(t){return"Array"==r(t)}},9093:function(t,e,n){var r=n("ce10"),i=n("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},9138:function(t,e,n){t.exports=n("35e8")},"9aa9":function(t,e){e.f=Object.getOwnPropertySymbols},"9b43":function(t,e,n){var r=n("d8e8");t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},"9c6c":function(t,e,n){var r=n("2b4c")("unscopables"),i=Array.prototype;void 0==i[r]&&n("32e9")(i,r,{}),t.exports=function(t){i[r][t]=!0}},"9def":function(t,e,n){var r=n("4588"),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},"9e1e":function(t,e,n){t.exports=!n("79e5")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},a159:function(t,e,n){var r=n("e4ae"),i=n("7e90"),o=n("1691"),a=n("5559")("IE_PROTO"),s=function(){},u="prototype",c=function(){var t,e=n("1ec9")("iframe"),r=o.length,i="<",a=">";e.style.display="none",n("32fc").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(i+"script"+a+"document.F=Object"+i+"/script"+a),t.close(),c=t.F;while(r--)delete c[u][o[r]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(s[u]=r(t),n=new s,s[u]=null,n[a]=t):n=c(),void 0===e?n:i(n,e)}},a4bb:function(t,e,n){t.exports=n("8aae")},aa77:function(t,e,n){var r=n("5ca1"),i=n("be13"),o=n("79e5"),a=n("fdef"),s="["+a+"]",u="​",c=RegExp("^"+s+s+"*"),h=RegExp(s+s+"*$"),l=function(t,e,n){var i={},s=o((function(){return!!a[t]()||u[t]()!=u})),c=i[t]=s?e(f):a[t];n&&(i[n]=c),r(r.P+r.F*s,"String",i)},f=l.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(h,"")),t};t.exports=l},aebd:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},b447:function(t,e,n){var r=n("3a38"),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},b8e3:function(t,e){t.exports=!0},be13:function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},bf0b:function(t,e,n){var r=n("355d"),i=n("aebd"),o=n("36c3"),a=n("1bc3"),s=n("07e3"),u=n("794b"),c=Object.getOwnPropertyDescriptor;e.f=n("8e60")?c:function(t,e){if(t=o(t),e=a(e,!0),u)try{return c(t,e)}catch(n){}if(s(t,e))return i(!r.f.call(t,e),t[e])}},bf90:function(t,e,n){var r=n("36c3"),i=n("bf0b").f;n("ce7e")("getOwnPropertyDescriptor",(function(){return function(t,e){return i(r(t),e)}}))},c366:function(t,e,n){var r=n("6821"),i=n("9def"),o=n("77f1");t.exports=function(t){return function(e,n,a){var s,u=r(e),c=i(u.length),h=o(a,c);if(t&&n!=n){while(c>h)if(s=u[h++],s!=s)return!0}else for(;c>h;h++)if((t||h in u)&&u[h]===n)return t||h||0;return!t&&-1}}},c3a1:function(t,e,n){var r=n("e6f3"),i=n("1691");t.exports=Object.keys||function(t){return r(t,i)}},c5f6:function(t,e,n){"use strict";var r=n("7726"),i=n("69a8"),o=n("2d95"),a=n("5dbc"),s=n("6a99"),u=n("79e5"),c=n("9093").f,h=n("11e9").f,l=n("86cc").f,f=n("aa77").trim,p="Number",d=r[p],m=d,y=d.prototype,g=o(n("2aeb")(y))==p,v="trim"in String.prototype,b=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){e=v?e.trim():f(e,3);var n,r,i,o=e.charCodeAt(0);if(43===o||45===o){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+e}for(var a,u=e.slice(2),c=0,h=u.length;c<h;c++)if(a=u.charCodeAt(c),a<48||a>i)return NaN;return parseInt(u,r)}}return+e};if(!d(" 0o1")||!d("0b1")||d("+0x1")){d=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof d&&(g?u((function(){y.valueOf.call(n)})):o(n)!=p)?a(new m(b(e)),n,d):b(e)};for(var _,w=n("9e1e")?c(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),T=0;w.length>T;T++)i(m,_=w[T])&&!i(d,_)&&l(d,_,h(m,_));d.prototype=y,y.constructor=d,n("2aba")(r,p,d)}},c69a:function(t,e,n){t.exports=!n("9e1e")&&!n("79e5")((function(){return 7!=Object.defineProperty(n("230e")("div"),"a",{get:function(){return 7}}).a}))},ca5a:function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},cb7c:function(t,e,n){var r=n("d3f4");t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},ccb9:function(t,e,n){e.f=n("5168")},ce10:function(t,e,n){var r=n("69a8"),i=n("6821"),o=n("c366")(!1),a=n("613b")("IE_PROTO");t.exports=function(t,e){var n,s=i(t),u=0,c=[];for(n in s)n!=a&&r(s,n)&&c.push(n);while(e.length>u)r(s,n=e[u++])&&(~o(c,n)||c.push(n));return c}},ce7e:function(t,e,n){var r=n("63b6"),i=n("584a"),o=n("294c");t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],a={};a[t]=e(n),r(r.S+r.F*o((function(){n(1)})),"Object",a)}},d3f4:function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},d864:function(t,e,n){var r=n("79aa");t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},d8e8:function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},d9f6:function(t,e,n){var r=n("e4ae"),i=n("794b"),o=n("1bc3"),a=Object.defineProperty;e.f=n("8e60")?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(s){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},dbdb:function(t,e,n){var r=n("584a"),i=n("e53d"),o="__core-js_shared__",a=i[o]||(i[o]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n("b8e3")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},df45:function(t,e,n){"use strict";n.r(e);var r={value:function(){}};function i(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new o(r)}function o(t){this._=t}function a(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function s(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function u(t,e,n){for(var i=0,o=t.length;i<o;++i)if(t[i].name===e){t[i]=r,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}o.prototype=i.prototype={constructor:o,on:function(t,e){var n,r=this._,i=a(t+"",r),o=-1,c=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!==typeof e)throw new Error("invalid callback: "+e);while(++o<c)if(n=(t=i[o]).type)r[n]=u(r[n],t.name,e);else if(null==e)for(n in r)r[n]=u(r[n],t.name,null);return this}while(++o<c)if((n=(t=i[o]).type)&&(n=s(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new o(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=this._[t],o=0,n=r.length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var c=i;n.d(e,"dispatch",(function(){return c}))},e11e:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},e265:function(t,e,n){t.exports=n("ed33")},e4ae:function(t,e,n){var r=n("f772");t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},e53d:function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},e6f3:function(t,e,n){var r=n("07e3"),i=n("36c3"),o=n("5b4e")(!1),a=n("5559")("IE_PROTO");t.exports=function(t,e){var n,s=i(t),u=0,c=[];for(n in s)n!=a&&r(s,n)&&c.push(n);while(e.length>u)r(s,n=e[u++])&&(~o(c,n)||c.push(n));return c}},ebfd:function(t,e,n){var r=n("62a0")("meta"),i=n("f772"),o=n("07e3"),a=n("d9f6").f,s=0,u=Object.isExtensible||function(){return!0},c=!n("294c")((function(){return u(Object.preventExtensions({}))})),h=function(t){a(t,r,{value:{i:"O"+ ++s,w:{}}})},l=function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,r)){if(!u(t))return"F";if(!e)return"E";h(t)}return t[r].i},f=function(t,e){if(!o(t,r)){if(!u(t))return!0;if(!e)return!1;h(t)}return t[r].w},p=function(t){return c&&d.NEED&&u(t)&&!o(t,r)&&h(t),t},d=t.exports={KEY:r,NEED:!1,fastKey:l,getWeak:f,onFreeze:p}},ed33:function(t,e,n){n("014b"),t.exports=n("584a").Object.getOwnPropertySymbols},f6fd:function(t,e){(function(t){var e="currentScript",n=t.getElementsByTagName("script");e in t||Object.defineProperty(t,e,{get:function(){try{throw new Error}catch(r){var t,e=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(r.stack)||[!1])[1];for(t in n)if(n[t].src==e||"interactive"==n[t].readyState)return n[t];return null}}})})(document)},f772:function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},fa5b:function(t,e,n){t.exports=n("5537")("native-function-to-string",Function.toString)},fab2:function(t,e,n){var r=n("7726").document;t.exports=r&&r.documentElement},fb15:function(t,e,n){"use strict";var r;(n.r(e),"undefined"!==typeof window)&&(n("f6fd"),(r=window.document.currentScript)&&(r=r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/))&&(n.p=r[1]));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"wordCloud",staticClass:"wordCloud"})},o=[],a=(n("6c7b"),n("268f")),s=n.n(a),u=n("e265"),c=n.n(u),h=n("a4bb"),l=n.n(h),f=n("85f2"),p=n.n(f);function d(t,e,n){return e in t?p()(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=l()(n);"function"===typeof c.a&&(r=r.concat(c()(n).filter((function(t){return s()(n,t).enumerable})))),r.forEach((function(e){d(t,e,n[e])}))}return t}n("c5f6");var y=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},g=function(t){return 1===t.length&&(t=v(t)),{left:function(e,n,r,i){null==r&&(r=0),null==i&&(i=e.length);while(r<i){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){null==r&&(r=0),null==i&&(i=e.length);while(r<i){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}};function v(t){return function(e,n){return y(t(e),n)}}var b=g(y);b.right,b.left;var _=Array.prototype;_.slice,_.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var w=function(t){var e,n,r,i=t.length,o=-1,a=0;while(++o<i)a+=t[o].length;n=new Array(a);while(--i>=0){r=t[i],e=r.length;while(--e>=0)n[--a]=r[e]}return n};Array.prototype.slice;var T=n("df45"),E="http://www.w3.org/1999/xhtml",S={svg:"http://www.w3.org/2000/svg",xhtml:E,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},C=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),S.hasOwnProperty(e)?{space:S[e],local:t}:t};function I(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===E&&e.documentElement.namespaceURI===E?e.createElement(t):e.createElementNS(n,t)}}function A(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var N=function(t){var e=C(t);return(e.local?A:I)(e)};function k(){}var D=function(t){return null==t?k:function(){return this.querySelector(t)}},x=function(t){"function"!==typeof t&&(t=D(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=e[i],u=s.length,c=r[i]=new Array(u),h=0;h<u;++h)(o=s[h])&&(a=t.call(o,o.__data__,h,s))&&("__data__"in o&&(a.__data__=o.__data__),c[h]=a);return new fe(r,this._parents)};function O(){return[]}var R=function(t){return null==t?O:function(){return this.querySelectorAll(t)}},M=function(t){"function"!==typeof t&&(t=R(t));for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,s=e[o],u=s.length,c=0;c<u;++c)(a=s[c])&&(r.push(t.call(a,a.__data__,c,s)),i.push(a));return new fe(r,i)},P=function(t){return function(){return this.matches(t)}};if("undefined"!==typeof document){var L=document.documentElement;if(!L.matches){var F=L.webkitMatchesSelector||L.msMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector;P=function(t){return function(){return F.call(this,t)}}}}var U=P,q=function(t){"function"!==typeof t&&(t=U(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,u=r[i]=[],c=0;c<s;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&u.push(o);return new fe(r,this._parents)},V=function(t){return new Array(t.length)},B=function(){return new fe(this._enter||this._groups.map(V),this._parents)};function j(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}j.prototype={constructor:j,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var W=function(t){return function(){return t}},K="$";function z(t,e,n,r,i,o){for(var a,s=0,u=e.length,c=o.length;s<c;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new j(t,o[s]);for(;s<u;++s)(a=e[s])&&(i[s]=a)}function G(t,e,n,r,i,o,a){var s,u,c,h={},l=e.length,f=o.length,p=new Array(l);for(s=0;s<l;++s)(u=e[s])&&(p[s]=c=K+a.call(u,u.__data__,s,e),c in h?i[s]=u:h[c]=u);for(s=0;s<f;++s)c=K+a.call(t,o[s],s,o),(u=h[c])?(r[s]=u,u.__data__=o[s],h[c]=null):n[s]=new j(t,o[s]);for(s=0;s<l;++s)(u=e[s])&&h[p[s]]===u&&(i[s]=u)}var Q=function(t,e){if(!t)return p=new Array(this.size()),c=-1,this.each((function(t){p[++c]=t})),p;var n=e?G:z,r=this._parents,i=this._groups;"function"!==typeof t&&(t=W(t));for(var o=i.length,a=new Array(o),s=new Array(o),u=new Array(o),c=0;c<o;++c){var h=r[c],l=i[c],f=l.length,p=t.call(h,h&&h.__data__,c,r),d=p.length,m=s[c]=new Array(d),y=a[c]=new Array(d),g=u[c]=new Array(f);n(h,l,m,y,g,p,e);for(var v,b,_=0,w=0;_<d;++_)if(v=m[_]){_>=w&&(w=_+1);while(!(b=y[w])&&++w<d);v._next=b||null}}return a=new fe(a,r),a._enter=s,a._exit=u,a},H=function(){return new fe(this._exit||this._groups.map(V),this._parents)},Y=function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var u,c=e[s],h=n[s],l=c.length,f=a[s]=new Array(l),p=0;p<l;++p)(u=c[p]||h[p])&&(f[p]=u);for(;s<r;++s)a[s]=e[s];return new fe(a,this._parents)},$=function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&a!==r.nextSibling&&a.parentNode.insertBefore(r,a),a=r);return this},X=function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=J);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],u=s.length,c=i[o]=new Array(u),h=0;h<u;++h)(a=s[h])&&(c[h]=a);c.sort(e)}return new fe(i,this._parents).order()};function J(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var Z=function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},tt=function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},et=function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},nt=function(){var t=0;return this.each((function(){++t})),t},rt=function(){return!this.node()},it=function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this};function ot(t){return function(){this.removeAttribute(t)}}function at(t){return function(){this.removeAttributeNS(t.space,t.local)}}function st(t,e){return function(){this.setAttribute(t,e)}}function ut(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ct(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function ht(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var lt=function(t,e){var n=C(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?at:ot:"function"===typeof e?n.local?ht:ct:n.local?ut:st)(n,e))},ft=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function pt(t){return function(){this.style.removeProperty(t)}}function dt(t,e,n){return function(){this.style.setProperty(t,e,n)}}function mt(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}var yt=function(t,e,n){return arguments.length>1?this.each((null==e?pt:"function"===typeof e?mt:dt)(t,e,null==n?"":n)):gt(this.node(),t)};function gt(t,e){return t.style.getPropertyValue(e)||ft(t).getComputedStyle(t,null).getPropertyValue(e)}function vt(t){return function(){delete this[t]}}function bt(t,e){return function(){this[t]=e}}function _t(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}var wt=function(t,e){return arguments.length>1?this.each((null==e?vt:"function"===typeof e?_t:bt)(t,e)):this.node()[t]};function Tt(t){return t.trim().split(/^|\s+/)}function Et(t){return t.classList||new St(t)}function St(t){this._node=t,this._names=Tt(t.getAttribute("class")||"")}function Ct(t,e){var n=Et(t),r=-1,i=e.length;while(++r<i)n.add(e[r])}function It(t,e){var n=Et(t),r=-1,i=e.length;while(++r<i)n.remove(e[r])}function At(t){return function(){Ct(this,t)}}function Nt(t){return function(){It(this,t)}}function kt(t,e){return function(){(e.apply(this,arguments)?Ct:It)(this,t)}}St.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Dt=function(t,e){var n=Tt(t+"");if(arguments.length<2){var r=Et(this.node()),i=-1,o=n.length;while(++i<o)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"===typeof e?kt:e?At:Nt)(n,e))};function xt(){this.textContent=""}function Ot(t){return function(){this.textContent=t}}function Rt(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}var Mt=function(t){return arguments.length?this.each(null==t?xt:("function"===typeof t?Rt:Ot)(t)):this.node().textContent};function Pt(){this.innerHTML=""}function Lt(t){return function(){this.innerHTML=t}}function Ft(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}var Ut=function(t){return arguments.length?this.each(null==t?Pt:("function"===typeof t?Ft:Lt)(t)):this.node().innerHTML};function qt(){this.nextSibling&&this.parentNode.appendChild(this)}var Vt=function(){return this.each(qt)};function Bt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}var jt=function(){return this.each(Bt)},Wt=function(t){var e="function"===typeof t?t:N(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))};function Kt(){return null}var zt=function(t,e){var n="function"===typeof t?t:N(t),r=null==e?Kt:"function"===typeof e?e:D(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))};function Gt(){var t=this.parentNode;t&&t.removeChild(this)}var Qt=function(){return this.each(Gt)};function Ht(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function Yt(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}var $t=function(t){return this.select(t?Yt:Ht)},Xt=function(t){return arguments.length?this.property("__data__",t):this.node().__data__},Jt={},Zt=null;if("undefined"!==typeof document){var te=document.documentElement;"onmouseenter"in te||(Jt={mouseenter:"mouseover",mouseleave:"mouseout"})}function ee(t,e,n){return t=ne(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function ne(t,e,n){return function(r){var i=Zt;Zt=r;try{t.call(this,this.__data__,e,n)}finally{Zt=i}}}function re(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function ie(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function oe(t,e,n){var r=Jt.hasOwnProperty(t.type)?ee:ne;return function(i,o,a){var s,u=this.__on,c=r(e,o,a);if(u)for(var h=0,l=u.length;h<l;++h)if((s=u[h]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=c,s.capture=n),void(s.value=e);this.addEventListener(t.type,c,n),s={type:t.type,name:t.name,value:e,listener:c,capture:n},u?u.push(s):this.__on=[s]}}var ae=function(t,e,n){var r,i,o=re(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?oe:ie,null==n&&(n=!1),r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var u,c=0,h=s.length;c<h;++c)for(r=0,u=s[c];r<a;++r)if((i=o[r]).type===u.type&&i.name===u.name)return u.value};function se(t,e,n){var r=ft(t),i=r.CustomEvent;"function"===typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ue(t,e){return function(){return se(this,t,e)}}function ce(t,e){return function(){return se(this,t,e.apply(this,arguments))}}var he=function(t,e){return this.each(("function"===typeof e?ce:ue)(t,e))},le=[null];function fe(t,e){this._groups=t,this._parents=e}function pe(){return new fe([[document.documentElement]],le)}fe.prototype=pe.prototype={constructor:fe,select:x,selectAll:M,filter:q,data:Q,enter:B,exit:H,merge:Y,order:$,sort:X,call:Z,nodes:tt,node:et,size:nt,empty:rt,each:it,attr:lt,style:yt,property:wt,classed:Dt,text:Mt,html:Ut,raise:Vt,lower:jt,append:Wt,insert:zt,remove:Qt,clone:$t,datum:Xt,on:ae,dispatch:he};var de=pe,me=function(t){return"string"===typeof t?new fe([[document.querySelector(t)]],[document.documentElement]):new fe([[t]],le)},ye=0;function ge(){return new ve}function ve(){this._="@"+(++ye).toString(36)}ve.prototype=ge.prototype={constructor:ve,get:function(t){var e=this._;while(!(e in t))if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};function be(t,e,n,r,i,o,a,s,u,c){this.target=t,this.type=e,this.subject=n,this.identifier=r,this.active=i,this.x=o,this.y=a,this.dx=s,this.dy=u,this._=c}be.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var _e=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function we(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Te(){}var Ee=.7,Se=1/Ee,Ce="\\s*([+-]?\\d+)\\s*",Ie="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ae="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ne=/^#([0-9a-f]{3})$/,ke=/^#([0-9a-f]{6})$/,De=new RegExp("^rgb\\("+[Ce,Ce,Ce]+"\\)$"),xe=new RegExp("^rgb\\("+[Ae,Ae,Ae]+"\\)$"),Oe=new RegExp("^rgba\\("+[Ce,Ce,Ce,Ie]+"\\)$"),Re=new RegExp("^rgba\\("+[Ae,Ae,Ae,Ie]+"\\)$"),Me=new RegExp("^hsl\\("+[Ie,Ae,Ae]+"\\)$"),Pe=new RegExp("^hsla\\("+[Ie,Ae,Ae,Ie]+"\\)$"),Le={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Fe(t){var e;return t=(t+"").trim().toLowerCase(),(e=Ne.exec(t))?(e=parseInt(e[1],16),new je(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1)):(e=ke.exec(t))?Ue(parseInt(e[1],16)):(e=De.exec(t))?new je(e[1],e[2],e[3],1):(e=xe.exec(t))?new je(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Oe.exec(t))?qe(e[1],e[2],e[3],e[4]):(e=Re.exec(t))?qe(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Me.exec(t))?Ke(e[1],e[2]/100,e[3]/100,1):(e=Pe.exec(t))?Ke(e[1],e[2]/100,e[3]/100,e[4]):Le.hasOwnProperty(t)?Ue(Le[t]):"transparent"===t?new je(NaN,NaN,NaN,0):null}function Ue(t){return new je(t>>16&255,t>>8&255,255&t,1)}function qe(t,e,n,r){return r<=0&&(t=e=n=NaN),new je(t,e,n,r)}function Ve(t){return t instanceof Te||(t=Fe(t)),t?(t=t.rgb(),new je(t.r,t.g,t.b,t.opacity)):new je}function Be(t,e,n,r){return 1===arguments.length?Ve(t):new je(t,e,n,null==r?1:r)}function je(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function We(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function Ke(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Qe(t,e,n,r)}function ze(t){if(t instanceof Qe)return new Qe(t.h,t.s,t.l,t.opacity);if(t instanceof Te||(t=Fe(t)),!t)return new Qe;if(t instanceof Qe)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Qe(a,s,u,t.opacity)}function Ge(t,e,n,r){return 1===arguments.length?ze(t):new Qe(t,e,n,null==r?1:r)}function Qe(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function He(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}_e(Te,Fe,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),_e(je,Be,we(Te,{brighter:function(t){return t=null==t?Se:Math.pow(Se,t),new je(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Ee:Math.pow(Ee,t),new je(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+We(this.r)+We(this.g)+We(this.b)},toString:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),_e(Qe,Ge,we(Te,{brighter:function(t){return t=null==t?Se:Math.pow(Se,t),new Qe(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Ee:Math.pow(Ee,t),new Qe(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new je(He(t>=240?t-240:t+120,i,r),He(t,i,r),He(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Ye=Math.PI/180,$e=180/Math.PI,Xe=18,Je=.96422,Ze=1,tn=.82521,en=4/29,nn=6/29,rn=3*nn*nn,on=nn*nn*nn;function an(t){if(t instanceof un)return new un(t.l,t.a,t.b,t.opacity);if(t instanceof mn){if(isNaN(t.h))return new un(t.l,0,0,t.opacity);var e=t.h*Ye;return new un(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof je||(t=Ve(t));var n,r,i=fn(t.r),o=fn(t.g),a=fn(t.b),s=cn((.2225045*i+.7168786*o+.0606169*a)/Ze);return i===o&&o===a?n=r=s:(n=cn((.4360747*i+.3850649*o+.1430804*a)/Je),r=cn((.0139322*i+.0971045*o+.7141733*a)/tn)),new un(116*s-16,500*(n-s),200*(s-r),t.opacity)}function sn(t,e,n,r){return 1===arguments.length?an(t):new un(t,e,n,null==r?1:r)}function un(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function cn(t){return t>on?Math.pow(t,1/3):t/rn+en}function hn(t){return t>nn?t*t*t:rn*(t-en)}function ln(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function fn(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function pn(t){if(t instanceof mn)return new mn(t.h,t.c,t.l,t.opacity);if(t instanceof un||(t=an(t)),0===t.a&&0===t.b)return new mn(NaN,0,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*$e;return new mn(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function dn(t,e,n,r){return 1===arguments.length?pn(t):new mn(t,e,n,null==r?1:r)}function mn(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}_e(un,sn,we(Te,{brighter:function(t){return new un(this.l+Xe*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new un(this.l-Xe*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=Je*hn(e),t=Ze*hn(t),n=tn*hn(n),new je(ln(3.1338561*e-1.6168667*t-.4906146*n),ln(-.9787684*e+1.9161415*t+.033454*n),ln(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),_e(mn,dn,we(Te,{brighter:function(t){return new mn(this.h,this.c,this.l+Xe*(null==t?1:t),this.opacity)},darker:function(t){return new mn(this.h,this.c,this.l-Xe*(null==t?1:t),this.opacity)},rgb:function(){return an(this).rgb()}}));var yn=-.14861,gn=1.78277,vn=-.29227,bn=-.90649,_n=1.97294,wn=_n*bn,Tn=_n*gn,En=gn*vn-bn*yn;function Sn(t){if(t instanceof In)return new In(t.h,t.s,t.l,t.opacity);t instanceof je||(t=Ve(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(En*r+wn*e-Tn*n)/(En+wn-Tn),o=r-i,a=(_n*(n-i)-vn*o)/bn,s=Math.sqrt(a*a+o*o)/(_n*i*(1-i)),u=s?Math.atan2(a,o)*$e-120:NaN;return new In(u<0?u+360:u,s,i,t.opacity)}function Cn(t,e,n,r){return 1===arguments.length?Sn(t):new In(t,e,n,null==r?1:r)}function In(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function An(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}_e(In,Cn,we(Te,{brighter:function(t){return t=null==t?Se:Math.pow(Se,t),new In(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Ee:Math.pow(Ee,t),new In(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Ye,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new je(255*(e+n*(yn*r+gn*i)),255*(e+n*(vn*r+bn*i)),255*(e+n*(_n*r)),this.opacity)}}));var Nn=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return An((n-r/e)*e,a,i,o,s)}},kn=function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return An((n-r/e)*e,i,o,a,s)}},Dn=function(t){return function(){return t}};function xn(t,e){return function(n){return t+n*e}}function On(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Rn(t,e){var n=e-t;return n?xn(t,n>180||n<-180?n-360*Math.round(n/360):n):Dn(isNaN(t)?e:t)}function Mn(t){return 1===(t=+t)?Pn:function(e,n){return n-e?On(e,n,t):Dn(isNaN(e)?n:e)}}function Pn(t,e){var n=e-t;return n?xn(t,n):Dn(isNaN(t)?e:t)}var Ln=function t(e){var n=Mn(e);function r(t,e){var r=n((t=Be(t)).r,(e=Be(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=Pn(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function Fn(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Be(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}var Un=Fn(Nn),qn=(Fn(kn),function(t,e){return t=+t,e-=t,function(n){return t+e*n}}),Vn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Bn=new RegExp(Vn.source,"g");function jn(t){return function(){return t}}function Wn(t){return function(e){return t(e)+""}}var Kn,zn,Gn,Qn,Hn=function(t,e){var n,r,i,o=Vn.lastIndex=Bn.lastIndex=0,a=-1,s=[],u=[];t+="",e+="";while((n=Vn.exec(t))&&(r=Bn.exec(e)))(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:qn(n,r)})),o=Bn.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?Wn(u[0].x):jn(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})},Yn=180/Math.PI,$n={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Xn=function(t,e,n,r,i,o){var a,s,u;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Yn,skewX:Math.atan(u)*Yn,scaleX:a,scaleY:s}};function Jn(t){return"none"===t?$n:(Kn||(Kn=document.createElement("DIV"),zn=document.documentElement,Gn=document.defaultView),Kn.style.transform=t,t=Gn.getComputedStyle(zn.appendChild(Kn),null).getPropertyValue("transform"),zn.removeChild(Kn),t=t.slice(7,-1).split(","),Xn(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function Zn(t){return null==t?$n:(Qn||(Qn=document.createElementNS("http://www.w3.org/2000/svg","g")),Qn.setAttribute("transform",t),(t=Qn.transform.baseVal.consolidate())?(t=t.matrix,Xn(t.a,t.b,t.c,t.d,t.e,t.f)):$n)}function tr(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}function o(t,r,i,o,a,s){if(t!==i||r!==o){var u=a.push("translate(",null,e,null,n);s.push({i:u-4,x:qn(t,i)},{i:u-2,x:qn(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}function a(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:qn(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}function s(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:qn(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}function u(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:qn(t,n)},{i:s-2,x:qn(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}return function(e,n){var r=[],i=[];return e=t(e),n=t(n),o(e.translateX,e.translateY,n.translateX,n.translateY,r,i),a(e.rotate,n.rotate,r,i),s(e.skewX,n.skewX,r,i),u(e.scaleX,e.scaleY,n.scaleX,n.scaleY,r,i),e=n=null,function(t){var e,n=-1,o=i.length;while(++n<o)r[(e=i[n]).i]=e.x(t);return r.join("")}}}var er=tr(Jn,"px, ","px)","deg)"),nr=tr(Zn,", ",")",")");Math.SQRT2;function rr(t){return function(e,n){var r=t((e=Ge(e)).h,(n=Ge(n)).h),i=Pn(e.s,n.s),o=Pn(e.l,n.l),a=Pn(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=o(t),e.opacity=a(t),e+""}}}rr(Rn),rr(Pn);function ir(t){return function(e,n){var r=t((e=dn(e)).h,(n=dn(n)).h),i=Pn(e.c,n.c),o=Pn(e.l,n.l),a=Pn(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=o(t),e.opacity=a(t),e+""}}}ir(Rn),ir(Pn);function or(t){return function e(n){function r(e,r){var i=t((e=Cn(e)).h,(r=Cn(r)).h),o=Pn(e.s,r.s),a=Pn(e.l,r.l),s=Pn(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=a(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}or(Rn);var ar=or(Pn);var sr,ur,cr=0,hr=0,lr=0,fr=1e3,pr=0,dr=0,mr=0,yr="object"===typeof performance&&performance.now?performance:Date,gr="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function vr(){return dr||(gr(br),dr=yr.now()+mr)}function br(){dr=0}function _r(){this._call=this._time=this._next=null}function wr(t,e,n){var r=new _r;return r.restart(t,e,n),r}function Tr(){vr(),++cr;var t,e=sr;while(e)(t=dr-e._time)>=0&&e._call.call(null,t),e=e._next;--cr}function Er(){dr=(pr=yr.now())+mr,cr=hr=0;try{Tr()}finally{cr=0,Cr(),dr=0}}function Sr(){var t=yr.now(),e=t-pr;e>fr&&(mr-=e,pr=t)}function Cr(){var t,e,n=sr,r=1/0;while(n)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:sr=e);ur=t,Ir(r)}function Ir(t){if(!cr){hr&&(hr=clearTimeout(hr));var e=t-dr;e>24?(t<1/0&&(hr=setTimeout(Er,t-yr.now()-mr)),lr&&(lr=clearInterval(lr))):(lr||(pr=yr.now(),lr=setInterval(Sr,fr)),cr=1,gr(Er))}}_r.prototype=wr.prototype={constructor:_r,restart:function(t,e,n){if("function"!==typeof t)throw new TypeError("callback is not a function");n=(null==n?vr():+n)+(null==e?0:+e),this._next||ur===this||(ur?ur._next=this:sr=this,ur=this),this._call=t,this._time=n,Ir()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ir())}};var Ar=function(t,e,n){var r=new _r;return e=null==e?0:+e,r.restart((function(n){r.stop(),t(n+e)}),e,n),r},Nr=Object(T["dispatch"])("start","end","interrupt"),kr=[],Dr=0,xr=1,Or=2,Rr=3,Mr=4,Pr=5,Lr=6,Fr=function(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};Br(t,n,{name:e,index:r,group:i,on:Nr,tween:kr,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Dr})};function Ur(t,e){var n=Vr(t,e);if(n.state>Dr)throw new Error("too late; already scheduled");return n}function qr(t,e){var n=Vr(t,e);if(n.state>Or)throw new Error("too late; already started");return n}function Vr(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Br(t,e,n){var r,i=t.__transition;function o(t){n.state=xr,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}function a(o){var c,h,l,f;if(n.state!==xr)return u();for(c in i)if(f=i[c],f.name===n.name){if(f.state===Rr)return Ar(a);f.state===Mr?(f.state=Lr,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete i[c]):+c<e&&(f.state=Lr,f.timer.stop(),delete i[c])}if(Ar((function(){n.state===Rr&&(n.state=Mr,n.timer.restart(s,n.delay,n.time),s(o))})),n.state=Or,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Or){for(n.state=Rr,r=new Array(l=n.tween.length),c=0,h=-1;c<l;++c)(f=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++h]=f);r.length=h+1}}function s(e){var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(u),n.state=Pr,1),o=-1,a=r.length;while(++o<a)r[o].call(null,i);n.state===Pr&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){for(var r in n.state=Lr,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=wr(o,0,n.time)}var jr=function(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>Or&&n.state<Pr,n.state=Lr,n.timer.stop(),r&&n.on.call("interrupt",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}},Wr=function(t){return this.each((function(){jr(this,t)}))};function Kr(t,e){var n,r;return function(){var i=qr(this,t),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===e){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function zr(t,e,n){var r,i;if("function"!==typeof n)throw new Error;return function(){var o=qr(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},u=0,c=i.length;u<c;++u)if(i[u].name===e){i[u]=s;break}u===c&&i.push(s)}o.tween=i}}var Gr=function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=Vr(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?Kr:zr)(n,t,e))};function Qr(t,e,n){var r=t._id;return t.each((function(){var t=qr(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Vr(t,r).value[e]}}var Hr=function(t,e){var n;return("number"===typeof e?qn:e instanceof Fe?Ln:(n=Fe(e))?(e=n,Ln):Hn)(t,e)};function Yr(t){return function(){this.removeAttribute(t)}}function $r(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Xr(t,e,n){var r,i;return function(){var o=this.getAttribute(t);return o===n?null:o===r?i:i=e(r=o,n)}}function Jr(t,e,n){var r,i;return function(){var o=this.getAttributeNS(t.space,t.local);return o===n?null:o===r?i:i=e(r=o,n)}}function Zr(t,e,n){var r,i,o;return function(){var a,s=n(this);if(null!=s)return a=this.getAttribute(t),a===s?null:a===r&&s===i?o:o=e(r=a,i=s);this.removeAttribute(t)}}function ti(t,e,n){var r,i,o;return function(){var a,s=n(this);if(null!=s)return a=this.getAttributeNS(t.space,t.local),a===s?null:a===r&&s===i?o:o=e(r=a,i=s);this.removeAttributeNS(t.space,t.local)}}var ei=function(t,e){var n=C(t),r="transform"===n?nr:Hr;return this.attrTween(t,"function"===typeof e?(n.local?ti:Zr)(n,r,Qr(this,"attr."+t,e)):null==e?(n.local?$r:Yr)(n):(n.local?Jr:Xr)(n,r,e+""))};function ni(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttributeNS(t.space,t.local,r(e))}}return n._value=e,n}function ri(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttribute(t,r(e))}}return n._value=e,n}var ii=function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!==typeof e)throw new Error;var r=C(t);return this.tween(n,(r.local?ni:ri)(r,e))};function oi(t,e){return function(){Ur(this,t).delay=+e.apply(this,arguments)}}function ai(t,e){return e=+e,function(){Ur(this,t).delay=e}}var si=function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?oi:ai)(e,t)):Vr(this.node(),e).delay};function ui(t,e){return function(){qr(this,t).duration=+e.apply(this,arguments)}}function ci(t,e){return e=+e,function(){qr(this,t).duration=e}}var hi=function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?ui:ci)(e,t)):Vr(this.node(),e).duration};function li(t,e){if("function"!==typeof e)throw new Error;return function(){qr(this,t).ease=e}}var fi=function(t){var e=this._id;return arguments.length?this.each(li(e,t)):Vr(this.node(),e).ease},pi=function(t){"function"!==typeof t&&(t=U(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,u=r[i]=[],c=0;c<s;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&u.push(o);return new Li(r,this._parents,this._name,this._id)},di=function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var u,c=e[s],h=n[s],l=c.length,f=a[s]=new Array(l),p=0;p<l;++p)(u=c[p]||h[p])&&(f[p]=u);for(;s<r;++s)a[s]=e[s];return new Li(a,this._parents,this._name,this._id)};function mi(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}function yi(t,e,n){var r,i,o=mi(e)?Ur:qr;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}var gi=function(t,e){var n=this._id;return arguments.length<2?Vr(this.node(),n).on.on(t):this.each(yi(n,t,e))};function vi(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}var bi=function(){return this.on("end.remove",vi(this._id))},_i=function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=D(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,u,c=r[a],h=c.length,l=o[a]=new Array(h),f=0;f<h;++f)(s=c[f])&&(u=t.call(s,s.__data__,f,c))&&("__data__"in s&&(u.__data__=s.__data__),l[f]=u,Fr(l[f],e,n,f,l,Vr(s,n)));return new Li(o,this._parents,e,n)},wi=function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=R(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var u,c=r[s],h=c.length,l=0;l<h;++l)if(u=c[l]){for(var f,p=t.call(u,u.__data__,l,c),d=Vr(u,n),m=0,y=p.length;m<y;++m)(f=p[m])&&Fr(f,e,n,m,p,d);o.push(p),a.push(u)}return new Li(o,a,e,n)},Ti=de.prototype.constructor,Ei=function(){return new Ti(this._groups,this._parents)};function Si(t,e){var n,r,i;return function(){var o=gt(this,t),a=(this.style.removeProperty(t),gt(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}function Ci(t){return function(){this.style.removeProperty(t)}}function Ii(t,e,n){var r,i;return function(){var o=gt(this,t);return o===n?null:o===r?i:i=e(r=o,n)}}function Ai(t,e,n){var r,i,o;return function(){var a=gt(this,t),s=n(this);return null==s&&(this.style.removeProperty(t),s=gt(this,t)),a===s?null:a===r&&s===i?o:o=e(r=a,i=s)}}var Ni=function(t,e,n){var r="transform"===(t+="")?er:Hr;return null==e?this.styleTween(t,Si(t,r)).on("end.style."+t,Ci(t)):this.styleTween(t,"function"===typeof e?Ai(t,r,Qr(this,"style."+t,e)):Ii(t,r,e+""),n)};function ki(t,e,n){function r(){var r=this,i=e.apply(r,arguments);return i&&function(e){r.style.setProperty(t,i(e),n)}}return r._value=e,r}var Di=function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!==typeof e)throw new Error;return this.tween(r,ki(t,e,null==n?"":n))};function xi(t){return function(){this.textContent=t}}function Oi(t){return function(){var e=t(this);this.textContent=null==e?"":e}}var Ri=function(t){return this.tween("text","function"===typeof t?Oi(Qr(this,"text",t)):xi(null==t?"":t+""))},Mi=function(){for(var t=this._name,e=this._id,n=Ui(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],u=s.length,c=0;c<u;++c)if(a=s[c]){var h=Vr(a,e);Fr(a,t,n,c,s,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Li(r,this._parents,t,n)},Pi=0;function Li(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Fi(t){return de().transition(t)}function Ui(){return++Pi}var qi=de.prototype;function Vi(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Li.prototype=Fi.prototype={constructor:Li,select:_i,selectAll:wi,filter:pi,merge:di,selection:Ei,transition:Mi,call:qi.call,nodes:qi.nodes,node:qi.node,size:qi.size,empty:qi.empty,each:qi.each,on:gi,attr:ei,attrTween:ii,style:Ni,styleTween:Di,text:Ri,remove:bi,tween:Gr,delay:si,duration:hi,ease:fi};var Bi=3;(function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n})(Bi),function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(Bi),function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(Bi),Math.PI;var ji=1.70158,Wi=(function t(e){function n(t){return t*t*((e+1)*t-e)}return e=+e,n.overshoot=t,n}(ji),function t(e){function n(t){return--t*t*((e+1)*t+e)+1}return e=+e,n.overshoot=t,n}(ji),function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(ji),2*Math.PI),Ki=1,zi=.3,Gi=(function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Wi);function i(t){return e*Math.pow(2,10*--t)*Math.sin((r-t)/n)}return i.amplitude=function(e){return t(e,n*Wi)},i.period=function(n){return t(e,n)},i}(Ki,zi),function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Wi);function i(t){return 1-e*Math.pow(2,-10*(t=+t))*Math.sin((t+r)/n)}return i.amplitude=function(e){return t(e,n*Wi)},i.period=function(n){return t(e,n)},i}(Ki,zi),function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Wi);function i(t){return((t=2*t-1)<0?e*Math.pow(2,10*t)*Math.sin((r-t)/n):2-e*Math.pow(2,-10*t)*Math.sin((r+t)/n))/2}return i.amplitude=function(e){return t(e,n*Wi)},i.period=function(n){return t(e,n)},i}(Ki,zi),{time:null,delay:0,duration:250,ease:Vi});function Qi(t,e){var n;while(!(n=t.__transition)||!(n=n[e]))if(!(t=t.parentNode))return Gi.time=vr(),Gi;return n}var Hi=function(t){var e,n;t instanceof Li?(e=t._id,t=t._name):(e=Ui(),(n=Gi).time=vr(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],u=s.length,c=0;c<u;++c)(a=s[c])&&Fr(a,t,e,c,s,n||Qi(a,e));return new Li(r,this._parents,t,e)};de.prototype.interrupt=Wr,de.prototype.transition=Hi;["e","w"].map(Yi),["n","s"].map(Yi),["n","e","s","w","nw","ne","se","sw"].map(Yi);function Yi(t){return{type:t}}Math.cos,Math.sin,Math.PI,Math.max;Array.prototype.slice;var $i=Math.PI,Xi=2*$i,Ji=1e-6,Zi=Xi-Ji;function to(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function eo(){return new to}to.prototype=eo.prototype={constructor:to,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,s=n-t,u=r-e,c=o-t,h=a-e,l=c*c+h*h;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(l>Ji)if(Math.abs(h*s-u*c)>Ji&&i){var f=n-o,p=r-a,d=s*s+u*u,m=f*f+p*p,y=Math.sqrt(d),g=Math.sqrt(l),v=i*Math.tan(($i-Math.acos((d+l-m)/(2*y*g)))/2),b=v/g,_=v/y;Math.abs(b-1)>Ji&&(this._+="L"+(t+b*c)+","+(e+b*h)),this._+="A"+i+","+i+",0,0,"+ +(h*f>c*p)+","+(this._x1=t+_*s)+","+(this._y1=e+_*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,o){t=+t,e=+e,n=+n;var a=n*Math.cos(r),s=n*Math.sin(r),u=t+a,c=e+s,h=1^o,l=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+c:(Math.abs(this._x1-u)>Ji||Math.abs(this._y1-c)>Ji)&&(this._+="L"+u+","+c),n&&(l<0&&(l=l%Xi+Xi),l>Zi?this._+="A"+n+","+n+",0,1,"+h+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+h+","+(this._x1=u)+","+(this._y1=c):l>Ji&&(this._+="A"+n+","+n+",0,"+ +(l>=$i)+","+h+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var no="$";function ro(){}function io(t,e){var n=new ro;if(t instanceof ro)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)while(++i<o)n.set(i,t[i]);else while(++i<o)n.set(e(r=t[i],i,t),r)}else if(t)for(var a in t)n.set(a,t[a]);return n}ro.prototype=io.prototype={constructor:ro,has:function(t){return no+t in this},get:function(t){return this[no+t]},set:function(t,e){return this[no+t]=e,this},remove:function(t){var e=no+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===no&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===no&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===no&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===no&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===no&&++t;return t},empty:function(){for(var t in this)if(t[0]===no)return!1;return!0},each:function(t){for(var e in this)e[0]===no&&t(this[e],e.slice(1),this)}};var oo=io;function ao(){}var so=oo.prototype;function uo(t,e){var n=new ao;if(t instanceof ao)t.each((function(t){n.add(t)}));else if(t){var r=-1,i=t.length;if(null==e)while(++r<i)n.add(t[r]);else while(++r<i)n.add(e(t[r],r,t))}return n}ao.prototype=uo.prototype={constructor:ao,has:so.has,add:function(t){return t+="",this[no+t]=t,this},remove:so.remove,clear:so.clear,values:so.keys,size:so.size,empty:so.empty,each:so.each};var co=Array.prototype;co.slice;var ho={},lo={},fo=34,po=10,mo=13;function yo(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+"]"})).join(",")+"}")}function go(t,e){var n=yo(t);return function(r,i){return e(n(r),i,t)}}function vo(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}var bo=function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var n,r,o=i(t,(function(t,i){if(n)return n(t,i-1);r=t,n=e?go(t,e):yo(t)}));return o.columns=r||[],o}function i(t,e){var r,i=[],o=t.length,a=0,s=0,u=o<=0,c=!1;function h(){if(u)return lo;if(c)return c=!1,ho;var e,r,i=a;if(t.charCodeAt(i)===fo){while(a++<o&&t.charCodeAt(a)!==fo||t.charCodeAt(++a)===fo);return(e=a)>=o?u=!0:(r=t.charCodeAt(a++))===po?c=!0:r===mo&&(c=!0,t.charCodeAt(a)===po&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}while(a<o){if((r=t.charCodeAt(e=a++))===po)c=!0;else if(r===mo)c=!0,t.charCodeAt(a)===po&&++a;else if(r!==n)continue;return t.slice(i,e)}return u=!0,t.slice(i,o)}t.charCodeAt(o-1)===po&&--o,t.charCodeAt(o-1)===mo&&--o;while((r=h())!==lo){var l=[];while(r!==ho&&r!==lo)l.push(r),r=h();e&&null==(l=e(l,s++))||i.push(l)}return i}function o(e,n){return null==n&&(n=vo(e)),[n.map(u).join(t)].concat(e.map((function(e){return n.map((function(t){return u(e[t])})).join(t)}))).join("\n")}function a(t){return t.map(s).join("\n")}function s(e){return e.map(u).join(t)}function u(t){return null==t?"":e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:r,parseRows:i,format:o,formatRows:a}},_o=bo(","),wo=_o.parse,To=(_o.parseRows,_o.format,_o.formatRows,bo("\t")),Eo=To.parse;To.parseRows,To.format,To.formatRows;function So(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}var Co=function(t,e){return fetch(t,e).then(So)};function Io(t){return function(e,n,r){return 2===arguments.length&&"function"===typeof n&&(r=n,n=void 0),Co(e,n).then((function(e){return t(e,r)}))}}Io(wo),Io(Eo);function Ao(t){return function(e,n){return Co(e,n).then((function(e){return(new DOMParser).parseFromString(e,t)}))}}Ao("application/xml"),Ao("text/html"),Ao("image/svg+xml");var No=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return ko(this.cover(e,n),e,n,t)};function ko(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,s,u,c,h,l,f,p=t._root,d={data:r},m=t._x0,y=t._y0,g=t._x1,v=t._y1;if(!p)return t._root=d,t;while(p.length)if((c=e>=(o=(m+g)/2))?m=o:g=o,(h=n>=(a=(y+v)/2))?y=a:v=a,i=p,!(p=p[l=h<<1|c]))return i[l]=d,t;if(s=+t._x.call(null,p.data),u=+t._y.call(null,p.data),e===s&&n===u)return d.next=p,i?i[l]=d:t._root=d,t;do{i=i?i[l]=new Array(4):t._root=new Array(4),(c=e>=(o=(m+g)/2))?m=o:g=o,(h=n>=(a=(y+v)/2))?y=a:v=a}while((l=h<<1|c)===(f=(u>=a)<<1|s>=o));return i[f]=p,i[l]=d,t}function Do(t){var e,n,r,i,o=t.length,a=new Array(o),s=new Array(o),u=1/0,c=1/0,h=-1/0,l=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,s[n]=i,r<u&&(u=r),r>h&&(h=r),i<c&&(c=i),i>l&&(l=i));for(h<u&&(u=this._x0,h=this._x1),l<c&&(c=this._y0,l=this._y1),this.cover(u,c).cover(h,l),n=0;n<o;++n)ko(this,a[n],s[n],t[n]);return this}var xo=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{if(!(n>t||t>i||r>e||e>o))return this;var a,s,u=i-n,c=this._root;switch(s=(e<(r+o)/2)<<1|t<(n+i)/2){case 0:do{a=new Array(4),a[s]=c,c=a}while(u*=2,i=n+u,o=r+u,t>i||e>o);break;case 1:do{a=new Array(4),a[s]=c,c=a}while(u*=2,n=i-u,o=r+u,n>t||e>o);break;case 2:do{a=new Array(4),a[s]=c,c=a}while(u*=2,i=n+u,r=o-u,t>i||r>e);break;case 3:do{a=new Array(4),a[s]=c,c=a}while(u*=2,n=i-u,r=o-u,n>t||r>e);break}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},Oo=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Ro=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Mo=function(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i},Po=function(t,e,n){var r,i,o,a,s,u,c,h=this._x0,l=this._y0,f=this._x1,p=this._y1,d=[],m=this._root;m&&d.push(new Mo(m,h,l,f,p)),null==n?n=1/0:(h=t-n,l=e-n,f=t+n,p=e+n,n*=n);while(u=d.pop())if(!(!(m=u.node)||(i=u.x0)>f||(o=u.y0)>p||(a=u.x1)<h||(s=u.y1)<l))if(m.length){var y=(i+a)/2,g=(o+s)/2;d.push(new Mo(m[3],y,g,a,s),new Mo(m[2],i,g,y,s),new Mo(m[1],y,o,a,g),new Mo(m[0],i,o,y,g)),(c=(e>=g)<<1|t>=y)&&(u=d[d.length-1],d[d.length-1]=d[d.length-1-c],d[d.length-1-c]=u)}else{var v=t-+this._x.call(null,m.data),b=e-+this._y.call(null,m.data),_=v*v+b*b;if(_<n){var w=Math.sqrt(n=_);h=t-w,l=e-w,f=t+w,p=e+w,r=m.data}}return r},Lo=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,s,u,c,h,l,f,p=this._root,d=this._x0,m=this._y0,y=this._x1,g=this._y1;if(!p)return this;if(p.length)while(1){if((c=o>=(s=(d+y)/2))?d=s:y=s,(h=a>=(u=(m+g)/2))?m=u:g=u,e=p,!(p=p[l=h<<1|c]))return this;if(!p.length)break;(e[l+1&3]||e[l+2&3]||e[l+3&3])&&(n=e,f=l)}while(p.data!==t)if(r=p,!(p=p.next))return this;return(i=p.next)&&delete p.next,r?(i?r.next=i:delete r.next,this):e?(i?e[l]=i:delete e[l],(p=e[0]||e[1]||e[2]||e[3])&&p===(e[3]||e[2]||e[1]||e[0])&&!p.length&&(n?n[f]=p:this._root=p),this):(this._root=i,this)};function Fo(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}var Uo=function(){return this._root},qo=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Vo=function(t){var e,n,r,i,o,a,s=[],u=this._root;u&&s.push(new Mo(u,this._x0,this._y0,this._x1,this._y1));while(e=s.pop())if(!t(u=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&u.length){var c=(r+o)/2,h=(i+a)/2;(n=u[3])&&s.push(new Mo(n,c,h,o,a)),(n=u[2])&&s.push(new Mo(n,r,h,c,a)),(n=u[1])&&s.push(new Mo(n,c,i,o,h)),(n=u[0])&&s.push(new Mo(n,r,i,c,h))}return this},Bo=function(t){var e,n=[],r=[];this._root&&n.push(new Mo(this._root,this._x0,this._y0,this._x1,this._y1));while(e=n.pop()){var i=e.node;if(i.length){var o,a=e.x0,s=e.y0,u=e.x1,c=e.y1,h=(a+u)/2,l=(s+c)/2;(o=i[0])&&n.push(new Mo(o,a,s,h,l)),(o=i[1])&&n.push(new Mo(o,h,s,u,l)),(o=i[2])&&n.push(new Mo(o,a,l,h,c)),(o=i[3])&&n.push(new Mo(o,h,l,u,c))}r.push(e)}while(e=r.pop())t(e.node,e.x0,e.y0,e.x1,e.y1);return this};function jo(t){return t[0]}var Wo=function(t){return arguments.length?(this._x=t,this):this._x};function Ko(t){return t[1]}var zo=function(t){return arguments.length?(this._y=t,this):this._y};function Go(t,e,n){var r=new Qo(null==e?jo:e,null==n?Ko:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Qo(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function Ho(t){var e={data:t.data},n=e;while(t=t.next)n=n.next={data:t.data};return e}var Yo=Go.prototype=Qo.prototype;Yo.copy=function(){var t,e,n=new Qo(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=Ho(r),n;t=[{source:r,target:n._root=new Array(4)}];while(r=t.pop())for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=Ho(e));return n},Yo.add=No,Yo.addAll=Do,Yo.cover=xo,Yo.data=Oo,Yo.extent=Ro,Yo.find=Po,Yo.remove=Lo,Yo.removeAll=Fo,Yo.root=Uo,Yo.size=qo,Yo.visit=Vo,Yo.visitAfter=Bo,Yo.x=Wo,Yo.y=zo;Math.PI,Math.sqrt(5);var $o=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},Xo=function(t){return t=$o(Math.abs(t)),t?t[1]:NaN},Jo=function(t,e){return function(n,r){var i=n.length,o=[],a=0,s=t[0],u=0;while(i>0&&s>0){if(u+s+1>r&&(s=Math.max(1,r-u)),o.push(n.substring(i-=s,i+s)),(u+=s+1)>r)break;s=t[a=(a+1)%t.length]}return o.reverse().join(e)}},Zo=function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}},ta=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ea(t){return new na(t)}function na(t){if(!(e=ta.exec(t)))throw new Error("invalid format: "+t);var e;this.fill=e[1]||" ",this.align=e[2]||">",this.sign=e[3]||"-",this.symbol=e[4]||"",this.zero=!!e[5],this.width=e[6]&&+e[6],this.comma=!!e[7],this.precision=e[8]&&+e[8].slice(1),this.trim=!!e[9],this.type=e[10]||""}ea.prototype=na.prototype,na.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var ra,ia,oa=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(i>0){if(!+t[r])break t;i=0}break}return i>0?t.slice(0,i)+t.slice(e+1):t},aa=function(t,e){var n=$o(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(ra=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+$o(t,Math.max(0,e+o-1))[0]},sa=function(t,e){var n=$o(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},ua={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return sa(100*t,e)},r:sa,s:aa,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},ca=function(t){return t},ha=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],la=function(t){var e=t.grouping&&t.thousands?Jo(t.grouping,t.thousands):ca,n=t.currency,r=t.decimal,i=t.numerals?Zo(t.numerals):ca,o=t.percent||"%";function a(t){t=ea(t);var a=t.fill,s=t.align,u=t.sign,c=t.symbol,h=t.zero,l=t.width,f=t.comma,p=t.precision,d=t.trim,m=t.type;"n"===m?(f=!0,m="g"):ua[m]||(null==p&&(p=12),d=!0,m="g"),(h||"0"===a&&"="===s)&&(h=!0,a="0",s="=");var y="$"===c?n[0]:"#"===c&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",g="$"===c?n[1]:/[%p]/.test(m)?o:"",v=ua[m],b=/[defgprs%]/.test(m);function _(t){var n,o,c,_=y,w=g;if("c"===m)w=v(t)+w,t="";else{t=+t;var T=t<0;if(t=v(Math.abs(t),p),d&&(t=oa(t)),T&&0===+t&&(T=!1),_=(T?"("===u?u:"-":"-"===u||"("===u?"":u)+_,w=("s"===m?ha[8+ra/3]:"")+w+(T&&"("===u?")":""),b){n=-1,o=t.length;while(++n<o)if(c=t.charCodeAt(n),48>c||c>57){w=(46===c?r+t.slice(n+1):t.slice(n))+w,t=t.slice(0,n);break}}}f&&!h&&(t=e(t,1/0));var E=_.length+t.length+w.length,S=E<l?new Array(l-E+1).join(a):"";switch(f&&h&&(t=e(S+t,S.length?l-w.length:1/0),S=""),s){case"<":t=_+t+w+S;break;case"=":t=_+S+t+w;break;case"^":t=S.slice(0,E=S.length>>1)+_+t+w+S.slice(E);break;default:t=S+_+t+w;break}return i(t)}return p=null==p?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p)),_.toString=function(){return t+""},_}function s(t,e){var n=a((t=ea(t),t.type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Xo(e)/3))),i=Math.pow(10,-r),o=ha[8+r/3];return function(t){return n(i*t)+o}}return{format:a,formatPrefix:s}};function fa(t){return ia=la(t),ia.format,ia.formatPrefix,ia}fa({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var pa=function(){return new da};function da(){this.reset()}da.prototype={constructor:da,reset:function(){this.s=this.t=0},add:function(t){ya(ma,t,this.t),ya(this,ma.s,this.s),this.s?this.t+=ma.t:this.s=ma.t},valueOf:function(){return this.s}};var ma=new da;function ya(t,e,n){var r=t.s=e+n,i=r-e,o=r-i;t.t=e-o+(n-i)}var ga=1e-6,va=1e-12,ba=Math.PI,_a=ba/2,wa=ba/4,Ta=2*ba,Ea=ba/180,Sa=Math.abs,Ca=Math.atan,Ia=Math.atan2,Aa=Math.cos,Na=(Math.ceil,Math.exp),ka=(Math.floor,Math.log),Da=(Math.pow,Math.sin),xa=(Math.sign,Math.sqrt),Oa=Math.tan;function Ra(t){return t>1?0:t<-1?ba:Math.acos(t)}function Ma(t){return t>1?_a:t<-1?-_a:Math.asin(t)}function Pa(){}pa(),pa();function La(t){var e=t[0],n=t[1],r=Aa(n);return[r*Aa(e),r*Da(e),Da(n)]}function Fa(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Ua(t){var e=xa(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}pa();function qa(t,e){return[t>ba?t-Ta:t<-ba?t+Ta:t,e]}qa.invert=qa;var Va=function(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:Pa,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},Ba=function(t,e){return Sa(t[0]-e[0])<ga&&Sa(t[1]-e[1])<ga};function ja(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var Wa=function(t,e,n,r,i){var o,a,s=[],u=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],a=t[e];if(Ba(r,a)){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);i.lineEnd()}else s.push(n=new ja(r,t,null,!0)),u.push(n.o=new ja(r,null,n,!1)),s.push(n=new ja(a,t,null,!1)),u.push(n.o=new ja(a,null,n,!0))}})),s.length){for(u.sort(e),Ka(s),Ka(u),o=0,a=u.length;o<a;++o)u[o].e=n=!n;var c,h,l=s[0];while(1){var f=l,p=!0;while(f.v)if((f=f.n)===l)return;c=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(p)for(o=0,a=c.length;o<a;++o)i.point((h=c[o])[0],h[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(p)for(c=f.p.z,o=c.length-1;o>=0;--o)i.point((h=c[o])[0],h[1]);else r(f.x,f.p.x,-1,i);f=f.p}f=f.o,c=f.z,p=!p}while(!f.v);i.lineEnd()}}};function Ka(t){if(e=t.length){var e,n,r=0,i=t[0];while(++r<e)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}var za=pa(),Ga=function(t,e){var n=e[0],r=e[1],i=Da(r),o=[Da(n),-Aa(n),0],a=0,s=0;za.reset(),1===i?r=_a+ga:-1===i&&(r=-_a-ga);for(var u=0,c=t.length;u<c;++u)if(l=(h=t[u]).length)for(var h,l,f=h[l-1],p=f[0],d=f[1]/2+wa,m=Da(d),y=Aa(d),g=0;g<l;++g,p=b,m=w,y=T,f=v){var v=h[g],b=v[0],_=v[1]/2+wa,w=Da(_),T=Aa(_),E=b-p,S=E>=0?1:-1,C=S*E,I=C>ba,A=m*w;if(za.add(Ia(A*S*Da(C),y*T+A*Aa(C))),a+=I?E+S*Ta:E,I^p>=n^b>=n){var N=Fa(La(f),La(v));Ua(N);var k=Fa(o,N);Ua(k);var D=(I^E>=0?-1:1)*Ma(k[2]);(r>D||r===D&&(N[0]||N[1]))&&(s+=I^E>=0?1:-1)}}return(a<-ga||a<ga&&za<-ga)^1&s},Qa=function(t,e,n,r){return function(i){var o,a,s,u=e(i),c=Va(),h=e(c),l=!1,f={point:p,lineStart:m,lineEnd:y,polygonStart:function(){f.point=g,f.lineStart=v,f.lineEnd=b,a=[],o=[]},polygonEnd:function(){f.point=p,f.lineStart=m,f.lineEnd=y,a=w(a);var t=Ga(o,r);a.length?(l||(i.polygonStart(),l=!0),Wa(a,Ya,t,n,i)):t&&(l||(i.polygonStart(),l=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function p(e,n){t(e,n)&&i.point(e,n)}function d(t,e){u.point(t,e)}function m(){f.point=d,u.lineStart()}function y(){f.point=p,u.lineEnd()}function g(t,e){s.push([t,e]),h.point(t,e)}function v(){h.lineStart(),s=[]}function b(){g(s[0][0],s[0][1]),h.lineEnd();var t,e,n,r,u=h.clean(),f=c.result(),p=f.length;if(s.pop(),o.push(s),s=null,p)if(1&u){if(n=f[0],(e=n.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else p>1&&2&u&&f.push(f.pop().concat(f.shift())),a.push(f.filter(Ha))}return f}};function Ha(t){return t.length>1}function Ya(t,e){return((t=t.x)[0]<0?t[1]-_a-ga:_a-t[1])-((e=e.x)[0]<0?e[1]-_a-ga:_a-e[1])}Qa((function(){return!0}),$a,Ja,[-ba,-_a]);function $a(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?ba:-ba,u=Sa(o-n);Sa(u-ba)<ga?(t.point(n,r=(r+a)/2>0?_a:-_a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(o,r),e=0):i!==s&&u>=ba&&(Sa(n-i)<ga&&(n-=i*ga),Sa(o-s)<ga&&(o-=s*ga),r=Xa(n,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=o,r=a),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}function Xa(t,e,n,r){var i,o,a=Da(t-n);return Sa(a)>ga?Ca((Da(e)*(o=Aa(r))*Da(n)-Da(r)*(i=Aa(e))*Da(t))/(i*o*a)):(e+r)/2}function Ja(t,e,n,r){var i;if(null==t)i=n*_a,r.point(-ba,i),r.point(0,i),r.point(ba,i),r.point(ba,0),r.point(ba,-i),r.point(0,-i),r.point(-ba,-i),r.point(-ba,0),r.point(-ba,i);else if(Sa(t[0]-e[0])>ga){var o=t[0]<e[0]?ba:-ba;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}pa();pa(),pa();function Za(t){this._context=t}Za.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Ta);break}},result:Pa};pa();function ts(){this._string=[]}function es(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}ts.prototype={_radius:4.5,_circle:es(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=es(this._radius)),this._string.push("M",t,",",e,this._circle);break}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};function ns(t){return function(e){var n=new rs;for(var r in t)n[r]=t[r];return n.stream=e,n}}function rs(){}rs.prototype={constructor:rs,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};Aa(30*Ea);ns({point:function(t,e){this.stream.point(t*Ea,e*Ea)}});function is(t){return function(e,n){var r=Aa(e),i=Aa(n),o=t(r*i);return[o*i*Da(e),o*Da(n)]}}function os(t){return function(e,n){var r=xa(e*e+n*n),i=t(r),o=Da(i),a=Aa(i);return[Ia(e*o,r*a),Ma(r&&n*o/r)]}}var as=is((function(t){return xa(2/(1+t))}));as.invert=os((function(t){return 2*Ma(t/2)}));var ss=is((function(t){return(t=Ra(t))&&t/Da(t)}));ss.invert=os((function(t){return t}));function us(t,e){return[t,ka(Oa((_a+e)/2))]}us.invert=function(t,e){return[t,2*Ca(Na(e))-_a]};function cs(t,e){return[t,e]}cs.invert=cs;var hs=1.340264,ls=-.081106,fs=893e-6,ps=.003796,ds=xa(3)/2,ms=12;function ys(t,e){var n=Ma(ds*Da(e)),r=n*n,i=r*r*r;return[t*Aa(n)/(ds*(hs+3*ls*r+i*(7*fs+9*ps*r))),n*(hs+ls*r+i*(fs+ps*r))]}ys.invert=function(t,e){for(var n,r,i,o=e,a=o*o,s=a*a*a,u=0;u<ms;++u)if(r=o*(hs+ls*a+s*(fs+ps*a))-e,i=hs+3*ls*a+s*(7*fs+9*ps*a),o-=n=r/i,a=o*o,s=a*a*a,Sa(n)<va)break;return[ds*t*(hs+3*ls*a+s*(7*fs+9*ps*a))/Aa(o),Ma(Da(o)/ds)]};function gs(t,e){var n=Aa(e),r=Aa(t)*n;return[n*Da(t)/r,Da(e)/r]}gs.invert=os(Ca);function vs(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}vs.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-e)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(Sa(n)>ga&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]};function bs(t,e){return[Aa(e)*Da(t),Da(e)]}bs.invert=os(Ma);function _s(t,e){var n=Aa(e),r=1+Aa(t)*n;return[n*Da(t)/r,Da(e)/r]}_s.invert=os((function(t){return 2*Ca(t)}));function ws(t,e){return[ka(Oa((_a+e)/2)),-t]}ws.invert=function(t,e){return[-e,2*Ca(Na(t))-_a]};function Ts(t){var e=0,n=t.children,r=n&&n.length;if(r)while(--r>=0)e+=n[r].value;else e=1;t.value=e}var Es=function(){return this.eachAfter(Ts)},Ss=function(t){var e,n,r,i,o=this,a=[o];do{e=a.reverse(),a=[];while(o=e.pop())if(t(o),n=o.children,n)for(r=0,i=n.length;r<i;++r)a.push(n[r])}while(a.length);return this},Cs=function(t){var e,n,r=this,i=[r];while(r=i.pop())if(t(r),e=r.children,e)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},Is=function(t){var e,n,r,i=this,o=[i],a=[];while(i=o.pop())if(a.push(i),e=i.children,e)for(n=0,r=e.length;n<r;++n)o.push(e[n]);while(i=a.pop())t(i);return this},As=function(t){return this.eachAfter((function(e){var n=+t(e.data)||0,r=e.children,i=r&&r.length;while(--i>=0)n+=r[i].value;e.value=n}))},Ns=function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},ks=function(t){var e=this,n=Ds(e,t),r=[e];while(e!==n)e=e.parent,r.push(e);var i=r.length;while(t!==n)r.splice(i,0,t),t=t.parent;return r};function Ds(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();while(t===e)i=t,t=n.pop(),e=r.pop();return i}var xs=function(){var t=this,e=[t];while(t=t.parent)e.push(t);return e},Os=function(){var t=[];return this.each((function(e){t.push(e)})),t},Rs=function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},Ms=function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e};function Ps(t,e){var n,r,i,o,a,s=new Vs(t),u=+t.value&&(s.value=t.value),c=[s];null==e&&(e=Fs);while(n=c.pop())if(u&&(n.value=+n.data.value),(i=e(n.data))&&(a=i.length))for(n.children=new Array(a),o=a-1;o>=0;--o)c.push(r=n.children[o]=new Vs(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(qs)}function Ls(){return Ps(this).eachBefore(Us)}function Fs(t){return t.children}function Us(t){t.data=t.data.data}function qs(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function Vs(t){this.data=t,this.depth=this.height=0,this.parent=null}Vs.prototype=Ps.prototype={constructor:Vs,count:Es,each:Ss,eachAfter:Is,eachBefore:Cs,sum:As,sort:Ns,path:ks,ancestors:xs,descendants:Os,leaves:Rs,links:Ms,copy:Ls};Array.prototype.slice;var Bs=function(t,e,n,r,i){var o,a=t.children,s=-1,u=a.length,c=t.value&&(r-e)/t.value;while(++s<u)o=a[s],o.y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*c};function js(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}js.prototype=Object.create(Vs.prototype);var Ws=function(t,e,n,r,i){var o,a=t.children,s=-1,u=a.length,c=t.value&&(i-n)/t.value;while(++s<u)o=a[s],o.x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*c},Ks=(1+Math.sqrt(5))/2;function zs(t,e,n,r,i,o){var a,s,u,c,h,l,f,p,d,m,y,g=[],v=e.children,b=0,_=0,w=v.length,T=e.value;while(b<w){u=i-n,c=o-r;do{h=v[_++].value}while(!h&&_<w);for(l=f=h,m=Math.max(c/u,u/c)/(T*t),y=h*h*m,d=Math.max(f/y,y/l);_<w;++_){if(h+=s=v[_].value,s<l&&(l=s),s>f&&(f=s),y=h*h*m,p=Math.max(f/y,y/l),p>d){h-=s;break}d=p}g.push(a={value:h,dice:u<c,children:v.slice(b,_)}),a.dice?Bs(a,n,r,i,T?r+=c*h/T:o):Ws(a,n,r,T?n+=u*h/T:i,o),T-=h,b=_}return g}(function t(e){function n(t,n,r,i,o){zs(e,t,n,r,i,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n})(Ks),function t(e){function n(t,n,r,i,o){if((a=t._squarify)&&a.ratio===e){var a,s,u,c,h,l=-1,f=a.length,p=t.value;while(++l<f){for(s=a[l],u=s.children,c=s.value=0,h=u.length;c<h;++c)s.value+=u[c].value;s.dice?Bs(s,n,r,i,r+=(o-r)*s.value/p):Ws(s,n,r,n+=(i-n)*s.value/p,o),p-=s.value}}else t._squarify=a=zs(e,t,n,r,i,o),a.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Ks);var Gs=function(){return Math.random()},Qs=(function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(Gs),function t(e){function n(t,n){var r,i;return t=null==t?0:+t,n=null==n?1:+n,function(){var o;if(null!=r)o=r,r=null;else do{r=2*e()-1,o=2*e()-1,i=r*r+o*o}while(!i||i>1);return t+n*o*Math.sqrt(-2*Math.log(i)/i)}}return n.source=t,n}(Gs)),Hs=(function t(e){function n(){var t=Qs.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(Gs),function t(e){function n(t){return function(){for(var n=0,r=0;r<t;++r)n+=e();return n}}return n.source=t,n}(Gs)),Ys=(function t(e){function n(t){var n=Hs.source(e)(t);return function(){return n()/t}}return n.source=t,n}(Gs),function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(Gs),Array.prototype),$s=(Ys.map,Ys.slice),Xs={name:"implicit"};function Js(t){var e=oo(),n=[],r=Xs;function i(i){var o=i+"",a=e.get(o);if(!a){if(r!==Xs)return r;e.set(o,a=n.push(i))}return t[(a-1)%t.length]}return t=null==t?[]:$s.call(t),i.domain=function(t){if(!arguments.length)return n.slice();n=[],e=oo();var r,o,a=-1,s=t.length;while(++a<s)e.has(o=(r=t[a])+"")||e.set(o,n.push(r));return i},i.range=function(e){return arguments.length?(t=$s.call(e),i):t.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Js().domain(n).range(t).unknown(r)},i}var Zs=new Date,tu=new Date;function eu(t,e,n,r){function i(e){return t(e=new Date(+e)),e}return i.floor=i,i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r)||!(o>0))return s;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<r);return s},i.filter=function(n){return eu((function(e){if(e>=e)while(t(e),!n(e))e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)while(++r<=0)while(e(t,-1),!n(t));else while(--r>=0)while(e(t,1),!n(t));}))},n&&(i.count=function(e,r){return Zs.setTime(+e),tu.setTime(+r),t(Zs),t(tu),Math.floor(n(Zs,tu))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t===0}:function(e){return i.count(0,e)%t===0}):i:null}),i}var nu=eu((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));nu.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?eu((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):nu:null};nu.range;var ru=1e3,iu=6e4,ou=36e5,au=864e5,su=6048e5,uu=eu((function(t){t.setTime(Math.floor(t/ru)*ru)}),(function(t,e){t.setTime(+t+e*ru)}),(function(t,e){return(e-t)/ru}),(function(t){return t.getUTCSeconds()})),cu=(uu.range,eu((function(t){t.setTime(Math.floor(t/iu)*iu)}),(function(t,e){t.setTime(+t+e*iu)}),(function(t,e){return(e-t)/iu}),(function(t){return t.getMinutes()}))),hu=(cu.range,eu((function(t){var e=t.getTimezoneOffset()*iu%ou;e<0&&(e+=ou),t.setTime(Math.floor((+t-e)/ou)*ou+e)}),(function(t,e){t.setTime(+t+e*ou)}),(function(t,e){return(e-t)/ou}),(function(t){return t.getHours()}))),lu=(hu.range,eu((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*iu)/au}),(function(t){return t.getDate()-1}))),fu=lu;lu.range;function pu(t){return eu((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*iu)/su}))}var du=pu(0),mu=pu(1),yu=pu(2),gu=pu(3),vu=pu(4),bu=pu(5),_u=pu(6),wu=(du.range,mu.range,yu.range,gu.range,vu.range,bu.range,_u.range,eu((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()}))),Tu=(wu.range,eu((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()})));Tu.every=function(t){return isFinite(t=Math.floor(t))&&t>0?eu((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var Eu=Tu,Su=(Tu.range,eu((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*iu)}),(function(t,e){return(e-t)/iu}),(function(t){return t.getUTCMinutes()}))),Cu=(Su.range,eu((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*ou)}),(function(t,e){return(e-t)/ou}),(function(t){return t.getUTCHours()}))),Iu=(Cu.range,eu((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/au}),(function(t){return t.getUTCDate()-1}))),Au=Iu;Iu.range;function Nu(t){return eu((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/su}))}var ku=Nu(0),Du=Nu(1),xu=Nu(2),Ou=Nu(3),Ru=Nu(4),Mu=Nu(5),Pu=Nu(6),Lu=(ku.range,Du.range,xu.range,Ou.range,Ru.range,Mu.range,Pu.range,eu((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()}))),Fu=(Lu.range,eu((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()})));Fu.every=function(t){return isFinite(t=Math.floor(t))&&t>0?eu((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var Uu=Fu;Fu.range;function qu(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Vu(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Bu(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function ju(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,u=t.shortMonths,c=Ju(i),h=Zu(i),l=Ju(o),f=Zu(o),p=Ju(a),d=Zu(a),m=Ju(s),y=Zu(s),g=Ju(u),v=Zu(u),b={a:R,A:M,b:P,B:L,c:null,d:bc,e:bc,f:Sc,H:_c,I:wc,j:Tc,L:Ec,m:Cc,M:Ic,p:F,Q:th,s:eh,S:Ac,u:Nc,U:kc,V:Dc,w:xc,W:Oc,x:null,X:null,y:Rc,Y:Mc,Z:Pc,"%":Zc},_={a:U,A:q,b:V,B:B,c:null,d:Lc,e:Lc,f:Bc,H:Fc,I:Uc,j:qc,L:Vc,m:jc,M:Wc,p:j,Q:th,s:eh,S:Kc,u:zc,U:Gc,V:Qc,w:Hc,W:Yc,x:null,X:null,y:$c,Y:Xc,Z:Jc,"%":Zc},w={a:I,A:A,b:N,B:k,c:D,d:cc,e:cc,f:mc,H:lc,I:lc,j:hc,L:dc,m:uc,M:fc,p:C,Q:gc,s:vc,S:pc,u:ec,U:nc,V:rc,w:tc,W:ic,x:x,X:O,y:ac,Y:oc,Z:sc,"%":yc};function T(t,e){return function(n){var r,i,o,a=[],s=-1,u=0,c=t.length;n instanceof Date||(n=new Date(+n));while(++s<c)37===t.charCodeAt(s)&&(a.push(t.slice(u,s)),null!=(i=Gu[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(t.slice(u,s)),a.join("")}}function E(t,e){return function(n){var r,i,o=Bu(1900),a=S(o,t,n+="",0);if(a!=n.length)return null;if("Q"in o)return new Date(o.Q);if("p"in o&&(o.H=o.H%12+12*o.p),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(r=Vu(Bu(o.y)),i=r.getUTCDay(),r=i>4||0===i?Du.ceil(r):Du(r),r=Au.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(r=e(Bu(o.y)),i=r.getDay(),r=i>4||0===i?mu.ceil(r):mu(r),r=fu.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Vu(Bu(o.y)).getUTCDay():e(Bu(o.y)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Vu(o)):e(o)}}function S(t,e,n,r){var i,o,a=0,s=e.length,u=n.length;while(a<s){if(r>=u)return-1;if(i=e.charCodeAt(a++),37===i){if(i=e.charAt(a++),o=w[i in Gu?e.charAt(a++):i],!o||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function C(t,e,n){var r=c.exec(e.slice(n));return r?(t.p=h[r[0].toLowerCase()],n+r[0].length):-1}function I(t,e,n){var r=p.exec(e.slice(n));return r?(t.w=d[r[0].toLowerCase()],n+r[0].length):-1}function A(t,e,n){var r=l.exec(e.slice(n));return r?(t.w=f[r[0].toLowerCase()],n+r[0].length):-1}function N(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=v[r[0].toLowerCase()],n+r[0].length):-1}function k(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1}function D(t,n,r){return S(t,e,n,r)}function x(t,e,r){return S(t,n,e,r)}function O(t,e,n){return S(t,r,e,n)}function R(t){return a[t.getDay()]}function M(t){return o[t.getDay()]}function P(t){return u[t.getMonth()]}function L(t){return s[t.getMonth()]}function F(t){return i[+(t.getHours()>=12)]}function U(t){return a[t.getUTCDay()]}function q(t){return o[t.getUTCDay()]}function V(t){return u[t.getUTCMonth()]}function B(t){return s[t.getUTCMonth()]}function j(t){return i[+(t.getUTCHours()>=12)]}return(b.x=T(n,b),b.X=T(r,b),b.c=T(e,b),_.x=T(n,_),_.X=T(r,_),_.c=T(e,_),{format:function(t){var e=T(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=E(t+="",qu);return e.toString=function(){return t},e},utcFormat:function(t){var e=T(t+="",_);return e.toString=function(){return t},e},utcParse:function(t){var e=E(t,Vu);return e.toString=function(){return t},e}})}var Wu,Ku,zu,Gu={"-":"",_:" ",0:"0"},Qu=/^\s*\d+/,Hu=/^%/,Yu=/[\\^$*+?|[\]().{}]/g;function $u(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Xu(t){return t.replace(Yu,"\\$&")}function Ju(t){return new RegExp("^(?:"+t.map(Xu).join("|")+")","i")}function Zu(t){var e={},n=-1,r=t.length;while(++n<r)e[t[n].toLowerCase()]=n;return e}function tc(t,e,n){var r=Qu.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function ec(t,e,n){var r=Qu.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function nc(t,e,n){var r=Qu.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function rc(t,e,n){var r=Qu.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function ic(t,e,n){var r=Qu.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function oc(t,e,n){var r=Qu.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function ac(t,e,n){var r=Qu.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function sc(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function uc(t,e,n){var r=Qu.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function cc(t,e,n){var r=Qu.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function hc(t,e,n){var r=Qu.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function lc(t,e,n){var r=Qu.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function fc(t,e,n){var r=Qu.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function pc(t,e,n){var r=Qu.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function dc(t,e,n){var r=Qu.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function mc(t,e,n){var r=Qu.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function yc(t,e,n){var r=Hu.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function gc(t,e,n){var r=Qu.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function vc(t,e,n){var r=Qu.exec(e.slice(n));return r?(t.Q=1e3*+r[0],n+r[0].length):-1}function bc(t,e){return $u(t.getDate(),e,2)}function _c(t,e){return $u(t.getHours(),e,2)}function wc(t,e){return $u(t.getHours()%12||12,e,2)}function Tc(t,e){return $u(1+fu.count(Eu(t),t),e,3)}function Ec(t,e){return $u(t.getMilliseconds(),e,3)}function Sc(t,e){return Ec(t,e)+"000"}function Cc(t,e){return $u(t.getMonth()+1,e,2)}function Ic(t,e){return $u(t.getMinutes(),e,2)}function Ac(t,e){return $u(t.getSeconds(),e,2)}function Nc(t){var e=t.getDay();return 0===e?7:e}function kc(t,e){return $u(du.count(Eu(t),t),e,2)}function Dc(t,e){var n=t.getDay();return t=n>=4||0===n?vu(t):vu.ceil(t),$u(vu.count(Eu(t),t)+(4===Eu(t).getDay()),e,2)}function xc(t){return t.getDay()}function Oc(t,e){return $u(mu.count(Eu(t),t),e,2)}function Rc(t,e){return $u(t.getFullYear()%100,e,2)}function Mc(t,e){return $u(t.getFullYear()%1e4,e,4)}function Pc(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+$u(e/60|0,"0",2)+$u(e%60,"0",2)}function Lc(t,e){return $u(t.getUTCDate(),e,2)}function Fc(t,e){return $u(t.getUTCHours(),e,2)}function Uc(t,e){return $u(t.getUTCHours()%12||12,e,2)}function qc(t,e){return $u(1+Au.count(Uu(t),t),e,3)}function Vc(t,e){return $u(t.getUTCMilliseconds(),e,3)}function Bc(t,e){return Vc(t,e)+"000"}function jc(t,e){return $u(t.getUTCMonth()+1,e,2)}function Wc(t,e){return $u(t.getUTCMinutes(),e,2)}function Kc(t,e){return $u(t.getUTCSeconds(),e,2)}function zc(t){var e=t.getUTCDay();return 0===e?7:e}function Gc(t,e){return $u(ku.count(Uu(t),t),e,2)}function Qc(t,e){var n=t.getUTCDay();return t=n>=4||0===n?Ru(t):Ru.ceil(t),$u(Ru.count(Uu(t),t)+(4===Uu(t).getUTCDay()),e,2)}function Hc(t){return t.getUTCDay()}function Yc(t,e){return $u(Du.count(Uu(t),t),e,2)}function $c(t,e){return $u(t.getUTCFullYear()%100,e,2)}function Xc(t,e){return $u(t.getUTCFullYear()%1e4,e,4)}function Jc(){return"+0000"}function Zc(){return"%"}function th(t){return+t}function eh(t){return Math.floor(+t/1e3)}function nh(t){return Wu=ju(t),Wu.format,Wu.parse,Ku=Wu.utcFormat,zu=Wu.utcParse,Wu}nh({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var rh="%Y-%m-%dT%H:%M:%S.%LZ";function ih(t){return t.toISOString()}Date.prototype.toISOString||Ku(rh);function oh(t){var e=new Date(t);return isNaN(e)?null:e}+new Date("2000-01-01T00:00:00.000Z")||zu(rh);var ah=function(t){var e=t.length/6|0,n=new Array(e),r=0;while(r<e)n[r]="#"+t.slice(6*r,6*++r);return n},sh=ah("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),uh=(ah("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),ah("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),ah("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),ah("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),ah("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),ah("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),ah("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),ah("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),function(t){return Un(t[t.length-1])}),ch=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(ah),hh=(uh(ch),new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(ah)),lh=(uh(hh),new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(ah)),fh=(uh(lh),new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(ah)),ph=(uh(fh),new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(ah)),dh=(uh(ph),new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(ah)),mh=(uh(dh),new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(ah)),yh=(uh(mh),new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(ah)),gh=(uh(yh),new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(ah)),vh=(uh(gh),new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(ah)),bh=(uh(vh),new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(ah)),_h=(uh(bh),new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(ah)),wh=(uh(_h),new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(ah)),Th=(uh(wh),new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(ah)),Eh=(uh(Th),new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(ah)),Sh=(uh(Eh),new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(ah)),Ch=(uh(Sh),new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(ah)),Ih=(uh(Ch),new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(ah)),Ah=(uh(Ih),new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(ah)),Nh=(uh(Ah),new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(ah)),kh=(uh(Nh),new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(ah)),Dh=(uh(kh),new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(ah)),xh=(uh(Dh),new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(ah)),Oh=(uh(xh),new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(ah)),Rh=(uh(Oh),new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(ah)),Mh=(uh(Rh),new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(ah)),Ph=(uh(Mh),new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(ah));uh(Ph),ar(Cn(300,.5,0),Cn(-240,.5,1)),ar(Cn(-100,.75,.35),Cn(80,1.5,.8)),ar(Cn(260,.75,.35),Cn(80,1.5,.8)),Cn(),Be(),Math.PI,Math.PI;function Lh(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}Lh(ah("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),Lh(ah("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Lh(ah("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Lh(ah("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),Math.abs,Math.atan2,Math.cos,Math.max,Math.min,Math.sin,Math.sqrt;var Fh=1e-12,Uh=Math.PI,qh=2*Uh;function Vh(t){this._context=t}Vh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};var Bh=function(t){return new Vh(t)};Wh(Bh);function jh(t){this._curve=t}function Wh(t){function e(e){return new jh(t(e))}return e._curve=t,e}jh.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};Array.prototype.slice;Math.sqrt(1/3);var Kh=Math.sin(Uh/10)/Math.sin(7*Uh/10),zh=(Math.sin(qh/10),Math.cos(qh/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),function(){});function Gh(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Qh(t){this._context=t}Qh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Gh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Gh(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Hh(t){this._context=t}Hh.prototype={areaStart:zh,areaEnd:zh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Gh(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Yh(t){this._context=t}Yh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Gh(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function $h(t,e){this._basis=new Qh(t),this._beta=e}$h.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0){var r,i=t[0],o=e[0],a=t[n]-i,s=e[n]-o,u=-1;while(++u<=n)r=u/n,this._basis.point(this._beta*t[u]+(1-this._beta)*(i+r*a),this._beta*e[u]+(1-this._beta)*(o+r*s))}this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};(function t(e){function n(t){return 1===e?new Qh(t):new $h(t,e)}return n.beta=function(e){return t(+e)},n})(.85);function Xh(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Jh(t,e){this._context=t,this._k=(1-e)/6}Jh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Xh(this,this._x1,this._y1);break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Xh(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(t){return new Jh(t,e)}return n.tension=function(e){return t(+e)},n})(0);function Zh(t,e){this._context=t,this._k=(1-e)/6}Zh.prototype={areaStart:zh,areaEnd:zh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Xh(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(t){return new Zh(t,e)}return n.tension=function(e){return t(+e)},n})(0);function tl(t,e){this._context=t,this._k=(1-e)/6}tl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Xh(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(t){return new tl(t,e)}return n.tension=function(e){return t(+e)},n})(0);function el(t,e,n){var r=t._x1,i=t._y1,o=t._x2,a=t._y2;if(t._l01_a>Fh){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>Fh){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,h=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*c+t._x1*t._l23_2a-e*t._l12_2a)/h,a=(a*c+t._y1*t._l23_2a-n*t._l12_2a)/h}t._context.bezierCurveTo(r,i,o,a,t._x2,t._y2)}function nl(t,e){this._context=t,this._alpha=e}nl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:el(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(t){return e?new nl(t,e):new Jh(t,0)}return n.alpha=function(e){return t(+e)},n})(.5);function rl(t,e){this._context=t,this._alpha=e}rl.prototype={areaStart:zh,areaEnd:zh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:el(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(t){return e?new rl(t,e):new Zh(t,0)}return n.alpha=function(e){return t(+e)},n})(.5);function il(t,e){this._context=t,this._alpha=e}il.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:el(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(t){return e?new il(t,e):new tl(t,0)}return n.alpha=function(e){return t(+e)},n})(.5);function ol(t){this._context=t}ol.prototype={areaStart:zh,areaEnd:zh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function al(t){return t<0?-1:1}function sl(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(al(o)+al(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function ul(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function cl(t,e,n){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,s=(o-r)/3;t._context.bezierCurveTo(r+s,i+s*e,o-s,a-s*n,o,a)}function hl(t){this._context=t}function ll(t){this._context=new fl(t)}function fl(t){this._context=t}function pl(t){this._context=t}function dl(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,a[e]-=n*a[e-1];for(i[r-1]=a[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(a[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}hl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:cl(this,this._t0,ul(this,this._t0));break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,t!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,cl(this,ul(this,n=sl(this,t,e)),n);break;default:cl(this,this._t0,n=sl(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(ll.prototype=Object.create(hl.prototype)).point=function(t,e){hl.prototype.point.call(this,e,t)},fl.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}},pl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=dl(t),i=dl(e),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[a],e[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function ml(t,e){this._context=t,this._t=e}ml.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}this._x=t,this._y=e}};function yl(){this._=null}function gl(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function vl(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function bl(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function _l(t){while(t.L)t=t.L;return t}yl.prototype={constructor:yl,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){t=t.R;while(t.L)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=_l(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);e.L=e.R=null,e.U=n,e.C=!0,t=e;while(n&&n.C)r=n.U,n===r.L?(i=r.R,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(vl(this,n),t=n,n=t.U),n.C=!1,r.C=!0,bl(this,r))):(i=r.L,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(bl(this,n),t=n,n=t.U),n.C=!1,r.C=!0,vl(this,r))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,o=t.L,a=t.R;if(n=o?a?_l(a):o:a,i?i.L===t?i.L=n:i.R=n:this._=n,o&&a?(r=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=a,a.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if(e=i.R,e.C&&(e.C=!1,i.C=!0,vl(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,bl(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,vl(this,i),t=this._;break}}else if(e=i.L,e.C&&(e.C=!1,i.C=!0,bl(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,vl(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,bl(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var wl=yl;function Tl(t,e,n,r){var i=[null,null],o=$l.push(i)-1;return i.left=t,i.right=e,n&&Sl(i,t,e,n),r&&Sl(i,e,t,r),Hl[t.index].halfedges.push(o),Hl[e.index].halfedges.push(o),i}function El(t,e,n){var r=[e,n];return r.left=t,r}function Sl(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function Cl(t,e,n,r,i){var o,a=t[0],s=t[1],u=a[0],c=a[1],h=s[0],l=s[1],f=0,p=1,d=h-u,m=l-c;if(o=e-u,d||!(o>0)){if(o/=d,d<0){if(o<f)return;o<p&&(p=o)}else if(d>0){if(o>p)return;o>f&&(f=o)}if(o=r-u,d||!(o<0)){if(o/=d,d<0){if(o>p)return;o>f&&(f=o)}else if(d>0){if(o<f)return;o<p&&(p=o)}if(o=n-c,m||!(o>0)){if(o/=m,m<0){if(o<f)return;o<p&&(p=o)}else if(m>0){if(o>p)return;o>f&&(f=o)}if(o=i-c,m||!(o<0)){if(o/=m,m<0){if(o>p)return;o>f&&(f=o)}else if(m>0){if(o<f)return;o<p&&(p=o)}return!(f>0||p<1)||(f>0&&(t[0]=[u+f*d,c+f*m]),p<1&&(t[1]=[u+p*d,c+p*m]),!0)}}}}}function Il(t,e,n,r,i){var o=t[1];if(o)return!0;var a,s,u=t[0],c=t.left,h=t.right,l=c[0],f=c[1],p=h[0],d=h[1],m=(l+p)/2,y=(f+d)/2;if(d===f){if(m<e||m>=r)return;if(l>p){if(u){if(u[1]>=i)return}else u=[m,n];o=[m,i]}else{if(u){if(u[1]<n)return}else u=[m,i];o=[m,n]}}else if(a=(l-p)/(d-f),s=y-a*m,a<-1||a>1)if(l>p){if(u){if(u[1]>=i)return}else u=[(n-s)/a,n];o=[(i-s)/a,i]}else{if(u){if(u[1]<n)return}else u=[(i-s)/a,i];o=[(n-s)/a,n]}else if(f<d){if(u){if(u[0]>=r)return}else u=[e,a*e+s];o=[r,a*r+s]}else{if(u){if(u[0]<e)return}else u=[r,a*r+s];o=[e,a*e+s]}return t[0]=u,t[1]=o,!0}function Al(t,e,n,r){var i,o=$l.length;while(o--)Il(i=$l[o],t,e,n,r)&&Cl(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>Xl||Math.abs(i[0][1]-i[1][1])>Xl)||delete $l[o]}function Nl(t){return Hl[t.index]={site:t,halfedges:[]}}function kl(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function Dl(t,e){return e[+(e.left!==t.site)]}function xl(t,e){return e[+(e.left===t.site)]}function Ol(){for(var t,e,n,r,i=0,o=Hl.length;i<o;++i)if((t=Hl[i])&&(r=(e=t.halfedges).length)){var a=new Array(r),s=new Array(r);for(n=0;n<r;++n)a[n]=n,s[n]=kl(t,$l[e[n]]);for(a.sort((function(t,e){return s[e]-s[t]})),n=0;n<r;++n)s[n]=e[a[n]];for(n=0;n<r;++n)e[n]=s[n]}}function Rl(t,e,n,r){var i,o,a,s,u,c,h,l,f,p,d,m,y=Hl.length,g=!0;for(i=0;i<y;++i)if(o=Hl[i]){a=o.site,u=o.halfedges,s=u.length;while(s--)$l[u[s]]||u.splice(s,1);s=0,c=u.length;while(s<c)p=xl(o,$l[u[s]]),d=p[0],m=p[1],h=Dl(o,$l[u[++s%c]]),l=h[0],f=h[1],(Math.abs(d-l)>Xl||Math.abs(m-f)>Xl)&&(u.splice(s,0,$l.push(El(a,p,Math.abs(d-t)<Xl&&r-m>Xl?[t,Math.abs(l-t)<Xl?f:r]:Math.abs(m-r)<Xl&&n-d>Xl?[Math.abs(f-r)<Xl?l:n,r]:Math.abs(d-n)<Xl&&m-e>Xl?[n,Math.abs(l-n)<Xl?f:e]:Math.abs(m-e)<Xl&&d-t>Xl?[Math.abs(f-e)<Xl?l:t,e]:null))-1),++c);c&&(g=!1)}if(g){var v,b,_,w=1/0;for(i=0,g=null;i<y;++i)(o=Hl[i])&&(a=o.site,v=a[0]-t,b=a[1]-e,_=v*v+b*b,_<w&&(w=_,g=o));if(g){var T=[t,e],E=[t,r],S=[n,r],C=[n,e];g.halfedges.push($l.push(El(a=g.site,T,E))-1,$l.push(El(a,E,S))-1,$l.push(El(a,S,C))-1,$l.push(El(a,C,T))-1)}}for(i=0;i<y;++i)(o=Hl[i])&&(o.halfedges.length||delete Hl[i])}var Ml,Pl=[];function Ll(){gl(this),this.x=this.y=this.arc=this.site=this.cy=null}function Fl(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,o=n.site;if(r!==o){var a=i[0],s=i[1],u=r[0]-a,c=r[1]-s,h=o[0]-a,l=o[1]-s,f=2*(u*l-c*h);if(!(f>=-Jl)){var p=u*u+c*c,d=h*h+l*l,m=(l*p-c*d)/f,y=(u*d-h*p)/f,g=Pl.pop()||new Ll;g.arc=t,g.site=i,g.x=m+a,g.y=(g.cy=y+s)+Math.sqrt(m*m+y*y),t.circle=g;var v=null,b=Yl._;while(b)if(g.y<b.y||g.y===b.y&&g.x<=b.x){if(!b.L){v=b.P;break}b=b.L}else{if(!b.R){v=b;break}b=b.R}Yl.insert(v,g),v||(Ml=g)}}}}function Ul(t){var e=t.circle;e&&(e.P||(Ml=e.N),Yl.remove(e),Pl.push(e),gl(e),t.circle=null)}var ql=[];function Vl(){gl(this),this.edge=this.site=this.circle=null}function Bl(t){var e=ql.pop()||new Vl;return e.site=t,e}function jl(t){Ul(t),Ql.remove(t),ql.push(t),gl(t)}function Wl(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],o=t.P,a=t.N,s=[t];jl(t);var u=o;while(u.circle&&Math.abs(n-u.circle.x)<Xl&&Math.abs(r-u.circle.cy)<Xl)o=u.P,s.unshift(u),jl(u),u=o;s.unshift(u),Ul(u);var c=a;while(c.circle&&Math.abs(n-c.circle.x)<Xl&&Math.abs(r-c.circle.cy)<Xl)a=c.N,s.push(c),jl(c),c=a;s.push(c),Ul(c);var h,l=s.length;for(h=1;h<l;++h)c=s[h],u=s[h-1],Sl(c.edge,u.site,c.site,i);u=s[0],c=s[l-1],c.edge=Tl(u.site,c.site,null,i),Fl(u),Fl(c)}function Kl(t){var e,n,r,i,o=t[0],a=t[1],s=Ql._;while(s)if(r=zl(s,a)-o,r>Xl)s=s.L;else{if(i=o-Gl(s,a),!(i>Xl)){r>-Xl?(e=s.P,n=s):i>-Xl?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}Nl(t);var u=Bl(t);if(Ql.insert(e,u),e||n){if(e===n)return Ul(e),n=Bl(e.site),Ql.insert(u,n),u.edge=n.edge=Tl(e.site,u.site),Fl(e),void Fl(n);if(n){Ul(e),Ul(n);var c=e.site,h=c[0],l=c[1],f=t[0]-h,p=t[1]-l,d=n.site,m=d[0]-h,y=d[1]-l,g=2*(f*y-p*m),v=f*f+p*p,b=m*m+y*y,_=[(y*v-p*b)/g+h,(f*b-m*v)/g+l];Sl(n.edge,c,d,_),u.edge=Tl(c,t,null,_),n.edge=Tl(t,d,null,_),Fl(e),Fl(n)}else u.edge=Tl(e.site,u.site)}}function zl(t,e){var n=t.site,r=n[0],i=n[1],o=i-e;if(!o)return r;var a=t.P;if(!a)return-1/0;n=a.site;var s=n[0],u=n[1],c=u-e;if(!c)return s;var h=s-r,l=1/o-1/c,f=h/c;return l?(-f+Math.sqrt(f*f-2*l*(h*h/(-2*c)-u+c/2+i-o/2)))/l+r:(r+s)/2}function Gl(t,e){var n=t.N;if(n)return zl(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var Ql,Hl,Yl,$l,Xl=1e-6,Jl=1e-12;function Zl(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function tf(t,e){return e[1]-t[1]||e[0]-t[0]}function ef(t,e){var n,r,i,o=t.sort(tf).pop();$l=[],Hl=new Array(t.length),Ql=new wl,Yl=new wl;while(1)if(i=Ml,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===n&&o[1]===r||(Kl(o),n=o[0],r=o[1]),o=t.pop();else{if(!i)break;Wl(i.arc)}if(Ol(),e){var a=+e[0][0],s=+e[0][1],u=+e[1][0],c=+e[1][1];Al(a,s,u,c),Rl(a,s,u,c)}this.edges=$l,this.cells=Hl,Ql=Yl=$l=Hl=null}ef.prototype={constructor:ef,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return Dl(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,r){if(o=(i=n.halfedges).length){var i,o,a,s=n.site,u=-1,c=e[i[o-1]],h=c.left===s?c.right:c.left;while(++u<o)a=h,c=e[i[u]],h=c.left===s?c.right:c.left,a&&h&&r<a.index&&r<h.index&&Zl(s,a,h)<0&&t.push([s.data,a.data,h.data])}})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){var r,i,o=this,a=o._found||0,s=o.cells.length;while(!(i=o.cells[a]))if(++a>=s)return null;var u=t-i.site[0],c=e-i.site[1],h=u*u+c*c;do{i=o.cells[r=a],a=null,i.halfedges.forEach((function(n){var r=o.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var u=t-s[0],c=e-s[1],l=u*u+c*c;l<h&&(h=l,a=s.index)}}))}while(null!==a);return o._found=r,null==n||h<=n*n?i.site:null}};function nf(t,e,n){this.k=t,this.x=e,this.y=n}nf.prototype={constructor:nf,scale:function(t){return 1===t?this:new nf(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new nf(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var rf=new nf(1,0,0);function of(t){return t.__zoom||rf}of.prototype=nf.prototype;var af=n("4a83"),sf={data:function(){return{layout:{},chart:{},fill:null}},props:{data:{type:Array,required:!0},fontSizeMapper:{type:Function,required:!0},onWordClick:{type:Function,default:function(t){window.alert("You clicked ".concat(t.text))}},rotate:{type:[Function,String,Number],default:0},font:{type:[String,Function],default:"Serif"},width:{type:[Number,String],default:960},height:{type:[Number,String],default:500},padding:{type:[Number,String],default:0},spiral:{type:String,default:"archimedean"},coloring:{type:String,default:"random"},colors:{type:Array}},mounted:function(){this.createCanvas()},watch:{data:function(){this.createCanvas()},rotate:function(){this.createCanvas()},font:function(){this.createCanvas()},padding:function(){this.createCanvas()},spiral:function(){this.createCanvas()},colors:function(){this.createCanvas()},coloring:function(){this.createCanvas()}},methods:{createCanvas:function(){var t=this.data.map((function(t){return m({},t)}));me(this.$el).selectAll("*").remove();var e=af().size([this.width,this.height]).words(t).padding(this.padding).spiral(this.spiral).rotate(this.rotate).font(this.font).fontSize(this.fontSizeMapper).on("end",this.end);this.colors?this.fill=Js().range(this.colors):this.fill=Js(sh),e.start()},end:function(t){var e,n=this;switch(this.coloring){case"random":e=function(t,e){return n.fill(e)};break;case"size":e=function(t){return n.fill(t.size)};break;default:e=function(t,e){return n.fill(e)}}me(this.$el).append("svg").attr("width",this.width).attr("height",this.height).append("g").attr("transform","translate(".concat(this.width/2,",").concat(this.height/2,")")).selectAll("text").data(t).enter().append("text").style("font-family",(function(t){return t.font})).style("font-size",(function(t){return"".concat(t.size,"px")})).style("fill",e).attr("text-anchor","middle").attr("transform",(function(t){return"translate(".concat([t.x,t.y],")rotate(").concat(t.rotate,")")})).text((function(t){return t.text})).on("click",(function(t){return n.onWordClick(t)}))}}},uf=sf;function cf(t,e,n,r,i,o,a,s){var u,c="function"===typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),r&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),a?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=u):i&&(u=s?function(){i.call(this,this.$root.$options.shadowRoot)}:i),u)if(c.functional){c._injectStyles=u;var h=c.render;c.render=function(t,e){return u.call(e),h(t,e)}}else{var l=c.beforeCreate;c.beforeCreate=l?[].concat(l,u):[u]}return{exports:t,options:c}}var hf=cf(uf,i,o,!1,null,null,null),lf=hf.exports,ff=lf;n.d(e,"Cloud",(function(){return lf}));e["default"]=ff},fde4:function(t,e,n){n("bf90");var r=n("584a").Object;t.exports=function(t,e){return r.getOwnPropertyDescriptor(t,e)}},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}})},e4ae:function(t,e,n){var r=n("f772");t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},e53d:function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},e683:function(t,e,n){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},e6f3:function(t,e,n){var r=n("07e3"),i=n("36c3"),o=n("5b4e")(!1),a=n("5559")("IE_PROTO");t.exports=function(t,e){var n,s=i(t),u=0,c=[];for(n in s)n!=a&&r(s,n)&&c.push(n);while(e.length>u)r(s,n=e[u++])&&(~o(c,n)||c.push(n));return c}},e71f:function(t,e,n){"use strict";n("e89a")},e89a:function(t,e,n){"use strict";(function(t){function r(t){return t&&"object"===typeof t&&"default"in t?t["default"]:t}Object.defineProperty(e,"__esModule",{value:!0});var i,o=r(n("c23d")),a=n("9ab4"),s=n("abfd"),u=n("cd51"),c=n("c7b2"),h=o.SDK_VERSION,l=new s.Logger("@firebase/firestore");function f(){return l.logLevel===s.LogLevel.DEBUG?i.DEBUG:l.logLevel===s.LogLevel.SILENT?i.SILENT:i.ERROR}function p(t){switch(t){case i.DEBUG:l.logLevel=s.LogLevel.DEBUG;break;case i.ERROR:l.logLevel=s.LogLevel.ERROR;break;case i.SILENT:l.logLevel=s.LogLevel.SILENT;break;default:l.error("Firestore ("+h+"): Invalid value passed to `setLogLevel`")}}function d(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(l.logLevel<=s.LogLevel.DEBUG){var i=n.map(y);l.debug.apply(l,a.__spreadArrays(["Firestore ("+h+") ["+t+"]: "+e],i))}}function m(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(l.logLevel<=s.LogLevel.ERROR){var r=e.map(y);l.error.apply(l,a.__spreadArrays(["Firestore ("+h+"): "+t],r))}}function y(t){if("string"===typeof t)return t;var e=b.getPlatform();try{return e.formatJSON(t)}catch(n){return t}}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g(t){var e="FIRESTORE ("+h+") INTERNAL ASSERTION FAILED: "+t;throw m(e),new Error(e)}function v(t,e){t||g(e)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(t){t[t["DEBUG"]=0]="DEBUG",t[t["ERROR"]=1]="ERROR",t[t["SILENT"]=2]="SILENT"})(i||(i={}));var b=function(){function t(){}return t.setPlatform=function(e){t.platform&&g("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||g("Platform not set"),t.platform},t}();function _(){return b.getPlatform().emptyByteString}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var w={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},T=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return a.__extends(e,t),e}(Error);
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function E(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new T(w.INVALID_ARGUMENT,t)}for(var r in n.prototype=t.prototype,t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function C(t,e){return void 0!==t?t:e}function I(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function A(t){var e=[];return N(t,(function(t,n){return e.push(n)})),e}function N(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function k(t){for(var e in v(null!=t&&"object"===typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function D(t){v(t&&"object"===typeof t,"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x(t,e){if(0!==e.length)throw new T(w.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+tt(e.length,"argument")+".")}function O(t,e,n){if(e.length!==n)throw new T(w.INVALID_ARGUMENT,"Function "+t+"() requires "+tt(n,"argument")+", but was called with "+tt(e.length,"argument")+".")}function R(t,e,n){if(e.length<n)throw new T(w.INVALID_ARGUMENT,"Function "+t+"() requires at least "+tt(n,"argument")+", but was called with "+tt(e.length,"argument")+".")}function M(t,e,n,r){if(e.length<n||e.length>r)throw new T(w.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+tt(e.length,"argument")+".")}function P(t,e,n,r){if(!(e instanceof Array)||e.length<r)throw new T(w.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" argument to be an array with at least "+tt(r,"element")+".")}function L(t,e,n,r){z(t,e,Z(n)+" argument",r)}function F(t,e,n,r){void 0!==r&&L(t,e,n,r)}function U(t,e,n,r){z(t,e,n+" option",r)}function q(t,e,n,r){void 0!==r&&U(t,e,n,r)}function V(t,e,n,r,i){if(!(r instanceof Array))throw new T(w.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Q(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new T(w.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+o+" was: "+Q(r[o]))}function B(t,e,n,r,i){void 0!==r&&V(t,e,n,r,i)}function j(t,e,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(Q(u))}var c=Q(r);throw new T(w.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}function W(t,e,n,r,i){void 0!==r&&j(t,e,n,r,i)}function K(t,e,n,r){if(!e.some((function(t){return t===r})))throw new T(w.INVALID_ARGUMENT,"Invalid value "+Q(r)+" provided to function "+t+"() for its "+Z(n)+" argument. Acceptable values: "+e.join(", "))}function z(t,e,n,r){var i=!1;if(i="object"===e?G(r):"non-empty string"===e?"string"===typeof r&&""!==r:typeof r===e,!i){var o=Q(r);throw new T(w.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+o)}}function G(t){return"object"===typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Q(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"===typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"===typeof t||"boolean"===typeof t)return""+t;if("object"===typeof t){if(t instanceof Array)return"an array";var e=H(t);return e?"a custom "+e+" object":"an object"}return"function"===typeof t?"a function":g("Unknown wrong type: "+typeof t)}function H(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/,n=e.exec(t.constructor.toString());if(n&&n.length>1)return n[1]}return null}function Y(t,e,n){if(void 0===n)throw new T(w.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Z(e)+" argument, but it was undefined.")}function $(t,e,n){N(e,(function(e,r){if(n.indexOf(e)<0)throw new T(w.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))}))}function X(t,e,n,r){var i=Q(r);return new T(w.INVALID_ARGUMENT,"Function "+t+"() requires its "+Z(n)+" argument to be a "+e+", but it was: "+i)}function J(t,e,n){if(n<=0)throw new T(w.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+Z(e)+" argument to be a positive number, but it was: "+n+".")}function Z(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function tt(t,e){return t+" "+e+(1===t?"":"s")}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et=function(){function t(){}return t.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return v(20===e.length,"Invalid auto ID: "+e),e},t}();function nt(t,e){return t<e?-1:t>e?1:0}function rt(t,e){return null!==t&&void 0!==t?!(!e||!t.isEqual(e)):t===e}function it(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function ot(t){return t+"\0"}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function at(){if("undefined"===typeof Uint8Array)throw new T(w.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function st(){if(!b.getPlatform().base64Available)throw new T(w.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var ut,ct=function(){function t(t){st(),this._binaryString=t}return t.fromBase64String=function(e){O("Blob.fromBase64String",arguments,1),L("Blob.fromBase64String","string",1,e),st();try{var n=b.getPlatform().atob(e);return new t(n)}catch(r){throw new T(w.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+r)}},t.fromUint8Array=function(e){if(O("Blob.fromUint8Array",arguments,1),at(),!(e instanceof Uint8Array))throw X("Blob.fromUint8Array","Uint8Array",1,e);var n=Array.prototype.map.call(e,(function(t){return String.fromCharCode(t)})).join("");return new t(n)},t.prototype.toBase64=function(){return O("Blob.toBase64",arguments,0),st(),b.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){O("Blob.toUint8Array",arguments,0),at();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._binaryString===t._binaryString},t.prototype._compareTo=function(t){return nt(this._binaryString,t._binaryString)},t}(),ht=E(ct,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),lt=function(){function t(t,e,n,r,i){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}return t}(),ft="(default)",pt=function(){function t(t,e){this.projectId=t,this.database=e||ft}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===ft},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return nt(this.projectId,t.projectId)||nt(this.database,t.database)},t}(),dt=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.setPreviousValue(t)},this.writeNewSequenceNumber=function(t){return e.writeSequenceNumber(t)})}return t.prototype.setPreviousValue=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t},t.INVALID=-1,t}(),mt="__name__",yt=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&g("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&g("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,v(this.length>=t,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return v(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return v(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return v(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(t.indexOf("//")>=0)throw new T(w.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");var n=t.split("/").filter((function(t){return t.length>0}));return new e(n)},e.EMPTY_PATH=new e([]),e}(yt),vt=/^[_a-zA-Z][_a-zA-Z0-9]*$/,bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return vt.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&this.get(0)===mt},e.keyField=function(){return new e([mt])},e.fromServerFormat=function(t){var n=[],r="",i=0,o=function(){if(0===r.length)throw new T(w.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;while(i<t.length){var s=t[i];if("\\"===s){if(i+1===t.length)throw new T(w.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new T(w.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new T(w.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(yt),_t=function(){function t(e){this.path=e,v(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===gt.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return gt.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2===0},t.fromSegments=function(e){return new t(new gt(e.slice()))},t.fromPathString=function(e){return new t(gt.fromString(e))},t.EMPTY=new t(new gt([])),t}(),wt=function(){function t(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t}();(function(t){t["All"]="all",t["ListenStreamIdle"]="listen_stream_idle",t["ListenStreamConnectionBackoff"]="listen_stream_connection_backoff",t["WriteStreamIdle"]="write_stream_idle",t["WriteStreamConnectionBackoff"]="write_stream_connection_backoff",t["OnlineStateTimeout"]="online_state_timeout",t["ClientMetadataRefresh"]="client_metadata_refresh",t["LruGarbageCollection"]="lru_garbage_collection",t["RetryTransaction"]="retry_transaction"})(ut||(ut={}));var Tt=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new wt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var a=Date.now()+r,s=new t(e,n,a,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new T(w.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}(),Et=function(){function t(){this.tail=Promise.resolve(),this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.timerIdsToSkip=[]}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._isShuttingDown},enumerable:!0,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenAfterShutdown=function(t){this.verifyNotFailed(),this.enqueueInternal(t)},t.prototype.enqueueEvenAfterShutdown=function(t){return this.verifyNotFailed(),this.enqueueInternal(t)},t.prototype.enqueueAndInitiateShutdown=function(t){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return this.verifyNotFailed(),this._isShuttingDown?[3,2]:(this._isShuttingDown=!0,[4,this.enqueueEvenAfterShutdown(t)]);case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.enqueue=function(t){return this.verifyNotFailed(),this._isShuttingDown?new Promise((function(t){})):this.enqueueInternal(t)},t.prototype.enqueueInternal=function(t){var e=this,n=this.tail.then((function(){return e.operationInProgress=!0,t().catch((function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||"";throw m("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout((function(){throw t}),0),t})).then((function(t){return e.operationInProgress=!1,t}))}));return this.tail=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.verifyNotFailed(),v(e>=0,"Attempted to schedule an operation with a negative delay of "+e),this.timerIdsToSkip.indexOf(t)>-1&&(e=0);var i=Tt.createAndSchedule(this,t,e,n,(function(t){return r.removeDelayedOperation(t)}));return this.delayedOperations.push(i),i},t.prototype.verifyNotFailed=function(){this.failure&&g("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},t.prototype.verifyOperationInProgress=function(){v(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.drain=function(){return this.enqueueEvenAfterShutdown((function(){return Promise.resolve()}))},t.prototype.containsDelayedOperation=function(t){for(var e=0,n=this.delayedOperations;e<n.length;e++){var r=n[e];if(r.timerId===t)return!0}return!1},t.prototype.runDelayedOperationsEarly=function(t){var e=this;return this.drain().then((function(){v(t===ut.All||e.containsDelayedOperation(t),"Attempted to drain to missing operation "+t),e.delayedOperations.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),t!==ut.All&&i.timerId===t)break}return e.drain()}))},t.prototype.skipDelaysForTimerId=function(t){this.timerIdsToSkip.push(t)},t.prototype.removeDelayedOperation=function(t){var e=this.delayedOperations.indexOf(t);v(e>=0,"Delayed operation not found."),this.delayedOperations.splice(e,1)},t}(),St="",Ct="",It="",At="";function Nt(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Dt(e)),e=kt(t.get(n),e);return Dt(e)}function kt(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=St+It;break;case St:n+=St+At;break;default:n+=o}}return n}function Dt(t){return t+St+Ct}function xt(t){var e=t.length;if(v(e>=2,"Invalid path "+t),2===e)return v(t.charAt(0)===St&&t.charAt(1)===Ct,"Non-empty path "+t+" had length 2"),gt.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf(St,o);(a<0||a>n)&&g('Invalid encoded resource path: "'+t+'"');var s=t.charAt(a+1);switch(s){case Ct:var u=t.substring(o,a),c=void 0;0===i.length?c=u:(i+=u,c=i,i=""),r.push(c);break;case It:i+=t.substring(o,a),i+="\0";break;case At:i+=t.substring(o,a+1);break;default:g('Invalid encoded resource path: "'+t+'"')}o=a+2}return new gt(r)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ot=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new T(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new T(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new T(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new T(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3),r=1e6*(e-1e3*n);return new t(n,r)},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?nt(this.nanoseconds,t.nanoseconds):nt(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t}(),Rt=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6),r=e%1e6*1e3;return new t(new Ot(n,r))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new Ot(0,0)),t}(),Mt=function(){function t(t,e){this.comparator=t,this.root=e||Lt.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Lt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Lt.BLACK,null,null))},t.prototype.get=function(t){var e=this.root;while(!e.isEmpty()){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){var e=0,n=this.root;while(!n.isEmpty()){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Pt(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Pt(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Pt(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Pt(this.root,t,this.comparator,!0)},t}(),Pt=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];var i=1;while(!t.isEmpty())if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){v(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse){t=t.left;while(!t.isEmpty())this.nodeStack.push(t),t=t.right}else{t=t.right;while(!t.isEmpty())this.nodeStack.push(t),t=t.left}return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Lt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw g("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw g("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw g("Black depths differ");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),Ft=function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw g("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw g("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw g("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw g("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw g("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Lt(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Lt.EMPTY=new Ft;
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ut=function(){function t(t){this.comparator=t,this.data=new Mt(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach((function(t){n=n.add(t)})),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){var n=this.data.getIteratorFrom(t[0]);while(n.hasNext()){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();while(n.hasNext()){var r=n.getNext(),i=t(r.key);if(!i)return}},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new qt(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new qt(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;var n=this.data.getIterator(),r=e.data.getIterator();while(n.hasNext()){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),qt=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Vt=new Mt(_t.comparator);function Bt(){return Vt}function jt(){return Bt()}var Wt=new Mt(_t.comparator);function Kt(){return Wt}var zt=new Mt(_t.comparator);function Gt(){return zt}var Qt=new Ut(_t.comparator);function Ht(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Qt,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Yt=new Ut(nt);function $t(){return Yt}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xt=-1,Jt=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r,v(r.length>0,"Cannot create an empty mutation batch")}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&v(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;v(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var a=r[i];e=o.applyToRemoteDocument(e,a)}}return e},t.prototype.applyToLocalView=function(t,e){e&&v(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=i.applyToLocalView(e,e,this.localWriteTime))}for(var o=e,a=0,s=this.mutations;a<s.length;a++){i=s[a];i.key.isEqual(t)&&(e=i.applyToLocalView(e,o,this.localWriteTime))}return e},t.prototype.applyToLocalDocumentSet=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.applyToLocalView(r.key,t.get(r.key));i&&(n=n.insert(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Ht())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&it(this.mutations,t.mutations)&&it(this.baseMutations,t.baseMutations)},t}(),Zt=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){v(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=Gt(),a=e.mutations,s=0;s<a.length;s++)o=o.insert(a[s].key,r[s].version);return new t(e,n,r,i,o)},t}(),te=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&g("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(r){return t.reject(r)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++){var a=o[i];r(a)}return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),ee="SimpleDb",ne=3,re=function(){function e(t){this.db=t;var n=e.getIOSVersion(u.getUA());12.2===n&&m("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.openOrCreate=function(t,n,r){return v(e.isAvailable(),"IndexedDB not supported in current environment."),d(ee,"Opening database:",t),new te((function(i,o){var a=window.indexedDB.open(t,n);a.onsuccess=function(t){var n=t.target.result;i(new e(n))},a.onblocked=function(){o(new T(w.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=function(t){var e=t.target.error;"VersionError"===e.name?o(new T(w.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o(e)},a.onupgradeneeded=function(e){d(ee,'Database "'+t+'" requires upgrade from version:',e.oldVersion);var n=e.target.result;r.createOrUpgrade(n,a.transaction,e.oldVersion,yn).next((function(){d(ee,"Database upgrade to version "+yn+" complete")}))}})).toPromise()},e.delete=function(t){return d(ee,"Removing database:",t),se(window.indexedDB.deleteDatabase(t)).toPromise()},e.isAvailable=function(){if("undefined"===typeof window||null==window.indexedDB)return!1;if(e.isMockPersistence())return!0;if(void 0===window.navigator)return!1;var t=u.getUA(),n=e.getIOSVersion(t),r=0<n&&n<10,i=e.getAndroidVersion(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||o)},e.isMockPersistence=function(){return"undefined"!==typeof t&&"YES"===Object({NODE_ENV:"production",BASE_URL:"/"}).USE_MOCK_PERSISTENCE},e.getStore=function(t,e){return t.store(e)},e.getIOSVersion=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.getAndroidVersion=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.setVersionChangeListener=function(t){this.db.onversionchange=function(e){return t(e)}},e.prototype.runTransaction=function(t,e,n){return a.__awaiter(this,void 0,void 0,(function(){var r,i,o,s,u,c;return a.__generator(this,(function(h){switch(h.label){case 0:r=t.startsWith("readonly"),i=t.endsWith("idempotent"),o=0,s=function(){var t,s,c,h;return a.__generator(this,(function(a){switch(a.label){case 0:++o,t=oe.open(u.db,r?"readonly":"readwrite",e),a.label=1;case 1:return a.trys.push([1,3,,4]),s=n(t).catch((function(e){return t.abort(e),te.reject(e)})).toPromise(),s.catch((function(){})),[4,t.completionPromise];case 2:return a.sent(),[2,{value:s}];case 3:return c=a.sent(),h=i&&"FirebaseError"!==c.name&&o<ne,d(ee,"Transaction failed with error: %s. Retrying: %s.",c.message,h),h?[3,4]:[2,{value:Promise.reject(c)}];case 4:return[2]}}))},u=this,h.label=1;case 1:return[5,s()];case 2:return c=h.sent(),"object"===typeof c?[2,c.value]:[3,1];case 3:return[2]}}))}))},e.prototype.close=function(){this.db.close()},e}(),ie=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return se(this.dbCursor.delete())},t}(),oe=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.completionDeferred=new wt,this.transaction.oncomplete=function(){e.completionDeferred.resolve()},this.transaction.onabort=function(){t.error?e.completionDeferred.reject(t.error):e.completionDeferred.resolve()},this.transaction.onerror=function(t){var n=ce(t.target.error);e.completionDeferred.reject(n)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.completionDeferred.reject(t),this.aborted||(d(ee,"Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return v(!!e,"Object store not part of transaction: "+t),new ae(e)},t}(),ae=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(d(ee,"PUT",this.store.name,t,e),n=this.store.put(e,t)):(d(ee,"PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),se(n)},t.prototype.add=function(t){d(ee,"ADD",this.store.name,t,t);var e=this.store.add(t);return se(e)},t.prototype.get=function(t){var e=this,n=this.store.get(t);return se(n).next((function(n){return void 0===n&&(n=null),d(ee,"GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){d(ee,"DELETE",this.store.name,t);var e=this.store.delete(t);return se(e)},t.prototype.count=function(){d(ee,"COUNT",this.store.name);var t=this.store.count();return se(t)},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.deleteAll=function(t,e){d(ee,"DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,(function(t,e,n){return n.delete()}))},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateSerial=function(t){var e=this.cursor({});return new te((function(n,r){e.onerror=function(t){var e=ce(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.iterateCursor=function(t,e){var n=[];return new te((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new ie(i),a=e(i.primaryKey,i.value,o);if(a instanceof te){var s=a.catch((function(t){return o.done(),te.reject(t)}));n.push(s)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}})).next((function(){return te.waitFor(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"===typeof t?n=t:(v(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function se(t){return new te((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=ce(t.target.error);n(e)}}))}var ue=!1;function ce(t){var e=re.getIOSVersion(u.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new T("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ue||(ue=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var he=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}return t.forUser=function(e,n,r,i){v(""!==e.uid,"UserID must not be an empty string.");var o=e.isAuthenticated()?e.uid:"";return new t(o,n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return me(t).iterate({index:En.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.acknowledgeBatch=function(t,e,n){return this.getMutationQueueMetadata(t).next((function(e){return e.lastStreamToken=de(n),ge(t).put(e)}))},t.prototype.getLastStreamToken=function(t){return this.getMutationQueueMetadata(t).next((function(t){return t.lastStreamToken}))},t.prototype.setLastStreamToken=function(t,e){return this.getMutationQueueMetadata(t).next((function(n){return n.lastStreamToken=de(e),ge(t).put(n)}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=ye(t),a=me(t);return a.add({}).next((function(s){v("number"===typeof s,"Auto-generated key is not a number");for(var u=new Jt(s,e,n,r),c=i.serializer.toDbMutationBatch(i.userId,u),h=[],l=new Ut((function(t,e){return nt(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],m=In.key(i.userId,d.key.path,s);l=l.add(d.key.path.popLast()),h.push(a.put(c)),h.push(o.put(m,In.PLACEHOLDER))}return l.forEach((function(e){h.push(i.indexManager.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.documentKeysByBatchId[s]=u.keys()})),te.waitFor(h).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return me(t).get(e).next((function(t){return t?(v(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),n.serializer.fromDbMutationBatch(t)):null}))},t.prototype.lookupMutationKeys=function(t,e){var n=this;return this.documentKeysByBatchId[e]?te.resolve(this.documentKeysByBatchId[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.documentKeysByBatchId[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return me(t).iterate({index:En.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(v(e.batchId>=r,"Should have found mutation after "+r),o=n.serializer.fromDbMutationBatch(e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=Xt;return me(t).iterate({index:En.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,Xt],[this.userId,Number.POSITIVE_INFINITY]);return me(t).loadAll(En.userMutationsIndex,n).next((function(t){return t.map((function(t){return e.serializer.fromDbMutationBatch(t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=In.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return ye(t).iterate({range:i},(function(r,i,a){var s=r[0],u=r[1],c=r[2],h=xt(u);if(s===n.userId&&e.path.isEqual(h))return me(t).get(c).next((function(t){if(!t)throw g("Dangling document-mutation reference found: "+r+" which points to "+c);v(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+c),o.push(n.serializer.fromDbMutationBatch(t))}));a.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Ut(nt),i=[];return e.forEach((function(e){var o=In.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=ye(t).iterate({range:a},(function(t,i,o){var a=t[0],s=t[1],u=t[2],c=xt(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(s)})),te.waitFor(i).next((function(){return n.lookupMutationBatches(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;v(!e.isDocumentQuery(),"Document queries shouldn't go down this path"),v(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=e.path,i=r.length+1,o=In.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Ut(nt);return ye(t).iterate({range:a},(function(t,e,o){var a=t[0],u=t[1],c=t[2],h=xt(u);a===n.userId&&r.isPrefixOf(h)?h.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.lookupMutationBatches(t,s)}))},t.prototype.lookupMutationBatches=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(me(t).get(e).next((function(t){if(null===t)throw g("Dangling document-mutation reference found, which points to "+e);v(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),r.push(n.serializer.fromDbMutationBatch(t))})))})),te.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return pe(t.simpleDbTransaction,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.removeCachedMutationKeys(e.batchId)})),te.forEach(r,(function(e){return n.referenceDelegate.removeMutationReference(t,e)}))}))},t.prototype.removeCachedMutationKeys=function(t){delete this.documentKeysByBatchId[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return te.resolve();var r=IDBKeyRange.lowerBound(In.prefixForUser(e.userId)),i=[];return ye(t).iterate({range:r},(function(t,n,r){var o=t[0];if(o===e.userId){var a=xt(t[1]);i.push(a)}else r.done()})).next((function(){v(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map((function(t){return t.canonicalString()})))}))}))},t.prototype.containsKey=function(t,e){return le(t,this.userId,e)},t.prototype.getMutationQueueMetadata=function(t){var e=this;return ge(t).get(this.userId).next((function(t){return t||new Tn(e.userId,Xt,"")}))},t}();function le(t,e,n){var r=In.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return ye(t).iterate({range:o,keysOnly:!0},(function(t,n,r){var o=t[0],s=t[1];t[2];o===e&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function fe(t,e){var n=!1;return ge(t).iterateSerial((function(r){return le(t,r,e).next((function(t){return t&&(n=!0),te.resolve(!t)}))})).next((function(){return n}))}function pe(t,e,n){var r=t.store(En.store),i=t.store(In.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.iterate({range:a},(function(t,e,n){return s++,n.delete()}));o.push(u.next((function(){v(1===s,"Dangling document-mutation reference found: Missing batch "+n.batchId)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=In.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return te.waitFor(o).next((function(){return c}))}function de(t){return t instanceof Uint8Array?(v(re.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence."),t.toString()):t}function me(t){return _r.getStore(t,En.store)}function ye(t){return _r.getStore(t,In.store)}function ge(t){return _r.getStore(t,Tn.store)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ve,be=1;(function(t){t[t["QueryCache"]=0]="QueryCache",t[t["SyncEngine"]=1]="SyncEngine"})(ve||(ve={}));var _e=function(){function t(t,e){this.generatorId=t,v((t&be)===t,"Generator ID "+t+" contains more than "+be+" reserved bits"),this.seek(void 0!==e?e:this.generatorId)}return t.prototype.next=function(){var t=this.nextId;return this.nextId+=1<<be,t},t.prototype.after=function(t){return this.seek(t+(1<<be)),this.next()},t.prototype.seek=function(t){v((t&be)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=t},t.forTargetCache=function(){var e=new t(ve.QueryCache,2);return e},t.forSyncEngine=function(){return new t(ve.SyncEngine)},t}(),we=function(){function t(t,e){this.referenceDelegate=t,this.serializer=e,this.targetIdGenerator=_e.forTargetCache()}return t.prototype.allocateTargetId=function(t){var e=this;return this.retrieveMetadata(t).next((function(n){return n.highestTargetId=e.targetIdGenerator.after(n.highestTargetId),e.saveMetadata(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.retrieveMetadata(t).next((function(t){return Rt.fromTimestamp(new Ot(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return Ce(t.simpleDbTransaction)},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.retrieveMetadata(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.saveMetadata(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.saveTargetData(t,e).next((function(){return n.retrieveMetadata(t).next((function(r){return r.targetCount+=1,n.updateMetadataFromTargetData(e,r),n.saveMetadata(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.saveTargetData(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return Te(t).delete(e.targetId)})).next((function(){return n.retrieveMetadata(t)})).next((function(e){return v(e.targetCount>0,"Removing from an empty target cache"),e.targetCount-=1,n.saveMetadata(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Te(t).iterate((function(a,s){var u=r.serializer.fromDbTarget(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return te.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){var n=this;return Te(t).iterate((function(t,r){var i=n.serializer.fromDbTarget(r);e(i)}))},t.prototype.retrieveMetadata=function(t){return Se(t.simpleDbTransaction)},t.prototype.saveMetadata=function(t,e){return Ee(t).put(Pn.key,e)},t.prototype.saveTargetData=function(t,e){return Te(t).put(this.serializer.toDbTarget(e))},t.prototype.updateMetadataFromTargetData=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.retrieveMetadata(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Te(t).iterate({range:i,index:Rn.queryTargetsIndexName},(function(t,r,i){var a=n.serializer.fromDbTarget(r);e.isEqual(a.target)&&(o=a,i.done())})).next((function(){return o}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Ie(t);return e.forEach((function(e){var a=Nt(e.path);i.push(o.put(new Mn(n,a))),i.push(r.referenceDelegate.addReference(t,e))})),te.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Ie(t);return te.forEach(e,(function(e){var o=Nt(e.path);return te.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Ie(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Ie(t),i=Ht();return r.iterate({range:n,keysOnly:!0},(function(t,e,n){var r=xt(t[1]),o=new _t(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=Nt(e.path),r=IDBKeyRange.bound([n],[ot(n)],!1,!0),i=0;return Ie(t).iterate({index:Mn.documentTargetsIndex,keysOnly:!0,range:r},(function(t,e,n){var r=t[0];t[1];0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.getTargetDataForTarget=function(t,e){var n=this;return Te(t).get(e).next((function(t){return t?n.serializer.fromDbTarget(t):null}))},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Te(t){return _r.getStore(t,Rn.store)}function Ee(t){return _r.getStore(t,Pn.store)}function Se(t){var e=re.getStore(t,Pn.store);return e.get(Pn.key).next((function(t){return v(null!==t,"Missing metadata row."),t}))}function Ce(t){return Se(t).next((function(t){return t.highestListenSequenceNumber}))}function Ie(t){return _r.getStore(t,Mn.store)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ae,Ne=function(){function t(t){this.fields=t}return t.fromSet=function(e){return new t(e)},t.fromArray=function(e){var n=new Ut(bt.comparator);return e.forEach((function(t){return n=n.add(t)})),new t(n)},t.prototype.covers=function(t){var e=!1;return this.fields.forEach((function(n){n.isPrefixOf(t)&&(e=!0)})),e},t.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},t}(),ke=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),De=function(){function t(t,e){this.version=t,this.transformResults=e}return t}();(function(t){t[t["Set"]=0]="Set",t[t["Patch"]=1]="Patch",t[t["Transform"]=2]="Transform",t[t["Delete"]=3]="Delete"})(Ae||(Ae={}));var xe,Oe,Re=function(){function t(t,e){this.updateTime=t,this.exists=e,v(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof rn&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof rn:(v(this.isNone,"Precondition should be empty"),!0)},t.prototype.isEqual=function(t){return rt(this.updateTime,t.updateTime)&&this.exists===t.exists},t.NONE=new t,t}(),Me=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&v(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},t.getPostMutationVersion=function(t){return t instanceof rn?t.version:Rt.MIN},t}(),Pe=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=Ae.Set,i}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),v(null==e.transformResults,"Transform results received by SetMutation.");var n=e.version;return new rn(this.key,n,{hasCommittedMutations:!0},this.value)},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=Me.getPostMutationVersion(t);return new rn(this.key,r,{hasLocalMutations:!0},this.value)},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.precondition.isEqual(t.precondition)},e}(Me),Le=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=Ae.Patch,o}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),v(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return new an(this.key,e.version);var n=this.patchDocument(t);return new rn(this.key,e.version,{hasCommittedMutations:!0},n)},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=Me.getPostMutationVersion(t),i=this.patchDocument(t);return new rn(this.key,r,{hasLocalMutations:!0},i)},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.fieldMask.isEqual(t.fieldMask)&&this.precondition.isEqual(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof rn?t.data():tn.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){var e=this;return this.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t=null!==r?t.set(n,r):t.delete(n)}})),t},e}(Me),Fe=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=Ae.Transform,r.precondition=Re.exists(!0),r}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),v(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(t))return new an(this.key,e.version);var n=this.requireDocument(t),r=this.serverTransformResults(t,e.transformResults),i=e.version,o=this.transformObject(n.data(),r);return new rn(this.key,i,{hasCommittedMutations:!0},o)},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.localTransformResults(n,t,e),o=this.transformObject(r.data(),i);return new rn(this.key,r.version,{hasLocalMutations:!0},o)},e.prototype.extractBaseValue=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof rn?t.field(i.field):void 0,a=i.transform.computeBaseValue(o||null);null!=a&&(e=null==e?tn.EMPTY.set(i.field,a):e.set(i.field,a))}return e},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&it(this.fieldTransforms,t.fieldTransforms)&&this.precondition.isEqual(t.precondition)},e.prototype.requireDocument=function(t){v(t instanceof rn,"Unknown MaybeDocument type "+t);var e=t;return v(e.key.isEqual(this.key),"Can only transform a document with the same key"),e},e.prototype.serverTransformResults=function(t,e){var n=[];v(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;t instanceof rn&&(a=t.field(i.field)),n.push(o.applyToRemoteDocument(a,e[r]))}return n},e.prototype.localTransformResults=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var a=o[i],s=a.transform,u=null;e instanceof rn&&(u=e.field(a.field)),null===u&&n instanceof rn&&(u=n.field(a.field)),r.push(s.applyToLocalView(u,t))}return r},e.prototype.transformObject=function(t,e){v(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n],i=r.field;t=t.set(i,e[n])}return t},e}(Me),Ue=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=Ae.Delete,r}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),v(null==e.transformResults,"Transform results received by DeleteMutation."),new on(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&v(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new on(this.key,Rt.forDeletedDoc())):t},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},e}(Me);(function(t){t[t["NullValue"]=0]="NullValue",t[t["BooleanValue"]=1]="BooleanValue",t[t["NumberValue"]=2]="NumberValue",t[t["TimestampValue"]=3]="TimestampValue",t[t["StringValue"]=4]="StringValue",t[t["BlobValue"]=5]="BlobValue",t[t["RefValue"]=6]="RefValue",t[t["GeoPointValue"]=7]="GeoPointValue",t[t["ArrayValue"]=8]="ArrayValue",t[t["ObjectValue"]=9]="ObjectValue"})(xe||(xe={})),function(t){t[t["Default"]=0]="Default",t[t["Estimate"]=1]="Estimate",t[t["Previous"]=2]="Previous"}(Oe||(Oe={}));var qe=function(){function t(t,e){this.serverTimestampBehavior=t,this.timestampsInSnapshots=e}return t.fromSnapshotOptions=function(e,n){switch(e.serverTimestamps){case"estimate":return new t(Oe.Estimate,n);case"previous":return new t(Oe.Previous,n);case"none":case void 0:return new t(Oe.Default,n);default:return g("fromSnapshotOptions() called with invalid options.")}},t}(),Ve=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},t.prototype.defaultCompareTo=function(t){v(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type.");var e=nt(this.typeOrder,t.typeOrder);return e},t}(),Be=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=xe.NullValue,e.internalValue=null,e}return a.__extends(e,t),e.prototype.value=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.INSTANCE=new e,e}(Ve),je=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=xe.BooleanValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?nt(this,t):this.defaultCompareTo(t)},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(Ve),We=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=xe.NumberValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?Ke(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(Ve);function Ke(t,e){return t<e?-1:t>e?1:t===e?0:isNaN(t)?isNaN(e)?0:-1:1}function ze(t,e){return t===e?0!==t||1/t===1/e:t!==t&&e!==e}var Ge=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&ze(this.internalValue,t.internalValue)},e}(We),Qe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&ze(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(We),He=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=xe.StringValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?nt(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(Ve),Ye=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=xe.TimestampValue,n}return a.__extends(e,t),e.prototype.value=function(t){return!t||t.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):t instanceof $e?-1:this.defaultCompareTo(t)},e}(Ve),$e=function(t){function e(e,n){var r=t.call(this)||this;return r.localWriteTime=e,r.previousValue=n,r.typeOrder=xe.TimestampValue,r}return a.__extends(e,t),e.prototype.value=function(t){return t&&t.serverTimestampBehavior===Oe.Estimate?new Ye(this.localWriteTime).value(t):t&&t.serverTimestampBehavior===Oe.Previous&&this.previousValue?this.previousValue.value(t):null},e.prototype.isEqual=function(t){return t instanceof e&&this.localWriteTime.isEqual(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime._compareTo(t.localWriteTime):t instanceof Ye?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},e}(Ve),Xe=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=xe.BlobValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Ve),Je=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=xe.RefValue,r}return a.__extends(e,t),e.prototype.value=function(t){return this.key},e.prototype.isEqual=function(t){return t instanceof e&&(this.key.isEqual(t.key)&&this.databaseId.isEqual(t.databaseId))},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:_t.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e}(Ve),Ze=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=xe.GeoPointValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Ve),tn=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=xe.ObjectValue,n}return a.__extends(e,t),e.prototype.value=function(t){var e={};return this.internalValue.inorderTraversal((function(n,r){e[n]=r.value(t)})),e},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.isEqual=function(t){if(t instanceof e){var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();while(n.hasNext()&&r.hasNext()){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();while(n.hasNext()&&r.hasNext()){var i=n.getNext(),o=r.getNext(),a=nt(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return nt(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(v(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(v(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return null!==this.field(t)},e.prototype.field=function(t){v(!t.isEmpty(),"Can't get field of empty path");var n=this;return t.forEach((function(t){n=n instanceof e?n.internalValue.get(t):null})),n},e.prototype.fieldMask=function(){var t=new Ut(bt.comparator);return this.internalValue.forEach((function(n,r){var i=new bt([n]);if(r instanceof e){var o=r.fieldMask(),a=o.fields;a.isEmpty()?t=t.add(i):a.forEach((function(e){t=t.add(i.child(e))}))}else t=t.add(i)})),Ne.fromSet(t)},e.prototype.toString=function(){return this.internalValue.toString()},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new Mt(nt)),e}(Ve),en=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=xe.ArrayValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue.map((function(e){return e.value(t)}))},e.prototype.contains=function(t){for(var e=0,n=this.internalValue;e<n.length;e++){var r=n[e];if(r.isEqual(t))return!0}return!1},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.isEqual=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return nt(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.toString=function(){var t=this.internalValue.map((function(t){return t.toString()}));return"["+t.join(",")+"]"},e}(Ve),nn=function(){function t(t,e){this.key=t,this.version=e}return t.compareByKey=function(t,e){return _t.comparator(t.key,e.key)},t}(),rn=function(t){function e(e,n,r,i,o,a){var s=t.call(this,e,n)||this;return s.objectValue=i,s.proto=o,s.converter=a,v(void 0!==s.objectValue||void 0!==s.proto&&void 0!==s.converter,"If objectValue is not defined, proto and converter need to be set."),s.hasLocalMutations=!!r.hasLocalMutations,s.hasCommittedMutations=!!r.hasCommittedMutations,s}return a.__extends(e,t),e.prototype.field=function(t){if(this.objectValue)return this.objectValue.field(t);this.fieldValueCache||(this.fieldValueCache=new Map);var e=t.canonicalString(),n=this.fieldValueCache.get(e);if(void 0===n){var r=this.getProtoField(t);n=void 0===r?null:this.converter(r),this.fieldValueCache.set(e,n)}return n},e.prototype.data=function(){var t=this;if(!this.objectValue){var e=tn.EMPTY;N(this.proto.fields||{},(function(n,r){e=e.set(new bt([n]),t.converter(r))})),this.objectValue=e,this.fieldValueCache=void 0}return this.objectValue},e.prototype.value=function(){return this.data().value()},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.hasLocalMutations===t.hasLocalMutations&&this.hasCommittedMutations===t.hasCommittedMutations&&this.data().isEqual(t.data())},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data().toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.getProtoField=function(t){v(void 0!==this.proto,"Can only call getProtoField() when proto is defined");for(var e=this.proto.fields?this.proto.fields[t.firstSegment()]:void 0,n=1;n<t.length;++n){if(!e||!e.mapValue||!e.mapValue.fields)return;e=e.mapValue.fields[t.get(n)]}return e},e.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?r.compareTo(i):g("Trying to compare documents on fields that don't exist")},e}(nn),on=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return a.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(nn),an=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(nn),sn=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.isEqual(t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){N(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}}))},t.prototype.isEmpty=function(){return k(this.inner)},t}(),un=function(){function t(){this.changes=new sn((function(t){return t.toString()})),this.changesApplied=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return v(void 0!==this._readTime,"Read time is not set. All removeEntry() calls must include a readTime if `trackRemovals` is used."),this._readTime},set:function(t){v(void 0===this._readTime||this._readTime.isEqual(t),"All changes in a RemoteDocumentChangeBuffer must have the same read time"),this._readTime=t},enumerable:!0,configurable:!0}),t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.readTime=e,this.changes.set(t.key,t)},t.prototype.removeEntry=function(t,e){this.assertNotApplied(),e&&(this.readTime=e),this.changes.set(t,null)},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?te.resolve(n):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){v(!this.changesApplied,"Changes have already been applied.")},t}(),cn=function(){function t(t,e){this.serializer=t,this.indexManager=e}return t.prototype.addEntry=function(t,e,n){var r=ln(t);return r.put(fn(e),n)},t.prototype.removeEntry=function(t,e){var n=ln(t),r=fn(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.setMetadata(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return ln(t).get(fn(e)).next((function(t){return n.maybeDecodeDocument(t)}))},t.prototype.getSizedEntry=function(t,e){var n=this;return ln(t).get(fn(e)).next((function(t){var e=n.maybeDecodeDocument(t);return e?{maybeDocument:e,size:pn(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=jt();return this.forEachDbEntry(t,e,(function(t,e){var i=n.maybeDecodeDocument(e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.getSizedEntries=function(t,e){var n=this,r=jt(),i=new Mt(_t.comparator);return this.forEachDbEntry(t,e,(function(t,e){var o=n.maybeDecodeDocument(e);o?(r=r.insert(t,o),i=i.insert(t,pn(e))):(r=r.insert(t,null),i=i.insert(t,0))})).next((function(){return{maybeDocuments:r,sizeMap:i}}))},t.prototype.forEachDbEntry=function(t,e,n){if(e.isEmpty())return te.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return ln(t).iterate({range:r},(function(t,e,r){var a=_t.fromSegments(t);while(o&&_t.comparator(o,a)<0)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.skip(o.path.toArray()):r.done()})).next((function(){while(o)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this;v(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var i=Kt(),o=e.path.length+1,a={};if(n.isEqual(Rt.MIN)){var s=e.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.toArray(),c=this.serializer.toDbTimestampKey(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=Dn.collectionReadTimeIndex}return ln(t).iterate(a,(function(t,n,a){if(t.length===o){var s=r.serializer.fromDbRemoteDocument(n);e.path.isPrefixOf(s.key.path)?s instanceof rn&&e.matches(s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},t.prototype.getNewDocumentChanges=function(t,e){var n=this,r=Bt(),i=this.serializer.toDbTimestampKey(e),o=ln(t),a=IDBKeyRange.lowerBound(i,!0);return o.iterate({index:Dn.readTimeIndex,range:a},(function(t,e){var o=n.serializer.fromDbRemoteDocument(e);r=r.insert(o.key,o),i=e.readTime})).next((function(){return{changedDocs:r,readTime:n.serializer.fromDbTimestampKey(i)}}))},t.prototype.getLastDocumentChange=function(t){var e,n=this,r=ln(t),i=Rt.MIN;return r.iterate({index:Dn.readTimeIndex,reverse:!0},(function(t,r,o){e=n.serializer.fromDbRemoteDocument(r),r.readTime&&(i=n.serializer.fromDbTimestampKey(r.readTime)),o.done()})).next((function(){return{changedDoc:e,readTime:i}}))},t.prototype.newChangeBuffer=function(e){return new t.RemoteDocumentChangeBuffer(this,!!e&&e.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return hn(t).get(xn.key).next((function(t){return v(!!t,"Missing document cache metadata"),t}))},t.prototype.setMetadata=function(t,e){return hn(t).put(xn.key,e)},t.prototype.maybeDecodeDocument=function(t){if(t){var e=this.serializer.fromDbRemoteDocument(t);return e instanceof on&&e.version.isEqual(Rt.forDeletedDoc())?null:e}return null},t.RemoteDocumentChangeBuffer=function(t){function e(e,n){var r=t.call(this)||this;return r.documentCache=e,r.trackRemovals=n,r.documentSizes=new sn((function(t){return t.toString()})),r}return a.__extends(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Ut((function(t,e){return nt(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,a){var s=e.documentSizes.get(o);if(v(void 0!==s,"Cannot modify a document that wasn't read (for "+o+")"),a){v(!e.readTime.isEqual(Rt.MIN),"Cannot add a document with a read time of zero");var u=e.documentCache.serializer.toDbRemoteDocument(a,e.readTime);i=i.add(o.path.popLast());var c=pn(u);r+=c-s,n.push(e.documentCache.addEntry(t,o,u))}else if(r-=s,e.trackRemovals){var h=e.documentCache.serializer.toDbRemoteDocument(new on(o,Rt.forDeletedDoc()),e.readTime);n.push(e.documentCache.addEntry(t,o,h))}else n.push(e.documentCache.removeEntry(t,o))})),i.forEach((function(r){n.push(e.documentCache.indexManager.addToCollectionParentIndex(t,r))})),n.push(this.documentCache.updateMetadata(t,r)),te.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.documentCache.getSizedEntry(t,e).next((function(t){return null===t?(n.documentSizes.set(e,0),null):(n.documentSizes.set(e,t.size),t.maybeDocument)}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.documentCache.getSizedEntries(t,e).next((function(t){var e=t.maybeDocuments,r=t.sizeMap;return r.forEach((function(t,e){n.documentSizes.set(t,e)})),e}))},e}(un),t}();function hn(t){return _r.getStore(t,xn.store)}function ln(t){return _r.getStore(t,Dn.store)}function fn(t){return t.path.toArray()}function pn(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw g("Unknown remote document type");e=t.noDocument}return JSON.stringify(e).length}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dn=function(){function t(){this.collectionParentIndex=new mn}return t.prototype.addToCollectionParentIndex=function(t,e){return this.collectionParentIndex.add(e),te.resolve()},t.prototype.getCollectionParents=function(t,e){return te.resolve(this.collectionParentIndex.getEntries(e))},t}(),mn=function(){function t(){this.index={}}return t.prototype.add=function(t){v(t.length%2===1,"Expected a collection path.");var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Ut(gt.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){var e=this.index[t]||new Ut(gt.comparator);return e.toArray()},t}(),yn=9,gn=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;v(n<r&&n>=0&&r<=yn,"Unexpected schema upgrade from v"+n+" to v{toVersion}.");var o=new oe(e);n<1&&r>=1&&(wn(t),Sn(t),Fn(t),An(t));var a=te.resolve();return n<3&&r>=3&&(0!==n&&(Un(t),Fn(t)),a=a.next((function(){return Vn(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return Cn(t,o)}))),a=a.next((function(){Wn(t)}))),n<5&&r>=5&&(a=a.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(a=a.next((function(){return On(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(a=a.next((function(){qn(t),Bn(e)}))),a},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Dn.store).iterate((function(t,n){e+=pn(n)})).next((function(){var n=new xn(e);return t.store(xn.store).put(xn.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Tn.store),r=t.store(En.store);return n.loadAll().next((function(n){return te.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,Xt],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(En.userMutationsIndex,i).next((function(r){return te.forEach(r,(function(r){v(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=e.serializer.fromDbMutationBatch(r);return pe(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Mn.store),n=t.store(Dn.store);return Ce(t).next((function(t){var r=function(n){return e.put(new Mn(0,Nt(n),t))},i=[];return n.iterate((function(t,n){var o=new gt(t),a=vn(o);i.push(e.get(a).next((function(t){return t?te.resolve():r(o)})))})).next((function(){return te.waitFor(i)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Ln.store,{keyPath:Ln.keyPath});var n=e.store(Ln.store),r=new mn,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Nt(i)})}};return e.store(Dn.store).iterate({keysOnly:!0},(function(t,e){var n=new gt(t);return i(n.popLast())})).next((function(){return e.store(In.store).iterate({keysOnly:!0},(function(t,e){t[0];var n=t[1],r=(t[2],xt(n));return i(r.popLast())}))}))},t}();function vn(t){return[0,Nt(t)]}var bn=function(){function t(t,e){this.seconds=t,this.nanoseconds=e}return t}(),_n=function(){function t(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}return t.store="owner",t.key="owner",t}();function wn(t){t.createObjectStore(_n.store)}var Tn=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),En=function(){function t(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}return t.store="mutations",t.keyPath="batchId",t.userMutationsIndex="userMutationsIndex",t.userMutationsKeyPath=["userId","batchId"],t}();function Sn(t){t.createObjectStore(Tn.store,{keyPath:Tn.keyPath});var e=t.createObjectStore(En.store,{keyPath:En.keyPath,autoIncrement:!0});e.createIndex(En.userMutationsIndex,En.userMutationsKeyPath,{unique:!0}),t.createObjectStore(In.store)}function Cn(t,e){var n=e.store(En.store);return n.loadAll().next((function(n){t.deleteObjectStore(En.store);var r=t.createObjectStore(En.store,{keyPath:En.keyPath,autoIncrement:!0});r.createIndex(En.userMutationsIndex,En.userMutationsKeyPath,{unique:!0});var i=e.store(En.store),o=n.map((function(t){return i.put(t)}));return te.waitFor(o)}))}var In=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Nt(e)]},t.key=function(t,e,n){return[t,Nt(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}();function An(t){t.createObjectStore(Dn.store)}var Nn=function(){function t(t,e){this.path=t,this.readTime=e}return t}(),kn=function(){function t(t,e){this.path=t,this.version=e}return t}(),Dn=function(){function t(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o}return t.store="remoteDocuments",t.readTimeIndex="readTimeIndex",t.readTimeIndexPath="readTime",t.collectionReadTimeIndex="collectionReadTimeIndex",t.collectionReadTimeIndexPath=["parentPath","readTime"],t}(),xn=function(){function t(t){this.byteSize=t}return t.store="remoteDocumentGlobal",t.key="remoteDocumentGlobalKey",t}();function On(t){t.createObjectStore(xn.store)}var Rn=function(){function t(t,e,n,r,i,o,a){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),Mn=function(){function t(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n,v(0===t===(void 0!==n),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),Pn=function(){function t(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return t.key="targetGlobalKey",t.store="targetGlobal",t}(),Ln=function(){function t(t,e){this.collectionId=t,this.parent=e}return t.store="collectionParents",t.keyPath=["collectionId","parent"],t}();function Fn(t){var e=t.createObjectStore(Mn.store,{keyPath:Mn.keyPath});e.createIndex(Mn.documentTargetsIndex,Mn.documentTargetsKeyPath,{unique:!0});var n=t.createObjectStore(Rn.store,{keyPath:Rn.keyPath});n.createIndex(Rn.queryTargetsIndexName,Rn.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Pn.store)}function Un(t){t.deleteObjectStore(Mn.store),t.deleteObjectStore(Rn.store),t.deleteObjectStore(Pn.store)}function qn(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}function Vn(t){var e=t.store(Pn.store),n=new Pn(0,0,Rt.MIN.toTimestamp(),0);return e.put(Pn.key,n)}function Bn(t){var e=t.objectStore(Dn.store);e.createIndex(Dn.readTimeIndex,Dn.readTimeIndexPath,{unique:!1}),e.createIndex(Dn.collectionReadTimeIndex,Dn.collectionReadTimeIndexPath,{unique:!1})}var jn=function(){function t(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}return t.store="clientMetadata",t.keyPath="clientId",t}();function Wn(t){t.createObjectStore(jn.store,{keyPath:jn.keyPath})}var Kn,zn=[Tn.store,En.store,In.store,Dn.store,Rn.store,_n.store,Pn.store,Mn.store],Gn=zn,Qn=a.__spreadArrays(Gn,[jn.store]),Hn=a.__spreadArrays(Qn,[xn.store]),Yn=a.__spreadArrays(Hn,[Ln.store]),$n=Yn,Xn=function(){function t(){this.collectionParentsCache=new mn}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(v(e.length%2===1,"Expected a collection path."),!this.collectionParentsCache.has(e)){var r=e.lastSegment(),i=e.popLast();return t.addOnCommittedListener((function(){n.collectionParentsCache.add(e)})),Jn(t).put({collectionId:r,parent:Nt(i)})}return te.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[ot(e),""],!1,!0);return Jn(t).loadAll(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(xt(o.parent))}return n}))},t}();function Jn(t){return _r.getStore(t,Ln.store)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(t){t[t["Listen"]=0]="Listen",t[t["ExistenceFilterMismatch"]=1]="ExistenceFilterMismatch",t[t["LimboResolution"]=2]="LimboResolution"})(Kn||(Kn={}));var Zn=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=Rt.MIN),void 0===o&&(o=Rt.MIN),void 0===a&&(a=_()),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.sequenceNumber===t.sequenceNumber&&this.snapshotVersion.isEqual(t.snapshotVersion)&&this.lastLimboFreeSnapshotVersion.isEqual(t.lastLimboFreeSnapshotVersion)&&this.resumeToken===t.resumeToken&&this.target.isEqual(t.target)},t}(),tr=function(){function t(t){this.remoteSerializer=t}return t.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=_t.fromSegments(t.noDocument.path),n=this.fromDbTimestamp(t.noDocument.readTime);return new on(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){e=_t.fromSegments(t.unknownDocument.path),n=this.fromDbTimestamp(t.unknownDocument.version);return new an(e,n)}return g("Unexpected DbRemoteDocument")},t.prototype.toDbRemoteDocument=function(t,e){var n=this.toDbTimestampKey(e),r=t.key.path.popLast().toArray();if(t instanceof rn){var i=t.proto?t.proto:this.remoteSerializer.toDocument(t),o=t.hasCommittedMutations;return new Dn(null,null,i,o,n,r)}if(t instanceof on){var a=t.key.path.toArray(),s=this.toDbTimestamp(t.version);o=t.hasCommittedMutations;return new Dn(null,new Nn(a,s),null,o,n,r)}if(t instanceof an){a=t.key.path.toArray();var u=this.toDbTimestamp(t.version);return new Dn(new kn(a,u),null,null,!0,n,r)}return g("Unexpected MaybeDocument")},t.prototype.toDbTimestampKey=function(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]},t.prototype.fromDbTimestampKey=function(t){var e=new Ot(t[0],t[1]);return Rt.fromTimestamp(e)},t.prototype.toDbTimestamp=function(t){var e=t.toTimestamp();return new bn(e.seconds,e.nanoseconds)},t.prototype.fromDbTimestamp=function(t){var e=new Ot(t.seconds,t.nanoseconds);return Rt.fromTimestamp(e)},t.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.baseMutations.map((function(t){return n.remoteSerializer.toMutation(t)})),i=e.mutations.map((function(t){return n.remoteSerializer.toMutation(t)}));return new En(t,e.batchId,e.localWriteTime.toMillis(),r,i)},t.prototype.fromDbMutationBatch=function(t){var e=this,n=(t.baseMutations||[]).map((function(t){return e.remoteSerializer.fromMutation(t)})),r=t.mutations.map((function(t){return e.remoteSerializer.fromMutation(t)})),i=Ot.fromMillis(t.localWriteTimeMs);return new Jt(t.batchId,i,n,r)},t.prototype.toDbResourcePaths=function(t){var e=[];return t.forEach((function(t){e.push(Nt(t.path))})),e},t.prototype.fromDbResourcePaths=function(t){for(var e=Ht(),n=0,r=t;n<r.length;n++){var i=r[n];e=e.add(new _t(xt(i)))}return e},t.prototype.fromDbTarget=function(t){var e,n=this.fromDbTimestamp(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?this.fromDbTimestamp(t.lastLimboFreeSnapshotVersion):Rt.MIN,i=t.resumeToken;return e=er(t.query)?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new Zn(e,t.targetId,Kn.Listen,t.lastListenSequenceNumber,n,r,i)},t.prototype.toDbTarget=function(t){v(Kn.Listen===t.purpose,"Only queries with purpose "+Kn.Listen+" may be stored, got "+t.purpose);var e,n,r=this.toDbTimestamp(t.snapshotVersion),i=this.toDbTimestamp(t.lastLimboFreeSnapshotVersion);return e=t.target.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(t.target):this.remoteSerializer.toQueryTarget(t.target),t.resumeToken instanceof Uint8Array?(v(re.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence ."),n=t.resumeToken.toString()):n=t.resumeToken,new Rn(t.targetId,t.target.canonicalId(),r,n,t.sequenceNumber,i,e)},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er(t){return void 0!==t.documents}
/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nr(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=nt(n,i);return 0===a?nt(r,o):a}var rr=function(){function t(t){this.maxElements=t,this.buffer=new Ut(nr),this.previousIndex=0}return t.prototype.nextIndex=function(){return++this.previousIndex},t.prototype.addElement=function(t){var e=[t,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();nr(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),ir={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},or=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t.COLLECTION_DISABLED=-1,t.MINIMUM_CACHE_SIZE_BYTES=1048576,t.DEFAULT_CACHE_SIZE_BYTES=41943040,t.DEFAULT_COLLECTION_PERCENTILE=10,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,t.DEFAULT=new t(t.DEFAULT_CACHE_SIZE_BYTES,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),t.DISABLED=new t(t.COLLECTION_DISABLED,0,0),t}(),ar=6e4,sr=3e5,ur=function(){function t(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.hasRun=!1,this.gcTask=null}return t.prototype.start=function(){v(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==or.COLLECTION_DISABLED&&this.scheduleGC()},t.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),t.prototype.scheduleGC=function(){var t=this;v(null===this.gcTask,"Cannot schedule GC while a task is pending");var e=this.hasRun?sr:ar;d("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(ut.LruGarbageCollection,e,(function(){return t.gcTask=null,t.hasRun=!0,t.localStore.collectGarbage(t.garbageCollector).then((function(){return t.scheduleGC()})).catch(Tr)}))},t}(),cr=function(){function t(t,e){this.delegate=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.delegate.getSequenceNumberCount(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return te.resolve(dt.INVALID);var r=new rr(e);return this.delegate.forEachTarget(t,(function(t){return r.addElement(t.sequenceNumber)})).next((function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(t,(function(t){return r.addElement(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.delegate.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.delegate.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return this.params.cacheSizeCollectionThreshold===or.COLLECTION_DISABLED?(d("LruGarbageCollector","Garbage collection skipped; disabled"),te.resolve(ir)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(d("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),ir):n.runGarbageCollection(t,e)}))},t.prototype.getCacheSize=function(t){return this.delegate.getCacheSize(t)},t.prototype.runGarbageCollection=function(t,e){var n,r,o,a,s,u,c,h=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>h.params.maximumSequenceNumbersToCollect?(d("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.maximumSequenceNumbersToCollect+" from "+e),r=h.params.maximumSequenceNumbersToCollect):r=e,a=Date.now(),h.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),h.removeTargets(t,n,e)})).next((function(e){return o=e,u=Date.now(),h.removeOrphanedDocuments(t,n)})).next((function(t){if(c=Date.now(),f()<=i.DEBUG){var e="LRU Garbage Collection\n\tCounted targets in "+(a-l)+"ms\n\tDetermined least recently used "+r+" in "+(s-a)+"ms\n\tRemoved "+o+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-l)+"ms";d("LruGarbageCollector",e)}return te.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:t})}))},t}(),hr=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),lr="IndexedDbPersistence",fr=18e5,pr=5e3,dr=4e3,mr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",yr="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",gr="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",vr="firestore_zombie",br=function(t){function e(e,n){var r=t.call(this)||this;return r.simpleDbTransaction=e,r.currentSequenceNumber=n,r}return a.__extends(e,t),e}(hr),_r=function(){function t(e,n,r,i,o,a,s,u){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.queue=a,this.sequenceNumberSyncer=u,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(t){return Promise.resolve()},this.referenceDelegate=new Cr(this,o),this.dbName=n+t.MAIN_DATABASE,this.serializer=new tr(s),this.document=i.document,this.targetCache=new we(this.referenceDelegate,this.serializer),this.indexManager=new Xn,this.remoteDocumentCache=new cn(this.serializer,this.indexManager),!i.window||!i.window.localStorage)throw new T(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=i.window,this.webStorage=this.window.localStorage}return t.getStore=function(t,e){if(t instanceof br)return re.getStore(t.simpleDbTransaction,e);throw g("IndexedDbPersistence must use instances of IndexedDbTransaction")},t.createIndexedDbPersistence=function(e){return a.__awaiter(this,void 0,void 0,(function(){var n;return a.__generator(this,(function(r){switch(r.label){case 0:if(!t.isAvailable())throw new T(w.UNIMPLEMENTED,gr);return n=new t(e.allowTabSynchronization,e.persistenceKey,e.clientId,e.platform,e.lruParams,e.queue,e.serializer,e.sequenceNumberSyncer),[4,n.start()];case 1:return r.sent(),[2,n]}}))}))},t.prototype.start=function(){var t=this;return v(!this.started,"IndexedDbPersistence double-started!"),v(null!==this.window,"Expected 'window' to be defined"),re.openOrCreate(this.dbName,yn,new gn(this.serializer)).then((function(e){return t.simpleDb=e,t.updateClientMetadataAndTryBecomePrimary()})).then((function(){return t.attachVisibilityHandler(),t.attachWindowUnloadHook(),t.scheduleClientMetadataAndPrimaryLeaseRefreshes(),t.simpleDb.runTransaction("readonly-idempotent",[Pn.store],(function(t){return Ce(t)}))})).then((function(e){t.listenSequence=new dt(e,t.sequenceNumberSyncer)})).then((function(){t._started=!0})).catch((function(e){return t.simpleDb&&t.simpleDb.close(),Promise.reject(e)}))},t.prototype.setPrimaryStateListener=function(t){var e=this;return this.primaryStateListener=function(n){return a.__awaiter(e,void 0,void 0,(function(){return a.__generator(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.simpleDb.setVersionChangeListener((function(n){return a.__awaiter(e,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return null!==n.newVersion?[3,2]:[4,t()];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.queue.enqueueAndForget((function(){return a.__awaiter(e,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.updateClientMetadataAndTryBecomePrimary=function(){var t=this;return this.simpleDb.runTransaction("readwrite-idempotent",$n,(function(e){var n=Sr(e);return n.put(new jn(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.verifyPrimaryLease(e).next((function(e){e||(t.isPrimary=!1,t.queue.enqueueAndForget((function(){return t.primaryStateListener(!1)})))}))})).next((function(){return t.canActAsPrimary(e)})).next((function(n){return t.isPrimary&&!n?t.releasePrimaryLeaseIfHeld(e).next((function(){return!1})):!!n&&t.acquireOrExtendPrimaryLease(e).next((function(){return!0}))}))})).catch((function(e){if(!t.allowTabSynchronization)throw e;return d(lr,"Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.queue.enqueueAndForget((function(){return t.primaryStateListener(e)})),t.isPrimary=e}))},t.prototype.verifyPrimaryLease=function(t){var e=this,n=Er(t);return n.get(_n.key).next((function(t){return te.resolve(e.isLocalClient(t))}))},t.prototype.removeClientMetadata=function(t){var e=Sr(t);return e.delete(this.clientId)},t.prototype.maybeGarbageCollectMultiClientState=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,n=this;return a.__generator(this,(function(r){switch(r.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,fr)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary-idempotent",(function(e){var r=t.getStore(e,jn.store);return r.loadAll().next((function(t){var e=n.filterActiveClients(t,fr),i=t.filter((function(t){return-1===e.indexOf(t)}));return te.forEach(i,(function(t){return r.delete(t.clientId)})).next((function(){return i}))}))}))]);case 1:e=r.sent(),e.forEach((function(t){n.window.localStorage.removeItem(n.zombiedClientLocalStorageKey(t.clientId))})),r.label=2;case 2:return[2]}}))}))},t.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var t=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(ut.ClientMetadataRefresh,dr,(function(){return t.updateClientMetadataAndTryBecomePrimary().then((function(){return t.maybeGarbageCollectMultiClientState()})).then((function(){return t.scheduleClientMetadataAndPrimaryLeaseRefreshes()}))}))},t.prototype.isLocalClient=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.canActAsPrimary=function(t){var e=this,n=Er(t);return n.get(_n.key).next((function(n){var r=null!==n&&e.isWithinAge(n.leaseTimestampMs,pr)&&!e.isClientZombied(n.ownerId);if(r){if(e.isLocalClient(n)&&e.networkEnabled)return!0;if(!e.isLocalClient(n)){if(!n.allowTabSynchronization)throw new T(w.FAILED_PRECONDITION,yr);return!1}}return!(!e.networkEnabled||!e.inForeground)||Sr(t).loadAll().next((function(t){var n=e.filterActiveClients(t,pr).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}));return void 0===n}))})).next((function(t){return e.isPrimary!==t&&d(lr,"Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return a.__awaiter(this,void 0,void 0,(function(){var t=this;return a.__generator(this,(function(e){switch(e.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite-idempotent",[_n.store,jn.store],(function(e){return t.releasePrimaryLeaseIfHeld(e).next((function(){return t.removeClientMetadata(e)}))}))];case 1:return e.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}}))}))},t.prototype.filterActiveClients=function(t,e){var n=this;return t.filter((function(t){return n.isWithinAge(t.updateTimeMs,e)&&!n.isClientZombied(t.clientId)}))},t.prototype.getActiveClients=function(){var t=this;return this.simpleDb.runTransaction("readonly-idempotent",[jn.store],(function(e){return Sr(e).loadAll().next((function(e){return t.filterActiveClients(e,fr).map((function(t){return t.clientId}))}))}))},t.clearPersistence=function(e){return a.__awaiter(this,void 0,void 0,(function(){var n;return a.__generator(this,(function(r){switch(r.label){case 0:return t.isAvailable()?(n=e+t.MAIN_DATABASE,[4,re.delete(n)]):[2,Promise.resolve()];case 1:return r.sent(),[2]}}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getMutationQueue=function(t){return v(this.started,"Cannot initialize MutationQueue before persistence is started."),he.forUser(t,this.serializer,this.indexManager,this.referenceDelegate)},t.prototype.getTargetCache=function(){return v(this.started,"Cannot initialize TargetCache before persistence is started."),this.targetCache},t.prototype.getRemoteDocumentCache=function(){return v(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},t.prototype.getIndexManager=function(){return v(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},t.prototype.runTransaction=function(t,e,n){var r=this;d(lr,"Starting transaction:",t);var i,o=e.endsWith("idempotent"),a=e.startsWith("readonly"),s=a?o?"readonly-idempotent":"readonly":o?"readwrite-idempotent":"readwrite";return this.simpleDb.runTransaction(s,$n,(function(o){return i=new br(o,r.listenSequence.next()),"readwrite-primary"===e||"readwrite-primary-idempotent"===e?r.verifyPrimaryLease(o).next((function(t){return!!t||r.canActAsPrimary(o)})).next((function(e){if(!e)throw m("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.queue.enqueueAndForget((function(){return r.primaryStateListener(!1)})),new T(w.FAILED_PRECONDITION,mr);return n(i)})).next((function(t){return r.acquireOrExtendPrimaryLease(o).next((function(){return t}))})):r.verifyAllowTabSynchronization(o).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.verifyAllowTabSynchronization=function(t){var e=this,n=Er(t);return n.get(_n.key).next((function(t){var n=null!==t&&e.isWithinAge(t.leaseTimestampMs,pr)&&!e.isClientZombied(t.ownerId);if(n&&!e.isLocalClient(t)&&!t.allowTabSynchronization)throw new T(w.FAILED_PRECONDITION,yr)}))},t.prototype.acquireOrExtendPrimaryLease=function(t){var e=new _n(this.clientId,this.allowTabSynchronization,Date.now());return Er(t).put(_n.key,e)},t.isAvailable=function(){return re.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.releasePrimaryLeaseIfHeld=function(t){var e=this,n=Er(t);return n.get(_n.key).next((function(t){return e.isLocalClient(t)?(d(lr,"Releasing primary lease."),n.delete(_n.key)):te.resolve()}))},t.prototype.isWithinAge=function(t,e){var n=Date.now(),r=n-e,i=n;return!(t<r)&&(!(t>i)||(m("Detected an update time that is in the future: "+t+" > "+i),!1))},t.prototype.attachVisibilityHandler=function(){var t=this;null!==this.document&&"function"===typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){t.queue.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.updateClientMetadataAndTryBecomePrimary()}))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},t.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(v(null!==this.document&&"function"===typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;"function"===typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){t.markClientZombied(),t.queue.enqueueAndForget((function(){return t.shutdown()}))},this.window.addEventListener("unload",this.windowUnloadHandler))},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(v("function"===typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.isClientZombied=function(t){try{var e=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(t));return d(lr,"Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(n){return m(lr,"Failed to get zombied client id.",n),!1}},t.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(t){m("Failed to set zombie client id.",t)}},t.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(t){}},t.prototype.zombiedClientLocalStorageKey=function(t){return vr+"_"+this.persistenceKey+"_"+t},t.MAIN_DATABASE="main",t}();function wr(t){return t.code===w.FAILED_PRECONDITION&&t.message===mr}function Tr(t){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){if(!wr(t))throw t;return d(lr,"Unexpectedly lost primary lease"),[2]}))}))}function Er(t){return t.store(_n.store)}function Sr(t){return t.store(jn.store)}var Cr=function(){function t(t,e){this.db=t,this.inMemoryPins=null,this.garbageCollector=new cr(this,e)}return t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocmentCount(t),n=this.db.getTargetCache().getTargetCount(t);return n.next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.orphanedDocmentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){return this.forEachOrphanedDocument(t,(function(t,n){return e(n)}))},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return Nr(t,e)},t.prototype.removeReference=function(t,e){return Nr(t,e)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.removeMutationReference=function(t,e){return Nr(t,e)},t.prototype.isPinned=function(t,e){return this.inMemoryPins.containsKey(e)?te.resolve(!0):fe(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache(),i=r.newChangeBuffer(),o=[],a=0,s=this.forEachOrphanedDocument(t,(function(r,s){if(s<=e){var u=n.isPinned(t,r).next((function(e){if(!e)return a++,i.getEntry(t,r).next((function(){return i.removeEntry(r),Ie(t).delete(Ir(r))}))}));o.push(u)}}));return s.next((function(){return te.waitFor(o)})).next((function(){return i.apply(t)})).next((function(){return a}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Nr(t,e)},t.prototype.forEachOrphanedDocument=function(t,e){var n,r=Ie(t),i=dt.INVALID;return r.iterate({index:Mn.documentTargetsIndex},(function(t,r){var o=t[0],a=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==dt.INVALID&&e(new _t(xt(n)),i),i=s,n=a):i=dt.INVALID})).next((function(){i!==dt.INVALID&&e(new _t(xt(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Ir(t){return[0,Nt(t.path)]}function Ar(t,e){return new Mn(0,Nt(t.path),e)}function Nr(t,e){return Ie(t).put(Ar(e,t.currentSequenceNumber))}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kr=function(){function t(t,e,n){this.remoteDocumentCache=t,this.mutationQueue=e,this.indexManager=n}return t.prototype.getDocument=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.getDocumentInternal(t,e,r)}))},t.prototype.getDocumentInternal=function(t,e,n){return this.remoteDocumentCache.getEntry(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++){var o=i[r];t=o.applyToLocalView(e,t)}return t}))},t.prototype.applyLocalMutationsToDocuments=function(t,e,n){var r=jt();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++){var a=o[i];e=a.applyToLocalView(t,e)}r=r.insert(t,e)})),r},t.prototype.getDocuments=function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next((function(e){return n.getLocalViewOfDocuments(t,e)}))},t.prototype.getLocalViewOfDocuments=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(r){var i=n.applyLocalMutationsToDocuments(t,e,r),o=Bt();return i.forEach((function(t,e){e||(e=new on(t,Rt.forDeletedDoc())),o=o.insert(t,e)})),o}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return e.isDocumentQuery()?this.getDocumentsMatchingDocumentQuery(t,e.path):e.isCollectionGroupQuery()?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new _t(e)).next((function(t){var e=Kt();return t instanceof rn&&(e=e.insert(t.key,t)),e}))},t.prototype.getDocumentsMatchingCollectionGroupQuery=function(t,e,n){var r=this;v(e.path.isEmpty(),"Currently we only support collection group queries at the root.");var i=e.collectionGroup,o=Kt();return this.indexManager.getCollectionParents(t,i).next((function(a){return te.forEach(a,(function(a){var s=e.asCollectionQueryAtPath(a.child(i));return r.getDocumentsMatchingCollectionQuery(t,s,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e,n){var r,i,o=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.addMissingBaseDocuments(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,h=r.get(c),l=u.applyToLocalView(h,h,o.localWriteTime);r=l instanceof rn?r.insert(c,l):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){e.matches(n)||(r=r.remove(t))})),r}))},t.prototype.addMissingBaseDocuments=function(t,e,n){for(var r=Ht(),i=0,o=e;i<o.length;i++)for(var a=o[i],s=0,u=a.mutations;s<u.length;s++){var c=u[s];c instanceof Le&&null===n.get(c.key)&&(r=r.add(c.key))}var h=n;return this.remoteDocumentCache.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof rn&&(h=h.insert(t,e))})),h}))},t}(),Dr=function(){function t(){this.refsByKey=new Ut(xr.compareByKey),this.refsByTarget=new Ut(xr.compareByTargetId)}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new xr(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.removeRef(new xr(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.removeReferencesForId=function(t){var e=this,n=_t.EMPTY,r=new xr(n,t),i=new xr(n,t+1),o=[];return this.refsByTarget.forEachInRange([r,i],(function(t){e.removeRef(t),o.push(t.key)})),o},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach((function(e){return t.removeRef(e)}))},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t)},t.prototype.referencesForId=function(t){var e=_t.EMPTY,n=new xr(e,t),r=new xr(e,t+1),i=Ht();return this.refsByTarget.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new xr(t,0),n=this.refsByKey.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),xr=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return _t.comparator(t.key,e.key)||nt(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return nt(t.targetOrBatchId,e.targetOrBatchId)||_t.comparator(t.key,e.key)},t}(),Or="LocalStore",Rr=function(){function t(t,e,n){this.persistence=t,this.queryEngine=e,this.localViewReferences=new Dr,this.targetDataByTarget=new Mt(nt),this.targetIdByTarget=new sn((function(t){return t.canonicalId()})),this.lastDocumentChangeReadTime=Rt.MIN,v(t.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=t.getMutationQueue(n),this.remoteDocuments=t.getRemoteDocumentCache(),this.targetCache=t.getTargetCache(),this.localDocuments=new kr(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager()),this.queryEngine.setLocalDocumentsView(this.localDocuments)}return t.prototype.start=function(){return this.synchronizeLastDocumentChangeReadTime()},t.prototype.handleUserChange=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r,i=this;return a.__generator(this,(function(o){switch(o.label){case 0:return e=this.mutationQueue,n=this.localDocuments,[4,this.persistence.runTransaction("Handle user change","readonly-idempotent",(function(r){var o;return i.mutationQueue.getAllMutationBatches(r).next((function(a){return o=a,e=i.persistence.getMutationQueue(t),n=new kr(i.remoteDocuments,e,i.persistence.getIndexManager()),e.getAllMutationBatches(r)})).next((function(t){for(var e=[],i=[],a=Ht(),s=0,u=o;s<u.length;s++){var c=u[s];e.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];a=a.add(f.key)}}for(var p=0,d=t;p<d.length;p++){c=d[p];i.push(c.batchId);for(var m=0,y=c.mutations;m<y.length;m++){f=y[m];a=a.add(f.key)}}return n.getDocuments(r,a).next((function(t){return{affectedDocuments:t,removedBatchIds:e,addedBatchIds:i}}))}))}))];case 1:return r=o.sent(),this.mutationQueue=e,this.localDocuments=n,this.queryEngine.setLocalDocumentsView(this.localDocuments),[2,r]}}))}))},t.prototype.localWrite=function(t){var e,n=this,r=Ot.now(),i=t.reduce((function(t,e){return t.add(e.key)}),Ht());return this.persistence.runTransaction("Locally write mutations","readwrite-idempotent",(function(o){return n.localDocuments.getDocuments(o,i).next((function(i){e=i;for(var a=[],s=0,u=t;s<u.length;s++){var c=u[s],h=c.extractBaseValue(e.get(c.key));null!=h&&a.push(new Le(c.key,h,h.fieldMask(),Re.exists(!0)))}return n.mutationQueue.addMutationBatch(o,r,a,t)}))})).then((function(t){var n=t.applyToLocalDocumentSet(e);return{batchId:t.batchId,changes:n}}))},t.prototype.lookupMutationDocuments=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly-idempotent",(function(n){return e.mutationQueue.lookupMutationKeys(n,t).next((function(t){return t?e.localDocuments.getDocuments(n,t):te.resolve(null)}))}))},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary-idempotent",(function(n){var r=t.batch.keys(),i=e.remoteDocuments.newChangeBuffer({trackRemovals:!0});return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next((function(){return e.applyWriteToRemoteDocuments(n,t,i)})).next((function(){return i.apply(n)})).next((function(){return e.mutationQueue.performConsistencyCheck(n)})).next((function(){return e.localDocuments.getDocuments(n,r)}))}))},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary-idempotent",(function(n){var r;return e.mutationQueue.lookupMutationBatch(n,t).next((function(t){return v(null!==t,"Attempt to reject nonexistent batch!"),r=t.keys(),e.mutationQueue.removeMutationBatch(n,t)})).next((function(){return e.mutationQueue.performConsistencyCheck(n)})).next((function(){return e.localDocuments.getDocuments(n,r)}))}))},t.prototype.getHighestUnacknowledgedBatchId=function(){var t=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly-idempotent",(function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)}))},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly-idempotent",(function(e){return t.mutationQueue.getLastStreamToken(e)}))},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary-idempotent",(function(n){return e.mutationQueue.setLastStreamToken(n,t)}))},t.prototype.getLastRemoteSnapshotVersion=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly-idempotent",(function(e){return t.targetCache.getLastRemoteSnapshotVersion(e)}))},t.prototype.applyRemoteEvent=function(e){var n=this,r=e.snapshotVersion,i=this.targetDataByTarget;return this.persistence.runTransaction("Apply remote event","readwrite-primary-idempotent",(function(o){var a=n.remoteDocuments.newChangeBuffer({trackRemovals:!0});i=n.targetDataByTarget;var s=[];I(e.targetChanges,(function(e,a){var u=i.get(e);if(u){s.push(n.targetCache.removeMatchingKeys(o,a.removedDocuments,e).next((function(){return n.targetCache.addMatchingKeys(o,a.addedDocuments,e)})));var c=a.resumeToken;if(c.length>0){var h=u.withResumeToken(c,r).withSequenceNumber(o.currentSequenceNumber);i=i.insert(e,h),t.shouldPersistTargetData(u,h,a)&&s.push(n.targetCache.updateTargetData(o,h))}}}));var u=Bt(),c=Ht();if(e.documentUpdates.forEach((function(t,e){c=c.add(t)})),s.push(a.getEntries(o,c).next((function(t){e.documentUpdates.forEach((function(i,c){var h=t.get(i);c instanceof on&&c.version.isEqual(Rt.MIN)?(a.removeEntry(i,r),u=u.insert(i,c)):null==h||c.version.compareTo(h.version)>0||0===c.version.compareTo(h.version)&&h.hasPendingWrites?(Rt.MIN.isEqual(r)&&m(Or,"Cannot add a document when the remote version is zero"),a.addEntry(c,r),u=u.insert(i,c)):d(Or,"Ignoring outdated watch update for ",i,". Current version:",h.version," Watch version:",c.version),e.resolvedLimboDocuments.has(i)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(o,i))}))}))),!r.isEqual(Rt.MIN)){var h=n.targetCache.getLastRemoteSnapshotVersion(o).next((function(t){return v(r.compareTo(t)>=0,"Watch stream reverted to previous snapshot?? "+r+" < "+t),n.targetCache.setTargetsMetadata(o,o.currentSequenceNumber,r)}));s.push(h)}return te.waitFor(s).next((function(){return a.apply(o)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(o,u)}))})).then((function(t){return n.targetDataByTarget=i,t}))},t.shouldPersistTargetData=function(t,e,n){if(v(e.resumeToken.length>0,"Attempted to persist target data with no resume token"),0===t.resumeToken.length)return!0;var r=e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds();if(r>=this.RESUME_TOKEN_MAX_AGE_MICROS)return!0;var i=n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size;return i>0},t.prototype.notifyLocalViewChanges=function(t){for(var e=this,n=0,r=t;n<r.length;n++){var i=r[n],o=i.targetId;if(this.localViewReferences.addReferences(i.addedKeys,o),this.localViewReferences.removeReferences(i.removedKeys,o),!i.fromCache){var a=this.targetDataByTarget.get(o);v(null!==a,"Can't set limbo-free snapshot version for unknown target: "+o);var s=a.snapshotVersion,u=a.withLastLimboFreeSnapshotVersion(s);this.targetDataByTarget=this.targetDataByTarget.insert(o,u)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite-idempotent",(function(n){return te.forEach(t,(function(t){return te.forEach(t.removedKeys,(function(t){return e.persistence.referenceDelegate.removeReference(n,t)}))}))}))},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly-idempotent",(function(n){return void 0===t&&(t=Xt),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)}))},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document","readonly-idempotent",(function(n){return e.localDocuments.getDocument(n,t)}))},t.prototype.allocateTarget=function(t){var e=this;return this.persistence.runTransaction("Allocate target","readwrite-idempotent",(function(n){var r;return e.targetCache.getTargetData(n,t).next((function(i){return i?(r=i,te.resolve(r)):e.targetCache.allocateTargetId(n).next((function(i){return r=new Zn(t,i,Kn.Listen,n.currentSequenceNumber),e.targetCache.addTargetData(n,r).next((function(){return r}))}))}))})).then((function(n){return null===e.targetDataByTarget.get(n.targetId)&&(e.targetDataByTarget=e.targetDataByTarget.insert(n.targetId,n),e.targetIdByTarget.set(t,n.targetId)),n}))},t.prototype.getTargetData=function(t,e){var n=this.targetIdByTarget.get(e);return void 0!==n?te.resolve(this.targetDataByTarget.get(n)):this.targetCache.getTargetData(t,e)},t.prototype.releaseTarget=function(t,e){var n=this,r=this.targetDataByTarget.get(t);if(!r)return Promise.resolve();var i=e?"readwrite-idempotent":"readwrite-primary-idempotent";return this.persistence.runTransaction("Release target",i,(function(i){var o=n.localViewReferences.removeReferencesForId(t);return e?te.resolve():te.forEach(o,(function(t){return n.persistence.referenceDelegate.removeReference(i,t)})).next((function(){n.persistence.referenceDelegate.removeTarget(i,r)}))})).then((function(){n.targetDataByTarget=n.targetDataByTarget.remove(t),n.targetIdByTarget.delete(r.target)}))},t.prototype.executeQuery=function(t,e){var n=this,r=Rt.MIN,i=Ht();return this.persistence.runTransaction("Execute query","readonly-idempotent",(function(o){return n.getTargetData(o,t.toTarget()).next((function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,n.targetCache.getMatchingKeysForTargetId(o,t.targetId).next((function(t){i=t}))})).next((function(){return n.queryEngine.getDocumentsMatchingQuery(o,t,e?r:Rt.MIN,e?i:Ht())})).next((function(t){return{documents:t,remoteKeys:i}}))}))},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys","readonly-idempotent",(function(n){return e.targetCache.getMatchingKeysForTargetId(n,t)}))},t.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},t.prototype.removeCachedMutationBatchMetadata=function(t){this.mutationQueue.removeCachedMutationKeys(t)},t.prototype.setNetworkEnabled=function(t){this.persistence.setNetworkEnabled(t)},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=this,i=e.batch,o=i.keys(),a=te.resolve();return o.forEach((function(r){a=a.next((function(){return n.getEntry(t,r)})).next((function(t){var o=t,a=e.docVersions.get(r);v(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&(o=i.applyToRemoteDocument(r,o,e),o?n.addEntry(o,e.commitVersion):v(!t,"Mutation batch "+i+" applied to document "+t+" resulted in null"))}))})),a.next((function(){return r.mutationQueue.removeMutationBatch(t,i)}))},t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary-idempotent",(function(n){return t.collect(n,e.targetDataByTarget)}))},t.prototype.getTarget=function(t){var e=this,n=this.targetDataByTarget.get(t);return n?Promise.resolve(n.target):this.persistence.runTransaction("Get target data","readonly-idempotent",(function(n){return e.targetCache.getTargetDataForTarget(n,t).next((function(t){return t?t.target:null}))}))},t.prototype.getNewDocumentChanges=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly-idempotent",(function(e){return t.remoteDocuments.getNewDocumentChanges(e,t.lastDocumentChangeReadTime)})).then((function(e){var n=e.changedDocs,r=e.readTime;return t.lastDocumentChangeReadTime=r,n}))},t.prototype.synchronizeLastDocumentChangeReadTime=function(){return a.__awaiter(this,void 0,void 0,(function(){var t,e=this;return a.__generator(this,(function(n){return this.remoteDocuments instanceof cn?(t=this.remoteDocuments,[2,this.persistence.runTransaction("Synchronize last document change read time","readonly-idempotent",(function(e){return t.getLastDocumentChange(e)})).then((function(t){var n=t.readTime;e.lastDocumentChangeReadTime=n}))]):[2]}))}))},t.RESUME_TOKEN_MAX_AGE_MICROS=3e8,t}(),Mr=function(){function t(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=_(),this.batchesByDocumentKey=new Ut(xr.compareByKey)}return t.prototype.checkEmpty=function(t){return te.resolve(0===this.mutationQueue.length)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId,i=this.indexOfExistingBatchId(r,"acknowledged");v(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return v(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,te.resolve()},t.prototype.getLastStreamToken=function(t){return te.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,te.resolve()},t.prototype.addMutationBatch=function(t,e,n,r){v(0!==r.length,"Mutation batches should not be empty");var i=this.nextBatchId;if(this.nextBatchId++,this.mutationQueue.length>0){var o=this.mutationQueue[this.mutationQueue.length-1];v(o.batchId<i,"Mutation batchIDs must be monotonically increasing order")}var a=new Jt(i,e,n,r);this.mutationQueue.push(a);for(var s=0,u=r;s<u.length;s++){var c=u[s];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new xr(c.key,i)),this.indexManager.addToCollectionParentIndex(t,c.key.path.popLast())}return te.resolve(a)},t.prototype.lookupMutationBatch=function(t,e){return te.resolve(this.findMutationBatch(e))},t.prototype.lookupMutationKeys=function(t,e){var n=this.findMutationBatch(e);return v(null!=n,"Failed to find local mutation batch."),te.resolve(n.keys())},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.indexOfBatchId(n),i=r<0?0:r;return te.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return te.resolve(0===this.mutationQueue.length?Xt:this.nextBatchId-1)},t.prototype.getAllMutationBatches=function(t){return te.resolve(this.mutationQueue.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new xr(e,0),i=new xr(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],(function(t){v(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);v(null!==r,"Batches in the index must exist in the main table"),o.push(r)})),te.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Ut(nt);return e.forEach((function(t){var e=new xr(t,0),i=new xr(t,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([e,i],(function(e){v(t.isEqual(e.key),"For each key, should only iterate over a single key's batches"),r=r.add(e.targetOrBatchId)}))})),te.resolve(this.findMutationBatches(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){v(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=e.path,r=n.length+1,i=n;_t.isDocumentKey(i)||(i=i.child(""));var o=new xr(new _t(i),0),a=new Ut(nt);return this.batchesByDocumentKey.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.targetOrBatchId)),!0)}),o),te.resolve(this.findMutationBatches(a))},t.prototype.findMutationBatches=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.findMutationBatch(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this,r=this.indexOfExistingBatchId(e.batchId,"removed");v(0===r,"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var i=this.batchesByDocumentKey;return te.forEach(e.mutations,(function(r){var o=new xr(r.key,e.batchId);return i=i.delete(o),n.referenceDelegate.removeMutationReference(t,r.key)})).next((function(){n.batchesByDocumentKey=i}))},t.prototype.removeCachedMutationKeys=function(t){},t.prototype.containsKey=function(t,e){var n=new xr(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return te.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&v(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),te.resolve()},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return v(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},t.prototype.indexOfBatchId=function(t){if(0===this.mutationQueue.length)return 0;var e=this.mutationQueue[0].batchId;return t-e},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return v(n.batchId===t,"If found batch must match"),n},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Pr(){return new Mt(_t.comparator)}var Lr=function(){function t(t,e){this.indexManager=t,this.sizer=e,this.docs=Pr(),this.size=0}return t.prototype.addEntry=function(t,e,n){v(!n.isEqual(Rt.MIN),"Cannot add a document with a read time of zero");var r=e.key,i=this.docs.get(r),o=i?i.size:0,a=this.sizer(e);return this.docs=this.docs.insert(r,{maybeDocument:e,size:a,readTime:n}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return te.resolve(n?n.maybeDocument:null)},t.prototype.getEntries=function(t,e){var n=this,r=jt();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null)})),te.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){v(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=Kt(),i=new _t(e.path.child("")),o=this.docs.getIteratorFrom(i);while(o.hasNext()){var a=o.getNext(),s=a.key,u=a.value,c=u.maybeDocument,h=u.readTime;if(!e.path.isPrefixOf(s.path))break;h.compareTo(n)<=0||c instanceof rn&&e.matches(c)&&(r=r.insert(c.key,c))}return te.resolve(r)},t.prototype.forEachDocumentKey=function(t,e){return te.forEach(this.docs,(function(t){return e(t)}))},t.prototype.getNewDocumentChanges=function(t,e){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},t.prototype.newChangeBuffer=function(e){return new t.RemoteDocumentChangeBuffer(this)},t.prototype.getSize=function(t){return te.resolve(this.size)},t.RemoteDocumentChangeBuffer=function(t){function e(e){var n=t.call(this)||this;return n.documentCache=e,n}return a.__extends(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i?n.push(e.documentCache.addEntry(t,i,e.readTime)):e.documentCache.removeEntry(r)})),te.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.documentCache.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getEntries(t,e)},e}(un),t}(),Fr=function(){function t(t){this.persistence=t,this.targets=new sn((function(t){return t.canonicalId()})),this.lastRemoteSnapshotVersion=Rt.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new Dr,this.targetCount=0,this.targetIdGenerator=_e.forTargetCache()}return t.prototype.forEachTarget=function(t,e){return this.targets.forEach((function(t,n){return e(n)})),te.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return te.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return te.resolve(this.highestSequenceNumber)},t.prototype.allocateTargetId=function(t){var e=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=e,te.resolve(e)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.highestSequenceNumber&&(this.highestSequenceNumber=e),te.resolve()},t.prototype.saveTargetData=function(t){this.targets.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return v(!this.targets.has(e.target),"Adding a target that already exists"),this.saveTargetData(e),this.targetCount+=1,te.resolve()},t.prototype.updateTargetData=function(t,e){return v(this.targets.has(e.target),"Updating a non-existent target"),this.saveTargetData(e),te.resolve()},t.prototype.removeTargetData=function(t,e){return v(this.targetCount>0,"Removing a target from an empty cache"),v(this.targets.has(e.target),"Removing a non-existent target from the cache"),this.targets.delete(e.target),this.references.removeReferencesForId(e.targetId),this.targetCount-=1,te.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.targets.forEach((function(a,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.targets.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)})),te.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return te.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.targets.get(e)||null;return te.resolve(n)},t.prototype.getTargetDataForTarget=function(t,e){return g("Not yet implemented.")},t.prototype.addMatchingKeys=function(t,e,n){this.references.addReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.addReference(t,e))})),te.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){this.references.removeReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.removeReference(t,e))})),te.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),te.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return te.resolve(n)},t.prototype.containsKey=function(t,e){return te.resolve(this.references.containsKey(e))},t}(),Ur="MemoryPersistence",qr=function(){function t(t,e){var n=this;this.clientId=t,this.mutationQueues={},this.listenSequence=new dt(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.targetCache=new Fr(this);var r=function(t){return n.referenceDelegate.documentSize(t)};this.indexManager=new dn,this.remoteDocumentCache=new Lr(this.indexManager,r)}return t.createLruPersistence=function(e,n,r){var i=function(t){return new jr(t,new tr(n),r)};return new t(e,i)},t.createEagerPersistence=function(e){var n=function(t){return new Br(t)};return new t(e,n)},t.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getActiveClients=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){return[2,[this.clientId]]}))}))},t.prototype.setPrimaryStateListener=function(t){return t(!0)},t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(t){},t.prototype.getIndexManager=function(){return this.indexManager},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new Mr(this.indexManager,this.referenceDelegate),this.mutationQueues[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.targetCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e,n){var r=this;d(Ur,"Starting transaction:",t);var i=new Vr(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next((function(t){return r.referenceDelegate.onTransactionCommitted(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.mutationQueuesContainKey=function(t,e){return te.or(A(this.mutationQueues).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),Vr=function(t){function e(e){var n=t.call(this)||this;return n.currentSequenceNumber=e,n}return a.__extends(e,t),e}(hr),Br=function(){function t(t){this.persistence=t,this.inMemoryPins=null,this._orphanedDocuments=null}return Object.defineProperty(t.prototype,"orphanedDocuments",{get:function(){if(this._orphanedDocuments)return this._orphanedDocuments;throw g("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return this.orphanedDocuments.delete(e),te.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedDocuments.add(e),te.resolve()},t.prototype.removeMutationReference=function(t,e){return this.orphanedDocuments.add(e),te.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.orphanedDocuments.add(t)}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.onTransactionStarted=function(){this._orphanedDocuments=new Set},t.prototype.onTransactionCommitted=function(t){var e=this,n=this.persistence.getRemoteDocumentCache(),r=n.newChangeBuffer();return te.forEach(this.orphanedDocuments,(function(n){return e.isReferenced(t,n).next((function(t){t||r.removeEntry(n)}))})).next((function(){return e._orphanedDocuments=null,r.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.isReferenced(t,e).next((function(t){t?n.orphanedDocuments.delete(e):n.orphanedDocuments.add(e)}))},t.prototype.documentSize=function(t){return 0},t.prototype.isReferenced=function(t,e){var n=this;return te.or([function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.mutationQueuesContainKey(t,e)},function(){return te.resolve(n.inMemoryPins.containsKey(e))}])},t}(),jr=function(){function t(t,e,n){this.persistence=t,this.serializer=e,this.inMemoryPins=null,this.orphanedSequenceNumbers=new sn((function(t){return Nt(t.path)})),this.garbageCollector=new cr(this,n)}return t.prototype.onTransactionStarted=function(){},t.prototype.onTransactionCommitted=function(t){return te.resolve()},t.prototype.forEachTarget=function(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)},t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocumentCount(t),n=this.persistence.getTargetCache().getTargetCount(t);return n.next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.orphanedDocumentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){var n=this;return te.forEach(this.orphanedSequenceNumbers,(function(r,i){return n.isPinned(t,r,i).next((function(t){return t?te.resolve():e(i)}))}))},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.removeTargets=function(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer(),a=i.forEachDocumentKey(t,(function(i){return n.isPinned(t,i,e).next((function(t){t||(r++,o.removeEntry(i))}))}));return a.next((function(){return o.apply(t)})).next((function(){return r}))},t.prototype.removeMutationReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),te.resolve()},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)},t.prototype.addReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),te.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),te.resolve()},t.prototype.updateLimboDocument=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),te.resolve()},t.prototype.documentSize=function(t){var e,n=this.serializer.toDbRemoteDocument(t,t.version);if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw g("Unknown remote document type");e=n.noDocument}return JSON.stringify(e).length},t.prototype.isPinned=function(t,e,n){var r=this;return te.or([function(){return r.persistence.mutationQueuesContainKey(t,e)},function(){return te.resolve(r.inMemoryPins.containsKey(e))},function(){return r.persistence.getTargetCache().containsKey(t,e)},function(){var t=r.orphanedSequenceNumbers.get(e);return te.resolve(void 0!==t&&t>n)}])},t.prototype.getCacheSize=function(t){return this.persistence.getRemoteDocumentCache().getSize(t)},t}(),Wr=function(){function t(){}return t.prototype.setLocalDocumentsView=function(t){this.localDocumentsView=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){return v(void 0!==this.localDocumentsView,"setLocalDocumentsView() not called"),this.localDocumentsView.getDocumentsMatchingQuery(t,e,Rt.MIN)},t}(),Kr=Number,zr=Kr.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),Gr=Kr.MAX_SAFE_INTEGER||Math.pow(2,53)-1,Qr=Kr.isInteger||function(t){return"number"===typeof t&&isFinite(t)&&Math.floor(t)===t};
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hr(t){return null===t||void 0===t}function Yr(t){return Qr(t)&&t<=Gr&&t>=zr}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $r,Xr="ExponentialBackoff",Jr=1e3,Zr=1.5,ti=6e4,ei=function(){function t(t,e,n,r,i){void 0===n&&(n=Jr),void 0===r&&(r=Zr),void 0===i&&(i=ti),this.queue=t,this.timerId=e,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndRun=function(t){var e=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);this.currentBaseMs>0&&d(Xr,"Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,(function(){return e.lastAttemptTime=Date.now(),t()})),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},t.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}(),ni="PersistentStream";(function(t){t[t["Initial"]=0]="Initial",t[t["Starting"]=1]="Starting",t[t["Open"]=2]="Open",t[t["Error"]=3]="Error",t[t["Backoff"]=4]="Backoff"})($r||($r={}));var ri,ii,oi=6e4,ai=function(){function t(t,e,n,r,i,o){this.queue=t,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=$r.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new ei(t,e)}return t.prototype.isStarted=function(){return this.state===$r.Starting||this.state===$r.Open||this.state===$r.Backoff},t.prototype.isOpen=function(){return this.state===$r.Open},t.prototype.start=function(){this.state!==$r.Error?(v(this.state===$r.Initial,"Already started"),this.auth()):this.performBackoff()},t.prototype.stop=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.isStarted()?[4,this.close($r.Initial)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.inhibitBackoff=function(){v(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=$r.Initial,this.backoff.reset()},t.prototype.markIdle=function(){var t=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,oi,(function(){return t.handleIdleCloseTimer()})))},t.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},t.prototype.handleIdleCloseTimer=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){return this.isOpen()?[2,this.close($r.Initial)]:[2]}))}))},t.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},t.prototype.close=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(n){switch(n.label){case 0:return v(this.isStarted(),"Only started streams should be closed."),v(t===$r.Error||Hr(e),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,t!==$r.Error?this.backoff.reset():e&&e.code===w.RESOURCE_EXHAUSTED?(m(e.toString()),m("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):e&&e.code===w.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.onClose(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.tearDown=function(){},t.prototype.auth=function(){var t=this;v(this.state===$r.Initial,"Must be in initial state to auth"),this.state=$r.Starting;var e=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then((function(e){t.closeCount===n&&t.startStream(e)}),(function(n){e((function(){var e=new T(w.UNKNOWN,"Fetching auth token failed: "+n.message);return t.handleStreamClose(e)}))}))},t.prototype.startStream=function(t){var e=this;v(this.state===$r.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(t),this.stream.onOpen((function(){n((function(){return v(e.state===$r.Starting,"Expected stream to be in state Starting, but was "+e.state),e.state=$r.Open,e.listener.onOpen()}))})),this.stream.onClose((function(t){n((function(){return e.handleStreamClose(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.performBackoff=function(){var t=this;v(this.state===$r.Error,"Should only perform backoff when in Error state"),this.state=$r.Backoff,this.backoff.backoffAndRun((function(){return a.__awaiter(t,void 0,void 0,(function(){return a.__generator(this,(function(t){return v(this.state===$r.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=$r.Initial,this.start(),v(this.isStarted(),"PersistentStream should have started"),[2]}))}))}))},t.prototype.handleStreamClose=function(t){return v(this.isStarted(),"Can't handle server close on non-started stream"),d(ni,"close with error: "+t),this.stream=null,this.close($r.Error,t)},t.prototype.getCloseGuardedDispatcher=function(t){var e=this;return function(n){e.queue.enqueueAndForget((function(){return e.closeCount===t?n():(d(ni,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),si=function(t){function e(e,n,r,i,o){var a=t.call(this,e,ut.ListenStreamConnectionBackoff,ut.ListenStreamIdle,n,r,o)||this;return a.serializer=i,a}return a.__extends(e,t),e.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},e}(ai),ui=function(t){function e(e,n,r,i,o){var a=t.call(this,e,ut.WriteStreamConnectionBackoff,ut.WriteStreamIdle,n,r,o)||this;return a.serializer=i,a.handshakeComplete_=!1,a.lastStreamToken=_(),a}return a.__extends(e,t),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.handshakeComplete_=!1,t.prototype.start.call(this)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},e.prototype.onMessage=function(t){if(v(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return v(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){v(this.isOpen(),"Writing handshake requires an opened stream"),v(!this.handshakeComplete_,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},e.prototype.writeMutations=function(t){var e=this;v(this.isOpen(),"Writing mutations requires an opened stream"),v(this.handshakeComplete_,"Handshake must be complete before writing mutations"),v(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map((function(t){return e.serializer.toMutation(t)}))};this.sendRequest(n)},e}(ai),ci=function(){function t(t,e,n,r){this.queue=t,this.connection=e,this.credentials=n,this.serializer=r}return t.prototype.newPersistentWriteStream=function(t){return new ui(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.newPersistentWatchStream=function(t){return new si(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map((function(t){return e.serializer.toMutation(t)}))};return this.invokeRPC("Commit",n).then((function(t){return e.serializer.fromWriteResults(t.writeResults,t.commitTime)}))},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map((function(t){return e.serializer.toName(t)}))};return this.invokeStreamingRPC("BatchGetDocuments",n).then((function(n){var r=Bt();n.forEach((function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)}));var i=[];return t.forEach((function(t){var e=r.get(t);v(!!e,"Missing entity in write response for "+t),i.push(e)})),i}))},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.connection.invokeRPC(t,e,r)})).catch((function(t){throw t.code===w.UNAUTHENTICATED&&n.credentials.invalidateToken(),t}))},t.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.connection.invokeStreamingRPC(t,e,r)})).catch((function(t){throw t.code===w.UNAUTHENTICATED&&n.credentials.invalidateToken(),t}))},t}(),hi=function(){function t(t){this.datastore=t,this.readVersions=Gt(),this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n=this;return a.__generator(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new T(w.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.datastore.lookup(t)];case 1:return e=r.sent(),e.forEach((function(t){t instanceof on||t instanceof rn?n.recordVersion(t):g("Document in a transaction was a "+t.constructor.name)})),[2,e]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t))),this.writtenDocs.add(t)},t.prototype.update=function(t,e){try{this.write(e.toMutations(t,this.preconditionForUpdate(t)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(t)},t.prototype.delete=function(t){this.write([new Ue(t,this.precondition(t))]),this.writtenDocs.add(t)},t.prototype.commit=function(){return a.__awaiter(this,void 0,void 0,(function(){var t;return a.__generator(this,(function(e){switch(e.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;if(t=this.readVersions,this.mutations.forEach((function(e){t=t.remove(e.key)})),!t.isEmpty())throw new T(w.INVALID_ARGUMENT,"Every document read in a transaction must also be written.");return[4,this.datastore.commit(this.mutations)];case 1:return e.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t instanceof rn)e=t.version;else{if(!(t instanceof on))throw g("Document in a transaction was a "+t.constructor.name);e=Rt.forDeletedDoc()}var n=this.readVersions.get(t.key);if(null!==n){if(!e.isEqual(n))throw new T(w.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return!this.writtenDocs.has(t)&&e?Re.updateTime(e):Re.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(!this.writtenDocs.has(t)&&e){if(e.isEqual(Rt.forDeletedDoc()))throw new T(w.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Re.updateTime(e)}return Re.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations=this.mutations.concat(t)},t.prototype.ensureCommitNotCalled=function(){v(!this.committed,"A transaction object cannot be used after its update callback has been invoked.")},t}();(function(t){t[t["Unknown"]=0]="Unknown",t[t["Online"]=1]="Online",t[t["Offline"]=2]="Offline"})(ri||(ri={})),function(t){t[t["RemoteStore"]=0]="RemoteStore",t[t["SharedClientState"]=1]="SharedClientState"}(ii||(ii={}));
/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var li,fi="OnlineStateTracker",pi=1,di=1e4,mi=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=ri.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return t.prototype.handleWatchStreamStart=function(){var t=this;0===this.watchStreamFailures&&(this.setAndBroadcast(ri.Unknown),v(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(ut.OnlineStateTimeout,di,(function(){return t.onlineStateTimer=null,v(t.state===ri.Unknown,"Timer should be canceled if we transitioned to a different state."),t.logClientOfflineWarningIfNecessary("Backend didn't respond within "+di/1e3+" seconds."),t.setAndBroadcast(ri.Offline),Promise.resolve()})))},t.prototype.handleWatchStreamFailure=function(t){this.state===ri.Online?(this.setAndBroadcast(ri.Unknown),v(0===this.watchStreamFailures,"watchStreamFailures must be 0"),v(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,this.watchStreamFailures>=pi&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed "+pi+" times. Most recent error: "+t.toString()),this.setAndBroadcast(ri.Offline)))},t.prototype.set=function(t){this.clearOnlineStateTimer(),this.watchStreamFailures=0,t===ri.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(t)},t.prototype.setAndBroadcast=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.logClientOfflineWarningIfNecessary=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(m(e),this.shouldWarnClientIsOffline=!1):d(fi,e)},t.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},t}();function yi(t){switch(t){case w.OK:return g("Treated status OK as error");case w.CANCELLED:case w.UNKNOWN:case w.DEADLINE_EXCEEDED:case w.RESOURCE_EXHAUSTED:case w.INTERNAL:case w.UNAVAILABLE:case w.UNAUTHENTICATED:return!1;case w.INVALID_ARGUMENT:case w.NOT_FOUND:case w.ALREADY_EXISTS:case w.PERMISSION_DENIED:case w.FAILED_PRECONDITION:case w.ABORTED:case w.OUT_OF_RANGE:case w.UNIMPLEMENTED:case w.DATA_LOSS:return!0;default:return g("Unknown status code: "+t)}}function gi(t){return yi(t)&&t!==w.ABORTED}function vi(t){var e=li[t];if(void 0!==e)return bi(e)}function bi(t){if(void 0===t)return m("GRPC error has no .code"),w.UNKNOWN;switch(t){case li.OK:return w.OK;case li.CANCELLED:return w.CANCELLED;case li.UNKNOWN:return w.UNKNOWN;case li.DEADLINE_EXCEEDED:return w.DEADLINE_EXCEEDED;case li.RESOURCE_EXHAUSTED:return w.RESOURCE_EXHAUSTED;case li.INTERNAL:return w.INTERNAL;case li.UNAVAILABLE:return w.UNAVAILABLE;case li.UNAUTHENTICATED:return w.UNAUTHENTICATED;case li.INVALID_ARGUMENT:return w.INVALID_ARGUMENT;case li.NOT_FOUND:return w.NOT_FOUND;case li.ALREADY_EXISTS:return w.ALREADY_EXISTS;case li.PERMISSION_DENIED:return w.PERMISSION_DENIED;case li.FAILED_PRECONDITION:return w.FAILED_PRECONDITION;case li.ABORTED:return w.ABORTED;case li.OUT_OF_RANGE:return w.OUT_OF_RANGE;case li.UNIMPLEMENTED:return w.UNIMPLEMENTED;case li.DATA_LOSS:return w.DATA_LOSS;default:return g("Unknown status code: "+t)}}function _i(t){if(void 0===t)return li.OK;switch(t){case w.OK:return li.OK;case w.CANCELLED:return li.CANCELLED;case w.UNKNOWN:return li.UNKNOWN;case w.DEADLINE_EXCEEDED:return li.DEADLINE_EXCEEDED;case w.RESOURCE_EXHAUSTED:return li.RESOURCE_EXHAUSTED;case w.INTERNAL:return li.INTERNAL;case w.UNAVAILABLE:return li.UNAVAILABLE;case w.UNAUTHENTICATED:return li.UNAUTHENTICATED;case w.INVALID_ARGUMENT:return li.INVALID_ARGUMENT;case w.NOT_FOUND:return li.NOT_FOUND;case w.ALREADY_EXISTS:return li.ALREADY_EXISTS;case w.PERMISSION_DENIED:return li.PERMISSION_DENIED;case w.FAILED_PRECONDITION:return li.FAILED_PRECONDITION;case w.ABORTED:return li.ABORTED;case w.OUT_OF_RANGE:return li.OUT_OF_RANGE;case w.UNIMPLEMENTED:return li.UNIMPLEMENTED;case w.DATA_LOSS:return li.DATA_LOSS;default:return g("Unknown status code: "+t)}}function wi(t){var e=t.toLowerCase().replace("_","-");return Object.values(w).indexOf(e)>=0?e:w.UNKNOWN}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(t){t[t["OK"]=0]="OK",t[t["CANCELLED"]=1]="CANCELLED",t[t["UNKNOWN"]=2]="UNKNOWN",t[t["INVALID_ARGUMENT"]=3]="INVALID_ARGUMENT",t[t["DEADLINE_EXCEEDED"]=4]="DEADLINE_EXCEEDED",t[t["NOT_FOUND"]=5]="NOT_FOUND",t[t["ALREADY_EXISTS"]=6]="ALREADY_EXISTS",t[t["PERMISSION_DENIED"]=7]="PERMISSION_DENIED",t[t["UNAUTHENTICATED"]=16]="UNAUTHENTICATED",t[t["RESOURCE_EXHAUSTED"]=8]="RESOURCE_EXHAUSTED",t[t["FAILED_PRECONDITION"]=9]="FAILED_PRECONDITION",t[t["ABORTED"]=10]="ABORTED",t[t["OUT_OF_RANGE"]=11]="OUT_OF_RANGE",t[t["UNIMPLEMENTED"]=12]="UNIMPLEMENTED",t[t["INTERNAL"]=13]="INTERNAL",t[t["UNAVAILABLE"]=14]="UNAVAILABLE",t[t["DATA_LOSS"]=15]="DATA_LOSS"})(li||(li={}));var Ti,Ei,Si=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||_t.comparator(e.key,n.key)}:function(t,e){return _t.comparator(t.key,e.key)},this.keyedMap=Kt(),this.sortedSet=new Mt(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();while(n.hasNext()){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(t){t[t["Added"]=0]="Added",t[t["Removed"]=1]="Removed",t[t["Modified"]=2]="Modified",t[t["Metadata"]=3]="Metadata"})(Ti||(Ti={})),function(t){t[t["Local"]=0]="Local",t[t["Synced"]=1]="Synced"}(Ei||(Ei={}));var Ci,Ii=function(){function t(){this.changeMap=new Mt(_t.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);n?t.type!==Ti.Added&&n.type===Ti.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===Ti.Metadata&&n.type!==Ti.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===Ti.Modified&&n.type===Ti.Modified?this.changeMap=this.changeMap.insert(e,{type:Ti.Modified,doc:t.doc}):t.type===Ti.Modified&&n.type===Ti.Added?this.changeMap=this.changeMap.insert(e,{type:Ti.Added,doc:t.doc}):t.type===Ti.Removed&&n.type===Ti.Added?this.changeMap=this.changeMap.remove(e):t.type===Ti.Removed&&n.type===Ti.Modified?this.changeMap=this.changeMap.insert(e,{type:Ti.Removed,doc:n.doc}):t.type===Ti.Added&&n.type===Ti.Removed?this.changeMap=this.changeMap.insert(e,{type:Ti.Modified,doc:t.doc}):g("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(e,t)},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal((function(e,n){t.push(n)})),t},t}(),Ai=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:Ti.Added,doc:t})})),new t(e,n,Si.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(this.fromCache!==t.fromCache||this.syncStateChanged!==t.syncStateChanged||!this.mutatedKeys.isEqual(t.mutatedKeys)||!this.query.isEqual(t.query)||!this.docs.isEqual(t.docs)||!this.oldDocs.isEqual(t.oldDocs))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Ni=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r,i=(r={},r[e]=ki.createSynthesizedTargetChangeForCurrentChange(e,n),r);return new t(Rt.MIN,i,$t(),Bt(),Ht())},t}(),ki=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(_(),n,Ht(),Ht(),Ht())},t}(),Di=function(){function t(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r}return t}(),xi=function(){function t(t,e){this.targetId=t,this.existenceFilter=e}return t}();(function(t){t[t["NoChange"]=0]="NoChange",t[t["Added"]=1]="Added",t[t["Removed"]=2]="Removed",t[t["Current"]=3]="Current",t[t["Reset"]=4]="Reset"})(Ci||(Ci={}));var Oi=function(){function t(t,e,n,r){void 0===n&&(n=_()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}return t}(),Ri=function(){function t(){this.pendingResponses=0,this.documentChanges=Fi(),this._resumeToken=_(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),t.prototype.updateResumeToken=function(t){t.length>0&&(this._hasPendingChanges=!0,this._resumeToken=t)},t.prototype.toTargetChange=function(){var t=Ht(),e=Ht(),n=Ht();return this.documentChanges.forEach((function(r,i){switch(i){case Ti.Added:t=t.add(r);break;case Ti.Modified:e=e.add(r);break;case Ti.Removed:n=n.add(r);break;default:g("Encountered invalid change type: "+i)}})),new ki(this._resumeToken,this._current,t,e,n)},t.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=Fi()},t.prototype.addDocumentChange=function(t,e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(t,e)},t.prototype.removeDocumentChange=function(t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(t)},t.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},t.prototype.recordTargetResponse=function(){this.pendingResponses-=1},t.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},t}(),Mi="WatchChangeAggregator",Pi=function(){function t(t){this.metadataProvider=t,this.targetStates={},this.pendingDocumentUpdates=Bt(),this.pendingDocumentTargetMapping=Li(),this.pendingTargetResets=new Ut(nt)}return t.prototype.handleDocumentChange=function(t){for(var e=0,n=t.updatedTargetIds;e<n.length;e++){var r=n[e];t.newDoc instanceof rn?this.addDocumentToTarget(r,t.newDoc):t.newDoc instanceof on&&this.removeDocumentFromTarget(r,t.key,t.newDoc)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){r=o[i];this.removeDocumentFromTarget(r,t.key,t.newDoc)}},t.prototype.handleTargetChange=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.ensureTargetState(n);switch(t.state){case Ci.NoChange:e.isActiveTarget(n)&&r.updateResumeToken(t.resumeToken);break;case Ci.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(t.resumeToken);break;case Ci.Removed:r.recordTargetResponse(),r.isPending||e.removeTarget(n),v(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case Ci.Current:e.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(t.resumeToken));break;case Ci.Reset:e.isActiveTarget(n)&&(e.resetTarget(n),r.updateResumeToken(t.resumeToken));break;default:g("Unknown target watch change state: "+t.state)}}))},t.prototype.forEachTarget=function(t,e){t.targetIds.length>0?t.targetIds.forEach(e):I(this.targetStates,e)},t.prototype.handleExistenceFilter=function(t){var e=t.targetId,n=t.existenceFilter.count,r=this.targetDataForActiveTarget(e);if(r){var i=r.target;if(i.isDocumentQuery())if(0===n){var o=new _t(i.path);this.removeDocumentFromTarget(e,o,new on(o,Rt.forDeletedDoc()))}else v(1===n,"Single document existence filter with count: "+n);else{var a=this.getCurrentDocumentCountForTarget(e);a!==n&&(this.resetTarget(e),this.pendingTargetResets=this.pendingTargetResets.add(e))}}},t.prototype.createRemoteEvent=function(t){var e=this,n={};I(this.targetStates,(function(r,i){var o=e.targetDataForActiveTarget(r);if(o){if(i.current&&o.target.isDocumentQuery()){var a=new _t(o.target.path);null!==e.pendingDocumentUpdates.get(a)||e.targetContainsDocument(r,a)||e.removeDocumentFromTarget(r,a,new on(a,t))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}}));var r=Ht();this.pendingDocumentTargetMapping.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.targetDataForActiveTarget(t);return!n||n.purpose===Kn.LimboResolution||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Ni(t,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=Bt(),this.pendingDocumentTargetMapping=Li(),this.pendingTargetResets=new Ut(nt),i},t.prototype.addDocumentToTarget=function(t,e){if(this.isActiveTarget(t)){var n=this.targetContainsDocument(t,e.key)?Ti.Modified:Ti.Added,r=this.ensureTargetState(t);r.addDocumentChange(e.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e.key,e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e.key,this.ensureDocumentTargetMapping(e.key).add(t))}},t.prototype.removeDocumentFromTarget=function(t,e,n){if(this.isActiveTarget(t)){var r=this.ensureTargetState(t);this.targetContainsDocument(t,e)?r.addDocumentChange(e,Ti.Removed):r.removeDocumentChange(e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,this.ensureDocumentTargetMapping(e).delete(t)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e,n))}},t.prototype.removeTarget=function(t){delete this.targetStates[t]},t.prototype.getCurrentDocumentCountForTarget=function(t){var e=this.ensureTargetState(t),n=e.toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size},t.prototype.recordPendingTargetRequest=function(t){var e=this.ensureTargetState(t);e.recordPendingTargetRequest()},t.prototype.ensureTargetState=function(t){return this.targetStates[t]||(this.targetStates[t]=new Ri),this.targetStates[t]},t.prototype.ensureDocumentTargetMapping=function(t){var e=this.pendingDocumentTargetMapping.get(t);return e||(e=new Ut(nt),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,e)),e},t.prototype.isActiveTarget=function(t){var e=null!==this.targetDataForActiveTarget(t);return e||d(Mi,"Detected inactive target",t),e},t.prototype.targetDataForActiveTarget=function(t){var e=this.targetStates[t];return e&&e.isPending?null:this.metadataProvider.getTargetDataForTarget(t)},t.prototype.resetTarget=function(t){var e=this;v(!this.targetStates[t].isPending,"Should only reset active targets"),this.targetStates[t]=new Ri;var n=this.metadataProvider.getRemoteKeysForTarget(t);n.forEach((function(n){e.removeDocumentFromTarget(t,n,null)}))},t.prototype.targetContainsDocument=function(t,e){var n=this.metadataProvider.getRemoteKeysForTarget(t);return n.has(e)},t}();function Li(){return new Mt(_t.comparator)}function Fi(){return new Mt(_t.comparator)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ui,qi="RemoteStore",Vi=10,Bi=function(){function t(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.connectivityMonitor=i,this.connectivityMonitor.addCallback((function(t){n.enqueueAndForget((function(){return a.__awaiter(o,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.canUseNetwork()?(d(qi,"Restarting streams for network reachability change."),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.onlineStateTracker=new mi(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return a.__awaiter(this,void 0,void 0,(function(){var t;return a.__generator(this,(function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(t=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(ri.Unknown),[4,this.fillWritePipeline()];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},t.prototype.disableNetwork=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(ri.Offline),[2]}}))}))},t.prototype.disableNetworkInternal=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return[4,this.writeStream.stop()];case 1:return t.sent(),[4,this.watchStream.stop()];case 2:return t.sent(),this.writePipeline.length>0&&(d(qi,"Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}}))}))},t.prototype.shutdown=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return d(qi,"RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.connectivityMonitor.shutdown(),this.onlineStateTracker.set(ri.Unknown),[2]}}))}))},t.prototype.listen=function(t){S(this.listenTargets,t.targetId)||(this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(t))},t.prototype.unlisten=function(t){S(this.listenTargets,t)&&(delete this.listenTargets[t],this.watchStream.isOpen()&&this.sendUnwatchRequest(t),k(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(ri.Unknown)))},t.prototype.getTargetDataForTarget=function(t){return this.listenTargets[t]||null},t.prototype.getRemoteKeysForTarget=function(t){return this.syncEngine.getRemoteKeysForTarget(t)},t.prototype.sendWatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.startWatchStream=function(){v(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new Pi(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},t.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!k(this.listenTargets)},t.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},t.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},t.prototype.onWatchStreamOpen=function(){return a.__awaiter(this,void 0,void 0,(function(){var t=this;return a.__generator(this,(function(e){return I(this.listenTargets,(function(e,n){t.sendWatchRequest(n)})),[2]}))}))},t.prototype.onWatchStreamClose=function(t){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){return void 0===t&&v(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(t),this.startWatchStream()):this.onlineStateTracker.set(ri.Unknown),[2]}))}))},t.prototype.onWatchStreamChange=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){var n;return a.__generator(this,(function(r){switch(r.label){case 0:return this.onlineStateTracker.set(ri.Online),t instanceof Oi&&t.state===Ci.Removed&&t.cause?[2,this.handleTargetError(t)]:(t instanceof Di?this.watchChangeAggregator.handleDocumentChange(t):t instanceof xi?this.watchChangeAggregator.handleExistenceFilter(t):(v(t instanceof Oi,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(t)),e.isEqual(Rt.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),e.compareTo(n)>=0?[4,this.raiseWatchSnapshot(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},t.prototype.raiseWatchSnapshot=function(t){var e=this;v(!t.isEqual(Rt.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(t);return I(n.targetChanges,(function(n,r){if(r.resumeToken.length>0){var i=e.listenTargets[n];i&&(e.listenTargets[n]=i.withResumeToken(r.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e.listenTargets[t];if(n){e.listenTargets[t]=n.withResumeToken(_(),n.snapshotVersion),e.sendUnwatchRequest(t);var r=new Zn(n.target,t,Kn.ExistenceFilterMismatch,n.sequenceNumber);e.sendWatchRequest(r)}})),this.syncEngine.applyRemoteEvent(n)},t.prototype.handleTargetError=function(t){var e=this;v(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach((function(t){r=r.then((function(){return a.__awaiter(e,void 0,void 0,(function(){return a.__generator(this,(function(e){return S(this.listenTargets,t)?(delete this.listenTargets[t],this.watchChangeAggregator.removeTarget(t),[2,this.syncEngine.rejectListen(t,n)]):[2]}))}))}))})),r},t.prototype.fillWritePipeline=function(){return a.__awaiter(this,void 0,void 0,(function(){var t,e;return a.__generator(this,(function(n){switch(n.label){case 0:return this.canAddToWritePipeline()?(t=this.writePipeline.length>0?this.writePipeline[this.writePipeline.length-1].batchId:Xt,[4,this.localStore.nextMutationBatch(t)]):[3,4];case 1:return e=n.sent(),null!==e?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(e),[4,this.fillWritePipeline()];case 3:n.sent(),n.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}}))}))},t.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<Vi},t.prototype.outstandingWrites=function(){return this.writePipeline.length},t.prototype.addToWritePipeline=function(t){v(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(t),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&this.writePipeline.length>0},t.prototype.startWriteStream=function(){v(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},t.prototype.onWriteStreamOpen=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){return this.writeStream.writeHandshake(),[2]}))}))},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then((function(){for(var e=0,n=t.writePipeline;e<n.length;e++){var r=n[e];t.writeStream.writeMutations(r.mutations)}})).catch(Tr)},t.prototype.onMutationResult=function(t,e){var n=this;v(this.writePipeline.length>0,"Got result for empty write pipeline");var r=this.writePipeline.shift(),i=Zt.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then((function(){return n.fillWritePipeline()}))},t.prototype.onWriteStreamClose=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n=this;return a.__generator(this,(function(r){return void 0===t&&v(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),t&&this.writePipeline.length>0?(e=void 0,e=this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t),[2,e.then((function(){n.shouldStartWriteStream()&&n.startWriteStream()}))]):[2]}))}))},t.prototype.handleHandshakeError=function(t){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){return yi(t.code)?(d(qi,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=_(),[2,this.localStore.setLastStreamToken(_()).catch(Tr)]):[2]}))}))},t.prototype.handleWriteError=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n=this;return a.__generator(this,(function(r){return gi(t.code)?(e=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(e.batchId,t).then((function(){return n.fillWritePipeline()}))]):[2]}))}))},t.prototype.createTransaction=function(){return new hi(this.datastore)},t.prototype.restartNetwork=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(ri.Unknown),[4,this.enableNetwork()];case 2:return t.sent(),[2]}}))}))},t.prototype.handleCredentialChange=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.canUseNetwork()?(d(qi,"RemoteStore restarting streams for new credential"),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.applyPrimaryState=function(t){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,4];case 2:return t?[3,4]:[4,this.disableNetworkInternal()];case 3:e.sent(),this.onlineStateTracker.set(ri.Unknown),e.label=4;case 4:return[2]}}))}))},t}(),ji=function(){function t(t,e){if(O("GeoPoint",arguments,2),L("GeoPoint","number",1,t),L("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new T(w.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new T(w.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype._compareTo=function(t){return nt(this._lat,t._lat)||nt(this._long,t._long)},t}(),Wi=function(){function t(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null}return t.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:";for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];t+=r.canonicalId(),t+=","}t+="|ob:";for(var i=0,o=this.orderBy;i<o.length;i++){var a=o[i];t+=a.canonicalId(),t+=","}Hr(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},t.prototype.toString=function(){var t=this.path.canonicalString();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),Hr(this.limit)||(t+=", limit: "+this.limit),this.orderBy.length>0&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return this.collectionGroup===t.collectionGroup&&(!!this.path.isEqual(t.path)&&(!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)))},t.prototype.isDocumentQuery=function(){return _t.isDocumentKey(this.path)&&null===this.collectionGroup&&0===this.filters.length},t}();(function(t){t["First"]="F",t["Last"]="L"})(Ui||(Ui={}));var Ki=function(){function t(t,e,n,r,i,o,a,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=Ui.First),void 0===a&&(a=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.memoizedOrderBy=null,this.memorizedTarget=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)t.isKeyField()?this.memoizedOrderBy=[no]:this.memoizedOrderBy=[new eo(t),no];else{v(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:Zi.ASCENDING;this.memoizedOrderBy.push(a===Zi.ASCENDING?no:ro)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){v(null==this.getInequalityFilterField()||!(e instanceof Qi)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),v(!this.isDocumentQuery(),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),n,this.limit,this.limitType,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){v(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},t.prototype.withLimitToFirst=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),e,Ui.First,this.startAt,this.endAt)},t.prototype.withLimitToLast=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),e,Ui.Last,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,e)},t.prototype.asCollectionQueryAtPath=function(e){return new t(e,null,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},t.prototype.matchesAllDocuments=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.explicitOrderBy.length||1===this.explicitOrderBy.length&&this.explicitOrderBy[0].field.isKeyField())},t.prototype.canonicalId=function(){return this.toTarget().canonicalId()+"|lt:"+this.limitType},t.prototype.toString=function(){return"Query(target="+this.toTarget().toString()+"; limitType="+this.limitType+")"},t.prototype.isEqual=function(t){return this.toTarget().isEqual(t.toTarget())&&this.limitType===t.limitType},t.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(t,e);if(0!==a)return a;n=n||o.field.isKeyField()}return v(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.matchesPathAndCollectionGroup(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimitToFirst=function(){return!Hr(this.limit)&&this.limitType===Ui.First},t.prototype.hasLimitToLast=function(){return!Hr(this.limit)&&this.limitType===Ui.Last},t.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Qi&&n.isInequality())return n.field}return null},t.prototype.findFilterOperator=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof Qi&&t.indexOf(r.op)>=0)return r.op}return null},t.prototype.isDocumentQuery=function(){return this.toTarget().isDocumentQuery()},t.prototype.isCollectionGroupQuery=function(){return null!==this.collectionGroup},t.prototype.toTarget=function(){if(!this.memorizedTarget)if(this.limitType===Ui.First)this.memorizedTarget=new Wi(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i=r.dir===Zi.DESCENDING?Zi.ASCENDING:Zi.DESCENDING;t.push(new eo(r.field,i))}var o=this.endAt?new to(this.endAt.position,!this.endAt.before):null,a=this.startAt?new to(this.startAt.position,!this.startAt.before):null;this.memorizedTarget=new Wi(this.path,this.collectionGroup,t,this.filters,this.limit,o,a)}return this.memorizedTarget},t.prototype.matchesPathAndCollectionGroup=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.hasCollectionId(this.collectionGroup)&&this.path.isPrefixOf(e):_t.isDocumentKey(this.path)?this.path.isEqual(e):this.path.isImmediateParentOf(e)},t.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&null===t.field(r.field))return!1}return!0},t.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(!r.matches(t))return!1}return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t))&&(!this.endAt||!this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){v(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),zi=function(){function t(){}return t}(),Gi=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;case"array-contains":return t.ARRAY_CONTAINS;case"in":return t.IN;case"array-contains-any":return t.ARRAY_CONTAINS_ANY;default:return g("Unknown FieldFilter operator: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t.ARRAY_CONTAINS=new t("array-contains"),t.IN=new t("in"),t.ARRAY_CONTAINS_ANY=new t("array-contains-any"),t}(),Qi=function(t){function e(e,n,r){var i=t.call(this)||this;return i.field=e,i.op=n,i.value=r,i}return a.__extends(e,t),e.create=function(t,n,r){if(t.isKeyField())return n===Gi.IN?(v(r instanceof en,"Comparing on key with IN, but filter value not an ArrayValue"),v(r.internalValue.every((function(t){return t instanceof Je})),"Comparing on key with IN, but an array value was not a RefValue"),new Yi(t,r)):(v(r instanceof Je,"Comparing on key, but filter value not a RefValue"),v(n!==Gi.ARRAY_CONTAINS&&n!==Gi.ARRAY_CONTAINS_ANY,"'"+n.toString()+"' queries don't make sense on document keys."),new Hi(t,n,r));if(r.isEqual(Be.INSTANCE)){if(n!==Gi.EQUAL)throw new T(w.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new e(t,n,r)}if(r.isEqual(Qe.NAN)){if(n!==Gi.EQUAL)throw new T(w.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new e(t,n,r)}return n===Gi.ARRAY_CONTAINS?new $i(t,r):n===Gi.IN?(v(r instanceof en,"IN filter has invalid value: "+r.toString()),new Xi(t,r)):n===Gi.ARRAY_CONTAINS_ANY?(v(r instanceof en,"ARRAY_CONTAINS_ANY filter has invalid value: "+r.toString()),new Ji(t,r)):new e(t,n,r)},e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&this.value.typeOrder===e.typeOrder&&this.matchesComparison(e.compareTo(this.value))},e.prototype.matchesComparison=function(t){switch(this.op){case Gi.LESS_THAN:return t<0;case Gi.LESS_THAN_OR_EQUAL:return t<=0;case Gi.EQUAL:return 0===t;case Gi.GREATER_THAN:return t>0;case Gi.GREATER_THAN_OR_EQUAL:return t>=0;default:return g("Unknown FieldFilter operator: "+this.op)}},e.prototype.isInequality=function(){return[Gi.LESS_THAN,Gi.LESS_THAN_OR_EQUAL,Gi.GREATER_THAN,Gi.GREATER_THAN_OR_EQUAL].indexOf(this.op)>=0},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},e.prototype.isEqual=function(t){return t instanceof e&&(this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&this.value.isEqual(t.value))},e.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},e}(zi),Hi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.matches=function(t){var e=this.value,n=_t.comparator(t.key,e.key);return this.matchesComparison(n)},e}(Qi),Yi=function(t){function e(e,n){var r=t.call(this,e,Gi.IN,n)||this;return r.value=n,r}return a.__extends(e,t),e.prototype.matches=function(t){var e=this.value;return e.internalValue.some((function(e){return t.key.isEqual(e.key)}))},e}(Qi),$i=function(t){function e(e,n){return t.call(this,e,Gi.ARRAY_CONTAINS,n)||this}return a.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return e instanceof en&&e.contains(this.value)},e}(Qi),Xi=function(t){function e(e,n){var r=t.call(this,e,Gi.IN,n)||this;return r.value=n,r}return a.__extends(e,t),e.prototype.matches=function(t){var e=this.value,n=t.field(this.field);return null!==n&&e.contains(n)},e}(Qi),Ji=function(t){function e(e,n){var r=t.call(this,e,Gi.ARRAY_CONTAINS_ANY,n)||this;return r.value=n,r}return a.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return n instanceof en&&n.internalValue.some((function(t){return e.value.contains(t)}))},e}(Qi),Zi=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),to=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++){var r=n[e];t+=r.toString()}return t},t.prototype.sortsBeforeDocument=function(t,e){v(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())v(o instanceof Je,"Bound has a non-key value where the key path is being used."),n=_t.comparator(o.key,e.key);else{var a=e.field(i.field);v(null!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===Zi.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];if(!n.isEqual(r))return!1}return!0},t}(),eo=function(){function t(t,e){this.field=t,void 0===e&&(e=Zi.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?rn.compareByKey(t,e):rn.compareByField(this.field,t,e);switch(this.dir){case Zi.ASCENDING:return n;case Zi.DESCENDING:return-1*n;default:return g("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},t.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),no=new eo(bt.keyField(),Zi.ASCENDING),ro=new eo(bt.keyField(),Zi.DESCENDING),io=function(){function t(){}return t.prototype.applyToLocalView=function(t,e){return new $e(e,t)},t.prototype.applyToRemoteDocument=function(t,e){return e},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),oo=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=uo(t),n=function(t){e.find((function(e){return e.isEqual(t)}))||e.push(t)},r=0,i=this.elements;r<i.length;r++){var o=i[r];n(o)}return new en(e)},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&it(e.elements,this.elements)},t}(),ao=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=uo(t),n=function(t){e=e.filter((function(e){return!e.isEqual(t)}))},r=0,i=this.elements;r<i.length;r++){var o=i[r];n(o)}return new en(e)},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&it(e.elements,this.elements)},t}(),so=function(){function t(t){this.operand=t}return t.prototype.applyToLocalView=function(t,e){var n=this.computeBaseValue(t);if(n instanceof Ge&&this.operand instanceof Ge){var r=n.internalValue+this.operand.internalValue;return new Ge(r)}r=n.internalValue+this.operand.internalValue;return new Qe(r)},t.prototype.applyToRemoteDocument=function(t,e){return v(null!==e,"Didn't receive transformResult for NUMERIC_ADD transform"),e},t.prototype.computeBaseValue=function(t){return t instanceof We?t:new Ge(0)},t.prototype.isEqual=function(e){return e instanceof t&&this.operand.isEqual(e.operand)},t}();function uo(t){return t instanceof en?t.internalValue.slice():[]}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var co=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}(),ho=function(){var t={};return t[Zi.ASCENDING.name]="ASCENDING",t[Zi.DESCENDING.name]="DESCENDING",t}(),lo=function(){var t={};return t[Gi.LESS_THAN.name]="LESS_THAN",t[Gi.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",t[Gi.GREATER_THAN.name]="GREATER_THAN",t[Gi.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",t[Gi.EQUAL.name]="EQUAL",t[Gi.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",t[Gi.IN.name]="IN",t[Gi.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",t}(),fo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function po(t,e){v(!Hr(t),e+" is missing")}function mo(t){return"number"===typeof t?t:"string"===typeof t?Number(t):g("can't parse "+t)}var yo=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?w.UNKNOWN:bi(t.code);return new T(e,t.message||"")},t.prototype.toInt32Value=function(t){return this.options.useProto3Json||Hr(t)?t:{value:t}},t.prototype.fromInt32Value=function(t){var e;return e="object"===typeof t?t.value:t,Hr(e)?null:e},t.prototype.toTimestamp=function(t){if(this.options.useProto3Json){var e=new Date(1e3*t.seconds).toISOString(),n=e.replace(/\.\d*/,"").replace("Z",""),r=("000000000"+t.nanoseconds).slice(-9);return n+"."+r+"Z"}return{seconds:""+t.seconds,nanos:t.nanoseconds}},t.prototype.fromTimestamp=function(t){if("string"===typeof t)return this.fromIso8601String(t);v(!!t,"Cannot deserialize null or undefined timestamp.");var e=mo(t.seconds||"0"),n=t.nanos||0;return new Ot(e,n)},t.prototype.fromIso8601String=function(t){var e=0,n=fo.exec(t);if(v(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new Ot(o,e)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return"string"===typeof t?(v(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),ct.fromBase64String(t)):(v(!this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),ct.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return v(!!t,"Trying to deserialize version that isn't set"),Rt.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=gt.fromString(t);return v(this.isValidResourceName(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return v(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),v(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new _t(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?gt.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,"encodedDatabaseId",{get:function(){var t=new gt(["projects",this.databaseId.projectId,"databases",this.databaseId.database]);return t.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new gt(["projects",t.projectId,"databases",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return v(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof Be)return{nullValue:"NULL_VALUE"};if(t instanceof je)return{booleanValue:t.value()};if(t instanceof Ge)return{integerValue:""+t.value()};if(t instanceof Qe){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof He?{stringValue:t.value()}:t instanceof tn?{mapValue:this.toMapValue(t)}:t instanceof en?{arrayValue:this.toArrayValue(t)}:t instanceof Ye?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof Ze?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof Xe?{bytesValue:this.toBytes(t.value())}:t instanceof Je?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:g("Unknown FieldValue "+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this;if("nullValue"in t)return Be.INSTANCE;if("booleanValue"in t)return je.of(t.booleanValue);if("integerValue"in t)return new Ge(mo(t.integerValue));if("doubleValue"in t){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return Qe.NAN;if("Infinity"===t.doubleValue)return Qe.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return Qe.NEGATIVE_INFINITY}return new Qe(t.doubleValue)}if("stringValue"in t)return new He(t.stringValue);if("mapValue"in t)return this.fromFields(t.mapValue.fields||{});if("arrayValue"in t){po(t.arrayValue,"arrayValue");var n=t.arrayValue.values||[];return new en(n.map((function(t){return e.fromValue(t)})))}if("timestampValue"in t)return po(t.timestampValue,"timestampValue"),new Ye(this.fromTimestamp(t.timestampValue));if("geoPointValue"in t){po(t.geoPointValue,"geoPointValue");var r=t.geoPointValue.latitude||0,i=t.geoPointValue.longitude||0;return new Ze(new ji(r,i))}if("bytesValue"in t){po(t.bytesValue,"bytesValue");var o=this.fromBlob(t.bytesValue);return new Xe(o)}if("referenceValue"in t){po(t.referenceValue,"referenceValue");var a=this.fromResourceName(t.referenceValue),s=new pt(a.get(1),a.get(3)),u=new _t(this.extractLocalPathFromResourceName(a));return new Je(s,u)}return g("Unknown Value proto "+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return v(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data()),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t,e){var n=this,r=this.fromName(t.name),i=this.fromVersion(t.updateTime);return new rn(r,i,{hasCommittedMutations:!!e},void 0,t,(function(t){return n.fromValue(t)}))},t.prototype.toFields=function(t){var e=this,n={};return t.forEach((function(t,r){n[t]=e.toValue(r)})),n},t.prototype.fromFields=function(t){var e=this,n=t,r=tn.EMPTY;return N(n,(function(t,n){r=r.set(new bt([t]),e.fromValue(n))})),r},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach((function(t){n.push(e.toValue(t))})),{values:n}},t.prototype.fromFound=function(t){var e=this;v(!!t.found,"Tried to deserialize a found document from a missing document."),po(t.found.name,"doc.found.name"),po(t.found.updateTime,"doc.found.updateTime");var n=this.fromName(t.found.name),r=this.fromVersion(t.found.updateTime);return new rn(n,r,{},void 0,t.found,(function(t){return e.fromValue(t)}))},t.prototype.fromMissing=function(t){v(!!t.missing,"Tried to deserialize a missing document from a found document."),v(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new on(e,n)},t.prototype.fromMaybeDocument=function(t){return"found"in t?this.fromFound(t):"missing"in t?this.fromMissing(t):g("invalid batch get response: "+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case Ci.Added:return"ADD";case Ci.Current:return"CURRENT";case Ci.NoChange:return"NO_CHANGE";case Ci.Removed:return"REMOVE";case Ci.Reset:return"RESET";default:return g("Unknown WatchTargetChangeState: "+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof xi)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof Di){if(t.newDoc instanceof rn){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data()),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof on){e=t.newDoc;return{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}}}if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof Oi){var n=void 0;return t.cause&&(n={code:_i(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return g("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e,n=this;if("targetChange"in t){po(t.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=t.targetChange.resumeToken||this.emptyByteString(),a=t.targetChange.cause,s=a&&this.fromRpcStatus(a);e=new Oi(r,i,o,s||null)}else if("documentChange"in t){po(t.documentChange,"documentChange"),po(t.documentChange.document,"documentChange.name"),po(t.documentChange.document.name,"documentChange.document.name"),po(t.documentChange.document.updateTime,"documentChange.document.updateTime");var u=t.documentChange,c=this.fromName(u.document.name),h=this.fromVersion(u.document.updateTime),l=new rn(c,h,{},void 0,u.document,(function(t){return n.fromValue(t)})),f=u.targetIds||[],p=u.removedTargetIds||[];e=new Di(f,p,l.key,l)}else if("documentDelete"in t){po(t.documentDelete,"documentDelete"),po(t.documentDelete.document,"documentDelete.document");var d=t.documentDelete;c=this.fromName(d.document),h=d.readTime?this.fromVersion(d.readTime):Rt.forDeletedDoc(),l=new on(c,h),p=d.removedTargetIds||[];e=new Di([],p,l.key,l)}else if("documentRemove"in t){po(t.documentRemove,"documentRemove"),po(t.documentRemove.document,"documentRemove");var m=t.documentRemove;c=this.fromName(m.document),p=m.removedTargetIds||[];e=new Di([],p,c,null)}else{if(!("filter"in t))return g("Unknown change type "+JSON.stringify(t));po(t.filter,"filter"),po(t.filter.targetId,"filter.targetId");var y=t.filter,v=y.count||0,b=new co(v),_=y.targetId;e=new xi(_,b)}return e},t.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?Ci.NoChange:"ADD"===t?Ci.Added:"REMOVE"===t?Ci.Removed:"CURRENT"===t?Ci.Current:"RESET"===t?Ci.Reset:g("Got unexpected TargetChange.state: "+t)},t.prototype.versionFromListenResponse=function(t){if(!("targetChange"in t))return Rt.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?Rt.MIN:e.readTime?this.fromVersion(e.readTime):Rt.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof Pe)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof Ue)e={delete:this.toName(t.key)};else if(t instanceof Le)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof Fe))return g("Unknown mutation type "+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map((function(t){return n.toFieldTransform(t)}))}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):Re.NONE;if(t.update){po(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new Le(r,i,o,n)}return new Pe(r,i,n)}if(t.delete){r=this.fromName(t.delete);return new Ue(r,n)}if(t.transform){r=this.fromName(t.transform.document);var a=t.transform.fieldTransforms.map((function(t){return e.fromFieldTransform(t)}));return v(!0===n.exists,'Transforms only support precondition "exists == true"'),new Fe(r,a)}return g("unknown mutation proto: "+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return v(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:g("Unknown precondition")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?Re.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?Re.exists(t.exists):Re.NONE},t.prototype.fromWriteResult=function(t,e){var n=this,r=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);r.isEqual(Rt.MIN)&&(r=this.fromVersion(e));var i=null;return t.transformResults&&t.transformResults.length>0&&(i=t.transformResults.map((function(t){return n.fromValue(t)}))),new De(r,i)},t.prototype.fromWriteResults=function(t,e){var n=this;return t&&t.length>0?(v(void 0!==e,"Received a write result without a commit time"),t.map((function(t){return n.fromWriteResult(t,e)}))):[]},t.prototype.toFieldTransform=function(t){var e=this,n=t.transform;if(n instanceof io)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof oo)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements.map((function(t){return e.toValue(t)}))}};if(n instanceof ao)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements.map((function(t){return e.toValue(t)}))}};if(n instanceof so)return{fieldPath:t.field.canonicalString(),increment:this.toValue(n.operand)};throw g("Unknown transform: "+t.transform)},t.prototype.fromFieldTransform=function(t){var e=this,n=null;if("setToServerValue"in t)v("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),n=io.instance;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new oo(r.map((function(t){return e.fromValue(t)})))}else if("removeAllFromArray"in t){r=t.removeAllFromArray.values||[];n=new ao(r.map((function(t){return e.fromValue(t)})))}else if("increment"in t){var i=this.fromValue(t.increment);v(i instanceof We,"NUMERIC_ADD transform requires a NumberValue"),n=new so(i)}else g("Unknown transform proto: "+JSON.stringify(t));var o=bt.fromServerFormat(t.fieldPath);return new ke(o,n)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;v(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return Ki.atPath(this.fromQueryPath(n)).toTarget()},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(v(n.length%2===0,"Collection Group queries should be within a document path or root."),e.parent=this.toQueryPath(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(v(n.length%2!==0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]);var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){v(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=this.fromFilter(n.where));var s=[];n.orderBy&&(s=this.fromOrder(n.orderBy));var u=null;n.limit&&(u=this.fromInt32Value(n.limit));var c=null;n.startAt&&(c=this.fromCursor(n.startAt));var h=null;return n.endAt&&(h=this.fromCursor(n.endAt)),new Ki(e,i,s,a,u,Ui.First,c,h).toTarget()},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},t.prototype.toLabel=function(t){switch(t){case Kn.Listen:return null;case Kn.ExistenceFilterMismatch:return"existence-filter-mismatch";case Kn.LimboResolution:return"limbo-document";default:return g("Unrecognized query purpose: "+t)}},t.prototype.toTarget=function(t){var e,n=t.target;return e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)},e.targetId=t.targetId,t.resumeToken.length>0&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map((function(t){return t instanceof Qi?e.toUnaryOrFieldFilter(t):g("Unrecognized filter: "+JSON.stringify(t))}));return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromFieldFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return e.fromFilter(t)})).reduce((function(t,e){return t.concat(e)})):g("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map((function(t){return e.toPropertyOrder(t)}))},t.prototype.fromOrder=function(t){var e=this;return t.map((function(t){return e.fromPropertyOrder(t)}))},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map((function(t){return e.toValue(t)}))}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map((function(t){return e.fromValue(t)}));return new to(r,n)},t.prototype.toDirection=function(t){return ho[t.name]},t.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return Zi.ASCENDING;case"DESCENDING":return Zi.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return lo[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return Gi.EQUAL;case"GREATER_THAN":return Gi.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Gi.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Gi.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Gi.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Gi.ARRAY_CONTAINS;case"IN":return Gi.IN;case"ARRAY_CONTAINS_ANY":return Gi.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return g("Unspecified operator");default:return g("Unknown operator")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return bt.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new eo(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.fromFieldFilter=function(t){return Qi.create(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryOrFieldFilter=function(t){if(t.op===Gi.EQUAL){if(t.value.isEqual(Qe.NAN))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}};if(t.value.isEqual(Be.INSTANCE))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return Qi.create(e,Gi.EQUAL,Qe.NAN);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return Qi.create(n,Gi.EQUAL,Be.INSTANCE);case"OPERATOR_UNSPECIFIED":return g("Unspecified filter");default:return g("Unknown filter")}},t.prototype.toDocumentMask=function(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}},t.prototype.fromDocumentMask=function(t){var e=t.fieldPaths||[],n=e.map((function(t){return bt.fromServerFormat(t)}));return Ne.fromArray(n)},t}(),go=function(){function t(){this.viewSnap=null,this.targetId=0,this.listeners=[]}return t}(),vo=function(){function t(t){this.syncEngine=t,this.queries=new sn((function(t){return t.canonicalId()})),this.onlineState=ri.Unknown,this.snapshotsInSyncListeners=new Set,this.syncEngine.subscribe(this)}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);r||(n=!0,r=new go,this.queries.set(e,r)),r.listeners.push(t);var i=t.applyOnlineStateChange(this.onlineState);if(v(!i,"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),r.viewSnap){var o=t.onViewSnapshot(r.viewSnap);o&&this.raiseSnapshotsInSyncEvent()}return n?this.syncEngine.listen(e).then((function(t){return r.targetId=t,t})):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r,i;return a.__generator(this,(function(o){return e=t.query,n=!1,r=this.queries.get(e),r&&(i=r.listeners.indexOf(t),i>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length)),n?(this.queries.delete(e),[2,this.syncEngine.unlisten(e)]):[2]}))}))},t.prototype.onWatchChange=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,a=this.queries.get(o);if(a){for(var s=0,u=a.listeners;s<u.length;s++){var c=u[s];c.onViewSnapshot(i)&&(e=!0)}a.viewSnap=i}}e&&this.raiseSnapshotsInSyncEvent()},t.prototype.onWatchError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++){var o=i[r];o.onError(e)}this.queries.delete(t)},t.prototype.onOnlineStateChange=function(t){this.onlineState=t;var e=!1;this.queries.forEach((function(n,r){for(var i=0,o=r.listeners;i<o.length;i++){var a=o[i];a.applyOnlineStateChange(t)&&(e=!0)}})),e&&this.raiseSnapshotsInSyncEvent()},t.prototype.addSnapshotsInSyncListener=function(t){this.snapshotsInSyncListeners.add(t),t.next()},t.prototype.removeSnapshotsInSyncListener=function(t){this.snapshotsInSyncListeners.delete(t)},t.prototype.raiseSnapshotsInSyncEvent=function(){this.snapshotsInSyncListeners.forEach((function(t){t.next()}))},t}(),bo=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.snap=null,this.onlineState=ri.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){if(v(t.docChanges.length>0||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==Ti.Metadata&&e.push(i)}t=new Ai(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(t)&&(this.queryObserver.next(t),o=!0):this.shouldRaiseInitialEvent(t,this.onlineState)&&(this.raiseInitialEvent(t),o=!0),this.snap=t,o},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t;var e=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&(this.raiseInitialEvent(this.snap),e=!0),e},t.prototype.shouldRaiseInitialEvent=function(t,e){if(v(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==ri.Offline;return this.options.waitForSyncWhenOnline&&n?(v(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===ri.Offline},t.prototype.shouldRaiseEvent=function(t){if(t.docChanges.length>0)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.raiseInitialEvent=function(t){v(!this.raisedInitialEvent,"Trying to raise initial events for second time"),t=Ai.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(t)},t}(),_o=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.addedKeys=n,this.removedKeys=r}return t.fromSnapshot=function(e,n){for(var r=Ht(),i=Ht(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case Ti.Added:r=r.add(s.doc.key);break;case Ti.Removed:i=i.add(s.doc.key);break}}return new t(e,n.fromCache,r,i)},t}(),wo=function(){function t(t){this.key=t}return t}(),To=function(){function t(t){this.key=t}return t}(),Eo=function(){function t(t,e){this.query=t,this._syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=Ht(),this.mutatedKeys=Ht(),this.documentSet=new Si(t.docComparator.bind(t))}return Object.defineProperty(t.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new Ii,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimitToFirst()&&i.size===this.query.limit?i.last():null,c=this.query.hasLimitToLast()&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=e instanceof rn?e:null;l&&(v(t.isEqual(l.key),"Mismatching keys found in document changes: "+t+" != "+l.key),l=n.query.matches(l)?l:null);var f=!!h&&n.mutatedKeys.has(h.key),p=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;if(h&&l){var m=h.data().isEqual(l.data());m?f!==p&&(r.track({type:Ti.Metadata,doc:l}),d=!0):n.shouldWaitForSyncedDocument(h,l)||(r.track({type:Ti.Modified,doc:l}),d=!0,(u&&n.query.docComparator(l,u)>0||c&&n.query.docComparator(l,c)<0)&&(s=!0))}else!h&&l?(r.track({type:Ti.Added,doc:l}),d=!0):h&&!l&&(r.track({type:Ti.Removed,doc:h}),d=!0,(u||c)&&(s=!0));d&&(l?(a=a.add(l),o=p?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))})),this.query.hasLimitToFirst()||this.query.hasLimitToLast())while(a.size>this.query.limit){var h=this.query.hasLimitToFirst()?a.last():a.first();a=a.delete(h.key),o=o.delete(h.key),r.track({type:Ti.Removed,doc:h})}return v(!s||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},t.prototype.shouldWaitForSyncedDocument=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this;v(!t.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var o=t.changeSet.getChanges();o.sort((function(t,e){return So(t.type,e.type)||r.query.docComparator(t.doc,e.doc)})),this.applyTargetChange(n);var a=e?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current,u=s?Ei.Synced:Ei.Local,c=u!==this.syncState;if(this.syncState=u,0!==o.length||c){var h=new Ai(this.query,t.documentSet,i,o,t.mutatedKeys,u===Ei.Local,c,!1);return{snapshot:h,limboChanges:a}}return{limboChanges:a}},t.prototype.applyOnlineStateChange=function(t){return this.current&&t===ri.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Ii,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},t.prototype.shouldBeInLimbo=function(t){return!this._syncedDocuments.has(t)&&(!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations)},t.prototype.applyTargetChange=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e._syncedDocuments=e._syncedDocuments.add(t)})),t.modifiedDocuments.forEach((function(t){return v(e._syncedDocuments.has(t),"Modified document "+t+" not found in view.")})),t.removedDocuments.forEach((function(t){return e._syncedDocuments=e._syncedDocuments.delete(t)})),this.current=t.current)},t.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var e=this.limboDocuments;this.limboDocuments=Ht(),this.documentSet.forEach((function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))}));var n=[];return e.forEach((function(e){t.limboDocuments.has(e)||n.push(new To(e))})),this.limboDocuments.forEach((function(t){e.has(t)||n.push(new wo(t))})),n},t.prototype.synchronizeWithPersistedState=function(t){this._syncedDocuments=t.remoteKeys,this.limboDocuments=Ht();var e=this.computeDocChanges(t.documents);return this.applyChanges(e,!0)},t.prototype.computeInitialSnapshot=function(){return Ai.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===Ei.Local)},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function So(t,e){var n=function(t){switch(t){case Ti.Added:return 1;case Ti.Modified:return 2;case Ti.Metadata:return 2;case Ti.Removed:return 0;default:return g("Unknown ChangeType: "+t)}};return n(t)-n(e)}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Co=5,Io=function(){function t(t,e,n,r){this.asyncQueue=t,this.remoteStore=e,this.updateFunction=n,this.deferred=r,this.retries=Co,this.backoff=new ei(this.asyncQueue,ut.RetryTransaction)}return t.prototype.run=function(){this.runWithBackOff()},t.prototype.runWithBackOff=function(){var t=this;this.backoff.backoffAndRun((function(){return a.__awaiter(t,void 0,void 0,(function(){var t,e,n=this;return a.__generator(this,(function(r){return t=this.remoteStore.createTransaction(),e=this.tryRunUpdateFunction(t),e&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.handleTransactionError(t)}))}))})).catch((function(t){n.handleTransactionError(t)})),[2]}))}))}))},t.prototype.tryRunUpdateFunction=function(t){try{var e=this.updateFunction(t);return!Hr(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(m){return this.deferred.reject(m),null}},t.prototype.handleTransactionError=function(t){var e=this;this.retries>0&&this.isRetryableTransactionError(t)?(this.retries-=1,this.asyncQueue.enqueueAndForget((function(){return e.runWithBackOff(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.isRetryableTransactionError=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!yi(e)}return!1},t}(),Ao="SyncEngine",No=function(){function t(t,e,n){this.query=t,this.targetId=e,this.view=n}return t}(),ko=function(){function t(t){this.key=t,this.receivedDocument=!1}return t}(),Do=function(){function t(t,e,n,r){this.localStore=t,this.remoteStore=e,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new sn((function(t){return t.canonicalId()})),this.queriesByTarget={},this.limboTargetsByKey=new Mt(_t.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new Dr,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=_e.forSyncEngine(),this.isPrimary=void 0,this.onlineState=ri.Unknown}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){v(null!==t,"SyncEngine listener cannot be null"),v(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=t},t.prototype.listen=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o;return a.__generator(this,(function(a){switch(a.label){case 0:return this.assertSubscribed("listen()"),r=this.queryViewsByQuery.get(t),r?(e=r.targetId,this.sharedClientState.addLocalQueryTarget(e),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateTarget(t.toTarget())];case 2:return i=a.sent(),o=this.sharedClientState.addLocalQueryTarget(i.targetId),e=i.targetId,[4,this.initializeViewAndComputeSnapshot(t,e,"current"===o)];case 3:n=a.sent(),this.isPrimary&&this.remoteStore.listen(i),a.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,e]}}))}))},t.prototype.initializeViewAndComputeSnapshot=function(t,e,n){return a.__awaiter(this,void 0,void 0,(function(){var r,i,o,s,u,c;return a.__generator(this,(function(a){switch(a.label){case 0:return[4,this.localStore.executeQuery(t,!0)];case 1:return r=a.sent(),i=new Eo(t,r.remoteKeys),o=i.computeDocChanges(r.documents),s=ki.createSynthesizedTargetChangeForCurrentChange(e,n&&this.onlineState!==ri.Offline),u=i.applyChanges(o,!0===this.isPrimary,s),v(0===u.limboChanges.length,"View returned limbo docs before target ack from the server."),v(!!u.snapshot,"applyChanges for new view should always return a snapshot"),c=new No(t,e,i),this.queryViewsByQuery.set(t,c),this.queriesByTarget[e]||(this.queriesByTarget[e]=[]),this.queriesByTarget[e].push(t),[2,u.snapshot]}}))}))},t.prototype.synchronizeViewAndComputeSnapshot=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n;return a.__generator(this,(function(r){switch(r.label){case 0:return[4,this.localStore.executeQuery(t.query,!0)];case 1:return e=r.sent(),n=t.view.synchronizeWithPersistedState(e),this.isPrimary&&this.updateTrackedLimbos(t.targetId,n.limboChanges),[2,n]}}))}))},t.prototype.unlisten=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r,i=this;return a.__generator(this,(function(o){switch(o.label){case 0:return this.assertSubscribed("unlisten()"),e=this.queryViewsByQuery.get(t),v(!!e,"Trying to unlisten on query not found:"+t),n=this.queriesByTarget[e.targetId],n.length>1?(this.queriesByTarget[e.targetId]=n.filter((function(e){return!e.isEqual(t)})),this.queryViewsByQuery.delete(t),[2]):this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(e.targetId),r=this.sharedClientState.isActiveQueryTarget(e.targetId),r?[3,2]:[4,this.localStore.releaseTarget(e.targetId,!1).then((function(){i.sharedClientState.clearQueryState(e.targetId),i.remoteStore.unlisten(e.targetId),i.removeAndCleanupTarget(e.targetId)})).catch(Tr)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupTarget(e.targetId),[4,this.localStore.releaseTarget(e.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))},t.prototype.write=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){var n;return a.__generator(this,(function(r){switch(r.label){case 0:return this.assertSubscribed("write()"),[4,this.localStore.localWrite(t)];case 1:return n=r.sent(),this.sharedClientState.addPendingMutation(n.batchId),this.addMutationCallback(n.batchId,e),[4,this.emitNewSnapsAndNotifyLocalStore(n.changes)];case 2:return r.sent(),[4,this.remoteStore.fillWritePipeline()];case 3:return r.sent(),[2]}}))}))},t.prototype.runTransaction=function(t,e,n){new Io(t,this.remoteStore,e,n).run()},t.prototype.applyRemoteEvent=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r=this;return a.__generator(this,(function(i){switch(i.label){case 0:this.assertSubscribed("applyRemoteEvent()"),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,this.localStore.applyRemoteEvent(t)];case 2:return e=i.sent(),N(t.targetChanges,(function(t,e){var n=r.limboResolutionsByTarget[Number(t)];n&&(v(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),e.addedDocuments.size>0?n.receivedDocument=!0:e.modifiedDocuments.size>0?v(n.receivedDocument,"Received change for limbo target document without add."):e.removedDocuments.size>0&&(v(n.receivedDocument,"Received remove for limbo target document without add."),n.receivedDocument=!1))})),[4,this.emitNewSnapsAndNotifyLocalStore(e,t)];case 3:return i.sent(),[3,6];case 4:return n=i.sent(),[4,Tr(n)];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.applyOnlineStateChange=function(t,e){if(this.isPrimary&&e===ii.RemoteStore||!this.isPrimary&&e===ii.SharedClientState){this.assertSubscribed("applyOnlineStateChange()");var n=[];this.queryViewsByQuery.forEach((function(e,r){var i=r.view.applyOnlineStateChange(t);v(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)})),this.syncEngineListener.onOnlineStateChange(t),this.syncEngineListener.onWatchChange(n),this.onlineState=t,this.isPrimary&&this.sharedClientState.setOnlineState(t)}},t.prototype.rejectListen=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,s,u=this;return a.__generator(this,(function(a){switch(a.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(t,"rejected",e),n=this.limboResolutionsByTarget[t],r=n&&n.key,r?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[t],i=new Mt(_t.comparator),i=i.insert(r,new on(r,Rt.forDeletedDoc())),o=Ht().add(r),s=new Ni(Rt.MIN,{},new Ut(nt),i,o),[2,this.applyRemoteEvent(s)]):[3,1];case 1:return[4,this.localStore.releaseTarget(t,!1).then((function(){return u.removeAndCleanupTarget(t,e)})).catch(Tr)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))},t.prototype.applyBatchState=function(t,e,n){return a.__awaiter(this,void 0,void 0,(function(){var r;return a.__generator(this,(function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(t)];case 1:return r=i.sent(),null===r?(d(Ao,"Cannot apply mutation batch with id: "+t),[2]):"pending"!==e?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.processUserCallback(t,n||null),this.localStore.removeCachedMutationBatchMetadata(t)):g("Unknown batchState: "+e),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}}))}))},t.prototype.applySuccessfulWrite=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r;return a.__generator(this,(function(i){switch(i.label){case 0:this.assertSubscribed("applySuccessfulWrite()"),e=t.batch.batchId,this.processUserCallback(e,null),this.triggerPendingWritesCallbacks(e),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,this.localStore.acknowledgeBatch(t)];case 2:return n=i.sent(),this.sharedClientState.updateMutationState(e,"acknowledged"),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return i.sent(),[3,6];case 4:return r=i.sent(),[4,Tr(r)];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.rejectFailedWrite=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){var n,r;return a.__generator(this,(function(i){switch(i.label){case 0:this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.triggerPendingWritesCallbacks(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,this.localStore.rejectBatch(t)];case 2:return n=i.sent(),this.sharedClientState.updateMutationState(t,"rejected",e),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return i.sent(),[3,6];case 4:return r=i.sent(),[4,Tr(r)];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.registerPendingWritesCallback=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n;return a.__generator(this,(function(r){switch(r.label){case 0:return this.remoteStore.canUseNetwork()||d(Ao,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.localStore.getHighestUnacknowledgedBatchId()];case 1:return e=r.sent(),e===Xt?(t.resolve(),[2]):(n=this.pendingWritesCallbacks.get(e)||[],n.push(t),this.pendingWritesCallbacks.set(e,n),[2])}}))}))},t.prototype.triggerPendingWritesCallbacks=function(t){(this.pendingWritesCallbacks.get(t)||[]).forEach((function(t){t.resolve()})),this.pendingWritesCallbacks.delete(t)},t.prototype.rejectOutstandingPendingWritesCallbacks=function(t){this.pendingWritesCallbacks.forEach((function(e){e.forEach((function(e){e.reject(new T(w.CANCELLED,t))}))})),this.pendingWritesCallbacks.clear()},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new Mt(nt)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(v(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupTarget=function(t,e){var n=this;void 0===e&&(e=null),this.sharedClientState.removeLocalQueryTarget(t),v(this.queriesByTarget[t]&&0!==this.queriesByTarget[t].length,"There are no queries mapped to target id "+t);for(var r=0,i=this.queriesByTarget[t];r<i.length;r++){var o=i[r];this.queryViewsByQuery.delete(o),e&&this.syncEngineListener.onWatchError(o,e)}if(delete this.queriesByTarget[t],this.isPrimary){var a=this.limboDocumentRefs.referencesForId(t);this.limboDocumentRefs.removeReferencesForId(t),a.forEach((function(t){var e=n.limboDocumentRefs.containsKey(t);e||n.removeLimboTarget(t)}))}},t.prototype.removeLimboTarget=function(t){var e=this.limboTargetsByKey.get(t);null!==e&&(this.remoteStore.unlisten(e),this.limboTargetsByKey=this.limboTargetsByKey.remove(t),delete this.limboResolutionsByTarget[e])},t.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i instanceof wo)this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i);else if(i instanceof To){d(Ao,"Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,t);var o=this.limboDocumentRefs.containsKey(i.key);o||this.removeLimboTarget(i.key)}else g("Unknown limbo change: "+JSON.stringify(i))}},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){d(Ao,"New document in limbo: "+e);var n=this.limboTargetIdGenerator.next(),r=Ki.atPath(e.path);this.limboResolutionsByTarget[n]=new ko(e),this.remoteStore.listen(new Zn(r.toTarget(),n,Kn.LimboResolution,dt.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){var n,r,i,o=this;return a.__generator(this,(function(a){switch(a.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach((function(a,s){i.push(Promise.resolve().then((function(){var e=s.view.computeDocChanges(t);return e.needsRefill?o.localStore.executeQuery(s.query,!1).then((function(t){var n=t.documents;return s.view.computeDocChanges(n,e)})):e})).then((function(t){var i=e&&e.targetChanges[s.targetId],a=s.view.applyChanges(t,!0===o.isPrimary,i);if(o.updateTrackedLimbos(s.targetId,a.limboChanges),a.snapshot){o.isPrimary&&o.sharedClientState.updateQueryState(s.targetId,a.snapshot.fromCache?"not-current":"current"),n.push(a.snapshot);var u=_o.fromSnapshot(s.targetId,a.snapshot);r.push(u)}})))})),[4,Promise.all(i)];case 1:return a.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return a.sent(),[2]}}))}))},t.prototype.assertSubscribed=function(t){v(null!==this.syncEngineListener,"Trying to call "+t+" before calling subscribe().")},t.prototype.handleCredentialChange=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n;return a.__generator(this,(function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?(this.rejectOutstandingPendingWritesCallbacks("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.localStore.handleUserChange(t)]):[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}}))}))},t.prototype.applyPrimaryState=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o,s,u,c=this;return a.__generator(this,(function(a){switch(a.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return a.sent(),e=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e.toArray())];case 2:for(n=a.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.remoteStore.listen(o);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,s=[],u=Promise.resolve(),I(this.queriesByTarget,(function(t,e){c.sharedClientState.isLocalQueryTarget(t)?s.push(t):u=u.then((function(){return c.removeAndCleanupTarget(t),c.localStore.releaseTarget(t,!0)})),c.remoteStore.unlisten(t)})),[4,u]);case 4:return a.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(s)];case 5:return a.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:a.sent(),a.label=7;case 7:return[2]}}))}))},t.prototype.resetLimboDocuments=function(){var t=this;I(this.limboResolutionsByTarget,(function(e){t.remoteStore.unlisten(e)})),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new Mt(_t.comparator)},t.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(t){return a.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o,s,u,c,h,l,f,p,d;return a.__generator(this,(function(a){switch(a.label){case 0:e=[],n=[],r=0,i=t,a.label=1;case 1:return r<i.length?(o=i[r],s=void 0,u=this.queriesByTarget[o],u&&0!==u.length?[4,this.localStore.releaseTarget(o,!0)]:[3,8]):[3,14];case 2:return a.sent(),[4,this.localStore.allocateTarget(u[0].toTarget())];case 3:s=a.sent(),c=0,h=u,a.label=4;case 4:return c<h.length?(l=h[c],f=this.queryViewsByQuery.get(l),v(!!f,"No query view found for "+l),[4,this.synchronizeViewAndComputeSnapshot(f)]):[3,7];case 5:p=a.sent(),p.snapshot&&n.push(p.snapshot),a.label=6;case 6:return c++,[3,4];case 7:return[3,12];case 8:return v(!0===this.isPrimary,"A secondary tab should never have an active target without an active query."),[4,this.localStore.getTarget(o)];case 9:return d=a.sent(),v(!!d,"Target for id "+o+" not found"),[4,this.localStore.allocateTarget(d)];case 10:return s=a.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(d),o,!1)];case 11:a.sent(),a.label=12;case 12:e.push(s),a.label=13;case 13:return r++,[3,1];case 14:return this.syncEngineListener.onWatchChange(n),[2,e]}}))}))},t.prototype.synthesizeTargetToQuery=function(t){return new Ki(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,Ui.First,t.startAt,t.endAt)},t.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},t.prototype.applyTargetState=function(t,e,n){return a.__awaiter(this,void 0,void 0,(function(){var r,i,o;return a.__generator(this,(function(a){switch(a.label){case 0:if(this.isPrimary)return d(Ao,"Ignoring unexpected query state notification."),[2];if(!this.queriesByTarget[t])return[3,7];switch(r=e,r){case"current":return[3,1];case"not-current":return[3,1];case"rejected":return[3,4]}return[3,6];case 1:return[4,this.localStore.getNewDocumentChanges()];case 2:return i=a.sent(),o=Ni.createSynthesizedRemoteEventForCurrentChange(t,"current"===e),[4,this.emitNewSnapsAndNotifyLocalStore(i,o)];case 3:return a.sent(),[3,7];case 4:return[4,this.localStore.releaseTarget(t,!0)];case 5:return a.sent(),this.removeAndCleanupTarget(t,n),[3,7];case 6:g("Unexpected target state: "+e),a.label=7;case 7:return[2]}}))}))},t.prototype.applyActiveTargetsChange=function(t,e){return a.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,s,u,c,h,l,f=this;return a.__generator(this,(function(p){switch(p.label){case 0:if(!this.isPrimary)return[2];n=0,r=t,p.label=1;case 1:return n<r.length?(l=r[n],v(!this.queriesByTarget[l],"Trying to add an already active target"),[4,this.localStore.getTarget(l)]):[3,6];case 2:return i=p.sent(),v(!!i,"Query data for active target "+l+" not found"),[4,this.localStore.allocateTarget(i)];case 3:return o=p.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(i),o.targetId,!1)];case 4:p.sent(),this.remoteStore.listen(o),p.label=5;case 5:return n++,[3,1];case 6:s=function(t){return a.__generator(this,(function(e){switch(e.label){case 0:return u.queriesByTarget[t]?[4,u.localStore.releaseTarget(t,!1).then((function(){f.remoteStore.unlisten(t),f.removeAndCleanupTarget(t)})).catch(Tr)]:[2,"continue"];case 1:return e.sent(),[2]}}))},u=this,c=0,h=e,p.label=7;case 7:return c<h.length?(l=h[c],[5,s(l)]):[3,10];case 8:p.sent(),p.label=9;case 9:return c++,[3,7];case 10:return[2]}}))}))},t.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},t.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},t.prototype.getRemoteKeysForTarget=function(t){var e=this.limboResolutionsByTarget[t];if(e&&e.receivedDocument)return Ht().add(e.key);var n=Ht(),r=this.queriesByTarget[t];if(!r)return n;for(var i=0,o=r;i<o.length;i++){var a=o[i],s=this.queryViewsByQuery.get(a);v(!!s,"No query view found for "+a),n=n.unionWith(s.view.syncedDocuments)}return n},t}(),xo=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t("google-credentials-uid"),t.FIRST_PARTY=new t("first-party-uid"),t}(),Oo="SharedClientState",Ro="firestore_clients",Mo="firestore_mutations",Po="firestore_targets",Lo="firestore_online_state",Fo="firestore_sequence_number",Uo=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r,v(void 0!==r===("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n,r){var i=JSON.parse(r),o="object"===typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"===typeof i.error),a=void 0;return o&&i.error&&(o="string"===typeof i.error.message&&"string"===typeof i.error.code,o&&(a=new T(i.error.code,i.error.message))),o?new t(e,n,i.state,a):(m(Oo,"Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),qo=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n,v(void 0!==n===("rejected"===e),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n){var r=JSON.parse(n),i="object"===typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"===typeof r.error),o=void 0;return i&&r.error&&(i="string"===typeof r.error.message&&"string"===typeof r.error.code,i&&(o=new T(r.error.code,r.error.message))),i?new t(e,r.state,o):(m(Oo,"Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Vo=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.fromWebStorageEntry=function(e,n){for(var r=JSON.parse(n),i="object"===typeof r&&r.activeTargetIds instanceof Array,o=$t(),a=0;i&&a<r.activeTargetIds.length;++a)i=Yr(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(m(Oo,"Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Bo=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.fromWebStorageEntry=function(e){var n=JSON.parse(e),r="object"===typeof n&&n.onlineState in ri&&"string"===typeof n.clientId;return r?new t(n.clientId,ri[n.onlineState]):(m(Oo,"Failed to parse online state: "+e),null)},t}(),jo=function(){function t(){this.activeTargetIds=$t()}return t.prototype.addQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.removeQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.toWebStorageJSON=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Wo=function(){function t(e,n,r,i,o){if(this.queue=e,this.platform=n,this.persistenceKey=r,this.localClientId=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!t.isAvailable(this.platform))throw new T(w.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.localClientStorageKey=this.toWebStorageClientStateKey(this.localClientId),this.sequenceNumberKey=Fo+"_"+r,this.activeClients[this.localClientId]=new jo,this.clientStateKeyRe=new RegExp("^"+Ro+"_"+a+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+Mo+"_"+a+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+Po+"_"+a+"_(\\d+)$"),this.onlineStateKey=Lo+"_"+r,this.platform.window.addEventListener("storage",this.storageListener)}return t.isAvailable=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return a.__awaiter(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,u,c,h,l,f=this;return a.__generator(this,(function(a){switch(a.label){case 0:return v(!this.started,"WebStorageSharedClientState already started"),v(null!==this.syncEngine,"syncEngine property must be set before calling start()"),v(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(t=a.sent(),e=0,n=t;e<n.length;e++)r=n[e],r!==this.localClientId&&(i=this.getItem(this.toWebStorageClientStateKey(r)),i&&(o=Vo.fromWebStorageEntry(r,i),o&&(this.activeClients[o.clientId]=o)));for(this.persistClientState(),s=this.storage.getItem(this.onlineStateKey),s&&(u=this.fromWebStorageOnlineState(s),u&&this.handleOnlineStateEvent(u)),c=0,h=this.earlyEvents;c<h.length;c++)l=h[c],this.handleWebStorageEvent(l);return this.earlyEvents=[],this.platform.window.addEventListener("unload",(function(){return f.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.sequenceNumberKey,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){var t=$t();return N(this.activeClients,(function(e,n){t=t.unionWith(n.activeTargetIds)})),t},t.prototype.isActiveQueryTarget=function(t){for(var e in this.activeClients)if(this.activeClients.hasOwnProperty(e)&&this.activeClients[e].activeTargetIds.has(t))return!0;return!1},t.prototype.addPendingMutation=function(t){this.persistMutationState(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.persistMutationState(t,e,n),this.removeMutationState(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(this.toWebStorageQueryTargetMetadataKey(t));if(n){var r=qo.fromWebStorageEntry(t,n);r&&(e=r.state)}}return this.localClientState.addQueryTarget(t),this.persistClientState(),e},t.prototype.removeLocalQueryTarget=function(t){this.localClientState.removeQueryTarget(t),this.persistClientState()},t.prototype.isLocalQueryTarget=function(t){return this.localClientState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(this.toWebStorageQueryTargetMetadataKey(t))},t.prototype.updateQueryState=function(t,e,n){this.persistQueryTargetState(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.removeMutationState(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.persistOnlineState(t)},t.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return d(Oo,"READ",t,e),e},t.prototype.setItem=function(t,e){d(Oo,"SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){d(Oo,"REMOVE",t),this.storage.removeItem(t)},t.prototype.handleWebStorageEvent=function(t){var e=this;if(t.storageArea===this.storage){if(d(Oo,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey)return void m("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget((function(){return a.__awaiter(e,void 0,void 0,(function(){var e,n,r,i,o,s;return a.__generator(this,(function(a){if(!this.started)return this.earlyEvents.push(t),[2];if(null===t.key)return[2];if(this.clientStateKeyRe.test(t.key)){if(null==t.newValue)return n=this.fromWebStorageClientStateKey(t.key),[2,this.handleClientStateEvent(n,null)];if(e=this.fromWebStorageClientState(t.key,t.newValue),e)return[2,this.handleClientStateEvent(e.clientId,e)]}else if(this.mutationBatchKeyRe.test(t.key)){if(null!==t.newValue&&(r=this.fromWebStorageMutationMetadata(t.key,t.newValue),r))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(t.key)){if(null!==t.newValue&&(i=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue),i))return[2,this.handleQueryTargetEvent(i)]}else if(t.key===this.onlineStateKey){if(null!==t.newValue&&(o=this.fromWebStorageOnlineState(t.newValue),o))return[2,this.handleOnlineStateEvent(o)]}else t.key===this.sequenceNumberKey&&(v(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),s=Ko(t.newValue),s!==dt.INVALID&&this.sequenceNumberHandler(s));return[2]}))}))}))}},Object.defineProperty(t.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),t.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},t.prototype.persistMutationState=function(t,e,n){var r=new Uo(this.currentUser,t,e,n),i=this.toWebStorageMutationBatchKey(t);this.setItem(i,r.toWebStorageJSON())},t.prototype.removeMutationState=function(t){var e=this.toWebStorageMutationBatchKey(t);this.removeItem(e)},t.prototype.persistOnlineState=function(t){var e={clientId:this.localClientId,onlineState:ri[t]};this.storage.setItem(this.onlineStateKey,JSON.stringify(e))},t.prototype.persistQueryTargetState=function(t,e,n){var r=this.toWebStorageQueryTargetMetadataKey(t),i=new qo(t,e,n);this.setItem(r,i.toWebStorageJSON())},t.prototype.toWebStorageClientStateKey=function(t){return v(-1===t.indexOf("_"),"Client key cannot contain '_', but was '"+t+"'"),Ro+"_"+this.persistenceKey+"_"+t},t.prototype.toWebStorageQueryTargetMetadataKey=function(t){return Po+"_"+this.persistenceKey+"_"+t},t.prototype.toWebStorageMutationBatchKey=function(t){var e=Mo+"_"+this.persistenceKey+"_"+t;return this.currentUser.isAuthenticated()&&(e+="_"+this.currentUser.uid),e},t.prototype.fromWebStorageClientStateKey=function(t){var e=this.clientStateKeyRe.exec(t);return e?e[1]:null},t.prototype.fromWebStorageClientState=function(t,e){var n=this.fromWebStorageClientStateKey(t);return v(null!==n,"Cannot parse client state key '"+t+"'"),Vo.fromWebStorageEntry(n,e)},t.prototype.fromWebStorageMutationMetadata=function(t,e){var n=this.mutationBatchKeyRe.exec(t);v(null!==n,"Cannot parse mutation batch key '"+t+"'");var r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Uo.fromWebStorageEntry(new xo(i),r,e)},t.prototype.fromWebStorageQueryTargetMetadata=function(t,e){var n=this.queryTargetKeyRe.exec(t);v(null!==n,"Cannot parse query target key '"+t+"'");var r=Number(n[1]);return qo.fromWebStorageEntry(r,e)},t.prototype.fromWebStorageOnlineState=function(t){return Bo.fromWebStorageEntry(t)},t.prototype.handleMutationBatchEvent=function(t){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){return t.user.uid!==this.currentUser.uid?(d(Oo,"Ignoring mutation for non-active user "+t.user.uid),[2]):[2,this.syncEngine.applyBatchState(t.batchId,t.state,t.error)]}))}))},t.prototype.handleQueryTargetEvent=function(t){return this.syncEngine.applyTargetState(t.targetId,t.state,t.error)},t.prototype.handleClientStateEvent=function(t,e){var n=this,r=this.getAllActiveQueryTargets();e?this.activeClients[t]=e:delete this.activeClients[t];var i=this.getAllActiveQueryTargets(),o=[],s=[];return i.forEach((function(t){return a.__awaiter(n,void 0,void 0,(function(){return a.__generator(this,(function(e){return r.has(t)||o.push(t),[2]}))}))})),r.forEach((function(t){return a.__awaiter(n,void 0,void 0,(function(){return a.__generator(this,(function(e){return i.has(t)||s.push(t),[2]}))}))})),this.syncEngine.applyActiveTargetsChange(o,s)},t.prototype.handleOnlineStateEvent=function(t){this.activeClients[t.clientId]&&this.onlineStateHandler(t.onlineState)},t}();function Ko(t){var e=dt.INVALID;if(null!=t)try{var n=JSON.parse(t);v("number"===typeof n,"Found non-numeric sequence number"),e=n}catch(r){m(Oo,"Failed to read sequence number from WebStorage",r)}return e}var zo=function(){function t(){this.localState=new jo,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.localState.addQueryTarget(t),this.queryState[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.queryState[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.localState.removeQueryTarget(t)},t.prototype.isLocalQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.queryState[t]},t.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.start=function(){return this.localState=new jo,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t}(),Go="FirestoreClient",Qo=11,Ho=20,Yo=22,$o=function(){function t(t,e){this.cacheSizeBytes=t,this.synchronizeTabs=e}return t.prototype.lruParams=function(){return or.withCacheSize(this.cacheSizeBytes)},t}(),Xo=function(){function t(){}return t}(),Jo=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r,this.clientId=et.newId()}return t.prototype.start=function(t){var e=this;this.verifyNotTerminated();var n=new wt,r=new wt,i=!1;return this.credentials.setChangeListener((function(o){i?e.asyncQueue.enqueueAndForget((function(){return e.handleCredentialChange(o)})):(i=!0,e.initializePersistence(t,r,o).then((function(t){return e.initializeRest(o,t)})).then(n.resolve,n.reject))})),this.asyncQueue.enqueueAndForget((function(){return n.promise})),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return t.syncEngine.enableNetwork()}))},t.prototype.initializePersistence=function(t,e,n){var r=this;return t instanceof $o?this.startIndexedDbPersistence(n,t).then((function(t){return e.resolve(),t})).catch((function(t){if(e.reject(t),!r.canFallback(t))throw t;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+t),r.startMemoryPersistence()})):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t instanceof T?t.code===w.FAILED_PRECONDITION||t.code===w.UNIMPLEMENTED:!("undefined"!==typeof DOMException&&t instanceof DOMException)||(t.code===Yo||t.code===Ho||t.code===Qo)},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new T(w.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.startIndexedDbPersistence=function(t,e){var n=this,r=_r.buildStoragePrefix(this.databaseInfo),i=new yo(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then((function(){return a.__awaiter(n,void 0,void 0,(function(){var n,o;return a.__generator(this,(function(a){switch(a.label){case 0:if(e.synchronizeTabs&&!Wo.isAvailable(this.platform))throw new T(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return n=e.lruParams(),this.sharedClientState=e.synchronizeTabs?new Wo(this.asyncQueue,this.platform,r,this.clientId,t):new zo,[4,_r.createIndexedDbPersistence({allowTabSynchronization:e.synchronizeTabs,persistenceKey:r,clientId:this.clientId,platform:this.platform,queue:this.asyncQueue,serializer:i,lruParams:n,sequenceNumberSyncer:this.sharedClientState})];case 1:return o=a.sent(),this.persistence=o,[2,o.referenceDelegate.garbageCollector]}}))}))}))},t.prototype.startMemoryPersistence=function(){return this.persistence=qr.createEagerPersistence(this.clientId),this.sharedClientState=new zo,Promise.resolve(null)},t.prototype.initializeRest=function(t,e){var n=this;return d(Go,"Initializing. user=",t.uid),this.platform.loadConnection(this.databaseInfo).then((function(r){return a.__awaiter(n,void 0,void 0,(function(){var n,i,o,s,u,c,h=this;return a.__generator(this,(function(l){switch(l.label){case 0:return n=new Wr,this.localStore=new Rr(this.persistence,n,t),[4,this.localStore.start()];case 1:return l.sent(),e&&(this.lruScheduler=new ur(e,this.asyncQueue,this.localStore)),i=this.platform.newConnectivityMonitor(),o=this.platform.newSerializer(this.databaseInfo.databaseId),s=new ci(this.asyncQueue,r,this.credentials,o),u=function(t){return h.syncEngine.applyOnlineStateChange(t,ii.RemoteStore)},c=function(t){return h.syncEngine.applyOnlineStateChange(t,ii.SharedClientState)},this.remoteStore=new Bi(this.localStore,s,this.asyncQueue,u,i),this.syncEngine=new Do(this.localStore,this.remoteStore,this.sharedClientState,t),this.sharedClientState.onlineStateHandler=c,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new vo(this.syncEngine),[4,this.sharedClientState.start()];case 2:return l.sent(),[4,this.remoteStore.start()];case 3:return l.sent(),[4,this.persistence.setPrimaryStateListener((function(t){return a.__awaiter(h,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return[4,this.syncEngine.applyPrimaryState(t)];case 1:return e.sent(),this.lruScheduler&&(t&&!this.lruScheduler.started?this.lruScheduler.start():t||this.lruScheduler.stop()),[2]}}))}))}))];case 4:return l.sent(),[4,this.persistence.setDatabaseDeletedListener((function(){return a.__awaiter(h,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))}))];case 5:return l.sent(),[2]}}))}))}))},t.prototype.handleCredentialChange=function(t){return this.asyncQueue.verifyOperationInProgress(),d(Go,"Credential Changed. Current user: "+t.uid),this.syncEngine.handleCredentialChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return t.syncEngine.disableNetwork()}))},t.prototype.terminate=function(){var t=this;return this.asyncQueue.enqueueAndInitiateShutdown((function(){return a.__awaiter(t,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()];case 1:return t.sent(),[4,this.sharedClientState.shutdown()];case 2:return t.sent(),[4,this.persistence.shutdown()];case 3:return t.sent(),this.credentials.removeChangeListener(),[2]}}))}))}))},t.prototype.waitForPendingWrites=function(){var t=this;this.verifyNotTerminated();var e=new wt;return this.asyncQueue.enqueueAndForget((function(){return t.syncEngine.registerPendingWritesCallback(e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.verifyNotTerminated();var i=new bo(t,e,n);return this.asyncQueue.enqueueAndForget((function(){return r.eventMgr.listen(i)})),i},t.prototype.unlisten=function(t){var e=this;this.clientTerminated||this.asyncQueue.enqueueAndForget((function(){return e.eventMgr.unlisten(t)}))},t.prototype.getDocumentFromLocalCache=function(t){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return e.localStore.readDocument(t)})).then((function(t){if(t instanceof rn)return t;if(t instanceof on)return null;throw new T(w.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")}))},t.prototype.getDocumentsFromLocalCache=function(t){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return a.__awaiter(e,void 0,void 0,(function(){var e,n,r;return a.__generator(this,(function(i){switch(i.label){case 0:return[4,this.localStore.executeQuery(t,!0)];case 1:return e=i.sent(),n=new Eo(t,e.remoteKeys),r=n.computeDocChanges(e.documents),[2,n.applyChanges(r,!1).snapshot]}}))}))}))},t.prototype.write=function(t){var e=this;this.verifyNotTerminated();var n=new wt;return this.asyncQueue.enqueueAndForget((function(){return e.syncEngine.write(t,n)})),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},t.prototype.addSnapshotsInSyncListener=function(t){var e=this;this.verifyNotTerminated(),this.asyncQueue.enqueueAndForget((function(){return e.eventMgr.addSnapshotsInSyncListener(t),Promise.resolve()}))},t.prototype.removeSnapshotsInSyncListener=function(t){this.clientTerminated||this.eventMgr.removeSnapshotsInSyncListener(t)},Object.defineProperty(t.prototype,"clientTerminated",{get:function(){return this.asyncQueue.isShuttingDown},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.verifyNotTerminated();var n=new wt;return this.asyncQueue.enqueueAndForget((function(){return e.syncEngine.runTransaction(e.asyncQueue,t,n),Promise.resolve()})),n.promise},t}(),Zo=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),ta=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];P("FieldPath",t,"fieldNames",1);for(var n=0;n<t.length;++n)if(L("FieldPath","string",n,t[n]),0===t[n].length)throw new T(w.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bt(t)}return t.documentId=function(){return t._DOCUMENT_ID},t.prototype.isEqual=function(e){if(!(e instanceof t))throw X("isEqual","FieldPath",1,e);return this._internalPath.isEqual(e._internalPath)},t._DOCUMENT_ID=new t(bt.keyField().canonicalString()),t}(),ea=new RegExp("[~\\*/\\[\\]]");
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function na(t){var e=t.search(ea);if(e>=0)throw new T(w.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ta.bind.apply(ta,a.__spreadArrays([void 0],t.split("."))))}catch(n){throw new T(w.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ra=function(){function t(t,e){this.user=e,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+t}}return t}(),ia=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t){v(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,t(xo.UNAUTHENTICATED)},t.prototype.removeChangeListener=function(){v(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},t}(),oa=function(){function t(t){var e=this;this.app=t,this.tokenListener=null,this.currentUser=xo.UNAUTHENTICATED,this.receivedInitialUser=!1,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){e.tokenCounter++,e.currentUser=e.getUser(),e.receivedInitialUser=!0,e.changeListener&&e.changeListener(e.currentUser)},this.tokenCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return t.prototype.getToken=function(){var t=this;v(null!=this.tokenListener,"getToken cannot be called after listener removed.");var e=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.app.INTERNAL.getToken(n).then((function(n){if(t.tokenCounter!==e)throw new T(w.ABORTED,"getToken aborted due to token change.");return n?(v("string"===typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new ra(n.accessToken,t.currentUser)):null}))},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t){v(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,this.receivedInitialUser&&t(this.currentUser)},t.prototype.removeChangeListener=function(){v(null!=this.tokenListener,"removeChangeListener() called twice"),v(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},t.prototype.getUser=function(){var t=this.app.INTERNAL.getUid();return v(null===t||"string"===typeof t,"Received invalid UID: "+t),new xo(t)},t}(),aa=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=xo.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.sessionIndex},e=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return e&&(t["Authorization"]=e),t},enumerable:!0,configurable:!0}),t}(),sa=function(){function t(t,e){this.gapi=t,this.sessionIndex=e}return t.prototype.getToken=function(){return Promise.resolve(new aa(this.gapi,this.sessionIndex))},t.prototype.setChangeListener=function(t){t(xo.FIRST_PARTY)},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function ua(t){if(!t)return new ia;switch(t.type){case"gapi":var e=t.client;return v(!("object"!==typeof e||null===e||!e["auth"]||!e["auth"]["getAuthHeaderValueForFirstParty"]),"unexpected gapi interface"),new sa(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new T(w.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ca(t){return ha(t,["next","error","complete"])}function ha(t,e){if("object"!==typeof t||null===t)return!1;for(var n=t,r=0,i=e;r<i.length;r++){var o=i[r];if(o in n&&"function"===typeof n[o])return!0}return!1}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var la,fa=function(){function t(t){this._methodName=t}return t.delete=function(){return x("FieldValue.delete",arguments),pa.instance},t.serverTimestamp=function(){return x("FieldValue.serverTimestamp",arguments),da.instance},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return R("FieldValue.arrayUnion",arguments,1),new ma(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return R("FieldValue.arrayRemove",arguments,1),new ya(t)},t.increment=function(t){return L("FieldValue.increment","number",1,t),O("FieldValue.increment",arguments,1),new ga(t)},t.prototype.isEqual=function(t){return this===t},t}(),pa=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return a.__extends(e,t),e.instance=new e,e}(fa),da=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return a.__extends(e,t),e.instance=new e,e}(fa),ma=function(t){function e(e){var n=t.call(this,"FieldValue.arrayUnion")||this;return n._elements=e,n}return a.__extends(e,t),e}(fa),ya=function(t){function e(e){var n=t.call(this,"FieldValue.arrayRemove")||this;return n._elements=e,n}return a.__extends(e,t),e}(fa),ga=function(t){function e(e){var n=t.call(this,"FieldValue.increment")||this;return n._operand=e,n}return a.__extends(e,t),e}(fa),va=E(fa,"Use FieldValue.<field>() instead."),ba=/^__.*__$/,_a=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new Le(t,this.data,this.fieldMask,e)):n.push(new Pe(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Fe(t,this.fieldTransforms)),n},t}(),wa=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new Le(t,this.data,this.fieldMask,e)];return this.fieldTransforms.length>0&&n.push(new Fe(t,this.fieldTransforms)),n},t}();function Ta(t){switch(t){case la.Set:case la.MergeSet:case la.Update:return!0;case la.Argument:case la.ArrayArgument:return!1;default:throw g("Unexpected case for UserDataSource: "+t)}}(function(t){t[t["Set"]=0]="Set",t[t["Update"]=1]="Update",t[t["MergeSet"]=2]="MergeSet",t[t["Argument"]=3]="Argument",t[t["ArrayArgument"]=4]="ArrayArgument"})(la||(la={}));var Ea=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new T(w.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(0===t.length)throw this.createError("Document fields must not be empty");if(Ta(this.dataSource)&&ba.test(t))throw this.createError('Document fields cannot begin and end with "__"')},t}(),Sa=function(){function t(t,e){this.databaseId=t,this.key=e}return t}(),Ca=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e){var n=new Ea(la.Set,t,bt.EMPTY_PATH);Aa("Data must be an object, but it was:",n,e);var r=this.parseData(e,n);return new _a(r,null,n.fieldTransforms)},t.prototype.parseMergeData=function(t,e,n){var r=new Ea(la.MergeSet,t,bt.EMPTY_PATH);Aa("Data must be an object, but it was:",r,e);var i,o,a=this.parseData(e,r);if(n){for(var s=new Ut(bt.comparator),u=0,c=n;u<c.length;u++){var h=c[u],l=void 0;if(h instanceof ta)l=h._internalPath;else{if("string"!==typeof h)throw g("Expected stringOrFieldPath to be a string or a FieldPath");l=ka(t,h)}if(!r.contains(l))throw new T(w.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");s=s.add(l)}i=Ne.fromSet(s),o=r.fieldTransforms.filter((function(t){return i.covers(t.field)}))}else i=Ne.fromArray(r.fieldMask),o=r.fieldTransforms;return new _a(a,i,o)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new Ea(la.Update,t,bt.EMPTY_PATH);Aa("Data must be an object, but it was:",r,e);var i=new Ut(bt.comparator),o=tn.EMPTY;N(e,(function(e,a){var s=ka(t,e),u=r.childContextForFieldPath(s);if(a=n.runPreConverter(a,u),a instanceof pa)i=i.add(s);else{var c=n.parseData(a,u);null!=c&&(i=i.add(s),o=o.set(s,c))}}));var a=Ne.fromSet(i);return new wa(o,a,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new Ea(la.Update,t,bt.EMPTY_PATH),o=[Na(t,e)],a=[n];if(r.length%2!==0)throw new T(w.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(Na(t,r[s])),a.push(r[s+1]);var u=new Ut(bt.comparator),c=tn.EMPTY;for(s=0;s<o.length;++s){var h=o[s],l=i.childContextForFieldPath(h),f=this.runPreConverter(a[s],l);if(f instanceof pa)u=u.add(h);else{var p=this.parseData(f,l);null!=p&&(u=u.add(h),c=c.set(h,p))}}var d=Ne.fromSet(u);return new wa(c,d,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e,n){void 0===n&&(n=!1);var r=new Ea(n?la.ArrayArgument:la.Argument,t,bt.EMPTY_PATH),i=this.parseData(e,r);return v(null!=i,"Parsed data should not be null."),v(0===r.fieldTransforms.length,"Field transforms should have been disallowed."),i},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(r){var n=Da(r);throw e.createError(n)}},t.prototype.parseData=function(t,e){if(t=this.runPreConverter(t,e),Ia(t))return Aa("Unsupported field value:",e,t),this.parseObject(t,e);if(t instanceof fa)return this.parseSentinelFieldValue(t,e),null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.arrayElement&&e.dataSource!==la.ArrayArgument)throw e.createError("Nested arrays are not supported");return this.parseArray(t,e)}return this.parseScalarValue(t,e)},t.prototype.parseObject=function(t,e){var n=this,r=new Mt(nt);return k(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):N(t,(function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))})),new tn(r)},t.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=o[i],s=this.parseData(a,e.childContextForArray(r));null==s&&(s=Be.INSTANCE),n.push(s),r++}return new en(n)},t.prototype.parseSentinelFieldValue=function(t,e){if(!Ta(e.dataSource))throw e.createError(t._methodName+"() can only be used with update() and set()");if(null===e.path)throw e.createError(t._methodName+"() is not currently supported inside arrays");if(t instanceof pa){if(e.dataSource!==la.MergeSet)throw e.dataSource===la.Update?(v(e.path.length>0,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data")):e.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.fieldMask.push(e.path)}else if(t instanceof da)e.fieldTransforms.push(new ke(e.path,io.instance));else if(t instanceof ma){var n=this.parseArrayTransformElements(t._methodName,t._elements),r=new oo(n);e.fieldTransforms.push(new ke(e.path,r))}else if(t instanceof ya){n=this.parseArrayTransformElements(t._methodName,t._elements);var i=new ao(n);e.fieldTransforms.push(new ke(e.path,i))}else if(t instanceof ga){var o=this.parseQueryValue("FieldValue.increment",t._operand),a=new so(o);e.fieldTransforms.push(new ke(e.path,a))}else g("Unknown FieldValue type: "+t)},t.prototype.parseScalarValue=function(t,e){if(null===t)return Be.INSTANCE;if("number"===typeof t)return Yr(t)?new Ge(t):new Qe(t);if("boolean"===typeof t)return je.of(t);if("string"===typeof t)return new He(t);if(t instanceof Date)return new Ye(Ot.fromDate(t));if(t instanceof Ot)return new Ye(new Ot(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof ji)return new Ze(t);if(t instanceof ct)return new Xe(t);if(t instanceof Sa)return new Je(t.databaseId,t.key);throw e.createError("Unsupported field value: "+Q(t))},t.prototype.parseArrayTransformElements=function(t,e){var n=this;return e.map((function(e,r){var i=new Ea(la.Argument,t,bt.EMPTY_PATH);return n.parseData(e,i.childContextForArray(r))}))},t}();function Ia(t){return"object"===typeof t&&null!==t&&!(t instanceof Array)&&!(t instanceof Date)&&!(t instanceof Ot)&&!(t instanceof ji)&&!(t instanceof ct)&&!(t instanceof Sa)&&!(t instanceof fa)}function Aa(t,e,n){if(!Ia(n)||!G(n)){var r=Q(n);throw"an object"===r?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Na(t,e){if(e instanceof ta)return e._internalPath;if("string"===typeof e)return ka(t,e);var n="Field path arguments must be of type string or FieldPath.";throw new T(w.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}function ka(t,e){try{return na(e)._internalPath}catch(r){var n=Da(r);throw new T(w.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Da(t){return t instanceof Error?t.message:t.toString()}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xa="firestore.googleapis.com",Oa=!0,Ra=!0,Ma=!1,Pa=or.COLLECTION_DISABLED,La=!1,Fa=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new T(w.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=xa,this.ssl=Oa}else U("settings","non-empty string","host",t.host),this.host=t.host,q("settings","boolean","ssl",t.ssl),this.ssl=C(t.ssl,Oa);if($("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),q("settings","object","credentials",t.credentials),this.credentials=t.credentials,q("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?m("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===t.timestampsInSnapshots&&m("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=C(t.timestampsInSnapshots,Ra),q("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=or.DEFAULT_CACHE_SIZE_BYTES;else{if(t.cacheSizeBytes!==Pa&&t.cacheSizeBytes<or.MINIMUM_CACHE_SIZE_BYTES)throw new T(w.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+or.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=t.cacheSizeBytes}q("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0===t.experimentalForceLongPolling?Ma:t.experimentalForceLongPolling}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},t}(),Ua=function(){function t(e){var n=this;if(this._firebaseApp=null,this._queue=new Et,this.INTERNAL={delete:function(){return a.__awaiter(n,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return this.ensureClientConfigured(),[4,this._firestoreClient.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"===typeof e.options){var r=e;this._firebaseApp=r,this._databaseId=t.databaseIdFromApp(r),this._persistenceKey=r.name,this._credentials=new oa(r)}else{var i=e;if(!i.projectId)throw new T(w.INVALID_ARGUMENT,"Must provide projectId");this._databaseId=new pt(i.projectId,i.database),this._persistenceKey="[DEFAULT]",this._credentials=new ia}this._settings=new Fa({}),this._dataConverter=this.createDataConverter(this._databaseId)}return t.prototype.settings=function(t){if(O("Firestore.settings",arguments,1),L("Firestore.settings","object",1,t),S(t,"persistence"))throw new T(w.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new Fa(t);if(this._firestoreClient&&!this._settings.isEqual(e))throw new T(w.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._settings=e,void 0!==e.credentials&&(this._credentials=ua(e.credentials))},t.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},t.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},t.prototype.enablePersistence=function(t){if(this._firestoreClient)throw new T(w.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1;return t&&(void 0!==t.experimentalTabSynchronization&&m("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),e=C(void 0!==t.synchronizeTabs?t.synchronizeTabs:t.experimentalTabSynchronization,La)),this.configureClient(new $o(this._settings.cacheSizeBytes,e))},t.prototype.clearPersistence=function(){var t=this,e=_r.buildStoragePrefix(this.makeDatabaseInfo()),n=new wt;return this._queue.enqueueAndForgetEvenAfterShutdown((function(){return a.__awaiter(t,void 0,void 0,(function(){var t;return a.__generator(this,(function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),void 0!==this._firestoreClient&&!this._firestoreClient.clientTerminated)throw new T(w.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return[4,_r.clearPersistence(e)];case 1:return r.sent(),n.resolve(),[3,3];case 2:return t=r.sent(),n.reject(t),[3,3];case 3:return[2]}}))}))})),n.promise},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"_isTerminated",{get:function(){return this.ensureClientConfigured(),this._firestoreClient.clientTerminated},enumerable:!0,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.ensureClientConfigured(),this._firestoreClient.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this.ensureClientConfigured(),ca(t))return this.onSnapshotsInSyncInternal(t);L("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.onSnapshotsInSyncInternal(e)},t.prototype.onSnapshotsInSyncInternal=function(t){var e=this,n=function(t){throw g("Uncaught Error in onSnapshotsInSync")},r=new Zo({next:function(){t.next&&t.next()},error:n});return this._firestoreClient.addSnapshotsInSyncListener(r),function(){r.mute(),e._firestoreClient.removeSnapshotsInSyncListener(r)}},t.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new Xo),this._firestoreClient},t.prototype.makeDatabaseInfo=function(){return new lt(this._databaseId,this._persistenceKey,this._settings.host,this._settings.ssl,this._settings.forceLongPolling)},t.prototype.configureClient=function(t){v(!!this._settings.host,"FirestoreSettings.host is not set"),v(!this._firestoreClient,"configureClient() called multiple times");var e=this.makeDatabaseInfo();return this._firestoreClient=new Jo(b.getPlatform(),e,this._credentials,this._queue),this._firestoreClient.start(t)},t.prototype.createDataConverter=function(t){var e=function(e){if(e instanceof Ba){var n=t,r=e.firestore._databaseId;if(!r.isEqual(n))throw new T(w.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new Sa(t,e._key)}return e};return new Ca(e)},t.databaseIdFromApp=function(t){var e=t.options;if(!S(e,"projectId"))throw new T(w.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=e["projectId"];if(!n||"string"!==typeof n)throw new T(w.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new pt(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this._firebaseApp)throw new T(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){return O("Firestore.collection",arguments,1),L("Firestore.collection","non-empty string",1,t),this.ensureClientConfigured(),new Ya(gt.fromString(t),this)},t.prototype.doc=function(t){return O("Firestore.doc",arguments,1),L("Firestore.doc","non-empty string",1,t),this.ensureClientConfigured(),Ba.forPath(gt.fromString(t),this)},t.prototype.collectionGroup=function(t){if(O("Firestore.collectionGroup",arguments,1),L("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new T(w.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ensureClientConfigured(),new za(new Ki(gt.EMPTY_PATH,t),this)},t.prototype.runTransaction=function(t){var e=this;return O("Firestore.runTransaction",arguments,1),L("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction((function(n){return t(new qa(e,n))}))},t.prototype.batch=function(){return this.ensureClientConfigured(),new Va(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(f()){case i.DEBUG:return"debug";case i.ERROR:return"error";case i.SILENT:return"silent";default:return g("Unknown log level: "+f())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(O("Firestore.setLogLevel",arguments,1),L("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":p(i.DEBUG);break;case"error":p(i.ERROR);break;case"silent":p(i.SILENT);break;default:throw new T(w.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype._areTimestampsInSnapshotsEnabled=function(){return this._settings.timestampsInSnapshots},t}(),qa=function(){function t(t,e){this._firestore=t,this._transaction=e}return t.prototype.get=function(t){var e=this;O("Transaction.get",arguments,1);var n=Za("Transaction.get",t,this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return g("Mismatch in docs returned from document lookup.");var r=t[0];if(r instanceof on)return new Wa(e._firestore,n._key,null,!1,!1);if(r instanceof rn)return new Wa(e._firestore,n._key,r,!1,!1);throw g("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)}))},t.prototype.set=function(t,e,n){M("Transaction.set",arguments,2,3);var r=Za("Transaction.set",t,this._firestore);n=$a("Transaction.set",n);var i=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("Transaction.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("Transaction.set",e);return this._transaction.set(r._key,i),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return"string"===typeof e||e instanceof ta?(R("Transaction.update",arguments,3),r=Za("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",e,n,o)):(O("Transaction.update",arguments,2),r=Za("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("Transaction.update",e)),this._transaction.update(r._key,i),this},t.prototype.delete=function(t){O("Transaction.delete",arguments,1);var e=Za("Transaction.delete",t,this._firestore);return this._transaction.delete(e._key),this},t}(),Va=function(){function t(t){this._firestore=t,this._mutations=[],this._committed=!1}return t.prototype.set=function(t,e,n){M("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=Za("WriteBatch.set",t,this._firestore);n=$a("WriteBatch.set",n);var i=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("WriteBatch.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("WriteBatch.set",e);return this._mutations=this._mutations.concat(i.toMutations(r._key,Re.NONE)),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.verifyNotCommitted(),"string"===typeof e||e instanceof ta?(R("WriteBatch.update",arguments,3),r=Za("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,o)):(O("WriteBatch.update",arguments,2),r=Za("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",e)),this._mutations=this._mutations.concat(i.toMutations(r._key,Re.exists(!0))),this},t.prototype.delete=function(t){O("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=Za("WriteBatch.delete",t,this._firestore);return this._mutations=this._mutations.concat(new Ue(e._key,Re.NONE)),this},t.prototype.commit=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]}))}))},t.prototype.verifyNotCommitted=function(){if(this._committed)throw new T(w.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Ba=function(){function t(t,e){this._key=t,this.firestore=e,this._firestoreClient=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n){if(e.length%2!==0)throw new T(w.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(new _t(e),n)},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Ya(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(O("DocumentReference.collection",arguments,1),L("DocumentReference.collection","non-empty string",1,t),!t)throw new T(w.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=gt.fromString(t);return new Ya(this._key.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw X("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)},t.prototype.set=function(t,e){M("DocumentReference.set",arguments,1,2),e=$a("DocumentReference.set",e);var n=e.merge||e.mergeFields?this.firestore._dataConverter.parseMergeData("DocumentReference.set",t,e.mergeFields):this.firestore._dataConverter.parseSetData("DocumentReference.set",t);return this._firestoreClient.write(n.toMutations(this._key,Re.NONE))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"===typeof t||t instanceof ta?(R("DocumentReference.update",arguments,2),n=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,r)):(O("DocumentReference.update",arguments,1),n=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this._firestoreClient.write(n.toMutations(this._key,Re.exists(!0)))},t.prototype.delete=function(){return O("DocumentReference.delete",arguments,0),this._firestoreClient.write([new Ue(this._key,Re.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];M("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!==typeof t[i]||ca(t[i])||(r=t[i],$("DocumentReference.onSnapshot",r,["includeMetadataChanges"]),q("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return ca(t[i])?n=t[i]:(L("DocumentReference.onSnapshot","function",i,t[i]),F("DocumentReference.onSnapshot","function",i+1,t[i+1]),F("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Zo({next:function(t){if(e.next){v(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n._key);e.next(new Wa(n.firestore,n._key,r,t.fromCache,t.hasPendingWrites))}},error:r}),o=this._firestoreClient.listen(Ki.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},t.prototype.get=function(t){var e=this;return M("DocumentReference.get",arguments,0,1),Ja("DocumentReference.get",t),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentFromLocalCache(e._key).then((function(t){n(new Wa(e.firestore,e._key,t,!0,t instanceof rn&&t.hasLocalMutations))}),r):e.getViaSnapshotListener(n,r,t)}))},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new T(w.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new T(w.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t}(),ja=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Wa=function(){function t(t,e,n,r,i){this._firestore=t,this._key=e,this._document=n,this._fromCache=r,this._hasPendingWrites=i}return t.prototype.data=function(t){return M("DocumentSnapshot.data",arguments,0,1),t=Xa("DocumentSnapshot.data",t),this._document?this.convertObject(this._document.data(),qe.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},t.prototype.get=function(t,e){if(M("DocumentSnapshot.get",arguments,1,2),e=Xa("DocumentSnapshot.get",e),this._document){var n=this._document.data().field(Na("DocumentSnapshot.get",t));if(null!==n)return this.convertValue(n,qe.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Ba(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new ja(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw X("isEqual","DocumentSnapshot",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))},t.prototype.convertObject=function(t,e){var n=this,r={};return t.forEach((function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertValue=function(t,e){if(t instanceof tn)return this.convertObject(t,e);if(t instanceof en)return this.convertArray(t,e);if(t instanceof Je){var n=t.value(e),r=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.isEqual(r)||m("Document "+this._key.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new Ba(n,this._firestore)}return t.value(e)},t.prototype.convertArray=function(t,e){var n=this;return t.internalValue.map((function(t){return n.convertValue(t,e)}))},t}(),Ka=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return v("object"===typeof n,"Document in a QueryDocumentSnapshot should exist"),n},e}(Wa),za=function(){function t(t,e){this._query=t,this.firestore=e}return t.prototype.where=function(e,n,r){O("Query.where",arguments,3),Y("Query.where",3,r);var i,o=["<","<=","==",">=",">","array-contains","in","array-contains-any"];K("Query.where",o,2,n);var a=Na("Query.where",e),s=Gi.fromString(n);if(a.isKeyField()){if(s===Gi.ARRAY_CONTAINS||s===Gi.ARRAY_CONTAINS_ANY)throw new T(w.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+s.toString()+"' queries on FieldPath.documentId().");if(s===Gi.IN){this.validateDisjunctiveFilterElements(r,s);for(var u=[],c=0,h=r;c<h.length;c++){var l=h[c];u.push(this.parseDocumentIdValue(l))}i=new en(u)}else i=this.parseDocumentIdValue(r)}else s!==Gi.IN&&s!==Gi.ARRAY_CONTAINS_ANY||this.validateDisjunctiveFilterElements(r,s),i=this.firestore._dataConverter.parseQueryValue("Query.where",r,s===Gi.IN);var f=Qi.create(a,s,i);return this.validateNewFilter(f),new t(this._query.addFilter(f),this.firestore)},t.prototype.orderBy=function(e,n){var r;if(M("Query.orderBy",arguments,1,2),F("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=Zi.ASCENDING;else{if("desc"!==n)throw new T(w.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=Zi.DESCENDING}if(null!==this._query.startAt)throw new T(w.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new T(w.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Na("Query.orderBy",e),o=new eo(i,r);return this.validateNewOrderBy(o),new t(this._query.addOrderBy(o),this.firestore)},t.prototype.limit=function(e){return O("Query.limit",arguments,1),L("Query.limit","number",1,e),J("Query.limit",1,e),new t(this._query.withLimitToFirst(e),this.firestore)},t.prototype.limitToLast=function(e){return O("Query.limitToLast",arguments,1),L("Query.limitToLast","number",1,e),J("Query.limitToLast",1,e),new t(this._query.withLimitToLast(e),this.firestore)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];R("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",e,n,!0);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];R("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",e,n,!1);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];R("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",e,n,!0);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];R("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",e,n,!1);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw X("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if(Y(t,1,e),e instanceof Wa){if(n.length>0)throw new T(w.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new T(w.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new Je(this.firestore._databaseId,e.key));else{var s=e.field(a.field);if(s instanceof $e)throw new T(w.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=a.field.canonicalString();throw new T(w.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new to(r,n)},t.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new T(w.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var a=e[o],s=r[o];if(s.field.isKeyField()){if("string"!==typeof a)throw new T(w.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof a);if(!this._query.isCollectionGroupQuery()&&-1!==a.indexOf("/"))throw new T(w.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+a+"' contains a slash.");var u=this._query.path.child(gt.fromString(a));if(!_t.isDocumentKey(u))throw new T(w.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var c=new _t(u);i.push(new Je(this.firestore._databaseId,c))}else{var h=this.firestore._dataConverter.parseQueryValue(t,a);i.push(h)}}return new to(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];M("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!==typeof t[i]||ca(t[i])||(r=t[i],$("Query.onSnapshot",r,["includeMetadataChanges"]),q("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),ca(t[i])?n=t[i]:(L("Query.onSnapshot","function",i,t[i]),F("Query.onSnapshot","function",i+1,t[i+1]),F("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.validateHasExplicitOrderByForLimitToLast(this._query),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Zo({next:function(t){e.next&&e.next(new Ga(n.firestore,n._query,t))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(a)}},t.prototype.validateHasExplicitOrderByForLimitToLast=function(t){if(t.hasLimitToLast()&&0===t.explicitOrderBy.length)throw new T(w.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},t.prototype.get=function(t){var e=this;return M("Query.get",arguments,0,1),Ja("Query.get",t),this.validateHasExplicitOrderByForLimitToLast(this._query),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentsFromLocalCache(e._query).then((function(t){n(new Ga(e.firestore,e._query,t))}),r):e.getViaSnapshotListener(n,r,t)}))},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new T(w.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.parseDocumentIdValue=function(t){if("string"===typeof t){if(""===t)throw new T(w.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this._query.isCollectionGroupQuery()&&-1!==t.indexOf("/"))throw new T(w.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this._query.path.child(gt.fromString(t));if(!_t.isDocumentKey(e))throw new T(w.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return new Je(this.firestore._databaseId,new _t(e))}if(t instanceof Ba){var n=t;return new Je(this.firestore._databaseId,n._key)}throw new T(w.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Q(t)+".")},t.prototype.validateDisjunctiveFilterElements=function(t,e){if(!Array.isArray(t)||0===t.length)throw new T(w.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new T(w.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(t.indexOf(null)>=0)throw new T(w.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter((function(t){return Number.isNaN(t)})).length>0)throw new T(w.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},t.prototype.validateNewFilter=function(t){if(t instanceof Qi){var e=[Gi.ARRAY_CONTAINS,Gi.ARRAY_CONTAINS_ANY],n=[Gi.IN,Gi.ARRAY_CONTAINS_ANY],r=e.indexOf(t.op)>=0,i=n.indexOf(t.op)>=0;if(t.isInequality()){var o=this._query.getInequalityFilterField();if(null!==o&&!o.isEqual(t.field))throw new T(w.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var a=this._query.getFirstOrderByField();null!==a&&this.validateOrderByAndInequalityMatch(t.field,a)}else if(i||r){var s=null;if(i&&(s=this._query.findFilterOperator(n)),null===s&&r&&(s=this._query.findFilterOperator(e)),null!=s)throw s===t.op?new T(w.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new T(w.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+s.toString()+"' filters.")}}},t.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.isEqual(t))throw new T(w.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),Ga=function(){function t(t,e,n){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new ja(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;M("QuerySnapshot.forEach",arguments,1,2),L("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach((function(r){t.call(e,n.convertToDocumentImpl(r))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new za(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&($("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),q("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this._snapshot.excludesMetadataChanges)throw new T(w.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=ts(this._firestore,e,this._snapshot),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t.prototype.isEqual=function(e){if(!(e instanceof t))throw X("isEqual","QuerySnapshot",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)},t.prototype.convertToDocumentImpl=function(t){return new Ka(this._firestore,t.key,t,this.metadata.fromCache,this._snapshot.mutatedKeys.has(t.key))},t}();function Qa(){throw new T(w.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}var Ha=a.__spreadArrays(["length","forEach","map"],"undefined"!==typeof Symbol?[Symbol.iterator]:[]);Ha.forEach((function(t){try{Object.defineProperty(Ga.prototype.docChanges,t,{get:function(){return Qa()}})}catch(e){}}));var Ya=function(t){function e(e,n){var r=t.call(this,Ki.atPath(e),n)||this;if(e.length%2!==1)throw new T(w.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return r}return a.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new Ba(new _t(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(M("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=et.newId()),L("CollectionReference.doc","non-empty string",1,t),""===t)throw new T(w.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=gt.fromString(t);return Ba.forPath(this._query.path.child(e),this.firestore)},e.prototype.add=function(t){O("CollectionReference.add",arguments,1),L("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then((function(){return e}))},e}(za);function $a(t,e){if(void 0===e)return{merge:!1};if($(t,e,["merge","mergeFields"]),q(t,"boolean","merge",e.merge),B(t,"mergeFields","a string or a FieldPath",e.mergeFields,(function(t){return"string"===typeof t||t instanceof ta})),void 0!==e.mergeFields&&void 0!==e.merge)throw new T(w.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Xa(t,e){return void 0===e?{}:($(t,e,["serverTimestamps"]),W(t,"options","serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Ja(t,e){F(t,"object",1,e),e&&($(t,e,["source"]),W(t,"options","source",e.source,["default","server","cache"]))}function Za(t,e,n){if(e instanceof Ba){if(e.firestore!==n)throw new T(w.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw X(t,"DocumentReference",1,e)}function ts(t,e,n){if(n.oldDocs.isEmpty()){var r,i=0;return n.docChanges.map((function(e){var o=new Ka(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key));return v(e.type===Ti.Added,"Invalid event type for first snapshot"),v(!r||n.query.docComparator(r,e.doc)<0,"Got added events in wrong order"),r=e.doc,{type:"added",doc:o,oldIndex:-1,newIndex:i++}}))}var o=n.oldDocs;return n.docChanges.filter((function(t){return e||t.type!==Ti.Metadata})).map((function(e){var r=new Ka(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key)),i=-1,a=-1;return e.type!==Ti.Added&&(i=o.indexOf(e.doc.key),v(i>=0,"Index for document not found"),o=o.delete(e.doc.key)),e.type!==Ti.Removed&&(o=o.add(e.doc),a=o.indexOf(e.doc.key)),{type:es(e.type),doc:r,oldIndex:i,newIndex:a}}))}function es(t){switch(t){case Ti.Added:return"added";case Ti.Modified:case Ti.Metadata:return"modified";case Ti.Removed:return"removed";default:return g("Unknown change type: "+t)}}var ns=E(Ua,"Use firebase.firestore() instead."),rs=E(qa,"Use firebase.firestore().runTransaction() instead."),is=E(Va,"Use firebase.firestore().batch() instead."),os=E(Ba,"Use firebase.firestore().doc() instead."),as=E(Wa),ss=E(Ka),us=E(za),cs=E(Ga),hs=E(Ya,"Use firebase.firestore().collection() instead."),ls={Firestore:ns,GeoPoint:ji,Timestamp:Ot,Blob:ht,Transaction:rs,WriteBatch:is,DocumentReference:os,DocumentSnapshot:as,Query:us,QueryDocumentSnapshot:ss,QuerySnapshot:cs,CollectionReference:hs,FieldPath:ta,FieldValue:va,setLogLevel:Ua.setLogLevel,CACHE_SIZE_UNLIMITED:Pa};function fs(t){t.INTERNAL.registerService("firestore",(function(t){return new Ua(t)}),D(ls))}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ps=function(){function t(){}return t.prototype.addCallback=function(t){},t.prototype.shutdown=function(){},t}(),ds="ConnectivityMonitor",ms=function(){function t(){var t=this;this.networkAvailableListener=function(){return t.onNetworkAvailable()},this.networkUnavailableListener=function(){return t.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}return t.prototype.addCallback=function(t){this.callbacks.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},t.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},t.prototype.onNetworkAvailable=function(){d(ds,"Network connectivity changed: AVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++){var n=e[t];n(0)}},t.prototype.onNetworkUnavailable=function(){d(ds,"Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++){var n=e[t];n(1)}},t.isAvailable=function(){return"undefined"!==typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),ys=function(){function t(t){this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){v(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){v(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){v(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){v(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){v(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){v(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},t}(),gs="Connection",vs="google.firestore.v1.Firestore",bs="v1",_s={BatchGetDocuments:"batchGet",Commit:"commit"},ws="gl-js/ fire/"+h,Ts=15,Es=function(){function t(t){this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.baseUrl=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=ws},t.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise((function(o,s){var u=new c.XhrIo;u.listenOnce(c.EventType.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case c.ErrorCode.NO_ERROR:var e=u.getResponseJson();d(gs,"XHR received:",JSON.stringify(e)),o(e);break;case c.ErrorCode.TIMEOUT:d(gs,'RPC "'+t+'" timed out'),s(new T(w.DEADLINE_EXCEEDED,"Request time out"));break;case c.ErrorCode.HTTP_ERROR:var n=u.getStatus();if(d(gs,'RPC "'+t+'" failed with status:',n,"response text:",u.getResponseText()),n>0){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var i=wi(r.status);s(new T(i,r.message))}else s(new T(w.UNKNOWN,"Server responded with status "+u.getStatus()))}else d(gs,'RPC "'+t+'" failed'),s(new T(w.UNAVAILABLE,"Connection failed."));break;default:g('RPC "'+t+'" failed with unanticipated webchannel error '+u.getLastErrorCode()+": "+u.getLastError()+", giving up.")}}finally{d(gs,'RPC "'+t+'" completed.')}}));var h=a.__assign({},e);delete h.database;var l=JSON.stringify(h);d(gs,"XHR sending: ",i+" "+l);var f={"Content-Type":"text/plain"};r.modifyHeadersForRequest(f,n),u.send(i,"POST",l,f,Ts)}))},t.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},t.prototype.openStream=function(t,e){var n=[this.baseUrl,"/",vs,"/",t,"/channel"],r=c.createWebChannelTransport(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.modifyHeadersForRequest(i.initMessageHeaders,e),u.isReactNative()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");d(gs,"Creating WebChannel: "+o+" "+i);var a=r.createWebChannel(o,i),s=!1,h=!1,l=new ys({sendFn:function(t){h?d(gs,"Not sending because WebChannel is closed:",t):(s||(d(gs,"Opening WebChannel transport."),a.open(),s=!0),d(gs,"WebChannel sending:",t),a.send(t))},closeFn:function(){return a.close()}}),f=function(t,e){a.listen(t,(function(t){try{e(t)}catch(n){setTimeout((function(){throw n}),0)}}))};return f(c.WebChannel.EventType.OPEN,(function(){h||d(gs,"WebChannel transport opened.")})),f(c.WebChannel.EventType.CLOSE,(function(){h||(h=!0,d(gs,"WebChannel transport closed"),l.callOnClose())})),f(c.WebChannel.EventType.ERROR,(function(t){h||(h=!0,d(gs,"WebChannel transport errored:",t),l.callOnClose(new T(w.UNAVAILABLE,"The operation could not be completed")))})),f(c.WebChannel.EventType.MESSAGE,(function(t){if(!h){var e=t.data[0];v(!!e,"Got a webchannel message without data.");var n=e,r=n.error||n[0]&&n[0].error;if(r){d(gs,"WebChannel received error:",r);var i=r.status,o=vi(i),s=r.message;void 0===o&&(o=w.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),h=!0,l.callOnClose(new T(o,s)),a.close()}else d(gs,"WebChannel received:",e),l.callOnMessage(e)}})),setTimeout((function(){l.callOnOpen()}),0),l},t.prototype.makeUrl=function(t){var e=_s[t];return v(void 0!==e,"Unknown REST mapping for: "+t),this.baseUrl+"/"+bs+"/projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents:"+e},t}(),Ss=function(){function t(){this.emptyByteString="",this.base64Available="undefined"!==typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!==typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return"undefined"!==typeof window?window:null},enumerable:!0,configurable:!0}),t.prototype.loadConnection=function(t){return Promise.resolve(new Es(t))},t.prototype.newConnectivityMonitor=function(){return ms.isAvailable()?new ms:new ps},t.prototype.newSerializer=function(t){return new yo(t,{useProto3Json:!0})},t.prototype.formatJSON=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Cs(t){fs(t)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
b.setPlatform(new Ss),Cs(o),e.registerFirestore=Cs}).call(this,n("4362"))},ebd6:function(t,e,n){var r=n("cb7c"),i=n("d8e8"),o=n("2b4c")("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||void 0==(n=r(a)[o])?e:i(n)}},ee68:function(t,e,n){(function(t,e){!function(t,e){e(n("c23d"))}(0,(function(n){"use strict";try{(function(){n=n&&n.hasOwnProperty("default")?n.default:n;var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o,a,s=function(){return(s=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function u(t,e,n,r){return new(n=n||Promise)((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function c(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function h(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function l(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function f(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString();switch(e){case o.DEBUG:case o.VERBOSE:console.log.apply(console,l(["["+i+"]  "+t.name+":"],n));break;case o.INFO:console.info.apply(console,l(["["+i+"]  "+t.name+":"],n));break;case o.WARN:console.warn.apply(console,l(["["+i+"]  "+t.name+":"],n));break;case o.ERROR:console.error.apply(console,l(["["+i+"]  "+t.name+":"],n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}}(a=o=o||{})[a.DEBUG=0]="DEBUG",a[a.VERBOSE=1]="VERBOSE",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.SILENT=5]="SILENT";var p=o.INFO,d=(Object.defineProperty(m.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in o))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),m.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,l([this,o.DEBUG],t))},m.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,l([this,o.VERBOSE],t))},m.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,l([this,o.INFO],t))},m.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,l([this,o.WARN],t))},m.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,l([this,o.ERROR],t))},m);function m(t){this.name=t,this._logLevel=p,this._logHandler=f}function y(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var g,v=(i(b,g=Error),b);function b(t,e){var n=g.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,b.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,_.prototype.create),n}var _=(w.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?function(t,e){return t.replace(E,(function(t,n){var r=e[n];return null!=r?r.toString():"<"+n+"?>"}))}(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new v(i,s),c=0,h=Object.keys(r);c<h.length;c++){var l=h[c];"_"!==l.slice(-1)&&(l in u&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),u[l]=r[l])}return u},w);function w(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T,E=/\{\$([^}]+)}/g,S="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:{},C=C||{},I=S;function A(t){return"string"==typeof t}function N(t){return"number"==typeof t}function k(t,e){t=t.split("."),e=e||I;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function D(){}function x(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function O(t){return"array"==x(t)}function R(t){var e=x(t);return"array"==e||"object"==e&&"number"==typeof t.length}function M(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),L=0;function F(t,e,n){return t.call.apply(t.bind,arguments)}function U(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function q(t,e,n){return(q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?F:U).apply(null,arguments)}function V(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var B=Date.now||function(){return+new Date};function j(t,e){function n(){}n.prototype=e.prototype,t.N=e.prototype,t.prototype=new n,(t.prototype.constructor=t).yb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function W(){this.j=this.j,this.i=this.i}W.prototype.j=!1,W.prototype.la=function(){!this.j&&(this.j=!0,this.G(),0)&&(this[P]||(this[P]=++L))},W.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var K=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(A(t))return A(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},z=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=A(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(t){return Array.prototype.concat.apply([],arguments)}function Q(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var Y,$=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:e<t?1:0}t:{var Z=I.navigator;if(Z){var tt=Z.userAgent;if(tt){Y=tt;break t}}Y=""}function et(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function nt(t){var e,n={};for(e in t)n[e]=t[e];return n}var rt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function it(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<rt.length;o++)n=rt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ot(t){return ot[" "](t),t}ot[" "]=D;var at,st,ut=X(Y,"Opera"),ct=X(Y,"Trident")||X(Y,"MSIE"),ht=X(Y,"Edge"),lt=ht||ct,ft=X(Y,"Gecko")&&!(X(Y.toLowerCase(),"webkit")&&!X(Y,"Edge"))&&!(X(Y,"Trident")||X(Y,"MSIE"))&&!X(Y,"Edge"),pt=X(Y.toLowerCase(),"webkit")&&!X(Y,"Edge");function dt(){var t=I.document;return t?t.documentMode:void 0}t:{var mt="",yt=(st=Y,ft?/rv:([^\);]+)(\)|;)/.exec(st):ht?/Edge\/([\d\.]+)/.exec(st):ct?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(st):pt?/WebKit\/(\S+)/.exec(st):ut?/(?:Version)[ \/]?(\S+)/.exec(st):void 0);if(yt&&(mt=yt?yt[1]:""),ct){var gt=dt();if(null!=gt&&gt>parseFloat(mt)){at=String(gt);break t}}at=mt}var vt,bt={};function _t(t){return function(t,e){var n=bt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=$(String(at)).split("."),r=$(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=J(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==a[2].length,0==s[2].length)||J(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}var wt=I.document;vt=wt&&ct?dt()||("CSS1Compat"==wt.compatMode?parseInt(at,10):5):void 0;var Tt=!ct||9<=Number(vt),Et=ct&&!_t("9"),St=function(){if(!I.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{I.addEventListener("test",D,e),I.removeEventListener("test",D,e)}catch(t){}return t}();function Ct(t,e){this.type=t,this.a=this.target=e,this.Ja=!0}function It(t,e){if(Ct.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ft){t:{try{ot(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=A(t.pointerType)?t.pointerType:At[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Ct.prototype.b=function(){this.Ja=!1},j(It,Ct);var At={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Et)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Nt="closure_listenable_"+(1e6*Math.random()|0),kt=0;function Dt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++kt,this.X=this.Z=!1}function xt(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function Ot(t){this.src=t,this.a={},this.b=0}function Rt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=K(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(xt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Mt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}Ot.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=Mt(t,e,r,i);return-1<a?(e=t[a],n||(e.Z=!1)):((e=new Dt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Lt={};function Ft(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(O(n)){for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);return null}return r=zt(r),e&&e[Nt]?e.Ba(n,r,M(i)?!!i.capture:!!i,o):Ut(e,n,r,!0,i,o)}(t,e,n,r,i);if(O(e)){for(var o=0;o<e.length;o++)Ft(t,e[o],n,r,i);return null}return n=zt(n),t&&t[Nt]?t.Aa(e,n,M(r)?!!r.capture:!!r,i):Ut(t,e,n,!1,r,i)}function Ut(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=M(i)?!!i.capture:!!i;if(a&&!Tt)return null;var s=Wt(t);if(s||(t[Pt]=s=new Ot(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){var t=jt,e=Tt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),(n.proxy=r).src=t,r.listener=n,t.addEventListener)St||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Vt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function qt(t){if(!N(t)&&t&&!t.X){var e=t.src;if(e&&e[Nt])Rt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Vt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Wt(e))?(Rt(n,t),0==n.b&&(n.src=null,e[Pt]=null)):xt(t)}}}function Vt(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function Bt(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&qt(t),n.call(r,e)}function jt(t,e){return!!t.X||Bt(t,Tt?new It(e,this):e=new It(e||k("window.event"),this))}function Wt(t){return(t=t[Pt])instanceof Ot?t:null}var Kt="__closure_events_fn_"+(1e9*Math.random()>>>0);function zt(t){return"function"==x(t)?t:(t[Kt]||(t[Kt]=function(e){return t.handleEvent(e)}),t[Kt])}function Gt(){W.call(this),this.c=new Ot(this),(this.J=this).B=null}function Qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.X&&a.capture==n){var s=a.listener,u=a.da||a.src;a.Z&&Rt(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Ja}j(Gt,W),Gt.prototype[Nt]=!0,(T=Gt.prototype).addEventListener=function(t,e,n,r){Ft(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(O(n))for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);else i=M(i)?!!i.capture:!!i,r=zt(r),e&&e[Nt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Mt(a=e.a[n],r,i,o))&&(xt(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete e.a[n],e.b--))):(e=e&&Wt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Mt(n,r,i,o)),(r=-1<e?n[e]:null)&&qt(r))}(this,t,e,n,r)},T.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var r=t.type||t;if(A(t))t=new Ct(t,n);else if(t instanceof Ct)t.target=t.target||n;else{var i=t;it(t=new Ct(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.a=e[o];i=Qt(a,r,!0,t)&&i}if(i=Qt(a=t.a=n,r,!0,t)&&i,i=Qt(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Qt(a=t.a=e[o],r,!1,t)&&i;return i},T.G=function(){if(Gt.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)xt(n[r]);delete e.a[t],e.b--}}this.B=null},T.Aa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},T.Ba=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ht=I.JSON.stringify;function Yt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function $t(){this.b=this.a=null}Yt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Xt,Jt=new Yt((function(){return new Zt}),(function(t){t.reset()}));function Zt(){this.next=this.b=this.a=null}function te(t){I.setTimeout((function(){throw t}),0)}function ee(t,e){Xt||function(){var t=I.Promise.resolve(void 0);Xt=function(){t.then(ie)}}(),ne||(Xt(),ne=!0),re.add(t,e)}$t.prototype.add=function(t,e){var n=Jt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Zt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var ne=!(Zt.prototype.reset=function(){this.next=this.b=this.a=null}),re=new $t;function ie(){for(var t;r=n=void 0,r=null,(n=re).a&&(r=n.a,n.a=n.a.next,n.a||(n.b=null),r.next=null),t=r;){try{t.a.call(t.b)}catch(t){te(t)}var e=Jt;e.f(t),e.b<100&&(e.b++,t.next=e.a,e.a=t)}var n,r;ne=!1}function oe(t,e){Gt.call(this),this.b=t||1,this.a=e||I,this.f=q(this.gb,this),this.g=B()}function ae(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function se(t,e,n){if("function"==x(t))n&&(t=q(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=q(t.handleEvent,t)}return 2147483647<Number(e)?-1:I.setTimeout(t,e||0)}function ue(t,e,n){W.call(this),this.f=null!=n?q(t,n):t,this.c=e,this.b=q(this.ab,this),this.a=[]}function ce(t){t.U=se(t.b,t.c),t.f.apply(null,t.a)}function he(t){W.call(this),this.b=t,this.a={}}j(oe,Gt),(T=oe.prototype).ba=!1,T.L=null,T.gb=function(){if(this.ba){var t=B()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(ae(this),this.start()))}},T.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=B())},T.G=function(){oe.N.G.call(this),ae(this),delete this.a},j(ue,W),(T=ue.prototype).ea=!1,T.U=null,T.Ua=function(t){this.a=arguments,this.U?this.ea=!0:ce(this)},T.G=function(){ue.N.G.call(this),this.U&&(I.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},T.ab=function(){this.U=null,this.ea&&(this.ea=!1,ce(this))},j(he,W);var le=[];function fe(t,e,n,r){O(n)||(n&&(le[0]=n.toString()),n=le);for(var i=0;i<n.length;i++){var o=Ft(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function pe(t){et(t.a,(function(t,e){this.a.hasOwnProperty(e)&&qt(t)}),t),t.a={}}function de(){}he.prototype.G=function(){he.N.G.call(this),pe(this)},he.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var me=new Gt;function ye(t){Ct.call(this,"serverreachability",t)}function ge(t){me.dispatchEvent(new ye(me,t))}function ve(t){Ct.call(this,"statevent",t)}function be(t){me.dispatchEvent(new ve(me,t))}function _e(t){Ct.call(this,"timingevent",t)}function we(t,e){if("function"!=x(t))throw Error("Fn must not be null and must be a function");return I.setTimeout((function(){t()}),e)}j(ye,Ct),j(ve,Ct),j(_e,Ct);var Te={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,Ma:7,TIMEOUT:8,sb:9},Ee={jb:"complete",wb:"success",Na:"error",Ma:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function Se(){}function Ce(t){var e;return(e=t.a)||(e=t.a={}),e}function Ie(){}Se.prototype.a=null;var Ae,Ne={OPEN:"a",ib:"b",Na:"c",rb:"d"};function ke(){Ct.call(this,"d")}function De(){Ct.call(this,"c")}function xe(){}function Oe(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new he(this),this.O=Re,t=lt?125:void 0,this.P=new oe(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}j(ke,Ct),j(De,Ct),j(xe,Se),Ae=new xe;var Re=45e3,Me={},Pe={};function Le(t,e,n){t.F=1,t.f=un(tn(e)),t.l=n,t.H=!0,Ue(t,null)}function Fe(t,e,n,r){t.F=1,t.f=un(tn(e)),t.l=null,t.H=n,Ue(t,r)}function Ue(t,e){t.v=B(),Be(t),t.D=tn(t.f),sn(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new ue(q(t.Ka,t,t.a),t.J)),fe(t.I,t.a,"readystatechange",t.eb),e=t.h?nt(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),ge(1)}function qe(t,e,n){for(var r=!0;!t.m&&t.A<n.length;){var i=Ve(t,n);if(i==Pe){4==e&&(t.c=4,be(14),r=!1);break}if(i==Me){t.c=4,be(15),r=!1;break}Ge(t,i)}4==e&&0==n.length&&(t.c=1,be(16),r=!1),t.b=t.b&&r,r||(ze(t),Ke(t))}function Ve(t,e){var n=t.A,r=e.indexOf("\n",n);return-1==r?Pe:(n=Number(e.substring(n,r)),isNaN(n)?Me:(r+=1)+n>e.length?Pe:(e=e.substr(r,n),t.A=r+n,e))}function Be(t){t.R=B()+t.O,je(t,t.O)}function je(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=we(q(t.bb,t),e)}function We(t){t.i&&(I.clearTimeout(t.i),t.i=null)}function Ke(t){t.g.Da()||t.m||t.g.na(t)}function ze(t){We(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,ae(t.P),pe(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Ge(t,e){try{t.g.Ga(t,e),ge(4)}catch(t){}}function Qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(R(t)||A(t))z(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(R(t)||A(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(A(t))return t.split("");if(R(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ye(t,e){Xe(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&$e(t))}function $e(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Xe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Xe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(T=Oe.prototype).setTimeout=function(t){this.O=t},T.eb=function(t){t=t.target;var e=this.B;e&&3==tr(t)?e.Ua():this.Ka(t)},T.Ka=function(t){try{if(t==this.a)t:{var e=tr(this.a),n=this.a.ya(),r=this.a.T();if(!(e<3||3==e&&!lt&&!this.a.aa())){this.m||4!=e||7==n||ge(8==n||r<=0?3:2),We(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var a=er(this.a,"X-HTTP-Initial-Response");if(a&&!H(a)){var s=a;break e}}s=null}if(!s){this.b=!1,this.c=3,be(12),ze(this),Ke(this);break t}this.s=!0,Ge(this,s)}this.H?(qe(this,e,o),lt&&this.b&&3==e&&(fe(this.I,this.P,"tick",this.cb),this.P.start())):Ge(this,o),4==e&&ze(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,Be(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,be(12)):(this.c=0,be(13)),ze(this),Ke(this)}}}catch(t){}},T.cb=function(){if(this.a){var t=tr(this.a),e=this.a.aa();this.A<e.length&&(We(this),qe(this,t,e),this.b&&4!=t&&Be(this))}},T.cancel=function(){this.m=!0,ze(this)},T.bb=function(){this.i=null;var t=B();0<=t-this.R?(2!=this.F&&(ge(3),be(17)),ze(this),this.c=2,Ke(this)):je(this,this.R-t)},(T=He.prototype).C=function(){$e(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},T.K=function(){return $e(this),this.a.concat()},T.get=function(t,e){return Xe(this.b,t)?this.b[t]:e},T.set=function(t,e){Xe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},T.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Je=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ze(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof Ze?(this.h=void 0!==e?e:t.h,en(this,t.f),this.j=t.j,nn(this,t.b),rn(this,t.i),this.a=t.a,on(this,Tn(t.c)),this.g=t.g):t&&(n=String(t).match(Je))?(this.h=!!e,en(this,n[1]||"",!0),this.j=cn(n[2]||""),nn(this,n[3]||"",!0),rn(this,n[4]),this.a=cn(n[5]||"",!0),on(this,n[6]||"",!0),this.g=cn(n[7]||"")):(this.h=!!e,this.c=new gn(null,this.h))}function tn(t){return new Ze(t)}function en(t,e,n){t.f=n?cn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function nn(t,e,n){t.b=n?cn(e,!0):e}function rn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.i=e}else t.i=null}function on(t,e,n){e instanceof gn?(t.c=e,function(t,e){e&&!t.f&&(vn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(bn(this,e),wn(this,n,t))}),t)),t.f=e}(t.c,t.h)):(n||(e=hn(e,mn)),t.c=new gn(e,t.h))}function an(t,e,n){t.c.set(e,n)}function sn(t,e,n){O(n)||(n=[String(n)]),wn(t.c,e,n)}function un(t){return an(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^B()).toString(36)),t}function cn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function hn(t,e,n){return A(t)?(t=encodeURI(t).replace(e,ln),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ln(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(hn(e,fn,!0),":");var n=this.b;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(hn(e,fn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(hn(n,"/"==n.charAt(0)?dn:pn,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",hn(n,yn)),t.join("")},Ze.prototype.resolve=function(t){var e=tn(this),n=!!t.f;n?en(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?nn(e,t.b):n=null!=t.i;var r=t.a;if(n)rn(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(X(i,"./")||X(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?on(e,Tn(t.c)):n=!!t.g,n&&(e.g=t.g),e};var fn=/[#\/\?@]/g,pn=/[#\?:]/g,dn=/[#\?]/g,mn=/[#\?@]/g,yn=/#/g;function gn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function vn(t){t.a||(t.a=new He,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function bn(t,e){vn(t),e=En(t,e),Xe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye(t.a,e))}function _n(t,e){return vn(t),e=En(t,e),Xe(t.a.b,e)}function wn(t,e,n){bn(t,e),0<n.length&&(t.c=null,t.a.set(En(t,e),Q(n)),t.b+=n.length)}function Tn(t){var e=new gn;return e.c=t.c,t.a&&(e.a=new He(t.a),e.b=t.b),e}function En(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Sn(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function Cn(t){var e=t.a.F.a;if(null!=e)be(4),e?(be(10),pr(t.a,t,!1)):(be(11),pr(t.a,t,!0));else{t.b=new Oe(t,void 0,void 0),t.b.h=t.h,e=vr(e=t.a,e.Y()?t.f:null,t.i),be(4),sn(e,"TYPE","xmlhttp");var n=t.a.j,r=t.a.I;n&&r&&an(e,n,r),Fe(t.b,e,!1,t.f)}}function In(){this.a=this.b=null}function An(){this.a=new He}function Nn(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[P]||(t[P]=++L)):e.charAt(0)+t}function kn(t,e){this.b=t,this.a=e}function Dn(t){this.g=t||xn,t=I.PerformanceNavigationTiming?0<(t=I.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(I.ka&&I.ka.Ea&&I.ka.Ea()&&I.ka.Ea().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new An),this.b=null,this.c=[]}(T=gn.prototype).add=function(t,e){vn(this),this.c=null,t=En(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},T.forEach=function(t,e){vn(this),this.a.forEach((function(n,r){z(n,(function(n){t.call(e,n,r,this)}),this)}),this)},T.K=function(){vn(this);for(var t=this.a.C(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},T.C=function(t){vn(this);var e=[];if(A(t))_n(this,t)&&(e=G(e,this.a.get(En(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},T.set=function(t,e){return vn(this),this.c=null,_n(this,t=En(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},T.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},T.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")},j((function(){}),(function(){})),(T=Sn.prototype).M=null,T.$=function(t){return this.a.$(t)},T.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},T.Da=function(){return!1},T.Ga=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=er(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=er(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var r=this.a.ja.a.parse(e)}catch(t){return(e=this.a).m=this.c,void yr(e,2)}this.f=r[0]}else(e=this.a).m=this.c,yr(e,2)}else 1==this.M&&(this.g?be(6):"11111"==e?(be(5),this.g=!0,(!ct||10<=Number(vt))&&(this.c=200,this.b.cancel(),be(11),pr(this.a,this,!0))):(be(7),this.g=!1))},T.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,Cn(this)):1==this.M&&(this.g?(be(11),pr(this.a,this,!0)):(be(10),pr(this.a,this,!1)));else{0==this.M?be(8):1==this.M&&be(9);var t=this.a;t.m=this.c,yr(t,2)}},T.Y=function(){return this.a.Y()},T.ma=function(){return this.a.ma()},An.prototype.add=function(t){this.a.set(Nn(t),t)},An.prototype.C=function(){return this.a.C()};var xn=10;function On(t,e){!t.a&&(X(e,"spdy")||X(e,"quic")||X(e,"h2"))&&(t.f=t.g,t.a=new An,t.b&&(Ln(t,t.b),t.b=null))}function Rn(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function Mn(t){return t.b?1:t.a?t.a.a.c:0}function Pn(t,e){return t.b?t.b==e:!!t.a&&(e=Nn(e),Xe(t.a.a.b,e))}function Ln(t,e){t.a?t.a.add(e):t.b=e}function Fn(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=Nn(e),n=Xe(t.a.a.b,n)),n&&Ye(t.a.a,Nn(e)))}function Un(t){if(null!=t.b)return t.c.concat(t.b.j);if(null==t.a||0==t.a.a.c)return Q(t.c);var e=t.c;return z(t.a.C(),(function(t){e=e.concat(t.j)})),e}function qn(){}function Vn(){this.a=new qn}function Bn(t,e,n){var r=n||"";try{Qe(t,(function(t,n){var i=t;M(t)&&(i=Ht(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function jn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}Dn.prototype.cancel=function(){this.c=Un(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(z(this.a.C(),(function(t){t.cancel()})),function(t){t.b={},t.a.length=0,t.c=0}(this.a.a))},qn.prototype.stringify=function(t){return I.JSON.stringify(t,void 0)},qn.prototype.parse=function(t){return I.JSON.parse(t,void 0)};var Wn=I.JSON.parse;function Kn(t){Gt.call(this),this.headers=new He,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=zn,this.D=this.F=!1}j(Kn,Gt);var zn="",Gn=/^https?$/i,Qn=["POST","PUT"];function Hn(t){return"content-type"==t.toLowerCase()}function Yn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,$n(t),Jn(t)}function $n(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Xn(t){if(t.b&&void 0!==C&&(!t.s[1]||4!=tr(t)||2!=t.T()))if(t.l&&4==tr(t))se(t.Fa,0,t);else if(t.dispatchEvent("readystatechange"),4==tr(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.A).match(Je)[1]||null;if(!o&&I.self&&I.self.location){var a=I.self.location.protocol;o=a.substr(0,a.length-1)}i=!Gn.test(o?o.toLowerCase():"")}e=i}e?(t.dispatchEvent("complete"),t.dispatchEvent("success")):(t.h=6,t.f=t.za()+" ["+t.T()+"]",$n(t))}finally{Jn(t)}}}function Jn(t,e){if(t.a){Zn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Zn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(I.clearTimeout(t.m),t.m=null)}function tr(t){return t.a?t.a.readyState:0}function er(t,e){return t.a?t.a.getResponseHeader(e):null}function nr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=function(t){var e="";return et(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),A(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if((n=t.indexOf("#"))<0&&(n=t.length),(r=t.indexOf("?"))<0||n<r){r=n;var i=""}else i=t.substring(r+1,n);n=(t=[t.substr(0,r),i,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return an(t,e,n),t}function rr(t){this.f=[],this.F=new In,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Ra=this.P=0,this.Pa=!!k("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Oa=k("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Sa=k("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Qa=k("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=k("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.La=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new Dn(t&&t.concurrentRequestLimit),this.ja=new Vn,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function ir(t){if(or(t),3==t.u){var e=t.P++,n=tn(t.B);an(n,"SID",t.H),an(n,"RID",e),an(n,"TYPE","terminate"),cr(t,n),(e=new Oe(t,e,void 0)).F=2,e.f=un(tn(n)),n=!1,I.navigator&&I.navigator.sendBeacon&&(n=I.navigator.sendBeacon(e.f.toString(),"")),!n&&I.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=B(),Be(e)}gr(t)}function or(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(I.clearTimeout(t.l),t.l=null),dr(t),t.b.cancel(),t.h&&(N(t.h)&&I.clearTimeout(t.h),t.h=null)}function ar(t,e){t.f.push(new kn(t.Ra++,e)),3==t.u&&sr(t)}function sr(t){Rn(t.b)||t.h||(t.h=!0,ee(t.Ia,t),t.A=0)}function ur(t,e){var n;n=e?e.W:t.P++;var r=tn(t.B);an(r,"SID",t.H),an(r,"RID",n),an(r,"AID",t.O),cr(t,r),t.g&&t.i&&nr(r,t.g,t.i),n=new Oe(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=hr(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),Ln(t.b,n),Le(n,r,e)}function cr(t,e){t.c&&Qe({},(function(t,n){an(e,n,t)}))}function hr(t,e,n){n=Math.min(t.f.length,n);var r=t.c?q(t.c.Ta,t.c,t):null;t:for(var i=t.f,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if((c-=o)<0)o=Math.max(0,i[u].b-100),s=!1;else try{Bn(h,a,"req"+c+"_")}catch(t){r&&r(h)}}if(s){r=a.join("&");break t}}return t=t.f.splice(0,n),e.j=t,r}function lr(t){t.a||t.l||(t.S=1,ee(t.Ha,t),t.v=0)}function fr(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=we(q(t.Ha,t),mr(t,t.v)),t.v++,!0)}function pr(t,e,n){var r=e.l;r&&On(t.b,r),t.ia=t.oa&&n,t.m=e.c,t.B=vr(t,null,t.ha),sr(t)}function dr(t){null!=t.s&&(I.clearTimeout(t.s),t.s=null)}function mr(t,e){var n=t.Oa+Math.floor(Math.random()*t.Sa);return t.ma()||(n*=2),n*e}function yr(t,e){if(2==e){var n=null;t.c&&(n=null);var r=q(t.fb,t);n||(n=new Ze("//www.google.com/images/cleardot.gif"),I.location&&"http"==I.location.protocol||en(n,"https"),un(n)),function(t,e){var n=new de;if(I.Image){var r=new Image;r.onload=V(jn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=V(jn,n,r,"TestLoadImage: error",!1,e),r.onabort=V(jn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=V(jn,n,r,"TestLoadImage: timeout",!1,e),I.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else be(2);t.u=0,t.c&&t.c.ta(e),gr(t),or(t)}function gr(t){t.u=0,t.m=-1,t.c&&(0==Un(t.b).length&&0==t.f.length||(t.b.c.length=0,Q(t.f),t.f.length=0),t.c.sa())}function vr(t,e,n){var r=function(t){return t instanceof Ze?tn(t):new Ze(t,void 0)}(n);if(""!=r.b)e&&nn(r,e+"."+r.b),rn(r,r.i);else{var i,o=I.location;i=e?e+"."+o.hostname:o.hostname,r=function(t,e,n,r){var i=new Ze(null,void 0);return t&&en(i,t),e&&nn(i,e),n&&rn(i,n),r&&(i.a=r),i}(o.protocol,i,+o.port,n)}return t.V&&et(t.V,(function(t,e){an(r,e,t)})),e=t.j,n=t.I,e&&n&&an(r,e,n),an(r,"VER",t.wa),cr(t,r),r}function br(){}function _r(){if(ct&&!(10<=Number(vt)))throw Error("Environmental error: no available transport.")}function wr(t,e){Gt.call(this),this.a=new rr(e),this.g=t,this.m=e&&e.testUrl?e.testUrl:function(t){for(var e=t,n=1;n<arguments.length;n++){var r,i=arguments[n];0==i.lastIndexOf("/",0)?e=i:((r=""==e)||(r=0<=(r=e.length-1)&&e.indexOf("/",r)==r),e+=r?i:"/"+i)}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Sr(this)}function Tr(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Er(){De.call(this),this.status=1}function Sr(t){this.a=t}(T=Kn.prototype).ca=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ce(this.H):Ce(Ae),this.a.onreadystatechange=q(this.Fa,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Yn(this,t)}t=n||"";var i=new He(this.headers);r&&Qe(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Hn,n=t.length,r=A(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:A(t)?t.charAt(e):t[e]}(i.K()),n=I.FormData&&t instanceof I.FormData,0<=K(Qn,e)&&!r&&!n&&i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Zn(this),0<this.o&&((this.D=function(t){return ct&&_t(9)&&N(t.timeout)&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=q(this.Ca,this)):this.m=se(this.Ca,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Yn(this,t)}},T.Ca=function(){void 0!==C&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},T.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Jn(this))},T.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Jn(this,!0)),Kn.N.G.call(this)},T.Fa=function(){this.j||(this.w||this.l||this.g?Xn(this):this.$a())},T.$a=function(){Xn(this)},T.T=function(){try{return 2<tr(this)?this.a.status:-1}catch(i){return-1}},T.za=function(){try{return 2<tr(this)?this.a.statusText:""}catch(i){return""}},T.aa=function(){try{return this.a?this.a.responseText:""}catch(i){return""}},T.Va=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Wn(e)}},T.ya=function(){return this.h},T.Ya=function(){return A(this.f)?this.f:String(this.f)},(T=rr.prototype).wa=8,T.u=1,T.Da=function(){return 0==this.u},T.Ia=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random()),t=this.P++;var e,n=new Oe(this,t,void 0),r=this.i;if(this.J&&(r?it(r=nt(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&A(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=hr(this,n,e),an(i=tn(this.B),"RID",t),an(i,"CVER",22),this.o&&this.j&&an(i,"X-HTTP-Session-Id",this.j),cr(this,i),this.g&&r&&nr(i,this.g,r),Ln(this.b,n),this.W?(an(i,"$req",e),an(i,"SID","null"),n.S=!0,Le(n,i,null)):Le(n,i,e),this.u=2}}else 3==this.u&&(t?ur(this,t):0==this.f.length||Rn(this.b)||ur(this))},T.Ha=function(){this.l=null,this.a=new Oe(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=tn(this.pa);an(t,"RID","rpc"),an(t,"SID",this.H),an(t,"CI",this.ia?"0":"1"),an(t,"AID",this.O),cr(this,t),an(t,"TYPE","xmlhttp"),this.g&&this.i&&nr(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),Fe(this.a,t,!0,this.ga)},T.Ga=function(t,e){if(0!=this.u&&(this.a==t||Pn(this.b,t)))if(this.m=t.o,!t.s&&Pn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(O(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;dr(this),this.a.cancel(),this.a=null}fr(this),be(18)}}else this.ra=e[1],0<this.ra-this.O&&e[2]<37500&&this.ia&&0==this.v&&!this.s&&(this.s=we(q(this.Za,this),6e3));if(Mn(this.b)<=1&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else yr(this,11)}else if(!t.s&&this.a!=t||dr(this),!H(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var r=e[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&N(r)&&0<r&&(this.D=1.5*r),this.o&&(r=t.a)&&((i=er(r,"X-Client-Wire-Protocol"))&&On(this.b,i),this.j&&(r=er(r,"X-HTTP-Session-Id")))&&(this.I=r,an(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=t,this.pa=vr(this,this.Y()?this.ga:null,this.ha),r.s?(Fn(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(We(r),Be(r)),this.a=r):lr(this),0<this.f.length&&sr(this)}else"stop"!=r[0]&&"close"!=r[0]||yr(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?yr(this,7):ir(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},T.Za=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,fr(this),be(19))},T.na=function(t){var e=null;if(this.a==t){dr(this),this.a=null;var n=2}else{if(!Pn(this.b,t))return;e=t.j,Fn(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=B()-t.v,me.dispatchEvent(new _e(me,t.l?t.l.length:0,e,this.A)),sr(this)):lr(this);else{var r=t.c;if(3==r||0==r&&0<this.m||!(1==n&&function(t,e){return!(Mn(t.b)>=t.b.f-(t.h?1:0))&&(t.h?(t.f=e.j.concat(t.f),!0):!(1==t.u||2==t.u||t.A>=(t.Pa?0:t.Qa))&&(t.h=we(q(t.Ia,t,e),mr(t,t.A)),t.A++,!0))}(this,t)||2==n&&fr(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),r){case 1:yr(this,5);break;case 4:yr(this,10);break;case 3:yr(this,6);break;default:yr(this,2)}}},T.fb=function(t){be(t?2:1)},T.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Kn(this.La)).F=this.R,t},T.ma=function(){return!!this.c&&!0},T.Y=function(){return this.R},(T=br.prototype).va=function(){},T.ua=function(){},T.ta=function(){},T.sa=function(){},T.Ta=function(){},_r.prototype.a=function(t,e){return new wr(t,e)},j(wr,Gt),(T=wr.prototype).addEventListener=function(t,e,n,r){wr.N.addEventListener.call(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){wr.N.removeEventListener.call(this,t,e,n,r)},T.Wa=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,r=this.b||void 0;be(0),t.ha=n,t.V=r||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new Sn(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=nr(e,t.g,t.i)),(t=t.w).i=n,e=vr(t.a,null,t.i),be(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,Cn(t)):(sn(e,"MODE","init"),!t.a.o&&t.a.j&&sn(e,"X-HTTP-Session-Id",t.a.j),t.b=new Oe(t,void 0,void 0),t.b.h=t.h,Fe(t.b,e,!1,null),t.M=0)},T.close=function(){ir(this.a)},T.Xa=function(t){if(A(t)){var e={};e.__data__=t,ar(this.a,e)}else this.h?((e={}).__data__=Ht(t),ar(this.a,e)):ar(this.a,t)},T.G=function(){this.a.c=null,delete this.f,ir(this.a),delete this.a,wr.N.G.call(this)},j(Tr,ke),j(Er,De),j(Sr,br),Sr.prototype.va=function(){this.a.dispatchEvent("a")},Sr.prototype.ua=function(t){this.a.dispatchEvent(new Tr(t))},Sr.prototype.ta=function(t){this.a.dispatchEvent(new Er(t))},Sr.prototype.sa=function(){this.a.dispatchEvent("b")};var Cr=V((function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r}),_r);_r.prototype.createWebChannel=_r.prototype.a,wr.prototype.send=wr.prototype.Xa,wr.prototype.open=wr.prototype.Wa,wr.prototype.close=wr.prototype.close,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ie.EventType=Ne).OPEN="a",Ne.CLOSE="b",Ne.ERROR="c",Ne.MESSAGE="d",Gt.prototype.listen=Gt.prototype.Aa,Kn.prototype.listenOnce=Kn.prototype.Ba,Kn.prototype.getLastError=Kn.prototype.Ya,Kn.prototype.getLastErrorCode=Kn.prototype.ya,Kn.prototype.getStatus=Kn.prototype.T,Kn.prototype.getStatusText=Kn.prototype.za,Kn.prototype.getResponseJson=Kn.prototype.Va,Kn.prototype.getResponseText=Kn.prototype.aa,Kn.prototype.send=Kn.prototype.ca;var Ir,Ar,Nr={createWebChannelTransport:Cr,ErrorCode:Te,EventType:Ee,WebChannel:Ie,XhrIo:Kn},kr=Nr.createWebChannelTransport,Dr=Nr.ErrorCode,xr=Nr.EventType,Or=Nr.WebChannel,Rr=Nr.XhrIo,Mr=n.SDK_VERSION,Pr=new d("@firebase/firestore");function Lr(){return Pr.logLevel===o.DEBUG?Ir.DEBUG:Pr.logLevel===o.SILENT?Ir.SILENT:Ir.ERROR}function Fr(t){switch(t){case Ir.DEBUG:Pr.logLevel=o.DEBUG;break;case Ir.ERROR:Pr.logLevel=o.ERROR;break;case Ir.SILENT:Pr.logLevel=o.SILENT;break;default:Pr.error("Firestore ("+Mr+"): Invalid value passed to `setLogLevel`")}}function Ur(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(Pr.logLevel<=o.DEBUG){var i=n.map(Vr);Pr.debug.apply(Pr,h(["Firestore ("+Mr+") ["+t+"]: "+e],i))}}function qr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Pr.logLevel<=o.ERROR){var r=e.map(Vr);Pr.error.apply(Pr,h(["Firestore ("+Mr+"): "+t],r))}}function Vr(t){if("string"==typeof t)return t;var e=Wr.getPlatform();try{return e.formatJSON(t)}catch(e){return t}}function Br(t){var e="FIRESTORE ("+Mr+") INTERNAL ASSERTION FAILED: "+t;throw qr(e),new Error(e)}function jr(t,e){t||Br(e)}(Ar=Ir=Ir||{})[Ar.DEBUG=0]="DEBUG",Ar[Ar.ERROR=1]="ERROR",Ar[Ar.SILENT=2]="SILENT";var Wr=(Kr.setPlatform=function(t){Kr.platform&&Br("Platform already defined"),Kr.platform=t},Kr.getPlatform=function(){return Kr.platform||Br("Platform not set"),Kr.platform},Kr);function Kr(){}function zr(){return Wr.getPlatform().emptyByteString}var Gr,Qr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Hr=(i(Yr,Gr=Error),Yr);function Yr(t,e){var n=Gr.call(this,e)||this;return n.code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function $r(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Hr(Qr.INVALID_ARGUMENT,t)}for(var r in n.prototype=t.prototype,t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function Xr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Jr(t,e){return void 0!==t?t:e}function Zr(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function ti(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ei(t){for(var e in jr(null!=t&&"object"==typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ni(t,e){if(0!==e.length)throw new Hr(Qr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+_i(e.length,"argument")+".")}function ri(t,e,n){if(e.length!==n)throw new Hr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires "+_i(n,"argument")+", but was called with "+_i(e.length,"argument")+".")}function ii(t,e,n){if(e.length<n)throw new Hr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+_i(n,"argument")+", but was called with "+_i(e.length,"argument")+".")}function oi(t,e,n,r){if(e.length<n||e.length>r)throw new Hr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+_i(e.length,"argument")+".")}function ai(t,e,n,r){fi(t,e,bi(n)+" argument",r)}function si(t,e,n,r){void 0!==r&&ai(t,e,n,r)}function ui(t,e,n,r){fi(t,e,n+" option",r)}function ci(t,e,n,r){void 0!==r&&ui(t,e,n,r)}function hi(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new Hr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+di(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new Hr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+o+" was: "+di(r[o]))}(t,e,n,r,i)}function li(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(di(u))}var c=di(r);throw new Hr(Qr.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function fi(t,e,n,r){if(!("object"===e?pi(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=di(r);throw new Hr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function pi(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function di(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return 20<t.length&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"!=typeof t)return"function"==typeof t?"a function":Br("Unknown wrong type: "+typeof t);if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&1<e.length)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}function mi(t,e,n){if(void 0===n)throw new Hr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+bi(e)+" argument, but it was undefined.")}function yi(t,e,n){ti(e,(function(e,r){if(n.indexOf(e)<0)throw new Hr(Qr.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))}))}function gi(t,e,n,r){var i=di(r);return new Hr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+bi(n)+" argument to be a "+e+", but it was: "+i)}function vi(t,e,n){if(n<=0)throw new Hr(Qr.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+bi(e)+" argument to be a positive number, but it was: "+n+".")}function bi(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function _i(t,e){return t+" "+e+(1===t?"":"s")}var wi=(Ti.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return jr(20===e.length,"Invalid auto ID: "+e),e},Ti);function Ti(){}function Ei(t,e){return t<e?-1:e<t?1:0}function Si(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function Ci(t){return t+"\0"}function Ii(){if("undefined"==typeof Uint8Array)throw new Hr(Qr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ai(){if(!Wr.getPlatform().base64Available)throw new Hr(Qr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ni=(ki.fromBase64String=function(t){ri("Blob.fromBase64String",arguments,1),ai("Blob.fromBase64String","string",1,t),Ai();try{return new ki(Wr.getPlatform().atob(t))}catch(t){throw new Hr(Qr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},ki.fromUint8Array=function(t){if(ri("Blob.fromUint8Array",arguments,1),Ii(),!(t instanceof Uint8Array))throw gi("Blob.fromUint8Array","Uint8Array",1,t);return new ki(Array.prototype.map.call(t,(function(t){return String.fromCharCode(t)})).join(""))},ki.prototype.toBase64=function(){return ri("Blob.toBase64",arguments,0),Ai(),Wr.getPlatform().btoa(this._binaryString)},ki.prototype.toUint8Array=function(){ri("Blob.toUint8Array",arguments,0),Ii();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},ki.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ki.prototype.isEqual=function(t){return this._binaryString===t._binaryString},ki.prototype._compareTo=function(t){return Ei(this._binaryString,t._binaryString)},ki);function ki(t){Ai(),this._binaryString=t}var Di=$r(Ni,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),xi=function(t,e,n,r,i){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},Oi="(default)",Ri=(Object.defineProperty(Mi.prototype,"isDefaultDatabase",{get:function(){return this.database===Oi},enumerable:!0,configurable:!0}),Mi.prototype.isEqual=function(t){return t instanceof Mi&&t.projectId===this.projectId&&t.database===this.database},Mi.prototype.compareTo=function(t){return Ei(this.projectId,t.projectId)||Ei(this.database,t.database)},Mi);function Mi(t,e){this.projectId=t,this.database=e||Oi}var Pi=(Li.prototype.setPreviousValue=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Li.prototype.next=function(){var t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t},Li.INVALID=-1,Li);function Li(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.setPreviousValue(t)},this.writeNewSequenceNumber=function(t){return e.writeSequenceNumber(t)})}var Fi="__name__",Ui=(Object.defineProperty(qi.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),qi.prototype.isEqual=function(t){return 0===qi.comparator(this,t)},qi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof qi?t.forEach((function(t){e.push(t)})):e.push(t),this.construct(e)},qi.prototype.limit=function(){return this.offset+this.length},qi.prototype.popFirst=function(t){return t=void 0===t?1:t,jr(this.length>=t,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},qi.prototype.popLast=function(){return jr(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},qi.prototype.firstSegment=function(){return jr(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},qi.prototype.lastSegment=function(){return this.get(this.length-1)},qi.prototype.get=function(t){return jr(t<this.length,"Index out of range"),this.segments[this.offset+t]},qi.prototype.isEmpty=function(){return 0===this.length},qi.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},qi.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},qi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},qi.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},qi.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},qi);function qi(t,e,n){void 0===e?e=0:e>t.length&&Br("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&Br("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n}var Vi,Bi=(i(ji,Vi=Ui),ji.prototype.construct=function(t,e,n){return new ji(t,e,n)},ji.prototype.canonicalString=function(){return this.toArray().join("/")},ji.prototype.toString=function(){return this.canonicalString()},ji.fromString=function(t){if(0<=t.indexOf("//"))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ji(t.split("/").filter((function(t){return 0<t.length})))},ji.EMPTY_PATH=new ji([]),ji);function ji(){return null!==Vi&&Vi.apply(this,arguments)||this}var Wi,Ki=/^[_a-zA-Z][_a-zA-Z0-9]*$/,zi=(i(Gi,Wi=Ui),Gi.prototype.construct=function(t,e,n){return new Gi(t,e,n)},Gi.isValidIdentifier=function(t){return Ki.test(t)},Gi.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Gi.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},Gi.prototype.toString=function(){return this.canonicalString()},Gi.prototype.isKeyField=function(){return 1===this.length&&this.get(0)===Fi},Gi.keyField=function(){return new Gi([Fi])},Gi.fromServerFormat=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var a=t[r];if("\\"===a){if(r+1===t.length)throw new Hr(Qr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var s=t[r+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new Hr(Qr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=s,r+=2}else"`"===a?o=!o:"."!==a||o?n+=a:i(),r++}if(i(),o)throw new Hr(Qr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Gi(e)},Gi.EMPTY_PATH=new Gi([]),Gi);function Gi(){return null!==Wi&&Wi.apply(this,arguments)||this}var Qi=(Hi.prototype.hasCollectionId=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Hi.prototype.isEqual=function(t){return null!==t&&0===Bi.comparator(this.path,t.path)},Hi.prototype.toString=function(){return this.path.toString()},Hi.comparator=function(t,e){return Bi.comparator(t.path,e.path)},Hi.isDocumentKey=function(t){return t.length%2==0},Hi.fromSegments=function(t){return new Hi(new Bi(t.slice()))},Hi.fromPathString=function(t){return new Hi(Bi.fromString(t))},Hi.EMPTY=new Hi(new Bi([])),Hi);function Hi(t){this.path=t,jr(Hi.isDocumentKey(t),"Invalid DocumentKey with an odd number of segments: "+t.toArray().join("/"))}var Yi,$i,Xi=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))};($i=Yi=Yi||{}).All="all",$i.ListenStreamIdle="listen_stream_idle",$i.ListenStreamConnectionBackoff="listen_stream_connection_backoff",$i.WriteStreamIdle="write_stream_idle",$i.WriteStreamConnectionBackoff="write_stream_connection_backoff",$i.OnlineStateTimeout="online_state_timeout",$i.ClientMetadataRefresh="client_metadata_refresh",$i.LruGarbageCollection="lru_garbage_collection",$i.RetryTransaction="retry_transaction";var Ji=(Zi.createAndSchedule=function(t,e,n,r,i){var o=new Zi(t,e,Date.now()+n,r,i);return o.start(n),o},Zi.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},Zi.prototype.skipDelay=function(){return this.handleDelayElapsed()},Zi.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Hr(Qr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Zi.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},Zi.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},Zi);function Zi(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Xi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}var to=(Object.defineProperty(eo.prototype,"isShuttingDown",{get:function(){return this._isShuttingDown},enumerable:!0,configurable:!0}),eo.prototype.enqueueAndForget=function(t){this.enqueue(t)},eo.prototype.enqueueAndForgetEvenAfterShutdown=function(t){this.verifyNotFailed(),this.enqueueInternal(t)},eo.prototype.enqueueEvenAfterShutdown=function(t){return this.verifyNotFailed(),this.enqueueInternal(t)},eo.prototype.enqueueAndInitiateShutdown=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return this.verifyNotFailed(),this._isShuttingDown?[3,2]:(this._isShuttingDown=!0,[4,this.enqueueEvenAfterShutdown(t)]);case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},eo.prototype.enqueue=function(t){return this.verifyNotFailed(),this._isShuttingDown?new Promise((function(t){})):this.enqueueInternal(t)},eo.prototype.enqueueInternal=function(t){var e=this,n=this.tail.then((function(){return e.operationInProgress=!0,t().catch((function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||"";throw qr("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout((function(){throw t}),0),t})).then((function(t){return e.operationInProgress=!1,t}))}));return this.tail=n},eo.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.verifyNotFailed(),jr(0<=e,"Attempted to schedule an operation with a negative delay of "+e),-1<this.timerIdsToSkip.indexOf(t)&&(e=0);var i=Ji.createAndSchedule(this,t,e,n,(function(t){return r.removeDelayedOperation(t)}));return this.delayedOperations.push(i),i},eo.prototype.verifyNotFailed=function(){this.failure&&Br("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},eo.prototype.verifyOperationInProgress=function(){jr(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},eo.prototype.drain=function(){return this.enqueueEvenAfterShutdown((function(){return Promise.resolve()}))},eo.prototype.containsDelayedOperation=function(t){for(var e=0,n=this.delayedOperations;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},eo.prototype.runDelayedOperationsEarly=function(t){var e=this;return this.drain().then((function(){jr(t===Yi.All||e.containsDelayedOperation(t),"Attempted to drain to missing operation "+t),e.delayedOperations.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),t!==Yi.All&&i.timerId===t)break}return e.drain()}))},eo.prototype.skipDelaysForTimerId=function(t){this.timerIdsToSkip.push(t)},eo.prototype.removeDelayedOperation=function(t){var e=this.delayedOperations.indexOf(t);jr(0<=e,"Delayed operation not found."),this.delayedOperations.splice(e,1)},eo);function eo(){this.tail=Promise.resolve(),this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.timerIdsToSkip=[]}var no="",ro="",io="",oo="";function ao(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=uo(e)),e=so(t.get(n),e);return uo(e)}function so(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=no+io;break;case no:n+=no+oo;break;default:n+=o}}return n}function uo(t){return t+no+ro}function co(t){var e=t.length;if(jr(2<=e,"Invalid path "+t),2===e)return jr(t.charAt(0)===no&&t.charAt(1)===ro,"Non-empty path "+t+" had length 2"),Bi.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf(no,o);switch((a<0||n<a)&&Br('Invalid encoded resource path: "'+t+'"'),t.charAt(a+1)){case ro:var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case io:i+=t.substring(o,a),i+="\0";break;case oo:i+=t.substring(o,a+1);break;default:Br('Invalid encoded resource path: "'+t+'"')}o=a+2}return new Bi(r)}var ho=(lo.now=function(){return lo.fromMillis(Date.now())},lo.fromDate=function(t){return lo.fromMillis(t.getTime())},lo.fromMillis=function(t){var e=Math.floor(t/1e3);return new lo(e,1e6*(t-1e3*e))},lo.prototype.toDate=function(){return new Date(this.toMillis())},lo.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},lo.prototype._compareTo=function(t){return this.seconds===t.seconds?Ei(this.nanoseconds,t.nanoseconds):Ei(this.seconds,t.seconds)},lo.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},lo.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},lo);function lo(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Hr(Qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Hr(Qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Hr(Qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Hr(Qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}var fo=(po.fromMicroseconds=function(t){var e=Math.floor(t/1e6);return new po(new ho(e,t%1e6*1e3))},po.fromTimestamp=function(t){return new po(t)},po.forDeletedDoc=function(){return po.MIN},po.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},po.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},po.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},po.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},po.prototype.toTimestamp=function(){return this.timestamp},po.MIN=new po(new ho(0,0)),po);function po(t){this.timestamp=t}var mo=(yo.prototype.insert=function(t,e){return new yo(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,bo.BLACK,null,null))},yo.prototype.remove=function(t){return new yo(this.comparator,this.root.remove(t,this.comparator).copy(null,null,bo.BLACK,null,null))},yo.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},yo.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},yo.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(yo.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),yo.prototype.minKey=function(){return this.root.minKey()},yo.prototype.maxKey=function(){return this.root.maxKey()},yo.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},yo.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},yo.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},yo.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},yo.prototype.getIterator=function(){return new go(this.root,null,this.comparator,!1)},yo.prototype.getIteratorFrom=function(t){return new go(this.root,t,this.comparator,!1)},yo.prototype.getReverseIterator=function(){return new go(this.root,null,this.comparator,!0)},yo.prototype.getReverseIteratorFrom=function(t){return new go(this.root,t,this.comparator,!0)},yo);function yo(t,e){this.comparator=t,this.root=e||bo.EMPTY}var go=(vo.prototype.getNext=function(){jr(0<this.nodeStack.length,"getNext() called on iterator when hasNext() is false.");var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},vo.prototype.hasNext=function(){return 0<this.nodeStack.length},vo.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},vo);function vo(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}var bo=(_o.prototype.copy=function(t,e,n,r,i){return new _o(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},_o.prototype.isEmpty=function(){return!1},_o.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},_o.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},_o.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},_o.prototype.minKey=function(){return this.min().key},_o.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},_o.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},_o.prototype.removeMin=function(){if(this.left.isEmpty())return _o.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()},_o.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===e(t,r.key)){if(r.right.isEmpty())return _o.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()},_o.prototype.isRed=function(){return this.color},_o.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},_o.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},_o.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},_o.prototype.rotateLeft=function(){var t=this.copy(null,null,_o.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},_o.prototype.rotateRight=function(){var t=this.copy(null,null,_o.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},_o.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},_o.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},_o.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Br("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw Br("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw Br("Black depths differ");return t+(this.isRed()?0:1)},_o.EMPTY=null,_o.RED=!0,_o.BLACK=!1,_o);function _o(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:_o.RED,this.left=null!=r?r:_o.EMPTY,this.right=null!=i?i:_o.EMPTY,this.size=this.left.size+1+this.right.size}var wo=(Object.defineProperty(To.prototype,"key",{get:function(){throw Br("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(To.prototype,"value",{get:function(){throw Br("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(To.prototype,"color",{get:function(){throw Br("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(To.prototype,"left",{get:function(){throw Br("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(To.prototype,"right",{get:function(){throw Br("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),To.prototype.copy=function(t,e,n,r,i){return this},To.prototype.insert=function(t,e,n){return new bo(t,e)},To.prototype.remove=function(t,e){return this},To.prototype.isEmpty=function(){return!0},To.prototype.inorderTraversal=function(t){return!1},To.prototype.reverseTraversal=function(t){return!1},To.prototype.minKey=function(){return null},To.prototype.maxKey=function(){return null},To.prototype.isRed=function(){return!1},To.prototype.checkMaxDepth=function(){return!0},To.prototype.check=function(){return 0},To);function To(){this.size=0}bo.EMPTY=new wo;var Eo=(So.fromMapKeys=function(t){var e=new So(t.comparator);return t.forEach((function(t){e=e.add(t)})),e},So.prototype.has=function(t){return null!==this.data.get(t)},So.prototype.first=function(){return this.data.minKey()},So.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(So.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),So.prototype.indexOf=function(t){return this.data.indexOf(t)},So.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},So.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(0<=this.comparator(r.key,t[1]))return;e(r.key)}},So.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},So.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},So.prototype.getIterator=function(){return new Co(this.data.getIterator())},So.prototype.getIteratorFrom=function(t){return new Co(this.data.getIteratorFrom(t))},So.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},So.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},So.prototype.isEmpty=function(){return this.data.isEmpty()},So.prototype.unionWith=function(t){var e=this;return t.forEach((function(t){e=e.add(t)})),e},So.prototype.isEqual=function(t){if(!(t instanceof So))return!1;if(this.size!==t.size)return!1;for(var e=this.data.getIterator(),n=t.data.getIterator();e.hasNext();){var r=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(r,i))return!1}return!0},So.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},So.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},So.prototype.copy=function(t){var e=new So(this.comparator);return e.data=t,e},So);function So(t){this.comparator=t,this.data=new mo(this.comparator)}var Co=(Io.prototype.getNext=function(){return this.iter.getNext().key},Io.prototype.hasNext=function(){return this.iter.hasNext()},Io);function Io(t){this.iter=t}var Ao=new mo(Qi.comparator);function No(){return Ao}function ko(){return No()}var Do=new mo(Qi.comparator);function xo(){return Do}var Oo=new mo(Qi.comparator);function Ro(){return Oo}var Mo=new Eo(Qi.comparator);function Po(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Mo,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Lo=new Eo(Ei);function Fo(){return Lo}var Uo=(qo.prototype.applyToRemoteDocument=function(t,e,n){e&&jr(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;jr(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var a=r[i];e=o.applyToRemoteDocument(e,a)}}return e},qo.prototype.applyToLocalView=function(t,e){e&&jr(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t)&&(e=s.applyToLocalView(e,e,this.localWriteTime));for(var i=e,o=0,a=this.mutations;o<a.length;o++){var s;(s=a[o]).key.isEqual(t)&&(e=s.applyToLocalView(e,i,this.localWriteTime))}return e},qo.prototype.applyToLocalDocumentSet=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.applyToLocalView(r.key,t.get(r.key));i&&(n=n.insert(r.key,i))})),n},qo.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Po())},qo.prototype.isEqual=function(t){return this.batchId===t.batchId&&Si(this.mutations,t.mutations)&&Si(this.baseMutations,t.baseMutations)},qo);function qo(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,jr(0<(this.mutations=r).length,"Cannot create an empty mutation batch")}var Vo=(Bo.from=function(t,e,n,r){jr(t.mutations.length===n.length,"Mutations sent "+t.mutations.length+" must equal results received "+n.length);for(var i=Ro(),o=t.mutations,a=0;a<o.length;a++)i=i.insert(o[a].key,n[a].version);return new Bo(t,e,n,r,i)},Bo);function Bo(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}var jo=(Wo.prototype.catch=function(t){return this.next(void 0,t)},Wo.prototype.next=function(t,e){var n=this;return this.callbackAttached&&Br("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Wo((function(r,i){n.nextCallback=function(e){n.wrapSuccess(t,e).next(r,i)},n.catchCallback=function(t){n.wrapFailure(e,t).next(r,i)}}))},Wo.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},Wo.prototype.wrapUserFunction=function(t){try{var e=t();return e instanceof Wo?e:Wo.resolve(e)}catch(t){return Wo.reject(t)}},Wo.prototype.wrapSuccess=function(t,e){return t?this.wrapUserFunction((function(){return t(e)})):Wo.resolve(e)},Wo.prototype.wrapFailure=function(t,e){return t?this.wrapUserFunction((function(){return t(e)})):Wo.reject(e)},Wo.resolve=function(t){return new Wo((function(e,n){e(t)}))},Wo.reject=function(t){return new Wo((function(e,n){n(t)}))},Wo.waitFor=function(t){return new Wo((function(e,n){var r=0,i=0,o=!1;t.forEach((function(t){++r,t.next((function(){++i,o&&i===r&&e()}),(function(t){return n(t)}))})),o=!0,i===r&&e()}))},Wo.or=function(t){for(var e=Wo.resolve(!1),n=function(t){e=e.next((function(e){return e?Wo.resolve(e):t()}))},r=0,i=t;r<i.length;r++)n(i[r]);return e},Wo.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},Wo);function Wo(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}var Ko="SimpleDb",zo=(Go.openOrCreate=function(t,e,n){return jr(Go.isAvailable(),"IndexedDB not supported in current environment."),Ur(Ko,"Opening database:",t),new jo((function(r,i){var o=window.indexedDB.open(t,e);o.onsuccess=function(t){var e=t.target.result;r(new Go(e))},o.onblocked=function(){i(new Hr(Qr.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},o.onerror=function(t){var e=t.target.error;"VersionError"===e.name?i(new Hr(Qr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):i(e)},o.onupgradeneeded=function(e){Ur(Ko,'Database "'+t+'" requires upgrade from version:',e.oldVersion);var r=e.target.result;n.createOrUpgrade(r,o.transaction,e.oldVersion,hu).next((function(){Ur(Ko,"Database upgrade to version "+hu+" complete")}))}})).toPromise()},Go.delete=function(t){return Ur(Ko,"Removing database:",t),Zo(window.indexedDB.deleteDatabase(t)).toPromise()},Go.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(Go.isMockPersistence())return!0;if(void 0===window.navigator)return!1;var t=y(),e=Go.getIOSVersion(t),n=0<e&&e<10,r=Go.getAndroidVersion(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},Go.isMockPersistence=function(){return"undefined"!=typeof e&&"YES"===Object({NODE_ENV:"production",BASE_URL:"/"}).USE_MOCK_PERSISTENCE},Go.getStore=function(t,e){return t.store(e)},Go.getIOSVersion=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},Go.getAndroidVersion=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},Go.prototype.setVersionChangeListener=function(t){this.db.onversionchange=function(e){return t(e)}},Go.prototype.runTransaction=function(t,e,n){return u(this,void 0,void 0,(function(){var r,i,o,a,s,u;return c(this,(function(h){switch(h.label){case 0:r=t.startsWith("readonly"),i=t.endsWith("idempotent"),o=0,a=function(){var t,a,u,h;return c(this,(function(c){switch(c.label){case 0:++o,t=Yo.open(s.db,r?"readonly":"readwrite",e),c.label=1;case 1:return c.trys.push([1,3,,4]),(a=n(t).catch((function(e){return t.abort(e),jo.reject(e)})).toPromise()).catch((function(){})),[4,t.completionPromise];case 2:return c.sent(),[2,{value:a}];case 3:return u=c.sent(),h=i&&"FirebaseError"!==u.name&&o<3,Ur(Ko,"Transaction failed with error: %s. Retrying: %s.",u.message,h),h?[3,4]:[2,{value:Promise.reject(u)}];case 4:return[2]}}))},s=this,h.label=1;case 1:return[5,a()];case 2:return"object"==typeof(u=h.sent())?[2,u.value]:[3,1];case 3:return[2]}}))}))},Go.prototype.close=function(){this.db.close()},Go);function Go(t){this.db=t,12.2===Go.getIOSVersion(y())&&qr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}var Qo=(Object.defineProperty(Ho.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(Ho.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(Ho.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),Ho.prototype.done=function(){this.shouldStop=!0},Ho.prototype.skip=function(t){this.nextKey=t},Ho.prototype.delete=function(){return Zo(this.dbCursor.delete())},Ho);function Ho(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}var Yo=($o.open=function(t,e,n){return new $o(t.transaction(n,e))},Object.defineProperty($o.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),$o.prototype.abort=function(t){t&&this.completionDeferred.reject(t),this.aborted||(Ur(Ko,"Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},$o.prototype.store=function(t){var e=this.transaction.objectStore(t);return jr(!!e,"Object store not part of transaction: "+t),new Xo(e)},$o);function $o(t){var e=this;this.transaction=t,this.aborted=!1,this.completionDeferred=new Xi,this.transaction.oncomplete=function(){e.completionDeferred.resolve()},this.transaction.onabort=function(){t.error?e.completionDeferred.reject(t.error):e.completionDeferred.resolve()},this.transaction.onerror=function(t){var n=ea(t.target.error);e.completionDeferred.reject(n)}}var Xo=(Jo.prototype.put=function(t,e){return Zo(void 0!==e?(Ur(Ko,"PUT",this.store.name,t,e),this.store.put(e,t)):(Ur(Ko,"PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Jo.prototype.add=function(t){return Ur(Ko,"ADD",this.store.name,t,t),Zo(this.store.add(t))},Jo.prototype.get=function(t){var e=this;return Zo(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Ur(Ko,"GET",e.store.name,t,n),n}))},Jo.prototype.delete=function(t){return Ur(Ko,"DELETE",this.store.name,t),Zo(this.store.delete(t))},Jo.prototype.count=function(){return Ur(Ko,"COUNT",this.store.name),Zo(this.store.count())},Jo.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,(function(t,e){r.push(e)})).next((function(){return r}))},Jo.prototype.deleteAll=function(t,e){Ur(Ko,"DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,(function(t,e,n){return n.delete()}))},Jo.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},Jo.prototype.iterateSerial=function(t){var e=this.cursor({});return new jo((function(n,r){e.onerror=function(t){var e=ea(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},Jo.prototype.iterateCursor=function(t,e){var n=[];return new jo((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Qo(i),a=e(i.primaryKey,i.value,o);if(a instanceof jo){var s=a.catch((function(t){return o.done(),jo.reject(t)}));n.push(s)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}})).next((function(){return jo.waitFor(n)}))},Jo.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:(jr(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},Jo.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Jo);function Jo(t){this.store=t}function Zo(t){return new jo((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=ea(t.target.error);n(e)}}))}var ta=!1;function ea(t){var e=zo.getIOSVersion(y());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new Hr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ta||(ta=!0,setTimeout((function(){throw r}),0)),r}}return t}var na,ra,ia=(oa.forUser=function(t,e,n,r){return jr(""!==t.uid,"UserID must not be an empty string."),new oa(t.isAuthenticated()?t.uid:"",e,n,r)},oa.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ca(t).iterate({index:vu.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},oa.prototype.acknowledgeBatch=function(t,e,n){return this.getMutationQueueMetadata(t).next((function(e){return e.lastStreamToken=ua(n),la(t).put(e)}))},oa.prototype.getLastStreamToken=function(t){return this.getMutationQueueMetadata(t).next((function(t){return t.lastStreamToken}))},oa.prototype.setLastStreamToken=function(t,e){return this.getMutationQueueMetadata(t).next((function(n){return n.lastStreamToken=ua(e),la(t).put(n)}))},oa.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=ha(t),a=ca(t);return a.add({}).next((function(s){jr("number"==typeof s,"Auto-generated key is not a number");for(var u=new Uo(s,e,n,r),c=i.serializer.toDbMutationBatch(i.userId,u),h=[],l=new Eo((function(t,e){return Ei(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],m=_u.key(i.userId,d.key.path,s);l=l.add(d.key.path.popLast()),h.push(a.put(c)),h.push(o.put(m,_u.PLACEHOLDER))}return l.forEach((function(e){h.push(i.indexManager.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.documentKeysByBatchId[s]=u.keys()})),jo.waitFor(h).next((function(){return u}))}))},oa.prototype.lookupMutationBatch=function(t,e){var n=this;return ca(t).get(e).next((function(t){return t?(jr(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),n.serializer.fromDbMutationBatch(t)):null}))},oa.prototype.lookupMutationKeys=function(t,e){var n=this;return this.documentKeysByBatchId[e]?jo.resolve(this.documentKeysByBatchId[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.documentKeysByBatchId[e]=r}return null}))},oa.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return ca(t).iterate({index:vu.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(jr(e.batchId>=r,"Should have found mutation after "+r),o=n.serializer.fromDbMutationBatch(e)),i.done()})).next((function(){return o}))},oa.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return ca(t).iterate({index:vu.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},oa.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ca(t).loadAll(vu.userMutationsIndex,n).next((function(t){return t.map((function(t){return e.serializer.fromDbMutationBatch(t)}))}))},oa.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=_u.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return ha(t).iterate({range:i},(function(r,i,a){var s=r[0],u=r[1],c=r[2],h=co(u);if(s===n.userId&&e.path.isEqual(h))return ca(t).get(c).next((function(t){if(!t)throw Br("Dangling document-mutation reference found: "+r+" which points to "+c);jr(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+c),o.push(n.serializer.fromDbMutationBatch(t))}));a.done()})).next((function(){return o}))},oa.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Eo(Ei),i=[];return e.forEach((function(e){var o=_u.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=ha(t).iterate({range:a},(function(t,i,o){var a=t[0],s=t[1],u=t[2],c=co(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(s)})),jo.waitFor(i).next((function(){return n.lookupMutationBatches(t,r)}))},oa.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;jr(!e.isDocumentQuery(),"Document queries shouldn't go down this path"),jr(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=e.path,i=r.length+1,o=_u.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Eo(Ei);return ha(t).iterate({range:a},(function(t,e,o){var a=t[0],u=t[1],c=t[2],h=co(u);a===n.userId&&r.isPrefixOf(h)?h.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.lookupMutationBatches(t,s)}))},oa.prototype.lookupMutationBatches=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(ca(t).get(e).next((function(t){if(null===t)throw Br("Dangling document-mutation reference found, which points to "+e);jr(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),r.push(n.serializer.fromDbMutationBatch(t))})))})),jo.waitFor(i).next((function(){return r}))},oa.prototype.removeMutationBatch=function(t,e){var n=this;return sa(t.simpleDbTransaction,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.removeCachedMutationKeys(e.batchId)})),jo.forEach(r,(function(e){return n.referenceDelegate.removeMutationReference(t,e)}))}))},oa.prototype.removeCachedMutationKeys=function(t){delete this.documentKeysByBatchId[t]},oa.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return jo.resolve();var r=IDBKeyRange.lowerBound(_u.prefixForUser(e.userId)),i=[];return ha(t).iterate({range:r},(function(t,n,r){if(t[0]===e.userId){var o=co(t[1]);i.push(o)}else r.done()})).next((function(){jr(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map((function(t){return t.canonicalString()})))}))}))},oa.prototype.containsKey=function(t,e){return aa(t,this.userId,e)},oa.prototype.getMutationQueueMetadata=function(t){var e=this;return la(t).get(this.userId).next((function(t){return t||new yu(e.userId,-1,"")}))},oa);function oa(t,e,n,r){this.userId=t,this.serializer=e,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}function aa(t,e,n){var r=_u.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return ha(t).iterate({range:o,keysOnly:!0},(function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function sa(t,e,n){var r=t.store(vu.store),i=t.store(_u.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.iterate({range:a},(function(t,e,n){return s++,n.delete()}));o.push(u.next((function(){jr(1===s,"Dangling document-mutation reference found: Missing batch "+n.batchId)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=_u.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return jo.waitFor(o).next((function(){return c}))}function ua(t){return t instanceof Uint8Array?(jr(zo.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence."),t.toString()):t}function ca(t){return pc.getStore(t,vu.store)}function ha(t){return pc.getStore(t,_u.store)}function la(t){return pc.getStore(t,yu.store)}(ra=na=na||{})[ra.QueryCache=0]="QueryCache",ra[ra.SyncEngine=1]="SyncEngine";var fa=(pa.prototype.next=function(){var t=this.nextId;return this.nextId+=2,t},pa.prototype.after=function(t){return this.seek(t+2),this.next()},pa.prototype.seek=function(t){jr((1&t)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=t},pa.forTargetCache=function(){return new pa(na.QueryCache,2)},pa.forSyncEngine=function(){return new pa(na.SyncEngine)},pa);function pa(t,e){jr((1&(this.generatorId=t))===t,"Generator ID "+t+" contains more than 1 reserved bits"),this.seek(void 0!==e?e:this.generatorId)}var da=(ma.prototype.allocateTargetId=function(t){var e=this;return this.retrieveMetadata(t).next((function(n){return n.highestTargetId=e.targetIdGenerator.after(n.highestTargetId),e.saveMetadata(t,n).next((function(){return n.highestTargetId}))}))},ma.prototype.getLastRemoteSnapshotVersion=function(t){return this.retrieveMetadata(t).next((function(t){return fo.fromTimestamp(new ho(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},ma.prototype.getHighestSequenceNumber=function(t){return va(t.simpleDbTransaction)},ma.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.retrieveMetadata(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.saveMetadata(t,i)}))},ma.prototype.addTargetData=function(t,e){var n=this;return this.saveTargetData(t,e).next((function(){return n.retrieveMetadata(t).next((function(r){return r.targetCount+=1,n.updateMetadataFromTargetData(e,r),n.saveMetadata(t,r)}))}))},ma.prototype.updateTargetData=function(t,e){return this.saveTargetData(t,e)},ma.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return ya(t).delete(e.targetId)})).next((function(){return n.retrieveMetadata(t)})).next((function(e){return jr(0<e.targetCount,"Removing from an empty target cache"),e.targetCount-=1,n.saveMetadata(t,e)}))},ma.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return ya(t).iterate((function(a,s){var u=r.serializer.fromDbTarget(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return jo.waitFor(o)})).next((function(){return i}))},ma.prototype.forEachTarget=function(t,e){var n=this;return ya(t).iterate((function(t,r){var i=n.serializer.fromDbTarget(r);e(i)}))},ma.prototype.retrieveMetadata=function(t){return ga(t.simpleDbTransaction)},ma.prototype.saveMetadata=function(t,e){return function(t){return pc.getStore(t,Ou.store)}(t).put(Ou.key,e)},ma.prototype.saveTargetData=function(t,e){return ya(t).put(this.serializer.toDbTarget(e))},ma.prototype.updateMetadataFromTargetData=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},ma.prototype.getTargetCount=function(t){return this.retrieveMetadata(t).next((function(t){return t.targetCount}))},ma.prototype.getTargetData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return ya(t).iterate({range:i,index:Nu.queryTargetsIndexName},(function(t,r,i){var a=n.serializer.fromDbTarget(r);e.isEqual(a.target)&&(o=a,i.done())})).next((function(){return o}))},ma.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=ba(t);return e.forEach((function(e){var a=ao(e.path);i.push(o.put(new Du(n,a))),i.push(r.referenceDelegate.addReference(t,e))})),jo.waitFor(i)},ma.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=ba(t);return jo.forEach(e,(function(e){var o=ao(e.path);return jo.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,e)])}))},ma.prototype.removeMatchingKeysForTargetId=function(t,e){var n=ba(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},ma.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=ba(t),i=Po();return r.iterate({range:n,keysOnly:!0},(function(t,e,n){var r=co(t[1]),o=new Qi(r);i=i.add(o)})).next((function(){return i}))},ma.prototype.containsKey=function(t,e){var n=ao(e.path),r=IDBKeyRange.bound([n],[Ci(n)],!1,!0),i=0;return ba(t).iterate({index:Du.documentTargetsIndex,keysOnly:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return 0<i}))},ma.prototype.getTargetDataForTarget=function(t,e){var n=this;return ya(t).get(e).next((function(t){return t?n.serializer.fromDbTarget(t):null}))},ma);function ma(t,e){this.referenceDelegate=t,this.serializer=e,this.targetIdGenerator=fa.forTargetCache()}function ya(t){return pc.getStore(t,Nu.store)}function ga(t){return zo.getStore(t,Ou.store).get(Ou.key).next((function(t){return jr(null!==t,"Missing metadata row."),t}))}function va(t){return ga(t).next((function(t){return t.highestListenSequenceNumber}))}function ba(t){return pc.getStore(t,Du.store)}var _a=(wa.fromSet=function(t){return new wa(t)},wa.fromArray=function(t){var e=new Eo(zi.comparator);return t.forEach((function(t){return e=e.add(t)})),new wa(e)},wa.prototype.covers=function(t){var e=!1;return this.fields.forEach((function(n){n.isPrefixOf(t)&&(e=!0)})),e},wa.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},wa);function wa(t){this.fields=t}var Ta=(Ea.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},Ea);function Ea(t,e){this.field=t,this.transform=e}var Sa,Ca,Ia=function(t,e){this.version=t,this.transformResults=e};(Ca=Sa=Sa||{})[Ca.Set=0]="Set",Ca[Ca.Patch=1]="Patch",Ca[Ca.Transform=2]="Transform",Ca[Ca.Delete=3]="Delete";var Aa=(Na.exists=function(t){return new Na(void 0,t)},Na.updateTime=function(t){return new Na(t)},Object.defineProperty(Na.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),Na.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof Vs&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof Vs:(jr(this.isNone,"Precondition should be empty"),!0)},Na.prototype.isEqual=function(t){return function(t,e){return null!=t?!(!e||!t.isEqual(e)):t===e}(this.updateTime,t.updateTime)&&this.exists===t.exists},Na.NONE=new Na,Na);function Na(t,e){this.updateTime=t,this.exists=e,jr(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}var ka=(Da.prototype.verifyKeyMatches=function(t){null!=t&&jr(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},Da.getPostMutationVersion=function(t){return t instanceof Vs?t.version:fo.MIN},Da);function Da(){}var xa,Oa=(i(Ra,xa=ka),Ra.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),jr(null==e.transformResults,"Transform results received by SetMutation.");var n=e.version;return new Vs(this.key,n,{hasCommittedMutations:!0},this.value)},Ra.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=ka.getPostMutationVersion(t);return new Vs(this.key,r,{hasLocalMutations:!0},this.value)},Ra.prototype.extractBaseValue=function(t){return null},Ra.prototype.isEqual=function(t){return t instanceof Ra&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.precondition.isEqual(t.precondition)},Ra);function Ra(t,e,n){var r=xa.call(this)||this;return r.key=t,r.value=e,r.precondition=n,r.type=Sa.Set,r}var Ma,Pa=(i(La,Ma=ka),La.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),jr(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return new Gs(this.key,e.version);var n=this.patchDocument(t);return new Vs(this.key,e.version,{hasCommittedMutations:!0},n)},La.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=ka.getPostMutationVersion(t),i=this.patchDocument(t);return new Vs(this.key,r,{hasLocalMutations:!0},i)},La.prototype.extractBaseValue=function(t){return null},La.prototype.isEqual=function(t){return t instanceof La&&this.key.isEqual(t.key)&&this.fieldMask.isEqual(t.fieldMask)&&this.precondition.isEqual(t.precondition)},La.prototype.patchDocument=function(t){var e;return e=t instanceof Vs?t.data():Os.EMPTY,this.patchObject(e)},La.prototype.patchObject=function(t){var e=this;return this.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t=null!==r?t.set(n,r):t.delete(n)}})),t},La);function La(t,e,n,r){var i=Ma.call(this)||this;return i.key=t,i.data=e,i.fieldMask=n,i.precondition=r,i.type=Sa.Patch,i}var Fa,Ua=(i(qa,Fa=ka),qa.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),jr(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(t))return new Gs(this.key,e.version);var n=this.requireDocument(t),r=this.serverTransformResults(t,e.transformResults),i=e.version,o=this.transformObject(n.data(),r);return new Vs(this.key,i,{hasCommittedMutations:!0},o)},qa.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.localTransformResults(n,t,e),o=this.transformObject(r.data(),i);return new Vs(this.key,r.version,{hasLocalMutations:!0},o)},qa.prototype.extractBaseValue=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Vs?t.field(i.field):void 0,a=i.transform.computeBaseValue(o||null);null!=a&&(e=null==e?Os.EMPTY.set(i.field,a):e.set(i.field,a))}return e},qa.prototype.isEqual=function(t){return t instanceof qa&&this.key.isEqual(t.key)&&Si(this.fieldTransforms,t.fieldTransforms)&&this.precondition.isEqual(t.precondition)},qa.prototype.requireDocument=function(t){jr(t instanceof Vs,"Unknown MaybeDocument type "+t);var e=t;return jr(e.key.isEqual(this.key),"Can only transform a document with the same key"),e},qa.prototype.serverTransformResults=function(t,e){var n=[];jr(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;t instanceof Vs&&(a=t.field(i.field)),n.push(o.applyToRemoteDocument(a,e[r]))}return n},qa.prototype.localTransformResults=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var a=o[i],s=a.transform,u=null;e instanceof Vs&&(u=e.field(a.field)),null===u&&n instanceof Vs&&(u=n.field(a.field)),r.push(s.applyToLocalView(u,t))}return r},qa.prototype.transformObject=function(t,e){jr(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n].field;t=t.set(r,e[n])}return t},qa);function qa(t,e){var n=Fa.call(this)||this;return n.key=t,n.fieldTransforms=e,n.type=Sa.Transform,n.precondition=Aa.exists(!0),n}var Va,Ba,ja,Wa,Ka,za=(i(Ga,Va=ka),Ga.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),jr(null==e.transformResults,"Transform results received by DeleteMutation."),new Ws(this.key,e.version,{hasCommittedMutations:!0})},Ga.prototype.applyToLocalView=function(t,e,n){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&jr(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new Ws(this.key,fo.forDeletedDoc())):t},Ga.prototype.extractBaseValue=function(t){return null},Ga.prototype.isEqual=function(t){return t instanceof Ga&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},Ga);function Ga(t,e){var n=Va.call(this)||this;return n.key=t,n.precondition=e,n.type=Sa.Delete,n}(ja=Ba=Ba||{})[ja.NullValue=0]="NullValue",ja[ja.BooleanValue=1]="BooleanValue",ja[ja.NumberValue=2]="NumberValue",ja[ja.TimestampValue=3]="TimestampValue",ja[ja.StringValue=4]="StringValue",ja[ja.BlobValue=5]="BlobValue",ja[ja.RefValue=6]="RefValue",ja[ja.GeoPointValue=7]="GeoPointValue",ja[ja.ArrayValue=8]="ArrayValue",ja[ja.ObjectValue=9]="ObjectValue",(Ka=Wa=Wa||{})[Ka.Default=0]="Default",Ka[Ka.Estimate=1]="Estimate",Ka[Ka.Previous=2]="Previous";var Qa=(Ha.fromSnapshotOptions=function(t,e){switch(t.serverTimestamps){case"estimate":return new Ha(Wa.Estimate,e);case"previous":return new Ha(Wa.Previous,e);case"none":case void 0:return new Ha(Wa.Default,e);default:return Br("fromSnapshotOptions() called with invalid options.")}},Ha);function Ha(t,e){this.serverTimestampBehavior=t,this.timestampsInSnapshots=e}var Ya=($a.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},$a.prototype.defaultCompareTo=function(t){return jr(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type."),Ei(this.typeOrder,t.typeOrder)},$a);function $a(){}var Xa,Ja=(i(Za,Xa=Ya),Za.prototype.value=function(t){return null},Za.prototype.isEqual=function(t){return t instanceof Za},Za.prototype.compareTo=function(t){return t instanceof Za?0:this.defaultCompareTo(t)},Za.INSTANCE=new Za,Za);function Za(){var t=Xa.call(this)||this;return t.typeOrder=Ba.NullValue,t.internalValue=null,t}var ts,es=(i(ns,ts=Ya),ns.prototype.value=function(t){return this.internalValue},ns.prototype.isEqual=function(t){return t instanceof ns&&this.internalValue===t.internalValue},ns.prototype.compareTo=function(t){return t instanceof ns?Ei(this,t):this.defaultCompareTo(t)},ns.of=function(t){return t?ns.TRUE:ns.FALSE},ns.TRUE=new ns(!0),ns.FALSE=new ns(!1),ns);function ns(t){var e=ts.call(this)||this;return e.internalValue=t,e.typeOrder=Ba.BooleanValue,e}var rs,is=(i(os,rs=Ya),os.prototype.value=function(t){return this.internalValue},os.prototype.compareTo=function(t){return t instanceof os?function(t,e){return t<e?-1:e<t?1:t===e?0:isNaN(t)?isNaN(e)?0:-1:1}(this.internalValue,t.internalValue):this.defaultCompareTo(t)},os);function os(t){var e=rs.call(this)||this;return e.internalValue=t,e.typeOrder=Ba.NumberValue,e}function as(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}var ss,us=(i(cs,ss=is),cs.prototype.isEqual=function(t){return t instanceof cs&&as(this.internalValue,t.internalValue)},cs);function cs(){return null!==ss&&ss.apply(this,arguments)||this}var hs,ls=(i(fs,hs=is),fs.prototype.isEqual=function(t){return t instanceof fs&&as(this.internalValue,t.internalValue)},fs.NAN=new fs(NaN),fs.POSITIVE_INFINITY=new fs(1/0),fs.NEGATIVE_INFINITY=new fs(-1/0),fs);function fs(){return null!==hs&&hs.apply(this,arguments)||this}var ps,ds=(i(ms,ps=Ya),ms.prototype.value=function(t){return this.internalValue},ms.prototype.isEqual=function(t){return t instanceof ms&&this.internalValue===t.internalValue},ms.prototype.compareTo=function(t){return t instanceof ms?Ei(this.internalValue,t.internalValue):this.defaultCompareTo(t)},ms);function ms(t){var e=ps.call(this)||this;return e.internalValue=t,e.typeOrder=Ba.StringValue,e}var ys,gs=(i(vs,ys=Ya),vs.prototype.value=function(t){return!t||t.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},vs.prototype.isEqual=function(t){return t instanceof vs&&this.internalValue.isEqual(t.internalValue)},vs.prototype.compareTo=function(t){return t instanceof vs?this.internalValue._compareTo(t.internalValue):t instanceof _s?-1:this.defaultCompareTo(t)},vs);function vs(t){var e=ys.call(this)||this;return e.internalValue=t,e.typeOrder=Ba.TimestampValue,e}var bs,_s=(i(ws,bs=Ya),ws.prototype.value=function(t){return t&&t.serverTimestampBehavior===Wa.Estimate?new gs(this.localWriteTime).value(t):t&&t.serverTimestampBehavior===Wa.Previous&&this.previousValue?this.previousValue.value(t):null},ws.prototype.isEqual=function(t){return t instanceof ws&&this.localWriteTime.isEqual(t.localWriteTime)},ws.prototype.compareTo=function(t){return t instanceof ws?this.localWriteTime._compareTo(t.localWriteTime):t instanceof gs?1:this.defaultCompareTo(t)},ws.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},ws);function ws(t,e){var n=bs.call(this)||this;return n.localWriteTime=t,n.previousValue=e,n.typeOrder=Ba.TimestampValue,n}var Ts,Es=(i(Ss,Ts=Ya),Ss.prototype.value=function(t){return this.internalValue},Ss.prototype.isEqual=function(t){return t instanceof Ss&&this.internalValue.isEqual(t.internalValue)},Ss.prototype.compareTo=function(t){return t instanceof Ss?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},Ss);function Ss(t){var e=Ts.call(this)||this;return e.internalValue=t,e.typeOrder=Ba.BlobValue,e}var Cs,Is=(i(As,Cs=Ya),As.prototype.value=function(t){return this.key},As.prototype.isEqual=function(t){return t instanceof As&&this.key.isEqual(t.key)&&this.databaseId.isEqual(t.databaseId)},As.prototype.compareTo=function(t){if(t instanceof As){var e=this.databaseId.compareTo(t.databaseId);return 0!==e?e:Qi.comparator(this.key,t.key)}return this.defaultCompareTo(t)},As);function As(t,e){var n=Cs.call(this)||this;return n.databaseId=t,n.key=e,n.typeOrder=Ba.RefValue,n}var Ns,ks=(i(Ds,Ns=Ya),Ds.prototype.value=function(t){return this.internalValue},Ds.prototype.isEqual=function(t){return t instanceof Ds&&this.internalValue.isEqual(t.internalValue)},Ds.prototype.compareTo=function(t){return t instanceof Ds?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},Ds);function Ds(t){var e=Ns.call(this)||this;return e.internalValue=t,e.typeOrder=Ba.GeoPointValue,e}var xs,Os=(i(Rs,xs=Ya),Rs.prototype.value=function(t){var e={};return this.internalValue.inorderTraversal((function(n,r){e[n]=r.value(t)})),e},Rs.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},Rs.prototype.isEqual=function(t){if(t instanceof Rs){for(var e=this.internalValue.getIterator(),n=t.internalValue.getIterator();e.hasNext()&&n.hasNext();){var r=e.getNext(),i=n.getNext();if(r.key!==i.key||!r.value.isEqual(i.value))return!1}return!e.hasNext()&&!n.hasNext()}return!1},Rs.prototype.compareTo=function(t){if(t instanceof Rs){for(var e=this.internalValue.getIterator(),n=t.internalValue.getIterator();e.hasNext()&&n.hasNext();){var r=e.getNext(),i=n.getNext(),o=Ei(r.key,i.key)||r.value.compareTo(i.value);if(o)return o}return Ei(e.hasNext(),n.hasNext())}return this.defaultCompareTo(t)},Rs.prototype.set=function(t,e){if(jr(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),e);var n=this.child(t.firstSegment());n instanceof Rs||(n=Rs.EMPTY);var r=n.set(t.popFirst(),e);return this.setChild(t.firstSegment(),r)},Rs.prototype.delete=function(t){if(jr(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new Rs(this.internalValue.remove(t.firstSegment()));var e=this.child(t.firstSegment());if(e instanceof Rs){var n=e.delete(t.popFirst());return new Rs(this.internalValue.insert(t.firstSegment(),n))}return this},Rs.prototype.contains=function(t){return null!==this.field(t)},Rs.prototype.field=function(t){jr(!t.isEmpty(),"Can't get field of empty path");var e=this;return t.forEach((function(t){e=e instanceof Rs?e.internalValue.get(t):null})),e},Rs.prototype.fieldMask=function(){var t=new Eo(zi.comparator);return this.internalValue.forEach((function(e,n){var r=new zi([e]);if(n instanceof Rs){var i=n.fieldMask().fields;i.isEmpty()?t=t.add(r):i.forEach((function(e){t=t.add(r.child(e))}))}else t=t.add(r)})),_a.fromSet(t)},Rs.prototype.toString=function(){return this.internalValue.toString()},Rs.prototype.child=function(t){return this.internalValue.get(t)||void 0},Rs.prototype.setChild=function(t,e){return new Rs(this.internalValue.insert(t,e))},Rs.EMPTY=new Rs(new mo(Ei)),Rs);function Rs(t){var e=xs.call(this)||this;return e.internalValue=t,e.typeOrder=Ba.ObjectValue,e}var Ms,Ps=(i(Ls,Ms=Ya),Ls.prototype.value=function(t){return this.internalValue.map((function(e){return e.value(t)}))},Ls.prototype.contains=function(t){for(var e=0,n=this.internalValue;e<n.length;e++)if(n[e].isEqual(t))return!0;return!1},Ls.prototype.forEach=function(t){this.internalValue.forEach(t)},Ls.prototype.isEqual=function(t){if(t instanceof Ls){if(this.internalValue.length!==t.internalValue.length)return!1;for(var e=0;e<this.internalValue.length;e++)if(!this.internalValue[e].isEqual(t.internalValue[e]))return!1;return!0}return!1},Ls.prototype.compareTo=function(t){if(t instanceof Ls){for(var e=Math.min(this.internalValue.length,t.internalValue.length),n=0;n<e;n++){var r=this.internalValue[n].compareTo(t.internalValue[n]);if(r)return r}return Ei(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},Ls.prototype.toString=function(){return"["+this.internalValue.map((function(t){return t.toString()})).join(",")+"]"},Ls);function Ls(t){var e=Ms.call(this)||this;return e.internalValue=t,e.typeOrder=Ba.ArrayValue,e}var Fs=(Us.compareByKey=function(t,e){return Qi.comparator(t.key,e.key)},Us);function Us(t,e){this.key=t,this.version=e}var qs,Vs=(i(Bs,qs=Fs),Bs.prototype.field=function(t){if(this.objectValue)return this.objectValue.field(t);this.fieldValueCache||(this.fieldValueCache=new Map);var e=t.canonicalString(),n=this.fieldValueCache.get(e);if(void 0===n){var r=this.getProtoField(t);n=void 0===r?null:this.converter(r),this.fieldValueCache.set(e,n)}return n},Bs.prototype.data=function(){var t=this;if(!this.objectValue){var e=Os.EMPTY;ti(this.proto.fields||{},(function(n,r){e=e.set(new zi([n]),t.converter(r))})),this.objectValue=e,this.fieldValueCache=void 0}return this.objectValue},Bs.prototype.value=function(){return this.data().value()},Bs.prototype.isEqual=function(t){return t instanceof Bs&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.hasLocalMutations===t.hasLocalMutations&&this.hasCommittedMutations===t.hasCommittedMutations&&this.data().isEqual(t.data())},Bs.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data().toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Bs.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Bs.prototype.getProtoField=function(t){jr(void 0!==this.proto,"Can only call getProtoField() when proto is defined");for(var e=this.proto.fields?this.proto.fields[t.firstSegment()]:void 0,n=1;n<t.length;++n){if(!e||!e.mapValue||!e.mapValue.fields)return;e=e.mapValue.fields[t.get(n)]}return e},Bs.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?r.compareTo(i):Br("Trying to compare documents on fields that don't exist")},Bs);function Bs(t,e,n,r,i,o){var a=qs.call(this,t,e)||this;return a.objectValue=r,a.proto=i,a.converter=o,jr(void 0!==a.objectValue||void 0!==a.proto&&void 0!==a.converter,"If objectValue is not defined, proto and converter need to be set."),a.hasLocalMutations=!!n.hasLocalMutations,a.hasCommittedMutations=!!n.hasCommittedMutations,a}var js,Ws=(i(Ks,js=Fs),Ks.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ks.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),Ks.prototype.isEqual=function(t){return t instanceof Ks&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ks);function Ks(t,e,n){var r=js.call(this,t,e)||this;return r.hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}var zs,Gs=(i(Qs,zs=Fs),Qs.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Qs.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),Qs.prototype.isEqual=function(t){return t instanceof Qs&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Qs);function Qs(){return null!==zs&&zs.apply(this,arguments)||this}var Hs=(Ys.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.isEqual(t))return s}},Ys.prototype.has=function(t){return void 0!==this.get(t)},Ys.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},Ys.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},Ys.prototype.forEach=function(t){ti(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}}))},Ys.prototype.isEmpty=function(){return ei(this.inner)},Ys);function Ys(t){this.mapKeyFn=t,this.inner={}}var $s=(Object.defineProperty(Xs.prototype,"readTime",{get:function(){return jr(void 0!==this._readTime,"Read time is not set. All removeEntry() calls must include a readTime if `trackRemovals` is used."),this._readTime},set:function(t){jr(void 0===this._readTime||this._readTime.isEqual(t),"All changes in a RemoteDocumentChangeBuffer must have the same read time"),this._readTime=t},enumerable:!0,configurable:!0}),Xs.prototype.addEntry=function(t,e){this.assertNotApplied(),this.readTime=e,this.changes.set(t.key,t)},Xs.prototype.removeEntry=function(t,e){this.assertNotApplied(),e&&(this.readTime=e),this.changes.set(t,null)},Xs.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?jo.resolve(n):this.getFromCache(t,e)},Xs.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},Xs.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},Xs.prototype.assertNotApplied=function(){jr(!this.changesApplied,"Changes have already been applied.")},Xs);function Xs(){this.changes=new Hs((function(t){return t.toString()})),this.changesApplied=!1}var Js,Zs=(tu.prototype.addEntry=function(t,e,n){return ru(t).put(iu(e),n)},tu.prototype.removeEntry=function(t,e){var n=ru(t),r=iu(e);return n.delete(r)},tu.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.setMetadata(t,r)}))},tu.prototype.getEntry=function(t,e){var n=this;return ru(t).get(iu(e)).next((function(t){return n.maybeDecodeDocument(t)}))},tu.prototype.getSizedEntry=function(t,e){var n=this;return ru(t).get(iu(e)).next((function(t){var e=n.maybeDecodeDocument(t);return e?{maybeDocument:e,size:ou(t)}:null}))},tu.prototype.getEntries=function(t,e){var n=this,r=ko();return this.forEachDbEntry(t,e,(function(t,e){var i=n.maybeDecodeDocument(e);r=r.insert(t,i)})).next((function(){return r}))},tu.prototype.getSizedEntries=function(t,e){var n=this,r=ko(),i=new mo(Qi.comparator);return this.forEachDbEntry(t,e,(function(t,e){var o=n.maybeDecodeDocument(e);i=o?(r=r.insert(t,o),i.insert(t,ou(e))):(r=r.insert(t,null),i.insert(t,0))})).next((function(){return{maybeDocuments:r,sizeMap:i}}))},tu.prototype.forEachDbEntry=function(t,e,n){if(e.isEmpty())return jo.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return ru(t).iterate({range:r},(function(t,e,r){for(var a=Qi.fromSegments(t);o&&Qi.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.skip(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},tu.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this;jr(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var i=xo(),o=e.path.length+1,a={};if(n.isEqual(fo.MIN)){var s=e.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.toArray(),c=this.serializer.toDbTimestampKey(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=Su.collectionReadTimeIndex}return ru(t).iterate(a,(function(t,n,a){if(t.length===o){var s=r.serializer.fromDbRemoteDocument(n);e.path.isPrefixOf(s.key.path)?s instanceof Vs&&e.matches(s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},tu.prototype.getNewDocumentChanges=function(t,e){var n=this,r=No(),i=this.serializer.toDbTimestampKey(e),o=ru(t),a=IDBKeyRange.lowerBound(i,!0);return o.iterate({index:Su.readTimeIndex,range:a},(function(t,e){var o=n.serializer.fromDbRemoteDocument(e);r=r.insert(o.key,o),i=e.readTime})).next((function(){return{changedDocs:r,readTime:n.serializer.fromDbTimestampKey(i)}}))},tu.prototype.getLastDocumentChange=function(t){var e,n=this,r=ru(t),i=fo.MIN;return r.iterate({index:Su.readTimeIndex,reverse:!0},(function(t,r,o){e=n.serializer.fromDbRemoteDocument(r),r.readTime&&(i=n.serializer.fromDbTimestampKey(r.readTime)),o.done()})).next((function(){return{changedDoc:e,readTime:i}}))},tu.prototype.newChangeBuffer=function(t){return new tu.RemoteDocumentChangeBuffer(this,!!t&&t.trackRemovals)},tu.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},tu.prototype.getMetadata=function(t){return nu(t).get(Iu.key).next((function(t){return jr(!!t,"Missing document cache metadata"),t}))},tu.prototype.setMetadata=function(t,e){return nu(t).put(Iu.key,e)},tu.prototype.maybeDecodeDocument=function(t){if(t){var e=this.serializer.fromDbRemoteDocument(t);return e instanceof Ws&&e.version.isEqual(fo.forDeletedDoc())?null:e}return null},tu.RemoteDocumentChangeBuffer=(i(eu,Js=$s),eu.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Eo((function(t,e){return Ei(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,a){var s=e.documentSizes.get(o);if(jr(void 0!==s,"Cannot modify a document that wasn't read (for "+o+")"),a){jr(!e.readTime.isEqual(fo.MIN),"Cannot add a document with a read time of zero");var u=e.documentCache.serializer.toDbRemoteDocument(a,e.readTime);i=i.add(o.path.popLast());var c=ou(u);r+=c-s,n.push(e.documentCache.addEntry(t,o,u))}else if(r-=s,e.trackRemovals){var h=e.documentCache.serializer.toDbRemoteDocument(new Ws(o,fo.forDeletedDoc()),e.readTime);n.push(e.documentCache.addEntry(t,o,h))}else n.push(e.documentCache.removeEntry(t,o))})),i.forEach((function(r){n.push(e.documentCache.indexManager.addToCollectionParentIndex(t,r))})),n.push(this.documentCache.updateMetadata(t,r)),jo.waitFor(n)},eu.prototype.getFromCache=function(t,e){var n=this;return this.documentCache.getSizedEntry(t,e).next((function(t){return null===t?(n.documentSizes.set(e,0),null):(n.documentSizes.set(e,t.size),t.maybeDocument)}))},eu.prototype.getAllFromCache=function(t,e){var n=this;return this.documentCache.getSizedEntries(t,e).next((function(t){var e=t.maybeDocuments;return t.sizeMap.forEach((function(t,e){n.documentSizes.set(t,e)})),e}))},eu),tu);function tu(t,e){this.serializer=t,this.indexManager=e}function eu(t,e){var n=Js.call(this)||this;return n.documentCache=t,n.trackRemovals=e,n.documentSizes=new Hs((function(t){return t.toString()})),n}function nu(t){return pc.getStore(t,Iu.store)}function ru(t){return pc.getStore(t,Su.store)}function iu(t){return t.path.toArray()}function ou(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Br("Unknown remote document type");e=t.noDocument}return JSON.stringify(e).length}var au=(su.prototype.addToCollectionParentIndex=function(t,e){return this.collectionParentIndex.add(e),jo.resolve()},su.prototype.getCollectionParents=function(t,e){return jo.resolve(this.collectionParentIndex.getEntries(e))},su);function su(){this.collectionParentIndex=new uu}var uu=(cu.prototype.add=function(t){jr(t.length%2==1,"Expected a collection path.");var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Eo(Bi.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},cu.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},cu.prototype.getEntries=function(t){return(this.index[t]||new Eo(Bi.comparator)).toArray()},cu);function cu(){this.index={}}var hu=9,lu=(fu.prototype.createOrUpgrade=function(t,e,n,r){var i=this;jr(n<r&&0<=n&&r<=hu,"Unexpected schema upgrade from v"+n+" to v{toVersion}.");var o=new Yo(e);n<1&&1<=r&&(function(t){t.createObjectStore(du.store)}(t),function(t){t.createObjectStore(yu.store,{keyPath:yu.keyPath}),t.createObjectStore(vu.store,{keyPath:vu.keyPath,autoIncrement:!0}).createIndex(vu.userMutationsIndex,vu.userMutationsKeyPath,{unique:!0}),t.createObjectStore(_u.store)}(t),Lu(t),function(t){t.createObjectStore(Su.store)}(t));var a=jo.resolve();return n<3&&3<=r&&(0!==n&&(function(t){t.deleteObjectStore(Du.store),t.deleteObjectStore(Nu.store),t.deleteObjectStore(Ou.store)}(t),Lu(t)),a=a.next((function(){return function(t){var e=t.store(Ou.store),n=new Ou(0,0,fo.MIN.toTimestamp(),0);return e.put(Ou.key,n)}(o)}))),n<4&&4<=r&&(0!==n&&(a=a.next((function(){return function(t,e){return e.store(vu.store).loadAll().next((function(n){t.deleteObjectStore(vu.store),t.createObjectStore(vu.store,{keyPath:vu.keyPath,autoIncrement:!0}).createIndex(vu.userMutationsIndex,vu.userMutationsKeyPath,{unique:!0});var r=e.store(vu.store),i=n.map((function(t){return r.put(t)}));return jo.waitFor(i)}))}(t,o)}))),a=a.next((function(){!function(t){t.createObjectStore(Fu.store,{keyPath:Fu.keyPath})}(t)}))),n<5&&5<=r&&(a=a.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&6<=r&&(a=a.next((function(){return function(t){t.createObjectStore(Iu.store)}(t),i.addDocumentGlobal(o)}))),n<7&&7<=r&&(a=a.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&8<=r&&(a=a.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&9<=r&&(a=a.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Su.store);e.createIndex(Su.readTimeIndex,Su.readTimeIndexPath,{unique:!1}),e.createIndex(Su.collectionReadTimeIndex,Su.collectionReadTimeIndexPath,{unique:!1})}(e)}))),a},fu.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Su.store).iterate((function(t,n){e+=ou(n)})).next((function(){var n=new Iu(e);return t.store(Iu.store).put(Iu.key,n)}))},fu.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(yu.store),r=t.store(vu.store);return n.loadAll().next((function(n){return jo.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(vu.userMutationsIndex,i).next((function(r){return jo.forEach(r,(function(r){jr(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=e.serializer.fromDbMutationBatch(r);return sa(t,n.userId,i).next((function(){}))}))}))}))}))},fu.prototype.ensureSequenceNumbers=function(t){var e=t.store(Du.store),n=t.store(Su.store);return va(t).next((function(t){var r=[];return n.iterate((function(n,i){var o=new Bi(n),a=function(t){return[0,ao(t)]}(o);r.push(e.get(a).next((function(n){return n?jo.resolve():function(n){return e.put(new Du(0,ao(n),t))}(o)})))})).next((function(){return jo.waitFor(r)}))}))},fu.prototype.createCollectionParentIndex=function(t,e){function n(t){if(i.add(t)){var e=t.lastSegment(),n=t.popLast();return r.put({collectionId:e,parent:ao(n)})}}t.createObjectStore(Mu.store,{keyPath:Mu.keyPath});var r=e.store(Mu.store),i=new uu;return e.store(Su.store).iterate({keysOnly:!0},(function(t,e){var r=new Bi(t);return n(r.popLast())})).next((function(){return e.store(_u.store).iterate({keysOnly:!0},(function(t,e){t[0];var r=t[1],i=(t[2],co(r));return n(i.popLast())}))}))},fu);function fu(t){this.serializer=t}var pu=function(t,e){this.seconds=t,this.nanoseconds=e},du=(mu.store="owner",mu.key="owner",mu);function mu(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}var yu=(gu.store="mutationQueues",gu.keyPath="userId",gu);function gu(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}var vu=(bu.store="mutations",bu.keyPath="batchId",bu.userMutationsIndex="userMutationsIndex",bu.userMutationsKeyPath=["userId","batchId"],bu);function bu(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}var _u=(wu.prefixForUser=function(t){return[t]},wu.prefixForPath=function(t,e){return[t,ao(e)]},wu.key=function(t,e,n){return[t,ao(e),n]},wu.store="documentMutations",wu.PLACEHOLDER=new wu,wu);function wu(){}var Tu=function(t,e){this.path=t,this.readTime=e},Eu=function(t,e){this.path=t,this.version=e},Su=(Cu.store="remoteDocuments",Cu.readTimeIndex="readTimeIndex",Cu.readTimeIndexPath="readTime",Cu.collectionReadTimeIndex="collectionReadTimeIndex",Cu.collectionReadTimeIndexPath=["parentPath","readTime"],Cu);function Cu(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o}var Iu=(Au.store="remoteDocumentGlobal",Au.key="remoteDocumentGlobalKey",Au);function Au(t){this.byteSize=t}var Nu=(ku.store="targets",ku.keyPath="targetId",ku.queryTargetsIndexName="queryTargetsIndex",ku.queryTargetsKeyPath=["canonicalId","targetId"],ku);function ku(t,e,n,r,i,o,a){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a}var Du=(xu.store="targetDocuments",xu.keyPath=["targetId","path"],xu.documentTargetsIndex="documentTargetsIndex",xu.documentTargetsKeyPath=["path","targetId"],xu);function xu(t,e,n){this.targetId=t,this.path=e,jr(0===t==(void 0!==(this.sequenceNumber=n)),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}var Ou=(Ru.key="targetGlobalKey",Ru.store="targetGlobal",Ru);function Ru(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}var Mu=(Pu.store="collectionParents",Pu.keyPath=["collectionId","parent"],Pu);function Pu(t,e){this.collectionId=t,this.parent=e}function Lu(t){t.createObjectStore(Du.store,{keyPath:Du.keyPath}).createIndex(Du.documentTargetsIndex,Du.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Nu.store,{keyPath:Nu.keyPath}).createIndex(Nu.queryTargetsIndexName,Nu.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ou.store)}var Fu=(Uu.store="clientMetadata",Uu.keyPath="clientId",Uu);function Uu(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}var qu,Vu,Bu=h(h(h([yu.store,vu.store,_u.store,Su.store,Nu.store,du.store,Ou.store,Du.store],[Fu.store]),[Iu.store]),[Mu.store]),ju=(Wu.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(jr(e.length%2==1,"Expected a collection path."),this.collectionParentsCache.has(e))return jo.resolve();var r=e.lastSegment(),i=e.popLast();return t.addOnCommittedListener((function(){n.collectionParentsCache.add(e)})),Ku(t).put({collectionId:r,parent:ao(i)})},Wu.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Ci(e),""],!1,!0);return Ku(t).loadAll(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(co(o.parent))}return n}))},Wu);function Wu(){this.collectionParentsCache=new uu}function Ku(t){return pc.getStore(t,Mu.store)}(Vu=qu=qu||{})[Vu.Listen=0]="Listen",Vu[Vu.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",Vu[Vu.LimboResolution=2]="LimboResolution";var zu=(Gu.prototype.withSequenceNumber=function(t){return new Gu(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Gu.prototype.withResumeToken=function(t,e){return new Gu(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Gu.prototype.withLastLimboFreeSnapshotVersion=function(t){return new Gu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)},Gu.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.sequenceNumber===t.sequenceNumber&&this.snapshotVersion.isEqual(t.snapshotVersion)&&this.lastLimboFreeSnapshotVersion.isEqual(t.lastLimboFreeSnapshotVersion)&&this.resumeToken===t.resumeToken&&this.target.isEqual(t.target)},Gu);function Gu(t,e,n,r,i,o,a){void 0===i&&(i=fo.MIN),void 0===o&&(o=fo.MIN),void 0===a&&(a=zr()),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}var Qu=(Hu.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=Qi.fromSegments(t.noDocument.path),n=this.fromDbTimestamp(t.noDocument.readTime);return new Ws(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}return t.unknownDocument?(e=Qi.fromSegments(t.unknownDocument.path),n=this.fromDbTimestamp(t.unknownDocument.version),new Gs(e,n)):Br("Unexpected DbRemoteDocument")},Hu.prototype.toDbRemoteDocument=function(t,e){var n=this.toDbTimestampKey(e),r=t.key.path.popLast().toArray();if(t instanceof Vs){var i=t.proto?t.proto:this.remoteSerializer.toDocument(t),o=t.hasCommittedMutations;return new Su(null,null,i,o,n,r)}if(t instanceof Ws){var a=t.key.path.toArray(),s=this.toDbTimestamp(t.version);return o=t.hasCommittedMutations,new Su(null,new Tu(a,s),null,o,n,r)}if(t instanceof Gs){a=t.key.path.toArray();var u=this.toDbTimestamp(t.version);return new Su(new Eu(a,u),null,null,!0,n,r)}return Br("Unexpected MaybeDocument")},Hu.prototype.toDbTimestampKey=function(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]},Hu.prototype.fromDbTimestampKey=function(t){var e=new ho(t[0],t[1]);return fo.fromTimestamp(e)},Hu.prototype.toDbTimestamp=function(t){var e=t.toTimestamp();return new pu(e.seconds,e.nanoseconds)},Hu.prototype.fromDbTimestamp=function(t){var e=new ho(t.seconds,t.nanoseconds);return fo.fromTimestamp(e)},Hu.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.baseMutations.map((function(t){return n.remoteSerializer.toMutation(t)})),i=e.mutations.map((function(t){return n.remoteSerializer.toMutation(t)}));return new vu(t,e.batchId,e.localWriteTime.toMillis(),r,i)},Hu.prototype.fromDbMutationBatch=function(t){var e=this,n=(t.baseMutations||[]).map((function(t){return e.remoteSerializer.fromMutation(t)})),r=t.mutations.map((function(t){return e.remoteSerializer.fromMutation(t)})),i=ho.fromMillis(t.localWriteTimeMs);return new Uo(t.batchId,i,n,r)},Hu.prototype.toDbResourcePaths=function(t){var e=[];return t.forEach((function(t){e.push(ao(t.path))})),e},Hu.prototype.fromDbResourcePaths=function(t){for(var e=Po(),n=0,r=t;n<r.length;n++){var i=r[n];e=e.add(new Qi(co(i)))}return e},Hu.prototype.fromDbTarget=function(t){var e,n=this.fromDbTimestamp(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?this.fromDbTimestamp(t.lastLimboFreeSnapshotVersion):fo.MIN,i=t.resumeToken;return e=function(t){return void 0!==t.documents}(t.query)?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new zu(e,t.targetId,qu.Listen,t.lastListenSequenceNumber,n,r,i)},Hu.prototype.toDbTarget=function(t){jr(qu.Listen===t.purpose,"Only queries with purpose "+qu.Listen+" may be stored, got "+t.purpose);var e,n,r=this.toDbTimestamp(t.snapshotVersion),i=this.toDbTimestamp(t.lastLimboFreeSnapshotVersion);return e=t.target.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(t.target):this.remoteSerializer.toQueryTarget(t.target),n=t.resumeToken instanceof Uint8Array?(jr(zo.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence ."),t.resumeToken.toString()):t.resumeToken,new Nu(t.targetId,t.target.canonicalId(),r,n,t.sequenceNumber,i,e)},Hu);function Hu(t){this.remoteSerializer=t}function Yu(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=Ei(n,i);return 0===a?Ei(r,o):a}var $u=(Xu.prototype.nextIndex=function(){return++this.previousIndex},Xu.prototype.addElement=function(t){var e=[t,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Yu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(Xu.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),Xu);function Xu(t){this.maxElements=t,this.buffer=new Eo(Yu),this.previousIndex=0}var Ju={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Zu=(tc.withCacheSize=function(t){return new tc(t,tc.DEFAULT_COLLECTION_PERCENTILE,tc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},tc.COLLECTION_DISABLED=-1,tc.MINIMUM_CACHE_SIZE_BYTES=1048576,tc.DEFAULT=new tc(tc.DEFAULT_CACHE_SIZE_BYTES=41943040,tc.DEFAULT_COLLECTION_PERCENTILE=10,tc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3),tc.DISABLED=new tc(tc.COLLECTION_DISABLED,0,0),tc);function tc(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}var ec=(nc.prototype.start=function(){jr(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==Zu.COLLECTION_DISABLED&&this.scheduleGC()},nc.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(nc.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),nc.prototype.scheduleGC=function(){var t=this;jr(null===this.gcTask,"Cannot schedule GC while a task is pending");var e=this.hasRun?3e5:6e4;Ur("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(Yi.LruGarbageCollection,e,(function(){return t.gcTask=null,t.hasRun=!0,t.localStore.collectGarbage(t.garbageCollector).then((function(){return t.scheduleGC()})).catch(mc)}))},nc);function nc(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.hasRun=!1,this.gcTask=null}var rc=(ic.prototype.calculateTargetCount=function(t,e){return this.delegate.getSequenceNumberCount(t).next((function(t){return Math.floor(e/100*t)}))},ic.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return jo.resolve(Pi.INVALID);var r=new $u(e);return this.delegate.forEachTarget(t,(function(t){return r.addElement(t.sequenceNumber)})).next((function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(t,(function(t){return r.addElement(t)}))})).next((function(){return r.maxValue}))},ic.prototype.removeTargets=function(t,e,n){return this.delegate.removeTargets(t,e,n)},ic.prototype.removeOrphanedDocuments=function(t,e){return this.delegate.removeOrphanedDocuments(t,e)},ic.prototype.collect=function(t,e){var n=this;return this.params.cacheSizeCollectionThreshold===Zu.COLLECTION_DISABLED?(Ur("LruGarbageCollector","Garbage collection skipped; disabled"),jo.resolve(Ju)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Ur("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Ju):n.runGarbageCollection(t,e)}))},ic.prototype.getCacheSize=function(t){return this.delegate.getCacheSize(t)},ic.prototype.runGarbageCollection=function(t,e){var n,r,i,o,a,s,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return r=e>c.params.maximumSequenceNumbersToCollect?(Ur("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),c.params.maximumSequenceNumbersToCollect):e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,a=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,s=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),Lr()<=Ir.DEBUG&&Ur("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(a-o)+"ms\n\tRemoved "+i+" targets in "+(s-a)+"ms\n\tRemoved "+t+" documents in "+(u-s)+"ms\nTotal Duration: "+(u-h)+"ms"),jo.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},ic);function ic(t,e){this.delegate=t,this.params=e}var oc=(ac.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},ac.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},ac);function ac(){this.onCommittedListeners=[]}var sc,uc="IndexedDbPersistence",cc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",hc="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",lc=(i(fc,sc=oc),fc);function fc(t,e){var n=sc.call(this)||this;return n.simpleDbTransaction=t,n.currentSequenceNumber=e,n}var pc=(dc.getStore=function(t,e){if(t instanceof lc)return zo.getStore(t.simpleDbTransaction,e);throw Br("IndexedDbPersistence must use instances of IndexedDbTransaction")},dc.createIndexedDbPersistence=function(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:if(!dc.isAvailable())throw new Hr(Qr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");return[4,(e=new dc(t.allowTabSynchronization,t.persistenceKey,t.clientId,t.platform,t.lruParams,t.queue,t.serializer,t.sequenceNumberSyncer)).start()];case 1:return n.sent(),[2,e]}}))}))},dc.prototype.start=function(){var t=this;return jr(!this.started,"IndexedDbPersistence double-started!"),jr(null!==this.window,"Expected 'window' to be defined"),zo.openOrCreate(this.dbName,hu,new lu(this.serializer)).then((function(e){return t.simpleDb=e,t.updateClientMetadataAndTryBecomePrimary()})).then((function(){return t.attachVisibilityHandler(),t.attachWindowUnloadHook(),t.scheduleClientMetadataAndPrimaryLeaseRefreshes(),t.simpleDb.runTransaction("readonly-idempotent",[Ou.store],(function(t){return va(t)}))})).then((function(e){t.listenSequence=new Pi(e,t.sequenceNumberSyncer)})).then((function(){t._started=!0})).catch((function(e){return t.simpleDb&&t.simpleDb.close(),Promise.reject(e)}))},dc.prototype.setPrimaryStateListener=function(t){var e=this;return this.primaryStateListener=function(n){return u(e,void 0,void 0,(function(){return c(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},dc.prototype.setDatabaseDeletedListener=function(t){var e=this;this.simpleDb.setVersionChangeListener((function(n){return u(e,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return null!==n.newVersion?[3,2]:[4,t()];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},dc.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.queue.enqueueAndForget((function(){return u(e,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},dc.prototype.updateClientMetadataAndTryBecomePrimary=function(){var t=this;return this.simpleDb.runTransaction("readwrite-idempotent",Bu,(function(e){return gc(e).put(new Fu(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.verifyPrimaryLease(e).next((function(e){e||(t.isPrimary=!1,t.queue.enqueueAndForget((function(){return t.primaryStateListener(!1)})))}))})).next((function(){return t.canActAsPrimary(e)})).next((function(n){return t.isPrimary&&!n?t.releasePrimaryLeaseIfHeld(e).next((function(){return!1})):!!n&&t.acquireOrExtendPrimaryLease(e).next((function(){return!0}))}))})).catch((function(e){if(!t.allowTabSynchronization)throw e;return Ur(uc,"Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.queue.enqueueAndForget((function(){return t.primaryStateListener(e)})),t.isPrimary=e}))},dc.prototype.verifyPrimaryLease=function(t){var e=this;return yc(t).get(du.key).next((function(t){return jo.resolve(e.isLocalClient(t))}))},dc.prototype.removeClientMetadata=function(t){return gc(t).delete(this.clientId)},dc.prototype.maybeGarbageCollectMultiClientState=function(){return u(this,void 0,void 0,(function(){var t=this;return c(this,(function(e){switch(e.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary-idempotent",(function(e){var n=dc.getStore(e,Fu.store);return n.loadAll().next((function(e){var r=t.filterActiveClients(e,18e5),i=e.filter((function(t){return-1===r.indexOf(t)}));return jo.forEach(i,(function(t){return n.delete(t.clientId)})).next((function(){return i}))}))}))]);case 1:e.sent().forEach((function(e){t.window.localStorage.removeItem(t.zombiedClientLocalStorageKey(e.clientId))})),e.label=2;case 2:return[2]}}))}))},dc.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var t=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(Yi.ClientMetadataRefresh,4e3,(function(){return t.updateClientMetadataAndTryBecomePrimary().then((function(){return t.maybeGarbageCollectMultiClientState()})).then((function(){return t.scheduleClientMetadataAndPrimaryLeaseRefreshes()}))}))},dc.prototype.isLocalClient=function(t){return!!t&&t.ownerId===this.clientId},dc.prototype.canActAsPrimary=function(t){var e=this;return yc(t).get(du.key).next((function(n){if(null!==n&&e.isWithinAge(n.leaseTimestampMs,5e3)&&!e.isClientZombied(n.ownerId)){if(e.isLocalClient(n)&&e.networkEnabled)return!0;if(!e.isLocalClient(n)){if(!n.allowTabSynchronization)throw new Hr(Qr.FAILED_PRECONDITION,hc);return!1}}return!(!e.networkEnabled||!e.inForeground)||gc(t).loadAll().next((function(t){return void 0===e.filterActiveClients(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&Ur(uc,"Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},dc.prototype.shutdown=function(){return u(this,void 0,void 0,(function(){var t=this;return c(this,(function(e){switch(e.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite-idempotent",[du.store,Fu.store],(function(e){return t.releasePrimaryLeaseIfHeld(e).next((function(){return t.removeClientMetadata(e)}))}))];case 1:return e.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}}))}))},dc.prototype.filterActiveClients=function(t,e){var n=this;return t.filter((function(t){return n.isWithinAge(t.updateTimeMs,e)&&!n.isClientZombied(t.clientId)}))},dc.prototype.getActiveClients=function(){var t=this;return this.simpleDb.runTransaction("readonly-idempotent",[Fu.store],(function(e){return gc(e).loadAll().next((function(e){return t.filterActiveClients(e,18e5).map((function(t){return t.clientId}))}))}))},dc.clearPersistence=function(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return dc.isAvailable()?(e=t+dc.MAIN_DATABASE,[4,zo.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))},Object.defineProperty(dc.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),dc.prototype.getMutationQueue=function(t){return jr(this.started,"Cannot initialize MutationQueue before persistence is started."),ia.forUser(t,this.serializer,this.indexManager,this.referenceDelegate)},dc.prototype.getTargetCache=function(){return jr(this.started,"Cannot initialize TargetCache before persistence is started."),this.targetCache},dc.prototype.getRemoteDocumentCache=function(){return jr(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},dc.prototype.getIndexManager=function(){return jr(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},dc.prototype.runTransaction=function(t,e,n){var r=this;Ur(uc,"Starting transaction:",t);var i,o=e.endsWith("idempotent"),a=e.startsWith("readonly")?o?"readonly-idempotent":"readonly":o?"readwrite-idempotent":"readwrite";return this.simpleDb.runTransaction(a,Bu,(function(o){return i=new lc(o,r.listenSequence.next()),"readwrite-primary"===e||"readwrite-primary-idempotent"===e?r.verifyPrimaryLease(o).next((function(t){return!!t||r.canActAsPrimary(o)})).next((function(e){if(!e)throw qr("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.queue.enqueueAndForget((function(){return r.primaryStateListener(!1)})),new Hr(Qr.FAILED_PRECONDITION,cc);return n(i)})).next((function(t){return r.acquireOrExtendPrimaryLease(o).next((function(){return t}))})):r.verifyAllowTabSynchronization(o).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},dc.prototype.verifyAllowTabSynchronization=function(t){var e=this;return yc(t).get(du.key).next((function(t){if(null!==t&&e.isWithinAge(t.leaseTimestampMs,5e3)&&!e.isClientZombied(t.ownerId)&&!e.isLocalClient(t)&&!t.allowTabSynchronization)throw new Hr(Qr.FAILED_PRECONDITION,hc)}))},dc.prototype.acquireOrExtendPrimaryLease=function(t){var e=new du(this.clientId,this.allowTabSynchronization,Date.now());return yc(t).put(du.key,e)},dc.isAvailable=function(){return zo.isAvailable()},dc.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},dc.prototype.releasePrimaryLeaseIfHeld=function(t){var e=this,n=yc(t);return n.get(du.key).next((function(t){return e.isLocalClient(t)?(Ur(uc,"Releasing primary lease."),n.delete(du.key)):jo.resolve()}))},dc.prototype.isWithinAge=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(qr("Detected an update time that is in the future: "+t+" > "+n),1))},dc.prototype.attachVisibilityHandler=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){t.queue.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.updateClientMetadataAndTryBecomePrimary()}))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},dc.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(jr(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},dc.prototype.attachWindowUnloadHook=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){t.markClientZombied(),t.queue.enqueueAndForget((function(){return t.shutdown()}))},this.window.addEventListener("unload",this.windowUnloadHandler))},dc.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(jr("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},dc.prototype.isClientZombied=function(t){try{var e=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(t));return Ur(uc,"Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return qr(uc,"Failed to get zombied client id.",t),!1}},dc.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(i){qr("Failed to set zombie client id.",i)}},dc.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(i){}},dc.prototype.zombiedClientLocalStorageKey=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},dc.MAIN_DATABASE="main",dc);function dc(t,e,n,r,i,o,a,s){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.queue=o,this.sequenceNumberSyncer=s,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(t){return Promise.resolve()},this.referenceDelegate=new vc(this,i),this.dbName=e+dc.MAIN_DATABASE,this.serializer=new Qu(a),this.document=r.document,this.targetCache=new da(this.referenceDelegate,this.serializer),this.indexManager=new ju,this.remoteDocumentCache=new Zs(this.serializer,this.indexManager),!r.window||!r.window.localStorage)throw new Hr(Qr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=r.window,this.webStorage=this.window.localStorage}function mc(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){if(!function(t){return t.code===Qr.FAILED_PRECONDITION&&t.message===cc}(t))throw t;return Ur(uc,"Unexpectedly lost primary lease"),[2]}))}))}function yc(t){return t.store(du.store)}function gc(t){return t.store(Fu.store)}var vc=(bc.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocmentCount(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},bc.prototype.orphanedDocmentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,(function(t){e++})).next((function(){return e}))},bc.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},bc.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){return this.forEachOrphanedDocument(t,(function(t,n){return e(n)}))},bc.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},bc.prototype.addReference=function(t,e){return _c(t,e)},bc.prototype.removeReference=function(t,e){return _c(t,e)},bc.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},bc.prototype.removeMutationReference=function(t,e){return _c(t,e)},bc.prototype.isPinned=function(t,e){return this.inMemoryPins.containsKey(e)?jo.resolve(!0):function(t,e){var n=!1;return la(t).iterateSerial((function(r){return aa(t,r,e).next((function(t){return t&&(n=!0),jo.resolve(!t)}))})).next((function(){return n}))}(t,e)},bc.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.forEachOrphanedDocument(t,(function(a,s){if(s<=e){var u=n.isPinned(t,a).next((function(e){if(!e)return o++,r.getEntry(t,a).next((function(){return r.removeEntry(a),ba(t).delete(function(t){return[0,ao(t.path)]}(a))}))}));i.push(u)}})).next((function(){return jo.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},bc.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},bc.prototype.updateLimboDocument=function(t,e){return _c(t,e)},bc.prototype.forEachOrphanedDocument=function(t,e){var n,r=ba(t),i=Pi.INVALID;return r.iterate({index:Du.documentTargetsIndex},(function(t,r){var o=t[0],a=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==Pi.INVALID&&e(new Qi(co(n)),i),i=s,n=a):i=Pi.INVALID})).next((function(){i!==Pi.INVALID&&e(new Qi(co(n)),i)}))},bc.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},bc);function bc(t,e){this.db=t,this.inMemoryPins=null,this.garbageCollector=new rc(this,e)}function _c(t,e){return ba(t).put(function(t,e){return new Du(0,ao(t.path),e)}(e,t.currentSequenceNumber))}var wc=(Tc.prototype.getDocument=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.getDocumentInternal(t,e,r)}))},Tc.prototype.getDocumentInternal=function(t,e,n){return this.remoteDocumentCache.getEntry(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].applyToLocalView(e,t);return t}))},Tc.prototype.applyLocalMutationsToDocuments=function(t,e,n){var r=ko();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].applyToLocalView(t,e);r=r.insert(t,e)})),r},Tc.prototype.getDocuments=function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next((function(e){return n.getLocalViewOfDocuments(t,e)}))},Tc.prototype.getLocalViewOfDocuments=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(r){var i=n.applyLocalMutationsToDocuments(t,e,r),o=No();return i.forEach((function(t,e){e=e||new Ws(t,fo.forDeletedDoc()),o=o.insert(t,e)})),o}))},Tc.prototype.getDocumentsMatchingQuery=function(t,e,n){return e.isDocumentQuery()?this.getDocumentsMatchingDocumentQuery(t,e.path):e.isCollectionGroupQuery()?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n)},Tc.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new Qi(e)).next((function(t){var e=xo();return t instanceof Vs&&(e=e.insert(t.key,t)),e}))},Tc.prototype.getDocumentsMatchingCollectionGroupQuery=function(t,e,n){var r=this;jr(e.path.isEmpty(),"Currently we only support collection group queries at the root.");var i=e.collectionGroup,o=xo();return this.indexManager.getCollectionParents(t,i).next((function(a){return jo.forEach(a,(function(a){var s=e.asCollectionQueryAtPath(a.child(i));return r.getDocumentsMatchingCollectionQuery(t,s,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},Tc.prototype.getDocumentsMatchingCollectionQuery=function(t,e,n){var r,i,o=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.addMissingBaseDocuments(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,h=r.get(c),l=u.applyToLocalView(h,h,o.localWriteTime);r=l instanceof Vs?r.insert(c,l):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){e.matches(n)||(r=r.remove(t))})),r}))},Tc.prototype.addMissingBaseDocuments=function(t,e,n){for(var r=Po(),i=0,o=e;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof Pa&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.remoteDocumentCache.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof Vs&&(c=c.insert(t,e))})),c}))},Tc);function Tc(t,e,n){this.remoteDocumentCache=t,this.mutationQueue=e,this.indexManager=n}var Ec=(Sc.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},Sc.prototype.addReference=function(t,e){var n=new Cc(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},Sc.prototype.addReferences=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},Sc.prototype.removeReference=function(t,e){this.removeRef(new Cc(t,e))},Sc.prototype.removeReferences=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},Sc.prototype.removeReferencesForId=function(t){var e=this,n=Qi.EMPTY,r=new Cc(n,t),i=new Cc(n,t+1),o=[];return this.refsByTarget.forEachInRange([r,i],(function(t){e.removeRef(t),o.push(t.key)})),o},Sc.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach((function(e){return t.removeRef(e)}))},Sc.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t)},Sc.prototype.referencesForId=function(t){var e=Qi.EMPTY,n=new Cc(e,t),r=new Cc(e,t+1),i=Po();return this.refsByTarget.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},Sc.prototype.containsKey=function(t){var e=new Cc(t,0),n=this.refsByKey.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},Sc);function Sc(){this.refsByKey=new Eo(Cc.compareByKey),this.refsByTarget=new Eo(Cc.compareByTargetId)}var Cc=(Ic.compareByKey=function(t,e){return Qi.comparator(t.key,e.key)||Ei(t.targetOrBatchId,e.targetOrBatchId)},Ic.compareByTargetId=function(t,e){return Ei(t.targetOrBatchId,e.targetOrBatchId)||Qi.comparator(t.key,e.key)},Ic);function Ic(t,e){this.key=t,this.targetOrBatchId=e}var Ac="LocalStore",Nc=(kc.prototype.start=function(){return this.synchronizeLastDocumentChangeReadTime()},kc.prototype.handleUserChange=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i=this;return c(this,(function(o){switch(o.label){case 0:return e=this.mutationQueue,n=this.localDocuments,[4,this.persistence.runTransaction("Handle user change","readonly-idempotent",(function(r){var o;return i.mutationQueue.getAllMutationBatches(r).next((function(a){return o=a,e=i.persistence.getMutationQueue(t),n=new wc(i.remoteDocuments,e,i.persistence.getIndexManager()),e.getAllMutationBatches(r)})).next((function(t){for(var e=[],i=[],a=Po(),s=0,u=o;s<u.length;s++){var c=u[s];e.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];a=a.add(f.key)}}for(var p=0,d=t;p<d.length;p++){c=d[p],i.push(c.batchId);for(var m=0,y=c.mutations;m<y.length;m++)f=y[m],a=a.add(f.key)}return n.getDocuments(r,a).next((function(t){return{affectedDocuments:t,removedBatchIds:e,addedBatchIds:i}}))}))}))];case 1:return r=o.sent(),this.mutationQueue=e,this.localDocuments=n,this.queryEngine.setLocalDocumentsView(this.localDocuments),[2,r]}}))}))},kc.prototype.localWrite=function(t){var e,n=this,r=ho.now(),i=t.reduce((function(t,e){return t.add(e.key)}),Po());return this.persistence.runTransaction("Locally write mutations","readwrite-idempotent",(function(o){return n.localDocuments.getDocuments(o,i).next((function(i){e=i;for(var a=[],s=0,u=t;s<u.length;s++){var c=u[s],h=c.extractBaseValue(e.get(c.key));null!=h&&a.push(new Pa(c.key,h,h.fieldMask(),Aa.exists(!0)))}return n.mutationQueue.addMutationBatch(o,r,a,t)}))})).then((function(t){var n=t.applyToLocalDocumentSet(e);return{batchId:t.batchId,changes:n}}))},kc.prototype.lookupMutationDocuments=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly-idempotent",(function(n){return e.mutationQueue.lookupMutationKeys(n,t).next((function(t){return t?e.localDocuments.getDocuments(n,t):jo.resolve(null)}))}))},kc.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary-idempotent",(function(n){var r=t.batch.keys(),i=e.remoteDocuments.newChangeBuffer({trackRemovals:!0});return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next((function(){return e.applyWriteToRemoteDocuments(n,t,i)})).next((function(){return i.apply(n)})).next((function(){return e.mutationQueue.performConsistencyCheck(n)})).next((function(){return e.localDocuments.getDocuments(n,r)}))}))},kc.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary-idempotent",(function(n){var r;return e.mutationQueue.lookupMutationBatch(n,t).next((function(t){return jr(null!==t,"Attempt to reject nonexistent batch!"),r=t.keys(),e.mutationQueue.removeMutationBatch(n,t)})).next((function(){return e.mutationQueue.performConsistencyCheck(n)})).next((function(){return e.localDocuments.getDocuments(n,r)}))}))},kc.prototype.getHighestUnacknowledgedBatchId=function(){var t=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly-idempotent",(function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)}))},kc.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly-idempotent",(function(e){return t.mutationQueue.getLastStreamToken(e)}))},kc.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary-idempotent",(function(n){return e.mutationQueue.setLastStreamToken(n,t)}))},kc.prototype.getLastRemoteSnapshotVersion=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly-idempotent",(function(e){return t.targetCache.getLastRemoteSnapshotVersion(e)}))},kc.prototype.applyRemoteEvent=function(t){var e=this,n=t.snapshotVersion,r=this.targetDataByTarget;return this.persistence.runTransaction("Apply remote event","readwrite-primary-idempotent",(function(i){var o=e.remoteDocuments.newChangeBuffer({trackRemovals:!0});r=e.targetDataByTarget;var a=[];Zr(t.targetChanges,(function(t,o){var s=r.get(t);if(s){a.push(e.targetCache.removeMatchingKeys(i,o.removedDocuments,t).next((function(){return e.targetCache.addMatchingKeys(i,o.addedDocuments,t)})));var u=o.resumeToken;if(0<u.length){var c=s.withResumeToken(u,n).withSequenceNumber(i.currentSequenceNumber);r=r.insert(t,c),kc.shouldPersistTargetData(s,c,o)&&a.push(e.targetCache.updateTargetData(i,c))}}}));var s=No(),u=Po();if(t.documentUpdates.forEach((function(t,e){u=u.add(t)})),a.push(o.getEntries(i,u).next((function(r){t.documentUpdates.forEach((function(u,c){var h=r.get(u);c instanceof Ws&&c.version.isEqual(fo.MIN)?(o.removeEntry(u,n),s=s.insert(u,c)):null==h||0<c.version.compareTo(h.version)||0===c.version.compareTo(h.version)&&h.hasPendingWrites?(fo.MIN.isEqual(n)&&qr(Ac,"Cannot add a document when the remote version is zero"),o.addEntry(c,n),s=s.insert(u,c)):Ur(Ac,"Ignoring outdated watch update for ",u,". Current version:",h.version," Watch version:",c.version),t.resolvedLimboDocuments.has(u)&&a.push(e.persistence.referenceDelegate.updateLimboDocument(i,u))}))}))),!n.isEqual(fo.MIN)){var c=e.targetCache.getLastRemoteSnapshotVersion(i).next((function(t){return jr(0<=n.compareTo(t),"Watch stream reverted to previous snapshot?? "+n+" < "+t),e.targetCache.setTargetsMetadata(i,i.currentSequenceNumber,n)}));a.push(c)}return jo.waitFor(a).next((function(){return o.apply(i)})).next((function(){return e.localDocuments.getLocalViewOfDocuments(i,s)}))})).then((function(t){return e.targetDataByTarget=r,t}))},kc.shouldPersistTargetData=function(t,e,n){return jr(0<e.resumeToken.length,"Attempted to persist target data with no resume token"),0===t.resumeToken.length||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||0<n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size},kc.prototype.notifyLocalViewChanges=function(t){for(var e=this,n=0,r=t;n<r.length;n++){var i=r[n],o=i.targetId;if(this.localViewReferences.addReferences(i.addedKeys,o),this.localViewReferences.removeReferences(i.removedKeys,o),!i.fromCache){var a=this.targetDataByTarget.get(o);jr(null!==a,"Can't set limbo-free snapshot version for unknown target: "+o);var s=a.snapshotVersion,u=a.withLastLimboFreeSnapshotVersion(s);this.targetDataByTarget=this.targetDataByTarget.insert(o,u)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite-idempotent",(function(n){return jo.forEach(t,(function(t){return jo.forEach(t.removedKeys,(function(t){return e.persistence.referenceDelegate.removeReference(n,t)}))}))}))},kc.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly-idempotent",(function(n){return void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)}))},kc.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document","readonly-idempotent",(function(n){return e.localDocuments.getDocument(n,t)}))},kc.prototype.allocateTarget=function(t){var e=this;return this.persistence.runTransaction("Allocate target","readwrite-idempotent",(function(n){var r;return e.targetCache.getTargetData(n,t).next((function(i){return i?(r=i,jo.resolve(r)):e.targetCache.allocateTargetId(n).next((function(i){return r=new zu(t,i,qu.Listen,n.currentSequenceNumber),e.targetCache.addTargetData(n,r).next((function(){return r}))}))}))})).then((function(n){return null===e.targetDataByTarget.get(n.targetId)&&(e.targetDataByTarget=e.targetDataByTarget.insert(n.targetId,n),e.targetIdByTarget.set(t,n.targetId)),n}))},kc.prototype.getTargetData=function(t,e){var n=this.targetIdByTarget.get(e);return void 0!==n?jo.resolve(this.targetDataByTarget.get(n)):this.targetCache.getTargetData(t,e)},kc.prototype.releaseTarget=function(t,e){var n=this,r=this.targetDataByTarget.get(t);if(!r)return Promise.resolve();var i=e?"readwrite-idempotent":"readwrite-primary-idempotent";return this.persistence.runTransaction("Release target",i,(function(i){var o=n.localViewReferences.removeReferencesForId(t);return e?jo.resolve():jo.forEach(o,(function(t){return n.persistence.referenceDelegate.removeReference(i,t)})).next((function(){n.persistence.referenceDelegate.removeTarget(i,r)}))})).then((function(){n.targetDataByTarget=n.targetDataByTarget.remove(t),n.targetIdByTarget.delete(r.target)}))},kc.prototype.executeQuery=function(t,e){var n=this,r=fo.MIN,i=Po();return this.persistence.runTransaction("Execute query","readonly-idempotent",(function(o){return n.getTargetData(o,t.toTarget()).next((function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,n.targetCache.getMatchingKeysForTargetId(o,t.targetId).next((function(t){i=t}))})).next((function(){return n.queryEngine.getDocumentsMatchingQuery(o,t,e?r:fo.MIN,e?i:Po())})).next((function(t){return{documents:t,remoteKeys:i}}))}))},kc.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys","readonly-idempotent",(function(n){return e.targetCache.getMatchingKeysForTargetId(n,t)}))},kc.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},kc.prototype.removeCachedMutationBatchMetadata=function(t){this.mutationQueue.removeCachedMutationKeys(t)},kc.prototype.setNetworkEnabled=function(t){this.persistence.setNetworkEnabled(t)},kc.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=this,i=e.batch,o=i.keys(),a=jo.resolve();return o.forEach((function(r){a=a.next((function(){return n.getEntry(t,r)})).next((function(t){var o=t,a=e.docVersions.get(r);jr(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&((o=i.applyToRemoteDocument(r,o,e))?n.addEntry(o,e.commitVersion):jr(!t,"Mutation batch "+i+" applied to document "+t+" resulted in null"))}))})),a.next((function(){return r.mutationQueue.removeMutationBatch(t,i)}))},kc.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary-idempotent",(function(n){return t.collect(n,e.targetDataByTarget)}))},kc.prototype.getTarget=function(t){var e=this,n=this.targetDataByTarget.get(t);return n?Promise.resolve(n.target):this.persistence.runTransaction("Get target data","readonly-idempotent",(function(n){return e.targetCache.getTargetDataForTarget(n,t).next((function(t){return t?t.target:null}))}))},kc.prototype.getNewDocumentChanges=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly-idempotent",(function(e){return t.remoteDocuments.getNewDocumentChanges(e,t.lastDocumentChangeReadTime)})).then((function(e){var n=e.changedDocs,r=e.readTime;return t.lastDocumentChangeReadTime=r,n}))},kc.prototype.synchronizeLastDocumentChangeReadTime=function(){return u(this,void 0,void 0,(function(){var t,e=this;return c(this,(function(n){return this.remoteDocuments instanceof Zs?(t=this.remoteDocuments,[2,this.persistence.runTransaction("Synchronize last document change read time","readonly-idempotent",(function(e){return t.getLastDocumentChange(e)})).then((function(t){var n=t.readTime;e.lastDocumentChangeReadTime=n}))]):[2]}))}))},kc.RESUME_TOKEN_MAX_AGE_MICROS=3e8,kc);function kc(t,e,n){this.persistence=t,this.queryEngine=e,this.localViewReferences=new Ec,this.targetDataByTarget=new mo(Ei),this.targetIdByTarget=new Hs((function(t){return t.canonicalId()})),this.lastDocumentChangeReadTime=fo.MIN,jr(t.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=t.getMutationQueue(n),this.remoteDocuments=t.getRemoteDocumentCache(),this.targetCache=t.getTargetCache(),this.localDocuments=new wc(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager()),this.queryEngine.setLocalDocumentsView(this.localDocuments)}var Dc=(xc.prototype.checkEmpty=function(t){return jo.resolve(0===this.mutationQueue.length)},xc.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId,i=this.indexOfExistingBatchId(r,"acknowledged");jr(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return jr(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,jo.resolve()},xc.prototype.getLastStreamToken=function(t){return jo.resolve(this.lastStreamToken)},xc.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,jo.resolve()},xc.prototype.addMutationBatch=function(t,e,n,r){jr(0!==r.length,"Mutation batches should not be empty");var i=this.nextBatchId;this.nextBatchId++,0<this.mutationQueue.length&&jr(this.mutationQueue[this.mutationQueue.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order");var o=new Uo(i,e,n,r);this.mutationQueue.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Cc(u.key,i)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast())}return jo.resolve(o)},xc.prototype.lookupMutationBatch=function(t,e){return jo.resolve(this.findMutationBatch(e))},xc.prototype.lookupMutationKeys=function(t,e){var n=this.findMutationBatch(e);return jr(null!=n,"Failed to find local mutation batch."),jo.resolve(n.keys())},xc.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.indexOfBatchId(n),i=r<0?0:r;return jo.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)},xc.prototype.getHighestUnacknowledgedBatchId=function(){return jo.resolve(0===this.mutationQueue.length?-1:this.nextBatchId-1)},xc.prototype.getAllMutationBatches=function(t){return jo.resolve(this.mutationQueue.slice())},xc.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Cc(e,0),i=new Cc(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],(function(t){jr(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);jr(null!==r,"Batches in the index must exist in the main table"),o.push(r)})),jo.resolve(o)},xc.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Eo(Ei);return e.forEach((function(t){var e=new Cc(t,0),i=new Cc(t,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([e,i],(function(e){jr(t.isEqual(e.key),"For each key, should only iterate over a single key's batches"),r=r.add(e.targetOrBatchId)}))})),jo.resolve(this.findMutationBatches(r))},xc.prototype.getAllMutationBatchesAffectingQuery=function(t,e){jr(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=e.path,r=n.length+1,i=n;Qi.isDocumentKey(i)||(i=i.child(""));var o=new Cc(new Qi(i),0),a=new Eo(Ei);return this.batchesByDocumentKey.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.targetOrBatchId)),!0)}),o),jo.resolve(this.findMutationBatches(a))},xc.prototype.findMutationBatches=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.findMutationBatch(t);null!==r&&n.push(r)})),n},xc.prototype.removeMutationBatch=function(t,e){var n=this;jr(0===this.indexOfExistingBatchId(e.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var r=this.batchesByDocumentKey;return jo.forEach(e.mutations,(function(i){var o=new Cc(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.removeMutationReference(t,i.key)})).next((function(){n.batchesByDocumentKey=r}))},xc.prototype.removeCachedMutationKeys=function(t){},xc.prototype.containsKey=function(t,e){var n=new Cc(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return jo.resolve(e.isEqual(r&&r.key))},xc.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&jr(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),jo.resolve()},xc.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return jr(0<=n&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},xc.prototype.indexOfBatchId=function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId},xc.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return jr(n.batchId===t,"If found batch must match"),n},xc);function xc(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=zr(),this.batchesByDocumentKey=new Eo(Cc.compareByKey)}var Oc,Rc=(Mc.prototype.addEntry=function(t,e,n){jr(!n.isEqual(fo.MIN),"Cannot add a document with a read time of zero");var r=e.key,i=this.docs.get(r),o=i?i.size:0,a=this.sizer(e);return this.docs=this.docs.insert(r,{maybeDocument:e,size:a,readTime:n}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())},Mc.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Mc.prototype.getEntry=function(t,e){var n=this.docs.get(e);return jo.resolve(n?n.maybeDocument:null)},Mc.prototype.getEntries=function(t,e){var n=this,r=ko();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null)})),jo.resolve(r)},Mc.prototype.getDocumentsMatchingQuery=function(t,e,n){jr(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var r=xo(),i=new Qi(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,u=a.value,c=u.maybeDocument,h=u.readTime;if(!e.path.isPrefixOf(s.path))break;h.compareTo(n)<=0||c instanceof Vs&&e.matches(c)&&(r=r.insert(c.key,c))}return jo.resolve(r)},Mc.prototype.forEachDocumentKey=function(t,e){return jo.forEach(this.docs,(function(t){return e(t)}))},Mc.prototype.getNewDocumentChanges=function(t,e){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},Mc.prototype.newChangeBuffer=function(t){return new Mc.RemoteDocumentChangeBuffer(this)},Mc.prototype.getSize=function(t){return jo.resolve(this.size)},Mc.RemoteDocumentChangeBuffer=(i(Pc,Oc=$s),Pc.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i?n.push(e.documentCache.addEntry(t,i,e.readTime)):e.documentCache.removeEntry(r)})),jo.waitFor(n)},Pc.prototype.getFromCache=function(t,e){return this.documentCache.getEntry(t,e)},Pc.prototype.getAllFromCache=function(t,e){return this.documentCache.getEntries(t,e)},Pc),Mc);function Mc(t,e){this.indexManager=t,this.sizer=e,this.docs=new mo(Qi.comparator),this.size=0}function Pc(t){var e=Oc.call(this)||this;return e.documentCache=t,e}var Lc=(Fc.prototype.forEachTarget=function(t,e){return this.targets.forEach((function(t,n){return e(n)})),jo.resolve()},Fc.prototype.getLastRemoteSnapshotVersion=function(t){return jo.resolve(this.lastRemoteSnapshotVersion)},Fc.prototype.getHighestSequenceNumber=function(t){return jo.resolve(this.highestSequenceNumber)},Fc.prototype.allocateTargetId=function(t){var e=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=e,jo.resolve(e)},Fc.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.highestSequenceNumber&&(this.highestSequenceNumber=e),jo.resolve()},Fc.prototype.saveTargetData=function(t){this.targets.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=t.sequenceNumber)},Fc.prototype.addTargetData=function(t,e){return jr(!this.targets.has(e.target),"Adding a target that already exists"),this.saveTargetData(e),this.targetCount+=1,jo.resolve()},Fc.prototype.updateTargetData=function(t,e){return jr(this.targets.has(e.target),"Updating a non-existent target"),this.saveTargetData(e),jo.resolve()},Fc.prototype.removeTargetData=function(t,e){return jr(0<this.targetCount,"Removing a target from an empty cache"),jr(this.targets.has(e.target),"Removing a non-existent target from the cache"),this.targets.delete(e.target),this.references.removeReferencesForId(e.targetId),this.targetCount-=1,jo.resolve()},Fc.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.targets.forEach((function(a,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.targets.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)})),jo.waitFor(o).next((function(){return i}))},Fc.prototype.getTargetCount=function(t){return jo.resolve(this.targetCount)},Fc.prototype.getTargetData=function(t,e){var n=this.targets.get(e)||null;return jo.resolve(n)},Fc.prototype.getTargetDataForTarget=function(t,e){return Br("Not yet implemented.")},Fc.prototype.addMatchingKeys=function(t,e,n){this.references.addReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.addReference(t,e))})),jo.waitFor(i)},Fc.prototype.removeMatchingKeys=function(t,e,n){this.references.removeReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.removeReference(t,e))})),jo.waitFor(i)},Fc.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),jo.resolve()},Fc.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return jo.resolve(n)},Fc.prototype.containsKey=function(t,e){return jo.resolve(this.references.containsKey(e))},Fc);function Fc(t){this.persistence=t,this.targets=new Hs((function(t){return t.canonicalId()})),this.lastRemoteSnapshotVersion=fo.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new Ec,this.targetCount=0,this.targetIdGenerator=fa.forTargetCache()}var Uc=(qc.createLruPersistence=function(t,e,n){return new qc(t,(function(t){return new zc(t,new Qu(e),n)}))},qc.createEagerPersistence=function(t){return new qc(t,(function(t){return new Wc(t)}))},qc.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(qc.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),qc.prototype.getActiveClients=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return[2,[this.clientId]]}))}))},qc.prototype.setPrimaryStateListener=function(t){return t(!0)},qc.prototype.setDatabaseDeletedListener=function(){},qc.prototype.setNetworkEnabled=function(t){},qc.prototype.getIndexManager=function(){return this.indexManager},qc.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new Dc(this.indexManager,this.referenceDelegate),this.mutationQueues[t.toKey()]=e),e},qc.prototype.getTargetCache=function(){return this.targetCache},qc.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},qc.prototype.runTransaction=function(t,e,n){var r=this;Ur("MemoryPersistence","Starting transaction:",t);var i=new Bc(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next((function(t){return r.referenceDelegate.onTransactionCommitted(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},qc.prototype.mutationQueuesContainKey=function(t,e){return jo.or(function(t){var e=[];return ti(t,(function(t,n){return e.push(n)})),e}(this.mutationQueues).map((function(n){return function(){return n.containsKey(t,e)}})))},qc);function qc(t,e){var n=this;this.clientId=t,this.mutationQueues={},this.listenSequence=new Pi(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.targetCache=new Lc(this),this.indexManager=new au,this.remoteDocumentCache=new Rc(this.indexManager,(function(t){return n.referenceDelegate.documentSize(t)}))}var Vc,Bc=(i(jc,Vc=oc),jc);function jc(t){var e=Vc.call(this)||this;return e.currentSequenceNumber=t,e}var Wc=(Object.defineProperty(Kc.prototype,"orphanedDocuments",{get:function(){if(this._orphanedDocuments)return this._orphanedDocuments;throw Br("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),Kc.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},Kc.prototype.addReference=function(t,e){return this.orphanedDocuments.delete(e),jo.resolve()},Kc.prototype.removeReference=function(t,e){return this.orphanedDocuments.add(e),jo.resolve()},Kc.prototype.removeMutationReference=function(t,e){return this.orphanedDocuments.add(e),jo.resolve()},Kc.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.orphanedDocuments.add(t)}))})).next((function(){return r.removeTargetData(t,e)}))},Kc.prototype.onTransactionStarted=function(){this._orphanedDocuments=new Set},Kc.prototype.onTransactionCommitted=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return jo.forEach(this.orphanedDocuments,(function(r){return e.isReferenced(t,r).next((function(t){t||n.removeEntry(r)}))})).next((function(){return e._orphanedDocuments=null,n.apply(t)}))},Kc.prototype.updateLimboDocument=function(t,e){var n=this;return this.isReferenced(t,e).next((function(t){t?n.orphanedDocuments.delete(e):n.orphanedDocuments.add(e)}))},Kc.prototype.documentSize=function(t){return 0},Kc.prototype.isReferenced=function(t,e){var n=this;return jo.or([function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.mutationQueuesContainKey(t,e)},function(){return jo.resolve(n.inMemoryPins.containsKey(e))}])},Kc);function Kc(t){this.persistence=t,this.inMemoryPins=null,this._orphanedDocuments=null}var zc=(Gc.prototype.onTransactionStarted=function(){},Gc.prototype.onTransactionCommitted=function(t){return jo.resolve()},Gc.prototype.forEachTarget=function(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)},Gc.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocumentCount(t);return this.persistence.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},Gc.prototype.orphanedDocumentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,(function(t){e++})).next((function(){return e}))},Gc.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){var n=this;return jo.forEach(this.orphanedSequenceNumbers,(function(r,i){return n.isPinned(t,r,i).next((function(t){return t?jo.resolve():e(i)}))}))},Gc.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},Gc.prototype.removeTargets=function(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)},Gc.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.forEachDocumentKey(t,(function(i){return n.isPinned(t,i,e).next((function(t){t||(r++,o.removeEntry(i))}))})).next((function(){return o.apply(t)})).next((function(){return r}))},Gc.prototype.removeMutationReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),jo.resolve()},Gc.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)},Gc.prototype.addReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),jo.resolve()},Gc.prototype.removeReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),jo.resolve()},Gc.prototype.updateLimboDocument=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),jo.resolve()},Gc.prototype.documentSize=function(t){var e,n=this.serializer.toDbRemoteDocument(t,t.version);if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Br("Unknown remote document type");e=n.noDocument}return JSON.stringify(e).length},Gc.prototype.isPinned=function(t,e,n){var r=this;return jo.or([function(){return r.persistence.mutationQueuesContainKey(t,e)},function(){return jo.resolve(r.inMemoryPins.containsKey(e))},function(){return r.persistence.getTargetCache().containsKey(t,e)},function(){var t=r.orphanedSequenceNumbers.get(e);return jo.resolve(void 0!==t&&n<t)}])},Gc.prototype.getCacheSize=function(t){return this.persistence.getRemoteDocumentCache().getSize(t)},Gc);function Gc(t,e,n){this.persistence=t,this.serializer=e,this.inMemoryPins=null,this.orphanedSequenceNumbers=new Hs((function(t){return ao(t.path)})),this.garbageCollector=new rc(this,n)}var Qc=(Hc.prototype.setLocalDocumentsView=function(t){this.localDocumentsView=t},Hc.prototype.getDocumentsMatchingQuery=function(t,e,n,r){return jr(void 0!==this.localDocumentsView,"setLocalDocumentsView() not called"),this.localDocumentsView.getDocumentsMatchingQuery(t,e,fo.MIN)},Hc);function Hc(){}var Yc=Number,$c=Yc.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),Xc=Yc.MAX_SAFE_INTEGER||Math.pow(2,53)-1,Jc=Yc.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t};function Zc(t){return null==t}function th(t){return Jc(t)&&t<=Xc&&$c<=t}var eh=(nh.prototype.reset=function(){this.currentBaseMs=0},nh.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},nh.prototype.backoffAndRun=function(t){var e=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);0<this.currentBaseMs&&Ur("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,(function(){return e.lastAttemptTime=Date.now(),t()})),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},nh.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},nh.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},nh);function nh(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.queue=t,this.timerId=e,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}var rh,ih,oh="PersistentStream";(ih=rh=rh||{})[ih.Initial=0]="Initial",ih[ih.Starting=1]="Starting",ih[ih.Open=2]="Open",ih[ih.Error=3]="Error",ih[ih.Backoff=4]="Backoff";var ah=(sh.prototype.isStarted=function(){return this.state===rh.Starting||this.state===rh.Open||this.state===rh.Backoff},sh.prototype.isOpen=function(){return this.state===rh.Open},sh.prototype.start=function(){this.state!==rh.Error?(jr(this.state===rh.Initial,"Already started"),this.auth()):this.performBackoff()},sh.prototype.stop=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return this.isStarted()?[4,this.close(rh.Initial)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},sh.prototype.inhibitBackoff=function(){jr(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=rh.Initial,this.backoff.reset()},sh.prototype.markIdle=function(){var t=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,(function(){return t.handleIdleCloseTimer()})))},sh.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},sh.prototype.handleIdleCloseTimer=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return this.isOpen()?[2,this.close(rh.Initial)]:[2]}))}))},sh.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},sh.prototype.close=function(t,e){return u(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return jr(this.isStarted(),"Only started streams should be closed."),jr(t===rh.Error||Zc(e),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,t!==rh.Error?this.backoff.reset():e&&e.code===Qr.RESOURCE_EXHAUSTED?(qr(e.toString()),qr("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):e&&e.code===Qr.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.onClose(e)];case 1:return n.sent(),[2]}}))}))},sh.prototype.tearDown=function(){},sh.prototype.auth=function(){var t=this;jr(this.state===rh.Initial,"Must be in initial state to auth"),this.state=rh.Starting;var e=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then((function(e){t.closeCount===n&&t.startStream(e)}),(function(n){e((function(){var e=new Hr(Qr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.handleStreamClose(e)}))}))},sh.prototype.startStream=function(t){var e=this;jr(this.state===rh.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(t),this.stream.onOpen((function(){n((function(){return jr(e.state===rh.Starting,"Expected stream to be in state Starting, but was "+e.state),e.state=rh.Open,e.listener.onOpen()}))})),this.stream.onClose((function(t){n((function(){return e.handleStreamClose(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},sh.prototype.performBackoff=function(){var t=this;jr(this.state===rh.Error,"Should only perform backoff when in Error state"),this.state=rh.Backoff,this.backoff.backoffAndRun((function(){return u(t,void 0,void 0,(function(){return c(this,(function(t){return jr(this.state===rh.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=rh.Initial,this.start(),jr(this.isStarted(),"PersistentStream should have started"),[2]}))}))}))},sh.prototype.handleStreamClose=function(t){return jr(this.isStarted(),"Can't handle server close on non-started stream"),Ur(oh,"close with error: "+t),this.stream=null,this.close(rh.Error,t)},sh.prototype.getCloseGuardedDispatcher=function(t){var e=this;return function(n){e.queue.enqueueAndForget((function(){return e.closeCount===t?n():(Ur(oh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},sh);function sh(t,e,n,r,i,o){this.queue=t,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=rh.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new eh(t,e)}var uh,ch=(i(hh,uh=ah),hh.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},hh.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},hh.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},hh.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},hh);function hh(t,e,n,r,i){var o=uh.call(this,t,Yi.ListenStreamConnectionBackoff,Yi.ListenStreamIdle,e,n,i)||this;return o.serializer=r,o}var lh,fh=(i(ph,lh=ah),Object.defineProperty(ph.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),ph.prototype.start=function(){this.handshakeComplete_=!1,lh.prototype.start.call(this)},ph.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},ph.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},ph.prototype.onMessage=function(t){if(jr(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return jr(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},ph.prototype.writeHandshake=function(){jr(this.isOpen(),"Writing handshake requires an opened stream"),jr(!this.handshakeComplete_,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},ph.prototype.writeMutations=function(t){var e=this;jr(this.isOpen(),"Writing mutations requires an opened stream"),jr(this.handshakeComplete_,"Handshake must be complete before writing mutations"),jr(0<this.lastStreamToken.length,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map((function(t){return e.serializer.toMutation(t)}))};this.sendRequest(n)},ph);function ph(t,e,n,r,i){var o=lh.call(this,t,Yi.WriteStreamConnectionBackoff,Yi.WriteStreamIdle,e,n,i)||this;return o.serializer=r,o.handshakeComplete_=!1,o.lastStreamToken=zr(),o}var dh=(mh.prototype.newPersistentWriteStream=function(t){return new fh(this.queue,this.connection,this.credentials,this.serializer,t)},mh.prototype.newPersistentWatchStream=function(t){return new ch(this.queue,this.connection,this.credentials,this.serializer,t)},mh.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map((function(t){return e.serializer.toMutation(t)}))};return this.invokeRPC("Commit",n).then((function(t){return e.serializer.fromWriteResults(t.writeResults,t.commitTime)}))},mh.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map((function(t){return e.serializer.toName(t)}))};return this.invokeStreamingRPC("BatchGetDocuments",n).then((function(n){var r=No();n.forEach((function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)}));var i=[];return t.forEach((function(t){var e=r.get(t);jr(!!e,"Missing entity in write response for "+t),i.push(e)})),i}))},mh.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.connection.invokeRPC(t,e,r)})).catch((function(t){throw t.code===Qr.UNAUTHENTICATED&&n.credentials.invalidateToken(),t}))},mh.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.connection.invokeStreamingRPC(t,e,r)})).catch((function(t){throw t.code===Qr.UNAUTHENTICATED&&n.credentials.invalidateToken(),t}))},mh);function mh(t,e,n,r){this.queue=t,this.connection=e,this.credentials=n,this.serializer=r}var yh,gh,vh,bh,_h=(wh.prototype.lookup=function(t){return u(this,void 0,void 0,(function(){var e,n=this;return c(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),0<this.mutations.length)throw new Hr(Qr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.datastore.lookup(t)];case 1:return(e=r.sent()).forEach((function(t){t instanceof Ws||t instanceof Vs?n.recordVersion(t):Br("Document in a transaction was a "+t.constructor.name)})),[2,e]}}))}))},wh.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t))),this.writtenDocs.add(t)},wh.prototype.update=function(t,e){try{this.write(e.toMutations(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t)},wh.prototype.delete=function(t){this.write([new za(t,this.precondition(t))]),this.writtenDocs.add(t)},wh.prototype.commit=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){switch(e.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;if(t=this.readVersions,this.mutations.forEach((function(e){t=t.remove(e.key)})),!t.isEmpty())throw new Hr(Qr.INVALID_ARGUMENT,"Every document read in a transaction must also be written.");return[4,this.datastore.commit(this.mutations)];case 1:return e.sent(),this.committed=!0,[2]}}))}))},wh.prototype.recordVersion=function(t){var e;if(t instanceof Vs)e=t.version;else{if(!(t instanceof Ws))throw Br("Document in a transaction was a "+t.constructor.name);e=fo.forDeletedDoc()}var n=this.readVersions.get(t.key);if(null!==n){if(!e.isEqual(n))throw new Hr(Qr.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},wh.prototype.precondition=function(t){var e=this.readVersions.get(t);return!this.writtenDocs.has(t)&&e?Aa.updateTime(e):Aa.NONE},wh.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(this.writtenDocs.has(t)||!e)return Aa.exists(!0);if(e.isEqual(fo.forDeletedDoc()))throw new Hr(Qr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Aa.updateTime(e)},wh.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations=this.mutations.concat(t)},wh.prototype.ensureCommitNotCalled=function(){jr(!this.committed,"A transaction object cannot be used after its update callback has been invoked.")},wh);function wh(t){this.datastore=t,this.readVersions=Ro(),this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}(gh=yh=yh||{})[gh.Unknown=0]="Unknown",gh[gh.Online=1]="Online",gh[gh.Offline=2]="Offline",(bh=vh=vh||{})[bh.RemoteStore=0]="RemoteStore",bh[bh.SharedClientState=1]="SharedClientState";var Th,Eh,Sh=(Ch.prototype.handleWatchStreamStart=function(){var t=this;0===this.watchStreamFailures&&(this.setAndBroadcast(yh.Unknown),jr(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(Yi.OnlineStateTimeout,1e4,(function(){return t.onlineStateTimer=null,jr(t.state===yh.Unknown,"Timer should be canceled if we transitioned to a different state."),t.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),t.setAndBroadcast(yh.Offline),Promise.resolve()})))},Ch.prototype.handleWatchStreamFailure=function(t){this.state===yh.Online?(this.setAndBroadcast(yh.Unknown),jr(0===this.watchStreamFailures,"watchStreamFailures must be 0"),jr(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,1<=this.watchStreamFailures&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+t.toString()),this.setAndBroadcast(yh.Offline)))},Ch.prototype.set=function(t){this.clearOnlineStateTimer(),this.watchStreamFailures=0,t===yh.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(t)},Ch.prototype.setAndBroadcast=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},Ch.prototype.logClientOfflineWarningIfNecessary=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(qr(e),this.shouldWarnClientIsOffline=!1):Ur("OnlineStateTracker",e)},Ch.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},Ch);function Ch(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=yh.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}function Ih(t){switch(t){case Qr.OK:return Br("Treated status OK as error");case Qr.CANCELLED:case Qr.UNKNOWN:case Qr.DEADLINE_EXCEEDED:case Qr.RESOURCE_EXHAUSTED:case Qr.INTERNAL:case Qr.UNAVAILABLE:case Qr.UNAUTHENTICATED:return!1;case Qr.INVALID_ARGUMENT:case Qr.NOT_FOUND:case Qr.ALREADY_EXISTS:case Qr.PERMISSION_DENIED:case Qr.FAILED_PRECONDITION:case Qr.ABORTED:case Qr.OUT_OF_RANGE:case Qr.UNIMPLEMENTED:case Qr.DATA_LOSS:return!0;default:return Br("Unknown status code: "+t)}}function Ah(t){if(void 0===t)return qr("GRPC error has no .code"),Qr.UNKNOWN;switch(t){case Th.OK:return Qr.OK;case Th.CANCELLED:return Qr.CANCELLED;case Th.UNKNOWN:return Qr.UNKNOWN;case Th.DEADLINE_EXCEEDED:return Qr.DEADLINE_EXCEEDED;case Th.RESOURCE_EXHAUSTED:return Qr.RESOURCE_EXHAUSTED;case Th.INTERNAL:return Qr.INTERNAL;case Th.UNAVAILABLE:return Qr.UNAVAILABLE;case Th.UNAUTHENTICATED:return Qr.UNAUTHENTICATED;case Th.INVALID_ARGUMENT:return Qr.INVALID_ARGUMENT;case Th.NOT_FOUND:return Qr.NOT_FOUND;case Th.ALREADY_EXISTS:return Qr.ALREADY_EXISTS;case Th.PERMISSION_DENIED:return Qr.PERMISSION_DENIED;case Th.FAILED_PRECONDITION:return Qr.FAILED_PRECONDITION;case Th.ABORTED:return Qr.ABORTED;case Th.OUT_OF_RANGE:return Qr.OUT_OF_RANGE;case Th.UNIMPLEMENTED:return Qr.UNIMPLEMENTED;case Th.DATA_LOSS:return Qr.DATA_LOSS;default:return Br("Unknown status code: "+t)}}(Eh=Th=Th||{})[Eh.OK=0]="OK",Eh[Eh.CANCELLED=1]="CANCELLED",Eh[Eh.UNKNOWN=2]="UNKNOWN",Eh[Eh.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Eh[Eh.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Eh[Eh.NOT_FOUND=5]="NOT_FOUND",Eh[Eh.ALREADY_EXISTS=6]="ALREADY_EXISTS",Eh[Eh.PERMISSION_DENIED=7]="PERMISSION_DENIED",Eh[Eh.UNAUTHENTICATED=16]="UNAUTHENTICATED",Eh[Eh.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Eh[Eh.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Eh[Eh.ABORTED=10]="ABORTED",Eh[Eh.OUT_OF_RANGE=11]="OUT_OF_RANGE",Eh[Eh.UNIMPLEMENTED=12]="UNIMPLEMENTED",Eh[Eh.INTERNAL=13]="INTERNAL",Eh[Eh.UNAVAILABLE=14]="UNAVAILABLE",Eh[Eh.DATA_LOSS=15]="DATA_LOSS";var Nh,kh,Dh,xh,Oh=(Rh.emptySet=function(t){return new Rh(t.comparator)},Rh.prototype.has=function(t){return null!=this.keyedMap.get(t)},Rh.prototype.get=function(t){return this.keyedMap.get(t)},Rh.prototype.first=function(){return this.sortedSet.minKey()},Rh.prototype.last=function(){return this.sortedSet.maxKey()},Rh.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},Rh.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(Rh.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),Rh.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},Rh.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},Rh.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},Rh.prototype.isEqual=function(t){if(!(t instanceof Rh))return!1;if(this.size!==t.size)return!1;for(var e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();e.hasNext();){var r=e.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0},Rh.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},Rh.prototype.copy=function(t,e){var n=new Rh;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n},Rh);function Rh(t){this.comparator=t?function(e,n){return t(e,n)||Qi.comparator(e.key,n.key)}:function(t,e){return Qi.comparator(t.key,e.key)},this.keyedMap=xo(),this.sortedSet=new mo(this.comparator)}(kh=Nh=Nh||{})[kh.Added=0]="Added",kh[kh.Removed=1]="Removed",kh[kh.Modified=2]="Modified",kh[kh.Metadata=3]="Metadata",(xh=Dh=Dh||{})[xh.Local=0]="Local",xh[xh.Synced=1]="Synced";var Mh=(Ph.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);n?t.type!==Nh.Added&&n.type===Nh.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===Nh.Metadata&&n.type!==Nh.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===Nh.Modified&&n.type===Nh.Modified?this.changeMap=this.changeMap.insert(e,{type:Nh.Modified,doc:t.doc}):t.type===Nh.Modified&&n.type===Nh.Added?this.changeMap=this.changeMap.insert(e,{type:Nh.Added,doc:t.doc}):t.type===Nh.Removed&&n.type===Nh.Added?this.changeMap=this.changeMap.remove(e):t.type===Nh.Removed&&n.type===Nh.Modified?this.changeMap=this.changeMap.insert(e,{type:Nh.Removed,doc:n.doc}):t.type===Nh.Added&&n.type===Nh.Removed?this.changeMap=this.changeMap.insert(e,{type:Nh.Modified,doc:t.doc}):Br("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(e,t)},Ph.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal((function(e,n){t.push(n)})),t},Ph);function Ph(){this.changeMap=new mo(Qi.comparator)}var Lh=(Fh.fromInitialDocuments=function(t,e,n,r){var i=[];return e.forEach((function(t){i.push({type:Nh.Added,doc:t})})),new Fh(t,e,Oh.emptySet(e),i,n,r,!0,!1)},Object.defineProperty(Fh.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),Fh.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Fh);function Fh(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}var Uh=(qh.createSynthesizedRemoteEventForCurrentChange=function(t,e){var n,r=((n={})[t]=Vh.createSynthesizedTargetChangeForCurrentChange(t,e),n);return new qh(fo.MIN,r,Fo(),No(),Po())},qh);function qh(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}var Vh=(Bh.createSynthesizedTargetChangeForCurrentChange=function(t,e){return new Bh(zr(),e,Po(),Po(),Po())},Bh);function Bh(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}var jh,Wh,Kh=function(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r},zh=function(t,e){this.targetId=t,this.existenceFilter=e};(Wh=jh=jh||{})[Wh.NoChange=0]="NoChange",Wh[Wh.Added=1]="Added",Wh[Wh.Removed=2]="Removed",Wh[Wh.Current=3]="Current",Wh[Wh.Reset=4]="Reset";var Gh=function(t,e,n,r){void 0===n&&(n=zr()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Qh=(Object.defineProperty(Hh.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(Hh.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(Hh.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(Hh.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),Hh.prototype.updateResumeToken=function(t){0<t.length&&(this._hasPendingChanges=!0,this._resumeToken=t)},Hh.prototype.toTargetChange=function(){var t=Po(),e=Po(),n=Po();return this.documentChanges.forEach((function(r,i){switch(i){case Nh.Added:t=t.add(r);break;case Nh.Modified:e=e.add(r);break;case Nh.Removed:n=n.add(r);break;default:Br("Encountered invalid change type: "+i)}})),new Vh(this._resumeToken,this._current,t,e,n)},Hh.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=Jh()},Hh.prototype.addDocumentChange=function(t,e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(t,e)},Hh.prototype.removeDocumentChange=function(t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(t)},Hh.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},Hh.prototype.recordTargetResponse=function(){this.pendingResponses-=1},Hh.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},Hh);function Hh(){this.pendingResponses=0,this.documentChanges=Jh(),this._resumeToken=zr(),this._current=!1,this._hasPendingChanges=!0}var Yh=($h.prototype.handleDocumentChange=function(t){for(var e=0,n=t.updatedTargetIds;e<n.length;e++){var r=n[e];t.newDoc instanceof Vs?this.addDocumentToTarget(r,t.newDoc):t.newDoc instanceof Ws&&this.removeDocumentFromTarget(r,t.key,t.newDoc)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.removeDocumentFromTarget(r,t.key,t.newDoc)},$h.prototype.handleTargetChange=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.ensureTargetState(n);switch(t.state){case jh.NoChange:e.isActiveTarget(n)&&r.updateResumeToken(t.resumeToken);break;case jh.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(t.resumeToken);break;case jh.Removed:r.recordTargetResponse(),r.isPending||e.removeTarget(n),jr(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case jh.Current:e.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(t.resumeToken));break;case jh.Reset:e.isActiveTarget(n)&&(e.resetTarget(n),r.updateResumeToken(t.resumeToken));break;default:Br("Unknown target watch change state: "+t.state)}}))},$h.prototype.forEachTarget=function(t,e){0<t.targetIds.length?t.targetIds.forEach(e):Zr(this.targetStates,e)},$h.prototype.handleExistenceFilter=function(t){var e=t.targetId,n=t.existenceFilter.count,r=this.targetDataForActiveTarget(e);if(r){var i=r.target;if(i.isDocumentQuery())if(0===n){var o=new Qi(i.path);this.removeDocumentFromTarget(e,o,new Ws(o,fo.forDeletedDoc()))}else jr(1===n,"Single document existence filter with count: "+n);else this.getCurrentDocumentCountForTarget(e)!==n&&(this.resetTarget(e),this.pendingTargetResets=this.pendingTargetResets.add(e))}},$h.prototype.createRemoteEvent=function(t){var e=this,n={};Zr(this.targetStates,(function(r,i){var o=e.targetDataForActiveTarget(r);if(o){if(i.current&&o.target.isDocumentQuery()){var a=new Qi(o.target.path);null!==e.pendingDocumentUpdates.get(a)||e.targetContainsDocument(r,a)||e.removeDocumentFromTarget(r,a,new Ws(a,t))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}}));var r=Po();this.pendingDocumentTargetMapping.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.targetDataForActiveTarget(t);return!n||n.purpose===qu.LimboResolution||(i=!1)})),i&&(r=r.add(t))}));var i=new Uh(t,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=No(),this.pendingDocumentTargetMapping=Xh(),this.pendingTargetResets=new Eo(Ei),i},$h.prototype.addDocumentToTarget=function(t,e){if(this.isActiveTarget(t)){var n=this.targetContainsDocument(t,e.key)?Nh.Modified:Nh.Added;this.ensureTargetState(t).addDocumentChange(e.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e.key,e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e.key,this.ensureDocumentTargetMapping(e.key).add(t))}},$h.prototype.removeDocumentFromTarget=function(t,e,n){if(this.isActiveTarget(t)){var r=this.ensureTargetState(t);this.targetContainsDocument(t,e)?r.addDocumentChange(e,Nh.Removed):r.removeDocumentChange(e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,this.ensureDocumentTargetMapping(e).delete(t)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e,n))}},$h.prototype.removeTarget=function(t){delete this.targetStates[t]},$h.prototype.getCurrentDocumentCountForTarget=function(t){var e=this.ensureTargetState(t).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},$h.prototype.recordPendingTargetRequest=function(t){this.ensureTargetState(t).recordPendingTargetRequest()},$h.prototype.ensureTargetState=function(t){return this.targetStates[t]||(this.targetStates[t]=new Qh),this.targetStates[t]},$h.prototype.ensureDocumentTargetMapping=function(t){var e=this.pendingDocumentTargetMapping.get(t);return e||(e=new Eo(Ei),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,e)),e},$h.prototype.isActiveTarget=function(t){var e=null!==this.targetDataForActiveTarget(t);return e||Ur("WatchChangeAggregator","Detected inactive target",t),e},$h.prototype.targetDataForActiveTarget=function(t){var e=this.targetStates[t];return e&&e.isPending?null:this.metadataProvider.getTargetDataForTarget(t)},$h.prototype.resetTarget=function(t){var e=this;jr(!this.targetStates[t].isPending,"Should only reset active targets"),this.targetStates[t]=new Qh,this.metadataProvider.getRemoteKeysForTarget(t).forEach((function(n){e.removeDocumentFromTarget(t,n,null)}))},$h.prototype.targetContainsDocument=function(t,e){return this.metadataProvider.getRemoteKeysForTarget(t).has(e)},$h);function $h(t){this.metadataProvider=t,this.targetStates={},this.pendingDocumentUpdates=No(),this.pendingDocumentTargetMapping=Xh(),this.pendingTargetResets=new Eo(Ei)}function Xh(){return new mo(Qi.comparator)}function Jh(){return new mo(Qi.comparator)}var Zh="RemoteStore",tl=(el.prototype.start=function(){return this.enableNetwork()},el.prototype.enableNetwork=function(){return u(this,void 0,void 0,(function(){var t;return c(this,(function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(t=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(yh.Unknown),[4,this.fillWritePipeline()];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},el.prototype.disableNetwork=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(yh.Offline),[2]}}))}))},el.prototype.disableNetworkInternal=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,this.writeStream.stop()];case 1:return t.sent(),[4,this.watchStream.stop()];case 2:return t.sent(),0<this.writePipeline.length&&(Ur(Zh,"Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}}))}))},el.prototype.shutdown=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return Ur(Zh,"RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.connectivityMonitor.shutdown(),this.onlineStateTracker.set(yh.Unknown),[2]}}))}))},el.prototype.listen=function(t){Xr(this.listenTargets,t.targetId)||(this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(t))},el.prototype.unlisten=function(t){Xr(this.listenTargets,t)&&(delete this.listenTargets[t],this.watchStream.isOpen()&&this.sendUnwatchRequest(t),ei(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(yh.Unknown)))},el.prototype.getTargetDataForTarget=function(t){return this.listenTargets[t]||null},el.prototype.getRemoteKeysForTarget=function(t){return this.syncEngine.getRemoteKeysForTarget(t)},el.prototype.sendWatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},el.prototype.sendUnwatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},el.prototype.startWatchStream=function(){jr(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new Yh(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},el.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!ei(this.listenTargets)},el.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},el.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},el.prototype.onWatchStreamOpen=function(){return u(this,void 0,void 0,(function(){var t=this;return c(this,(function(e){return Zr(this.listenTargets,(function(e,n){t.sendWatchRequest(n)})),[2]}))}))},el.prototype.onWatchStreamClose=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){return void 0===t&&jr(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(t),this.startWatchStream()):this.onlineStateTracker.set(yh.Unknown),[2]}))}))},el.prototype.onWatchStreamChange=function(t,e){return u(this,void 0,void 0,(function(){var n;return c(this,(function(r){switch(r.label){case 0:return this.onlineStateTracker.set(yh.Online),t instanceof Gh&&t.state===jh.Removed&&t.cause?[2,this.handleTargetError(t)]:(t instanceof Kh?this.watchChangeAggregator.handleDocumentChange(t):t instanceof zh?this.watchChangeAggregator.handleExistenceFilter(t):(jr(t instanceof Gh,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(t)),e.isEqual(fo.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),0<=e.compareTo(n)?[4,this.raiseWatchSnapshot(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},el.prototype.raiseWatchSnapshot=function(t){var e=this;jr(!t.isEqual(fo.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(t);return Zr(n.targetChanges,(function(n,r){if(0<r.resumeToken.length){var i=e.listenTargets[n];i&&(e.listenTargets[n]=i.withResumeToken(r.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e.listenTargets[t];if(n){e.listenTargets[t]=n.withResumeToken(zr(),n.snapshotVersion),e.sendUnwatchRequest(t);var r=new zu(n.target,t,qu.ExistenceFilterMismatch,n.sequenceNumber);e.sendWatchRequest(r)}})),this.syncEngine.applyRemoteEvent(n)},el.prototype.handleTargetError=function(t){var e=this;jr(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach((function(t){r=r.then((function(){return u(e,void 0,void 0,(function(){return c(this,(function(e){return Xr(this.listenTargets,t)?(delete this.listenTargets[t],this.watchChangeAggregator.removeTarget(t),[2,this.syncEngine.rejectListen(t,n)]):[2]}))}))}))})),r},el.prototype.fillWritePipeline=function(){return u(this,void 0,void 0,(function(){var t,e;return c(this,(function(n){switch(n.label){case 0:return this.canAddToWritePipeline()?(t=0<this.writePipeline.length?this.writePipeline[this.writePipeline.length-1].batchId:-1,[4,this.localStore.nextMutationBatch(t)]):[3,4];case 1:return null!==(e=n.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(e),[4,this.fillWritePipeline()];case 3:n.sent(),n.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}}))}))},el.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},el.prototype.outstandingWrites=function(){return this.writePipeline.length},el.prototype.addToWritePipeline=function(t){jr(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(t),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},el.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&0<this.writePipeline.length},el.prototype.startWriteStream=function(){jr(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},el.prototype.onWriteStreamOpen=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return this.writeStream.writeHandshake(),[2]}))}))},el.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then((function(){for(var e=0,n=t.writePipeline;e<n.length;e++){var r=n[e];t.writeStream.writeMutations(r.mutations)}})).catch(mc)},el.prototype.onMutationResult=function(t,e){var n=this;jr(0<this.writePipeline.length,"Got result for empty write pipeline");var r=this.writePipeline.shift(),i=Vo.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then((function(){return n.fillWritePipeline()}))},el.prototype.onWriteStreamClose=function(t){return u(this,void 0,void 0,(function(){var e=this;return c(this,(function(n){return void 0===t&&jr(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),t&&0<this.writePipeline.length?[2,(this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t)).then((function(){e.shouldStartWriteStream()&&e.startWriteStream()}))]:[2]}))}))},el.prototype.handleHandshakeError=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){return Ih(t.code)?(Ur(Zh,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=zr(),[2,this.localStore.setLastStreamToken(zr()).catch(mc)]):[2]}))}))},el.prototype.handleWriteError=function(t){return u(this,void 0,void 0,(function(){var e,n=this;return c(this,(function(r){return function(t){return Ih(t)&&t!==Qr.ABORTED}(t.code)?(e=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(e.batchId,t).then((function(){return n.fillWritePipeline()}))]):[2]}))}))},el.prototype.createTransaction=function(){return new _h(this.datastore)},el.prototype.restartNetwork=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(yh.Unknown),[4,this.enableNetwork()];case 2:return t.sent(),[2]}}))}))},el.prototype.handleCredentialChange=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return this.canUseNetwork()?(Ur(Zh,"RemoteStore restarting streams for new credential"),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},el.prototype.applyPrimaryState=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return(this.isPrimary=t)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,4];case 2:return t?[3,4]:[4,this.disableNetworkInternal()];case 3:e.sent(),this.onlineStateTracker.set(yh.Unknown),e.label=4;case 4:return[2]}}))}))},el);function el(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.connectivityMonitor=i,this.connectivityMonitor.addCallback((function(t){n.enqueueAndForget((function(){return u(o,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return this.canUseNetwork()?(Ur(Zh,"Restarting streams for network reachability change."),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.onlineStateTracker=new Sh(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}var nl=(Object.defineProperty(rl.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(rl.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),rl.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},rl.prototype._compareTo=function(t){return Ei(this._lat,t._lat)||Ei(this._long,t._long)},rl);function rl(t,e){if(ri("GeoPoint",arguments,2),ai("GeoPoint","number",1,t),ai("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Hr(Qr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Hr(Qr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}var il,ol,al=(sl.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:";for(var e=0,n=this.filters;e<n.length;e++)t+=n[e].canonicalId(),t+=",";t+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++)t+=i[r].canonicalId(),t+=",";Zc(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},sl.prototype.toString=function(){var t=this.path.canonicalString();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),Zc(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},sl.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},sl.prototype.isDocumentQuery=function(){return Qi.isDocumentKey(this.path)&&null===this.collectionGroup&&0===this.filters.length},sl);function sl(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null}(ol=il=il||{}).First="F",ol.Last="L";var ul=(cl.atPath=function(t){return new cl(t)},Object.defineProperty(cl.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)t.isKeyField()?this.memoizedOrderBy=[Fl]:this.memoizedOrderBy=[new Pl(t),Fl];else{jr(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field.");for(var n=!(this.memoizedOrderBy=[]),r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=0<this.explicitOrderBy.length?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:xl.ASCENDING;this.memoizedOrderBy.push(a===xl.ASCENDING?Fl:Ul)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),cl.prototype.addFilter=function(t){jr(null==this.getInequalityFilterField()||!(t instanceof dl)||!t.isInequality()||t.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),jr(!this.isDocumentQuery(),"No filtering allowed for document query");var e=this.filters.concat([t]);return new cl(this.path,this.collectionGroup,this.explicitOrderBy.slice(),e,this.limit,this.limitType,this.startAt,this.endAt)},cl.prototype.addOrderBy=function(t){jr(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var e=this.explicitOrderBy.concat([t]);return new cl(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},cl.prototype.withLimitToFirst=function(t){return new cl(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),t,il.First,this.startAt,this.endAt)},cl.prototype.withLimitToLast=function(t){return new cl(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),t,il.Last,this.startAt,this.endAt)},cl.prototype.withStartAt=function(t){return new cl(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,t,this.endAt)},cl.prototype.withEndAt=function(t){return new cl(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,t)},cl.prototype.asCollectionQueryAtPath=function(t){return new cl(t,null,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},cl.prototype.matchesAllDocuments=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.explicitOrderBy.length||1===this.explicitOrderBy.length&&this.explicitOrderBy[0].field.isKeyField())},cl.prototype.canonicalId=function(){return this.toTarget().canonicalId()+"|lt:"+this.limitType},cl.prototype.toString=function(){return"Query(target="+this.toTarget().toString()+"; limitType="+this.limitType+")"},cl.prototype.isEqual=function(t){return this.toTarget().isEqual(t.toTarget())&&this.limitType===t.limitType},cl.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(t,e);if(0!==a)return a;n=n||o.field.isKeyField()}return jr(n,"orderBy used that doesn't compare on key field"),0},cl.prototype.matches=function(t){return this.matchesPathAndCollectionGroup(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},cl.prototype.hasLimitToFirst=function(){return!Zc(this.limit)&&this.limitType===il.First},cl.prototype.hasLimitToLast=function(){return!Zc(this.limit)&&this.limitType===il.Last},cl.prototype.getFirstOrderByField=function(){return 0<this.explicitOrderBy.length?this.explicitOrderBy[0].field:null},cl.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof dl&&n.isInequality())return n.field}return null},cl.prototype.findFilterOperator=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof dl&&0<=t.indexOf(r.op))return r.op}return null},cl.prototype.isDocumentQuery=function(){return this.toTarget().isDocumentQuery()},cl.prototype.isCollectionGroupQuery=function(){return null!==this.collectionGroup},cl.prototype.toTarget=function(){if(!this.memorizedTarget)if(this.limitType===il.First)this.memorizedTarget=new al(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i=r.dir===xl.DESCENDING?xl.ASCENDING:xl.DESCENDING;t.push(new Pl(r.field,i))}var o=this.endAt?new Rl(this.endAt.position,!this.endAt.before):null,a=this.startAt?new Rl(this.startAt.position,!this.startAt.before):null;this.memorizedTarget=new al(this.path,this.collectionGroup,t,this.filters,this.limit,o,a)}return this.memorizedTarget},cl.prototype.matchesPathAndCollectionGroup=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.hasCollectionId(this.collectionGroup)&&this.path.isPrefixOf(e):Qi.isDocumentKey(this.path)?this.path.isEqual(e):this.path.isImmediateParentOf(e)},cl.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&null===t.field(r.field))return!1}return!0},cl.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},cl.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t)||this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,t))},cl.prototype.assertValidBound=function(t){jr(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},cl);function cl(t,e,n,r,i,o,a,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=il.First),void 0===a&&(a=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.memoizedOrderBy=null,this.memorizedTarget=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}function hl(){}var ll=(fl.fromString=function(t){switch(t){case"<":return fl.LESS_THAN;case"<=":return fl.LESS_THAN_OR_EQUAL;case"==":return fl.EQUAL;case">=":return fl.GREATER_THAN_OR_EQUAL;case">":return fl.GREATER_THAN;case"array-contains":return fl.ARRAY_CONTAINS;case"in":return fl.IN;case"array-contains-any":return fl.ARRAY_CONTAINS_ANY;default:return Br("Unknown FieldFilter operator: "+t)}},fl.prototype.toString=function(){return this.name},fl.prototype.isEqual=function(t){return this.name===t.name},fl.LESS_THAN=new fl("<"),fl.LESS_THAN_OR_EQUAL=new fl("<="),fl.EQUAL=new fl("=="),fl.GREATER_THAN=new fl(">"),fl.GREATER_THAN_OR_EQUAL=new fl(">="),fl.ARRAY_CONTAINS=new fl("array-contains"),fl.IN=new fl("in"),fl.ARRAY_CONTAINS_ANY=new fl("array-contains-any"),fl);function fl(t){this.name=t}var pl,dl=(i(ml,pl=hl),ml.create=function(t,e,n){if(t.isKeyField())return e===ll.IN?(jr(n instanceof Ps,"Comparing on key with IN, but filter value not an ArrayValue"),jr(n.internalValue.every((function(t){return t instanceof Is})),"Comparing on key with IN, but an array value was not a RefValue"),new _l(t,n)):(jr(n instanceof Is,"Comparing on key, but filter value not a RefValue"),jr(e!==ll.ARRAY_CONTAINS&&e!==ll.ARRAY_CONTAINS_ANY,"'"+e.toString()+"' queries don't make sense on document keys."),new gl(t,e,n));if(n.isEqual(Ja.INSTANCE)){if(e!==ll.EQUAL)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new ml(t,e,n)}if(n.isEqual(ls.NAN)){if(e!==ll.EQUAL)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new ml(t,e,n)}return e===ll.ARRAY_CONTAINS?new El(t,n):e===ll.IN?(jr(n instanceof Ps,"IN filter has invalid value: "+n.toString()),new Il(t,n)):e===ll.ARRAY_CONTAINS_ANY?(jr(n instanceof Ps,"ARRAY_CONTAINS_ANY filter has invalid value: "+n.toString()),new kl(t,n)):new ml(t,e,n)},ml.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&this.value.typeOrder===e.typeOrder&&this.matchesComparison(e.compareTo(this.value))},ml.prototype.matchesComparison=function(t){switch(this.op){case ll.LESS_THAN:return t<0;case ll.LESS_THAN_OR_EQUAL:return t<=0;case ll.EQUAL:return 0===t;case ll.GREATER_THAN:return 0<t;case ll.GREATER_THAN_OR_EQUAL:return 0<=t;default:return Br("Unknown FieldFilter operator: "+this.op)}},ml.prototype.isInequality=function(){return 0<=[ll.LESS_THAN,ll.LESS_THAN_OR_EQUAL,ll.GREATER_THAN,ll.GREATER_THAN_OR_EQUAL].indexOf(this.op)},ml.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},ml.prototype.isEqual=function(t){return t instanceof ml&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&this.value.isEqual(t.value)},ml.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},ml);function ml(t,e,n){var r=pl.call(this)||this;return r.field=t,r.op=e,r.value=n,r}var yl,gl=(i(vl,yl=dl),vl.prototype.matches=function(t){var e=this.value,n=Qi.comparator(t.key,e.key);return this.matchesComparison(n)},vl);function vl(){return null!==yl&&yl.apply(this,arguments)||this}var bl,_l=(i(wl,bl=dl),wl.prototype.matches=function(t){return this.value.internalValue.some((function(e){return t.key.isEqual(e.key)}))},wl);function wl(t,e){var n=bl.call(this,t,ll.IN,e)||this;return n.value=e,n}var Tl,El=(i(Sl,Tl=dl),Sl.prototype.matches=function(t){var e=t.field(this.field);return e instanceof Ps&&e.contains(this.value)},Sl);function Sl(t,e){return Tl.call(this,t,ll.ARRAY_CONTAINS,e)||this}var Cl,Il=(i(Al,Cl=dl),Al.prototype.matches=function(t){var e=this.value,n=t.field(this.field);return null!==n&&e.contains(n)},Al);function Al(t,e){var n=Cl.call(this,t,ll.IN,e)||this;return n.value=e,n}var Nl,kl=(i(Dl,Nl=dl),Dl.prototype.matches=function(t){var e=this,n=t.field(this.field);return n instanceof Ps&&n.internalValue.some((function(t){return e.value.contains(t)}))},Dl);function Dl(t,e){var n=Nl.call(this,t,ll.ARRAY_CONTAINS_ANY,e)||this;return n.value=e,n}var xl=(Ol.prototype.toString=function(){return this.name},Ol.ASCENDING=new Ol("asc"),Ol.DESCENDING=new Ol("desc"),Ol);function Ol(t){this.name=t}var Rl=(Ml.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++)t+=n[e].toString();return t},Ml.prototype.sortsBeforeDocument=function(t,e){jr(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())jr(o instanceof Is,"Bound has a non-key value where the key path is being used."),n=Qi.comparator(o.key,e.key);else{var a=e.field(i.field);jr(null!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===xl.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},Ml.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];if(!n.isEqual(r))return!1}return!0},Ml);function Ml(t,e){this.position=t,this.before=e}var Pl=(Ll.prototype.compare=function(t,e){var n=this.isKeyOrderBy?Vs.compareByKey(t,e):Vs.compareByField(this.field,t,e);switch(this.dir){case xl.ASCENDING:return n;case xl.DESCENDING:return-1*n;default:return Br("Unknown direction: "+this.dir)}},Ll.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},Ll.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},Ll.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},Ll);function Ll(t,e){this.field=t,void 0===e&&(e=xl.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}var Fl=new Pl(zi.keyField(),xl.ASCENDING),Ul=new Pl(zi.keyField(),xl.DESCENDING),ql=(Vl.prototype.applyToLocalView=function(t,e){return new _s(e,t)},Vl.prototype.applyToRemoteDocument=function(t,e){return e},Vl.prototype.computeBaseValue=function(t){return null},Vl.prototype.isEqual=function(t){return t instanceof Vl},Vl.instance=new Vl,Vl);function Vl(){}var Bl=(jl.prototype.applyToLocalView=function(t,e){return this.apply(t)},jl.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},jl.prototype.apply=function(t){for(var e=Ql(t),n=function(t){e.find((function(e){return e.isEqual(t)}))||e.push(t)},r=0,i=this.elements;r<i.length;r++)n(i[r]);return new Ps(e)},jl.prototype.computeBaseValue=function(t){return null},jl.prototype.isEqual=function(t){return t instanceof jl&&Si(t.elements,this.elements)},jl);function jl(t){this.elements=t}var Wl=(Kl.prototype.applyToLocalView=function(t,e){return this.apply(t)},Kl.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},Kl.prototype.apply=function(t){for(var e=Ql(t),n=function(t){e=e.filter((function(e){return!e.isEqual(t)}))},r=0,i=this.elements;r<i.length;r++)n(i[r]);return new Ps(e)},Kl.prototype.computeBaseValue=function(t){return null},Kl.prototype.isEqual=function(t){return t instanceof Kl&&Si(t.elements,this.elements)},Kl);function Kl(t){this.elements=t}var zl=(Gl.prototype.applyToLocalView=function(t,e){var n=this.computeBaseValue(t);if(n instanceof us&&this.operand instanceof us){var r=n.internalValue+this.operand.internalValue;return new us(r)}return r=n.internalValue+this.operand.internalValue,new ls(r)},Gl.prototype.applyToRemoteDocument=function(t,e){return jr(null!==e,"Didn't receive transformResult for NUMERIC_ADD transform"),e},Gl.prototype.computeBaseValue=function(t){return t instanceof is?t:new us(0)},Gl.prototype.isEqual=function(t){return t instanceof Gl&&this.operand.isEqual(t.operand)},Gl);function Gl(t){this.operand=t}function Ql(t){return t instanceof Ps?t.internalValue.slice():[]}var Hl=(Yl.prototype.isEqual=function(t){return t&&t.count===this.count},Yl);function Yl(t){this.count=t}var $l,Xl,Jl=(($l={})[xl.ASCENDING.name]="ASCENDING",$l[xl.DESCENDING.name]="DESCENDING",$l),Zl=((Xl={})[ll.LESS_THAN.name]="LESS_THAN",Xl[ll.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",Xl[ll.GREATER_THAN.name]="GREATER_THAN",Xl[ll.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",Xl[ll.EQUAL.name]="EQUAL",Xl[ll.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",Xl[ll.IN.name]="IN",Xl[ll.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",Xl),tf=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ef(t,e){jr(!Zc(t),e+" is missing")}function nf(t){return"number"==typeof t?t:"string"==typeof t?Number(t):Br("can't parse "+t)}var rf=(of.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},of.prototype.unsafeCastProtoByteString=function(t){return t},of.prototype.fromRpcStatus=function(t){var e=void 0===t.code?Qr.UNKNOWN:Ah(t.code);return new Hr(e,t.message||"")},of.prototype.toInt32Value=function(t){return this.options.useProto3Json||Zc(t)?t:{value:t}},of.prototype.fromInt32Value=function(t){var e;return Zc(e="object"==typeof t?t.value:t)?null:e},of.prototype.toTimestamp=function(t){return this.options.useProto3Json?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},of.prototype.fromTimestamp=function(t){if("string"==typeof t)return this.fromIso8601String(t);jr(!!t,"Cannot deserialize null or undefined timestamp.");var e=nf(t.seconds||"0"),n=t.nanos||0;return new ho(e,n)},of.prototype.fromIso8601String=function(t){var e=0,n=tf.exec(t);if(jr(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new ho(o,e)},of.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},of.prototype.fromBlob=function(t){return"string"==typeof t?(jr(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),Ni.fromBase64String(t)):(jr(!this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),Ni.fromUint8Array(t))},of.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},of.prototype.fromVersion=function(t){return jr(!!t,"Trying to deserialize version that isn't set"),fo.fromTimestamp(this.fromTimestamp(t))},of.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},of.prototype.fromResourceName=function(t){var e=Bi.fromString(t);return jr(this.isValidResourceName(e),"Tried to deserialize invalid key "+e.toString()),e},of.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},of.prototype.fromName=function(t){var e=this.fromResourceName(t);return jr(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),jr(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new Qi(this.extractLocalPathFromResourceName(e))},of.prototype.toQueryPath=function(t){return this.toResourceName(this.databaseId,t)},of.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?Bi.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(of.prototype,"encodedDatabaseId",{get:function(){return new Bi(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),of.prototype.fullyQualifiedPrefixPath=function(t){return new Bi(["projects",t.projectId,"databases",t.database])},of.prototype.extractLocalPathFromResourceName=function(t){return jr(4<t.length&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.popFirst(5)},of.prototype.isValidResourceName=function(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)},of.prototype.toValue=function(t){if(t instanceof Ja)return{nullValue:"NULL_VALUE"};if(t instanceof es)return{booleanValue:t.value()};if(t instanceof us)return{integerValue:""+t.value()};if(t instanceof ls){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof ds?{stringValue:t.value()}:t instanceof Os?{mapValue:this.toMapValue(t)}:t instanceof Ps?{arrayValue:this.toArrayValue(t)}:t instanceof gs?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof ks?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof Es?{bytesValue:this.toBytes(t.value())}:t instanceof Is?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:Br("Unknown FieldValue "+JSON.stringify(t))},of.prototype.fromValue=function(t){var e=this;if("nullValue"in t)return Ja.INSTANCE;if("booleanValue"in t)return es.of(t.booleanValue);if("integerValue"in t)return new us(nf(t.integerValue));if("doubleValue"in t){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return ls.NAN;if("Infinity"===t.doubleValue)return ls.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return ls.NEGATIVE_INFINITY}return new ls(t.doubleValue)}if("stringValue"in t)return new ds(t.stringValue);if("mapValue"in t)return this.fromFields(t.mapValue.fields||{});if("arrayValue"in t){ef(t.arrayValue,"arrayValue");var n=t.arrayValue.values||[];return new Ps(n.map((function(t){return e.fromValue(t)})))}if("timestampValue"in t)return ef(t.timestampValue,"timestampValue"),new gs(this.fromTimestamp(t.timestampValue));if("geoPointValue"in t){ef(t.geoPointValue,"geoPointValue");var r=t.geoPointValue.latitude||0,i=t.geoPointValue.longitude||0;return new ks(new nl(r,i))}if("bytesValue"in t){ef(t.bytesValue,"bytesValue");var o=this.fromBlob(t.bytesValue);return new Es(o)}if("referenceValue"in t){ef(t.referenceValue,"referenceValue");var a=this.fromResourceName(t.referenceValue),s=new Ri(a.get(1),a.get(3)),u=new Qi(this.extractLocalPathFromResourceName(a));return new Is(s,u)}return Br("Unknown Value proto "+JSON.stringify(t))},of.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},of.prototype.toDocument=function(t){return jr(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data()),updateTime:this.toTimestamp(t.version.toTimestamp())}},of.prototype.fromDocument=function(t,e){var n=this,r=this.fromName(t.name),i=this.fromVersion(t.updateTime);return new Vs(r,i,{hasCommittedMutations:!!e},void 0,t,(function(t){return n.fromValue(t)}))},of.prototype.toFields=function(t){var e=this,n={};return t.forEach((function(t,r){n[t]=e.toValue(r)})),n},of.prototype.fromFields=function(t){var e=this,n=t,r=Os.EMPTY;return ti(n,(function(t,n){r=r.set(new zi([t]),e.fromValue(n))})),r},of.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},of.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach((function(t){n.push(e.toValue(t))})),{values:n}},of.prototype.fromFound=function(t){var e=this;jr(!!t.found,"Tried to deserialize a found document from a missing document."),ef(t.found.name,"doc.found.name"),ef(t.found.updateTime,"doc.found.updateTime");var n=this.fromName(t.found.name),r=this.fromVersion(t.found.updateTime);return new Vs(n,r,{},void 0,t.found,(function(t){return e.fromValue(t)}))},of.prototype.fromMissing=function(t){jr(!!t.missing,"Tried to deserialize a missing document from a found document."),jr(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new Ws(e,n)},of.prototype.fromMaybeDocument=function(t){return"found"in t?this.fromFound(t):"missing"in t?this.fromMissing(t):Br("invalid batch get response: "+JSON.stringify(t))},of.prototype.toWatchTargetChangeState=function(t){switch(t){case jh.Added:return"ADD";case jh.Current:return"CURRENT";case jh.NoChange:return"NO_CHANGE";case jh.Removed:return"REMOVE";case jh.Reset:return"RESET";default:return Br("Unknown WatchTargetChangeState: "+t)}},of.prototype.toTestWatchChange=function(t){if(t instanceof zh)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof Kh){if(t.newDoc instanceof Vs){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data()),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof Ws)return e=t.newDoc,{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}};if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof Gh){var n=void 0;return t.cause&&(n={code:function(t){if(void 0===t)return Th.OK;switch(t){case Qr.OK:return Th.OK;case Qr.CANCELLED:return Th.CANCELLED;case Qr.UNKNOWN:return Th.UNKNOWN;case Qr.DEADLINE_EXCEEDED:return Th.DEADLINE_EXCEEDED;case Qr.RESOURCE_EXHAUSTED:return Th.RESOURCE_EXHAUSTED;case Qr.INTERNAL:return Th.INTERNAL;case Qr.UNAVAILABLE:return Th.UNAVAILABLE;case Qr.UNAUTHENTICATED:return Th.UNAUTHENTICATED;case Qr.INVALID_ARGUMENT:return Th.INVALID_ARGUMENT;case Qr.NOT_FOUND:return Th.NOT_FOUND;case Qr.ALREADY_EXISTS:return Th.ALREADY_EXISTS;case Qr.PERMISSION_DENIED:return Th.PERMISSION_DENIED;case Qr.FAILED_PRECONDITION:return Th.FAILED_PRECONDITION;case Qr.ABORTED:return Th.ABORTED;case Qr.OUT_OF_RANGE:return Th.OUT_OF_RANGE;case Qr.UNIMPLEMENTED:return Th.UNIMPLEMENTED;case Qr.DATA_LOSS:return Th.DATA_LOSS;default:return Br("Unknown status code: "+t)}}(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return Br("Unrecognized watch change: "+JSON.stringify(t))},of.prototype.fromWatchChange=function(t){var e,n=this;if("targetChange"in t){ef(t.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=t.targetChange.resumeToken||this.emptyByteString(),a=t.targetChange.cause,s=a&&this.fromRpcStatus(a);e=new Gh(r,i,o,s||null)}else if("documentChange"in t){ef(t.documentChange,"documentChange"),ef(t.documentChange.document,"documentChange.name"),ef(t.documentChange.document.name,"documentChange.document.name"),ef(t.documentChange.document.updateTime,"documentChange.document.updateTime");var u=t.documentChange,c=this.fromName(u.document.name),h=this.fromVersion(u.document.updateTime),l=new Vs(c,h,{},void 0,u.document,(function(t){return n.fromValue(t)})),f=u.targetIds||[],p=u.removedTargetIds||[];e=new Kh(f,p,l.key,l)}else if("documentDelete"in t){ef(t.documentDelete,"documentDelete"),ef(t.documentDelete.document,"documentDelete.document");var d=t.documentDelete;c=this.fromName(d.document),h=d.readTime?this.fromVersion(d.readTime):fo.forDeletedDoc(),l=new Ws(c,h),p=d.removedTargetIds||[],e=new Kh([],p,l.key,l)}else if("documentRemove"in t){ef(t.documentRemove,"documentRemove"),ef(t.documentRemove.document,"documentRemove");var m=t.documentRemove;c=this.fromName(m.document),p=m.removedTargetIds||[],e=new Kh([],p,c,null)}else{if(!("filter"in t))return Br("Unknown change type "+JSON.stringify(t));ef(t.filter,"filter"),ef(t.filter.targetId,"filter.targetId");var y=t.filter,g=y.count||0,v=new Hl(g),b=y.targetId;e=new zh(b,v)}return e},of.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?jh.NoChange:"ADD"===t?jh.Added:"REMOVE"===t?jh.Removed:"CURRENT"===t?jh.Current:"RESET"===t?jh.Reset:Br("Got unexpected TargetChange.state: "+t)},of.prototype.versionFromListenResponse=function(t){if(!("targetChange"in t))return fo.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?fo.MIN:e.readTime?this.fromVersion(e.readTime):fo.MIN},of.prototype.toMutation=function(t){var e,n=this;if(t instanceof Oa)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof za)e={delete:this.toName(t.key)};else if(t instanceof Pa)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof Ua))return Br("Unknown mutation type "+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map((function(t){return n.toFieldTransform(t)}))}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},of.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):Aa.NONE;if(t.update){ef(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new Pa(r,i,o,n)}return new Oa(r,i,n)}if(t.delete)return r=this.fromName(t.delete),new za(r,n);if(t.transform){r=this.fromName(t.transform.document);var a=t.transform.fieldTransforms.map((function(t){return e.fromFieldTransform(t)}));return jr(!0===n.exists,'Transforms only support precondition "exists == true"'),new Ua(r,a)}return Br("unknown mutation proto: "+JSON.stringify(t))},of.prototype.toPrecondition=function(t){return jr(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Br("Unknown precondition")},of.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?Aa.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?Aa.exists(t.exists):Aa.NONE},of.prototype.fromWriteResult=function(t,e){var n=this,r=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);r.isEqual(fo.MIN)&&(r=this.fromVersion(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults.map((function(t){return n.fromValue(t)}))),new Ia(r,i)},of.prototype.fromWriteResults=function(t,e){var n=this;return t&&0<t.length?(jr(void 0!==e,"Received a write result without a commit time"),t.map((function(t){return n.fromWriteResult(t,e)}))):[]},of.prototype.toFieldTransform=function(t){var e=this,n=t.transform;if(n instanceof ql)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Bl)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements.map((function(t){return e.toValue(t)}))}};if(n instanceof Wl)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements.map((function(t){return e.toValue(t)}))}};if(n instanceof zl)return{fieldPath:t.field.canonicalString(),increment:this.toValue(n.operand)};throw Br("Unknown transform: "+t.transform)},of.prototype.fromFieldTransform=function(t){var e=this,n=null;if("setToServerValue"in t)jr("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),n=ql.instance;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new Bl(r.map((function(t){return e.fromValue(t)})))}else if("removeAllFromArray"in t)r=t.removeAllFromArray.values||[],n=new Wl(r.map((function(t){return e.fromValue(t)})));else if("increment"in t){var i=this.fromValue(t.increment);jr(i instanceof is,"NUMERIC_ADD transform requires a NumberValue"),n=new zl(i)}else Br("Unknown transform proto: "+JSON.stringify(t));var o=zi.fromServerFormat(t.fieldPath);return new Ta(o,n)},of.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},of.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;jr(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return ul.atPath(this.fromQueryPath(n)).toTarget()},of.prototype.toQueryTarget=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(jr(n.length%2==0,"Collection Group queries should be within a document path or root."),e.parent=this.toQueryPath(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(jr(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]);var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},of.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(0<r){jr(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=this.fromFilter(n.where));var s=[];n.orderBy&&(s=this.fromOrder(n.orderBy));var u=null;n.limit&&(u=this.fromInt32Value(n.limit));var c=null;n.startAt&&(c=this.fromCursor(n.startAt));var h=null;return n.endAt&&(h=this.fromCursor(n.endAt)),new ul(e,i,s,a,u,il.First,c,h).toTarget()},of.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},of.prototype.toLabel=function(t){switch(t){case qu.Listen:return null;case qu.ExistenceFilterMismatch:return"existence-filter-mismatch";case qu.LimboResolution:return"limbo-document";default:return Br("Unrecognized query purpose: "+t)}},of.prototype.toTarget=function(t){var e,n=t.target;return(e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=t.targetId,0<t.resumeToken.length&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},of.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map((function(t){return t instanceof dl?e.toUnaryOrFieldFilter(t):Br("Unrecognized filter: "+JSON.stringify(t))}));return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},of.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromFieldFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return e.fromFilter(t)})).reduce((function(t,e){return t.concat(e)})):Br("Unknown filter: "+JSON.stringify(t)):[]},of.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map((function(t){return e.toPropertyOrder(t)}))},of.prototype.fromOrder=function(t){var e=this;return t.map((function(t){return e.fromPropertyOrder(t)}))},of.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map((function(t){return e.toValue(t)}))}},of.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map((function(t){return e.fromValue(t)}));return new Rl(r,n)},of.prototype.toDirection=function(t){return Jl[t.name]},of.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return xl.ASCENDING;case"DESCENDING":return xl.DESCENDING;default:return}},of.prototype.toOperatorName=function(t){return Zl[t.name]},of.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return ll.EQUAL;case"GREATER_THAN":return ll.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return ll.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return ll.LESS_THAN;case"LESS_THAN_OR_EQUAL":return ll.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return ll.ARRAY_CONTAINS;case"IN":return ll.IN;case"ARRAY_CONTAINS_ANY":return ll.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return Br("Unspecified operator");default:return Br("Unknown operator")}},of.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},of.prototype.fromFieldPathReference=function(t){return zi.fromServerFormat(t.fieldPath)},of.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},of.prototype.fromPropertyOrder=function(t){return new Pl(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},of.prototype.fromFieldFilter=function(t){return dl.create(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},of.prototype.toUnaryOrFieldFilter=function(t){if(t.op===ll.EQUAL){if(t.value.isEqual(ls.NAN))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}};if(t.value.isEqual(Ja.INSTANCE))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}},of.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return dl.create(e,ll.EQUAL,ls.NAN);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return dl.create(n,ll.EQUAL,Ja.INSTANCE);case"OPERATOR_UNSPECIFIED":return Br("Unspecified filter");default:return Br("Unknown filter")}},of.prototype.toDocumentMask=function(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}},of.prototype.fromDocumentMask=function(t){var e=(t.fieldPaths||[]).map((function(t){return zi.fromServerFormat(t)}));return _a.fromArray(e)},of);function of(t,e){this.databaseId=t,this.options=e}var af=function(){this.viewSnap=null,this.targetId=0,this.listeners=[]},sf=(uf.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);return r||(n=!0,r=new af,this.queries.set(e,r)),r.listeners.push(t),jr(!t.applyOnlineStateChange(this.onlineState),"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),!r.viewSnap||t.onViewSnapshot(r.viewSnap)&&this.raiseSnapshotsInSyncEvent(),n?this.syncEngine.listen(e).then((function(t){return r.targetId=t})):Promise.resolve(r.targetId)},uf.prototype.unlisten=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i;return c(this,(function(o){return e=t.query,n=!1,(r=this.queries.get(e))&&0<=(i=r.listeners.indexOf(t))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(e),[2,this.syncEngine.unlisten(e)]):[2]}))}))},uf.prototype.onWatchChange=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,a=this.queries.get(o);if(a){for(var s=0,u=a.listeners;s<u.length;s++)u[s].onViewSnapshot(i)&&(e=!0);a.viewSnap=i}}e&&this.raiseSnapshotsInSyncEvent()},uf.prototype.onWatchError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.queries.delete(t)},uf.prototype.onOnlineStateChange=function(t){this.onlineState=t;var e=!1;this.queries.forEach((function(n,r){for(var i=0,o=r.listeners;i<o.length;i++)o[i].applyOnlineStateChange(t)&&(e=!0)})),e&&this.raiseSnapshotsInSyncEvent()},uf.prototype.addSnapshotsInSyncListener=function(t){this.snapshotsInSyncListeners.add(t),t.next()},uf.prototype.removeSnapshotsInSyncListener=function(t){this.snapshotsInSyncListeners.delete(t)},uf.prototype.raiseSnapshotsInSyncEvent=function(){this.snapshotsInSyncListeners.forEach((function(t){t.next()}))},uf);function uf(t){this.syncEngine=t,this.queries=new Hs((function(t){return t.canonicalId()})),this.onlineState=yh.Unknown,this.snapshotsInSyncListeners=new Set,this.syncEngine.subscribe(this)}var cf=(hf.prototype.onViewSnapshot=function(t){if(jr(0<t.docChanges.length||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==Nh.Metadata&&e.push(i)}t=new Lh(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(t)&&(this.queryObserver.next(t),o=!0):this.shouldRaiseInitialEvent(t,this.onlineState)&&(this.raiseInitialEvent(t),o=!0),this.snap=t,o},hf.prototype.onError=function(t){this.queryObserver.error(t)},hf.prototype.applyOnlineStateChange=function(t){this.onlineState=t;var e=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&(this.raiseInitialEvent(this.snap),e=!0),e},hf.prototype.shouldRaiseInitialEvent=function(t,e){if(jr(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==yh.Offline;return this.options.waitForSyncWhenOnline&&n?(jr(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===yh.Offline},hf.prototype.shouldRaiseEvent=function(t){if(0<t.docChanges.length)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},hf.prototype.raiseInitialEvent=function(t){jr(!this.raisedInitialEvent,"Trying to raise initial events for second time"),t=Lh.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(t)},hf);function hf(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.snap=null,this.onlineState=yh.Unknown,this.options=n||{}}var lf=(ff.fromSnapshot=function(t,e){for(var n=Po(),r=Po(),i=0,o=e.docChanges;i<o.length;i++){var a=o[i];switch(a.type){case Nh.Added:n=n.add(a.doc.key);break;case Nh.Removed:r=r.add(a.doc.key)}}return new ff(t,e.fromCache,n,r)},ff);function ff(t,e,n,r){this.targetId=t,this.fromCache=e,this.addedKeys=n,this.removedKeys=r}var pf=function(t){this.key=t},df=function(t){this.key=t},mf=(Object.defineProperty(yf.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),yf.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new Mh,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimitToFirst()&&i.size===this.query.limit?i.last():null,c=this.query.hasLimitToLast()&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=e instanceof Vs?e:null;l&&(jr(t.isEqual(l.key),"Mismatching keys found in document changes: "+t+" != "+l.key),l=n.query.matches(l)?l:null);var f=!!h&&n.mutatedKeys.has(h.key),p=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data().isEqual(l.data())?f!==p&&(r.track({type:Nh.Metadata,doc:l}),d=!0):n.shouldWaitForSyncedDocument(h,l)||(r.track({type:Nh.Modified,doc:l}),d=!0,(u&&0<n.query.docComparator(l,u)||c&&n.query.docComparator(l,c)<0)&&(s=!0)):!h&&l?(r.track({type:Nh.Added,doc:l}),d=!0):h&&!l&&(r.track({type:Nh.Removed,doc:h}),d=!0,(u||c)&&(s=!0)),d&&(o=l?(a=a.add(l),p?o.add(t):o.delete(t)):(a=a.delete(t),o.delete(t)))})),this.query.hasLimitToFirst()||this.query.hasLimitToLast())for(;a.size>this.query.limit;){var h=this.query.hasLimitToFirst()?a.last():a.first();a=a.delete(h.key),o=o.delete(h.key),r.track({type:Nh.Removed,doc:h})}return jr(!s||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},yf.prototype.shouldWaitForSyncedDocument=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},yf.prototype.applyChanges=function(t,e,n){var r=this;jr(!t.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var o=t.changeSet.getChanges();o.sort((function(t,e){return function(t,e){function n(t){switch(t){case Nh.Added:return 1;case Nh.Modified:case Nh.Metadata:return 2;case Nh.Removed:return 0;default:return Br("Unknown ChangeType: "+t)}}return n(t)-n(e)}(t.type,e.type)||r.query.docComparator(t.doc,e.doc)})),this.applyTargetChange(n);var a=e?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current?Dh.Synced:Dh.Local,u=s!==this.syncState;return this.syncState=s,0!==o.length||u?{snapshot:new Lh(this.query,t.documentSet,i,o,t.mutatedKeys,s===Dh.Local,u,!1),limboChanges:a}:{limboChanges:a}},yf.prototype.applyOnlineStateChange=function(t){return this.current&&t===yh.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Mh,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},yf.prototype.shouldBeInLimbo=function(t){return!this._syncedDocuments.has(t)&&!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations},yf.prototype.applyTargetChange=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e._syncedDocuments=e._syncedDocuments.add(t)})),t.modifiedDocuments.forEach((function(t){return jr(e._syncedDocuments.has(t),"Modified document "+t+" not found in view.")})),t.removedDocuments.forEach((function(t){return e._syncedDocuments=e._syncedDocuments.delete(t)})),this.current=t.current)},yf.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var e=this.limboDocuments;this.limboDocuments=Po(),this.documentSet.forEach((function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))}));var n=[];return e.forEach((function(e){t.limboDocuments.has(e)||n.push(new df(e))})),this.limboDocuments.forEach((function(t){e.has(t)||n.push(new pf(t))})),n},yf.prototype.synchronizeWithPersistedState=function(t){this._syncedDocuments=t.remoteKeys,this.limboDocuments=Po();var e=this.computeDocChanges(t.documents);return this.applyChanges(e,!0)},yf.prototype.computeInitialSnapshot=function(){return Lh.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===Dh.Local)},yf);function yf(t,e){this.query=t,this._syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=Po(),this.mutatedKeys=Po(),this.documentSet=new Oh(t.docComparator.bind(t))}var gf=(vf.prototype.run=function(){this.runWithBackOff()},vf.prototype.runWithBackOff=function(){var t=this;this.backoff.backoffAndRun((function(){return u(t,void 0,void 0,(function(){var t,e,n=this;return c(this,(function(r){return t=this.remoteStore.createTransaction(),(e=this.tryRunUpdateFunction(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.handleTransactionError(t)}))}))})).catch((function(t){n.handleTransactionError(t)})),[2]}))}))}))},vf.prototype.tryRunUpdateFunction=function(t){try{var e=this.updateFunction(t);return!Zc(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},vf.prototype.handleTransactionError=function(t){var e=this;0<this.retries&&this.isRetryableTransactionError(t)?(this.retries-=1,this.asyncQueue.enqueueAndForget((function(){return e.runWithBackOff(),Promise.resolve()}))):this.deferred.reject(t)},vf.prototype.isRetryableTransactionError=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ih(e)},vf);function vf(t,e,n,r){this.asyncQueue=t,this.remoteStore=e,this.updateFunction=n,this.deferred=r,this.retries=5,this.backoff=new eh(this.asyncQueue,Yi.RetryTransaction)}var bf="SyncEngine",_f=function(t,e,n){this.query=t,this.targetId=e,this.view=n},wf=function(t){this.key=t,this.receivedDocument=!1},Tf=(Object.defineProperty(Ef.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),Ef.prototype.subscribe=function(t){jr(null!==t,"SyncEngine listener cannot be null"),jr(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=t},Ef.prototype.listen=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i,o;return c(this,(function(a){switch(a.label){case 0:return this.assertSubscribed("listen()"),(r=this.queryViewsByQuery.get(t))?(e=r.targetId,this.sharedClientState.addLocalQueryTarget(e),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateTarget(t.toTarget())];case 2:return i=a.sent(),o=this.sharedClientState.addLocalQueryTarget(i.targetId),e=i.targetId,[4,this.initializeViewAndComputeSnapshot(t,e,"current"===o)];case 3:n=a.sent(),this.isPrimary&&this.remoteStore.listen(i),a.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,e]}}))}))},Ef.prototype.initializeViewAndComputeSnapshot=function(t,e,n){return u(this,void 0,void 0,(function(){var r,i,o,a,s,u;return c(this,(function(c){switch(c.label){case 0:return[4,this.localStore.executeQuery(t,!0)];case 1:return r=c.sent(),i=new mf(t,r.remoteKeys),o=i.computeDocChanges(r.documents),a=Vh.createSynthesizedTargetChangeForCurrentChange(e,n&&this.onlineState!==yh.Offline),jr(0===(s=i.applyChanges(o,!0===this.isPrimary,a)).limboChanges.length,"View returned limbo docs before target ack from the server."),jr(!!s.snapshot,"applyChanges for new view should always return a snapshot"),u=new _f(t,e,i),this.queryViewsByQuery.set(t,u),this.queriesByTarget[e]||(this.queriesByTarget[e]=[]),this.queriesByTarget[e].push(t),[2,s.snapshot]}}))}))},Ef.prototype.synchronizeViewAndComputeSnapshot=function(t){return u(this,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:return[4,this.localStore.executeQuery(t.query,!0)];case 1:return e=r.sent(),n=t.view.synchronizeWithPersistedState(e),this.isPrimary&&this.updateTrackedLimbos(t.targetId,n.limboChanges),[2,n]}}))}))},Ef.prototype.unlisten=function(t){return u(this,void 0,void 0,(function(){var e,n,r=this;return c(this,(function(i){switch(i.label){case 0:return this.assertSubscribed("unlisten()"),jr(!!(e=this.queryViewsByQuery.get(t)),"Trying to unlisten on query not found:"+t),1<(n=this.queriesByTarget[e.targetId]).length?(this.queriesByTarget[e.targetId]=n.filter((function(e){return!e.isEqual(t)})),this.queryViewsByQuery.delete(t),[2]):this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(e.targetId),this.sharedClientState.isActiveQueryTarget(e.targetId)?[3,2]:[4,this.localStore.releaseTarget(e.targetId,!1).then((function(){r.sharedClientState.clearQueryState(e.targetId),r.remoteStore.unlisten(e.targetId),r.removeAndCleanupTarget(e.targetId)})).catch(mc)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupTarget(e.targetId),[4,this.localStore.releaseTarget(e.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))},Ef.prototype.write=function(t,e){return u(this,void 0,void 0,(function(){var n;return c(this,(function(r){switch(r.label){case 0:return this.assertSubscribed("write()"),[4,this.localStore.localWrite(t)];case 1:return n=r.sent(),this.sharedClientState.addPendingMutation(n.batchId),this.addMutationCallback(n.batchId,e),[4,this.emitNewSnapsAndNotifyLocalStore(n.changes)];case 2:return r.sent(),[4,this.remoteStore.fillWritePipeline()];case 3:return r.sent(),[2]}}))}))},Ef.prototype.runTransaction=function(t,e,n){new gf(t,this.remoteStore,e,n).run()},Ef.prototype.applyRemoteEvent=function(t){return u(this,void 0,void 0,(function(){var e,n=this;return c(this,(function(r){switch(r.label){case 0:this.assertSubscribed("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.applyRemoteEvent(t)];case 2:return e=r.sent(),ti(t.targetChanges,(function(t,e){var r=n.limboResolutionsByTarget[Number(t)];r&&(jr(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),0<e.addedDocuments.size?r.receivedDocument=!0:0<e.modifiedDocuments.size?jr(r.receivedDocument,"Received change for limbo target document without add."):0<e.removedDocuments.size&&(jr(r.receivedDocument,"Received remove for limbo target document without add."),r.receivedDocument=!1))})),[4,this.emitNewSnapsAndNotifyLocalStore(e,t)];case 3:return r.sent(),[3,6];case 4:return[4,mc(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},Ef.prototype.applyOnlineStateChange=function(t,e){if(this.isPrimary&&e===vh.RemoteStore||!this.isPrimary&&e===vh.SharedClientState){this.assertSubscribed("applyOnlineStateChange()");var n=[];this.queryViewsByQuery.forEach((function(e,r){var i=r.view.applyOnlineStateChange(t);jr(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)})),this.syncEngineListener.onOnlineStateChange(t),this.syncEngineListener.onWatchChange(n),this.onlineState=t,this.isPrimary&&this.sharedClientState.setOnlineState(t)}},Ef.prototype.rejectListen=function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o,a,s=this;return c(this,(function(u){switch(u.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(t,"rejected",e),n=this.limboResolutionsByTarget[t],(r=n&&n.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[t],i=(i=new mo(Qi.comparator)).insert(r,new Ws(r,fo.forDeletedDoc())),o=Po().add(r),a=new Uh(fo.MIN,{},new Eo(Ei),i,o),[2,this.applyRemoteEvent(a)]):[3,1];case 1:return[4,this.localStore.releaseTarget(t,!1).then((function(){return s.removeAndCleanupTarget(t,e)})).catch(mc)];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))},Ef.prototype.applyBatchState=function(t,e,n){return u(this,void 0,void 0,(function(){var r;return c(this,(function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(t)];case 1:return null===(r=i.sent())?(Ur(bf,"Cannot apply mutation batch with id: "+t),[2]):"pending"!==e?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.processUserCallback(t,n||null),this.localStore.removeCachedMutationBatchMetadata(t)):Br("Unknown batchState: "+e),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}}))}))},Ef.prototype.applySuccessfulWrite=function(t){return u(this,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:this.assertSubscribed("applySuccessfulWrite()"),e=t.batch.batchId,this.processUserCallback(e,null),this.triggerPendingWritesCallbacks(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.acknowledgeBatch(t)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(e,"acknowledged"),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,mc(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},Ef.prototype.rejectFailedWrite=function(t,e){return u(this,void 0,void 0,(function(){var n;return c(this,(function(r){switch(r.label){case 0:this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.triggerPendingWritesCallbacks(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.rejectBatch(t)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(t,"rejected",e),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,mc(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},Ef.prototype.registerPendingWritesCallback=function(t){return u(this,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:return this.remoteStore.canUseNetwork()||Ur(bf,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.localStore.getHighestUnacknowledgedBatchId()];case 1:return-1===(e=r.sent())?t.resolve():((n=this.pendingWritesCallbacks.get(e)||[]).push(t),this.pendingWritesCallbacks.set(e,n)),[2]}}))}))},Ef.prototype.triggerPendingWritesCallbacks=function(t){(this.pendingWritesCallbacks.get(t)||[]).forEach((function(t){t.resolve()})),this.pendingWritesCallbacks.delete(t)},Ef.prototype.rejectOutstandingPendingWritesCallbacks=function(t){this.pendingWritesCallbacks.forEach((function(e){e.forEach((function(e){e.reject(new Hr(Qr.CANCELLED,t))}))})),this.pendingWritesCallbacks.clear()},Ef.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n=(n=n||new mo(Ei)).insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},Ef.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(jr(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},Ef.prototype.removeAndCleanupTarget=function(t,e){var n=this;void 0===e&&(e=null),this.sharedClientState.removeLocalQueryTarget(t),jr(this.queriesByTarget[t]&&0!==this.queriesByTarget[t].length,"There are no queries mapped to target id "+t);for(var r=0,i=this.queriesByTarget[t];r<i.length;r++){var o=i[r];this.queryViewsByQuery.delete(o),e&&this.syncEngineListener.onWatchError(o,e)}if(delete this.queriesByTarget[t],this.isPrimary){var a=this.limboDocumentRefs.referencesForId(t);this.limboDocumentRefs.removeReferencesForId(t),a.forEach((function(t){n.limboDocumentRefs.containsKey(t)||n.removeLimboTarget(t)}))}},Ef.prototype.removeLimboTarget=function(t){var e=this.limboTargetsByKey.get(t);null!==e&&(this.remoteStore.unlisten(e),this.limboTargetsByKey=this.limboTargetsByKey.remove(t),delete this.limboResolutionsByTarget[e])},Ef.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof pf?(this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i)):i instanceof df?(Ur(bf,"Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,t),this.limboDocumentRefs.containsKey(i.key)||this.removeLimboTarget(i.key)):Br("Unknown limbo change: "+JSON.stringify(i))}},Ef.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){Ur(bf,"New document in limbo: "+e);var n=this.limboTargetIdGenerator.next(),r=ul.atPath(e.path);this.limboResolutionsByTarget[n]=new wf(e),this.remoteStore.listen(new zu(r.toTarget(),n,qu.LimboResolution,Pi.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},Ef.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},Ef.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o=this;return c(this,(function(a){switch(a.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach((function(a,s){i.push(Promise.resolve().then((function(){var e=s.view.computeDocChanges(t);return e.needsRefill?o.localStore.executeQuery(s.query,!1).then((function(t){var n=t.documents;return s.view.computeDocChanges(n,e)})):e})).then((function(t){var i=e&&e.targetChanges[s.targetId],a=s.view.applyChanges(t,!0===o.isPrimary,i);if(o.updateTrackedLimbos(s.targetId,a.limboChanges),a.snapshot){o.isPrimary&&o.sharedClientState.updateQueryState(s.targetId,a.snapshot.fromCache?"not-current":"current"),n.push(a.snapshot);var u=lf.fromSnapshot(s.targetId,a.snapshot);r.push(u)}})))})),[4,Promise.all(i)];case 1:return a.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return a.sent(),[2]}}))}))},Ef.prototype.assertSubscribed=function(t){jr(null!==this.syncEngineListener,"Trying to call "+t+" before calling subscribe().")},Ef.prototype.handleCredentialChange=function(t){return u(this,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?(this.rejectOutstandingPendingWritesCallbacks("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.localStore.handleUserChange(t)]):[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}}))}))},Ef.prototype.applyPrimaryState=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u=this;return c(this,(function(c){switch(c.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return c.sent(),e=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e.toArray())];case 2:for(n=c.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.remoteStore.listen(o);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,a=[],s=Promise.resolve(),Zr(this.queriesByTarget,(function(t,e){u.sharedClientState.isLocalQueryTarget(t)?a.push(t):s=s.then((function(){return u.removeAndCleanupTarget(t),u.localStore.releaseTarget(t,!0)})),u.remoteStore.unlisten(t)})),[4,s]);case 4:return c.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(a)];case 5:return c.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:c.sent(),c.label=7;case 7:return[2]}}))}))},Ef.prototype.resetLimboDocuments=function(){var t=this;Zr(this.limboResolutionsByTarget,(function(e){t.remoteStore.unlisten(e)})),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new mo(Qi.comparator)},Ef.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,h,l,f,p,d;return c(this,(function(c){switch(c.label){case 0:e=[],n=[],r=0,i=t,c.label=1;case 1:return r<i.length?(o=i[r],a=void 0,(s=this.queriesByTarget[o])&&0!==s.length?[4,this.localStore.releaseTarget(o,!0)]:[3,8]):[3,14];case 2:return c.sent(),[4,this.localStore.allocateTarget(s[0].toTarget())];case 3:a=c.sent(),u=0,h=s,c.label=4;case 4:return u<h.length?(l=h[u],jr(!!(f=this.queryViewsByQuery.get(l)),"No query view found for "+l),[4,this.synchronizeViewAndComputeSnapshot(f)]):[3,7];case 5:(p=c.sent()).snapshot&&n.push(p.snapshot),c.label=6;case 6:return u++,[3,4];case 7:return[3,12];case 8:return jr(!0===this.isPrimary,"A secondary tab should never have an active target without an active query."),[4,this.localStore.getTarget(o)];case 9:return jr(!!(d=c.sent()),"Target for id "+o+" not found"),[4,this.localStore.allocateTarget(d)];case 10:return a=c.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(d),o,!1)];case 11:c.sent(),c.label=12;case 12:e.push(a),c.label=13;case 13:return r++,[3,1];case 14:return this.syncEngineListener.onWatchChange(n),[2,e]}}))}))},Ef.prototype.synthesizeTargetToQuery=function(t){return new ul(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,il.First,t.startAt,t.endAt)},Ef.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},Ef.prototype.applyTargetState=function(t,e,n){return u(this,void 0,void 0,(function(){var r,i;return c(this,(function(o){switch(o.label){case 0:if(this.isPrimary)return Ur(bf,"Ignoring unexpected query state notification."),[2];if(!this.queriesByTarget[t])return[3,7];switch(e){case"current":case"not-current":return[3,1];case"rejected":return[3,4]}return[3,6];case 1:return[4,this.localStore.getNewDocumentChanges()];case 2:return r=o.sent(),i=Uh.createSynthesizedRemoteEventForCurrentChange(t,"current"===e),[4,this.emitNewSnapsAndNotifyLocalStore(r,i)];case 3:return o.sent(),[3,7];case 4:return[4,this.localStore.releaseTarget(t,!0)];case 5:return o.sent(),this.removeAndCleanupTarget(t,n),[3,7];case 6:Br("Unexpected target state: "+e),o.label=7;case 7:return[2]}}))}))},Ef.prototype.applyActiveTargetsChange=function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,h,l,f=this;return c(this,(function(p){switch(p.label){case 0:if(!this.isPrimary)return[2];n=0,r=t,p.label=1;case 1:return n<r.length?(l=r[n],jr(!this.queriesByTarget[l],"Trying to add an already active target"),[4,this.localStore.getTarget(l)]):[3,6];case 2:return jr(!!(i=p.sent()),"Query data for active target "+l+" not found"),[4,this.localStore.allocateTarget(i)];case 3:return o=p.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(i),o.targetId,!1)];case 4:p.sent(),this.remoteStore.listen(o),p.label=5;case 5:return n++,[3,1];case 6:a=function(t){return c(this,(function(e){switch(e.label){case 0:return s.queriesByTarget[t]?[4,s.localStore.releaseTarget(t,!1).then((function(){f.remoteStore.unlisten(t),f.removeAndCleanupTarget(t)})).catch(mc)]:[2,"continue"];case 1:return e.sent(),[2]}}))},s=this,u=0,h=e,p.label=7;case 7:return u<h.length?(l=h[u],[5,a(l)]):[3,10];case 8:p.sent(),p.label=9;case 9:return u++,[3,7];case 10:return[2]}}))}))},Ef.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},Ef.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},Ef.prototype.getRemoteKeysForTarget=function(t){var e=this.limboResolutionsByTarget[t];if(e&&e.receivedDocument)return Po().add(e.key);var n=Po(),r=this.queriesByTarget[t];if(!r)return n;for(var i=0,o=r;i<o.length;i++){var a=o[i],s=this.queryViewsByQuery.get(a);jr(!!s,"No query view found for "+a),n=n.unionWith(s.view.syncedDocuments)}return n},Ef);function Ef(t,e,n,r){this.localStore=t,this.remoteStore=e,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new Hs((function(t){return t.canonicalId()})),this.queriesByTarget={},this.limboTargetsByKey=new mo(Qi.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new Ec,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=fa.forSyncEngine(),this.isPrimary=void 0,this.onlineState=yh.Unknown}var Sf=(Cf.prototype.isAuthenticated=function(){return null!=this.uid},Cf.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},Cf.prototype.isEqual=function(t){return t.uid===this.uid},Cf.UNAUTHENTICATED=new Cf(null),Cf.GOOGLE_CREDENTIALS=new Cf("google-credentials-uid"),Cf.FIRST_PARTY=new Cf("first-party-uid"),Cf);function Cf(t){this.uid=t}var If="SharedClientState",Af="firestore_clients",Nf="firestore_mutations",kf="firestore_targets",Df=(xf.fromWebStorageEntry=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Hr(r.error.code,r.error.message)),i?new xf(t,e,r.state,o):(qr(If,"Failed to parse mutation state for ID '"+e+"': "+n),null)},xf.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},xf);function xf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,jr(void 0!==(this.error=r)==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}var Of=(Rf.fromWebStorageEntry=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Hr(n.error.code,n.error.message)),r?new Rf(t,n.state,i):(qr(If,"Failed to parse target state for ID '"+t+"': "+e),null)},Rf.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Rf);function Rf(t,e,n){this.targetId=t,this.state=e,jr(void 0!==(this.error=n)==("rejected"===e),"QueryTargetMetadata must contain an error iff state is 'rejected'")}var Mf=(Pf.fromWebStorageEntry=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Fo(),o=0;r&&o<n.activeTargetIds.length;++o)r=th(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Pf(t,i):(qr(If,"Failed to parse client data for instance '"+t+"': "+e),null)},Pf);function Pf(t,e){this.clientId=t,this.activeTargetIds=e}var Lf=(Ff.fromWebStorageEntry=function(t){var e=JSON.parse(t);return"object"==typeof e&&e.onlineState in yh&&"string"==typeof e.clientId?new Ff(e.clientId,yh[e.onlineState]):(qr(If,"Failed to parse online state: "+t),null)},Ff);function Ff(t,e){this.clientId=t,this.onlineState=e}var Uf=(qf.prototype.addQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},qf.prototype.removeQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},qf.prototype.toWebStorageJSON=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},qf);function qf(){this.activeTargetIds=Fo()}var Vf=(Bf.isAvailable=function(t){return!(!t.window||null==t.window.localStorage)},Bf.prototype.start=function(){return u(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s,u,h,l,f=this;return c(this,(function(c){switch(c.label){case 0:return jr(!this.started,"WebStorageSharedClientState already started"),jr(null!==this.syncEngine,"syncEngine property must be set before calling start()"),jr(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(t=c.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.localClientId&&(i=this.getItem(this.toWebStorageClientStateKey(r)))&&(o=Mf.fromWebStorageEntry(r,i))&&(this.activeClients[o.clientId]=o);for(this.persistClientState(),(a=this.storage.getItem(this.onlineStateKey))&&(s=this.fromWebStorageOnlineState(a))&&this.handleOnlineStateEvent(s),u=0,h=this.earlyEvents;u<h.length;u++)l=h[u],this.handleWebStorageEvent(l);return this.earlyEvents=[],this.platform.window.addEventListener("unload",(function(){return f.shutdown()})),this.started=!0,[2]}}))}))},Bf.prototype.writeSequenceNumber=function(t){this.setItem(this.sequenceNumberKey,JSON.stringify(t))},Bf.prototype.getAllActiveQueryTargets=function(){var t=Fo();return ti(this.activeClients,(function(e,n){t=t.unionWith(n.activeTargetIds)})),t},Bf.prototype.isActiveQueryTarget=function(t){for(var e in this.activeClients)if(this.activeClients.hasOwnProperty(e)&&this.activeClients[e].activeTargetIds.has(t))return!0;return!1},Bf.prototype.addPendingMutation=function(t){this.persistMutationState(t,"pending")},Bf.prototype.updateMutationState=function(t,e,n){this.persistMutationState(t,e,n),this.removeMutationState(t)},Bf.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(this.toWebStorageQueryTargetMetadataKey(t));if(n){var r=Of.fromWebStorageEntry(t,n);r&&(e=r.state)}}return this.localClientState.addQueryTarget(t),this.persistClientState(),e},Bf.prototype.removeLocalQueryTarget=function(t){this.localClientState.removeQueryTarget(t),this.persistClientState()},Bf.prototype.isLocalQueryTarget=function(t){return this.localClientState.activeTargetIds.has(t)},Bf.prototype.clearQueryState=function(t){this.removeItem(this.toWebStorageQueryTargetMetadataKey(t))},Bf.prototype.updateQueryState=function(t,e,n){this.persistQueryTargetState(t,e,n)},Bf.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.removeMutationState(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},Bf.prototype.setOnlineState=function(t){this.persistOnlineState(t)},Bf.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},Bf.prototype.getItem=function(t){var e=this.storage.getItem(t);return Ur(If,"READ",t,e),e},Bf.prototype.setItem=function(t,e){Ur(If,"SET",t,e),this.storage.setItem(t,e)},Bf.prototype.removeItem=function(t){Ur(If,"REMOVE",t),this.storage.removeItem(t)},Bf.prototype.handleWebStorageEvent=function(t){var e=this;if(t.storageArea===this.storage){if(Ur(If,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey)return void qr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget((function(){return u(e,void 0,void 0,(function(){var e,n,r,i,o,a;return c(this,(function(s){if(!this.started)return this.earlyEvents.push(t),[2];if(null===t.key)return[2];if(this.clientStateKeyRe.test(t.key)){if(null==t.newValue)return n=this.fromWebStorageClientStateKey(t.key),[2,this.handleClientStateEvent(n,null)];if(e=this.fromWebStorageClientState(t.key,t.newValue))return[2,this.handleClientStateEvent(e.clientId,e)]}else if(this.mutationBatchKeyRe.test(t.key)){if(null!==t.newValue&&(r=this.fromWebStorageMutationMetadata(t.key,t.newValue)))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(t.key)){if(null!==t.newValue&&(i=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue)))return[2,this.handleQueryTargetEvent(i)]}else if(t.key===this.onlineStateKey){if(null!==t.newValue&&(o=this.fromWebStorageOnlineState(t.newValue)))return[2,this.handleOnlineStateEvent(o)]}else t.key===this.sequenceNumberKey&&(jr(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(a=function(t){var e=Pi.INVALID;if(null!=t)try{var n=JSON.parse(t);jr("number"==typeof n,"Found non-numeric sequence number"),e=n}catch(t){qr(If,"Failed to read sequence number from WebStorage",t)}return e}(t.newValue))!==Pi.INVALID&&this.sequenceNumberHandler(a));return[2]}))}))}))}},Object.defineProperty(Bf.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),Bf.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},Bf.prototype.persistMutationState=function(t,e,n){var r=new Df(this.currentUser,t,e,n),i=this.toWebStorageMutationBatchKey(t);this.setItem(i,r.toWebStorageJSON())},Bf.prototype.removeMutationState=function(t){var e=this.toWebStorageMutationBatchKey(t);this.removeItem(e)},Bf.prototype.persistOnlineState=function(t){var e={clientId:this.localClientId,onlineState:yh[t]};this.storage.setItem(this.onlineStateKey,JSON.stringify(e))},Bf.prototype.persistQueryTargetState=function(t,e,n){var r=this.toWebStorageQueryTargetMetadataKey(t),i=new Of(t,e,n);this.setItem(r,i.toWebStorageJSON())},Bf.prototype.toWebStorageClientStateKey=function(t){return jr(-1===t.indexOf("_"),"Client key cannot contain '_', but was '"+t+"'"),Af+"_"+this.persistenceKey+"_"+t},Bf.prototype.toWebStorageQueryTargetMetadataKey=function(t){return kf+"_"+this.persistenceKey+"_"+t},Bf.prototype.toWebStorageMutationBatchKey=function(t){var e=Nf+"_"+this.persistenceKey+"_"+t;return this.currentUser.isAuthenticated()&&(e+="_"+this.currentUser.uid),e},Bf.prototype.fromWebStorageClientStateKey=function(t){var e=this.clientStateKeyRe.exec(t);return e?e[1]:null},Bf.prototype.fromWebStorageClientState=function(t,e){var n=this.fromWebStorageClientStateKey(t);return jr(null!==n,"Cannot parse client state key '"+t+"'"),Mf.fromWebStorageEntry(n,e)},Bf.prototype.fromWebStorageMutationMetadata=function(t,e){var n=this.mutationBatchKeyRe.exec(t);jr(null!==n,"Cannot parse mutation batch key '"+t+"'");var r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Df.fromWebStorageEntry(new Sf(i),r,e)},Bf.prototype.fromWebStorageQueryTargetMetadata=function(t,e){var n=this.queryTargetKeyRe.exec(t);jr(null!==n,"Cannot parse query target key '"+t+"'");var r=Number(n[1]);return Of.fromWebStorageEntry(r,e)},Bf.prototype.fromWebStorageOnlineState=function(t){return Lf.fromWebStorageEntry(t)},Bf.prototype.handleMutationBatchEvent=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){return t.user.uid!==this.currentUser.uid?(Ur(If,"Ignoring mutation for non-active user "+t.user.uid),[2]):[2,this.syncEngine.applyBatchState(t.batchId,t.state,t.error)]}))}))},Bf.prototype.handleQueryTargetEvent=function(t){return this.syncEngine.applyTargetState(t.targetId,t.state,t.error)},Bf.prototype.handleClientStateEvent=function(t,e){var n=this,r=this.getAllActiveQueryTargets();e?this.activeClients[t]=e:delete this.activeClients[t];var i=this.getAllActiveQueryTargets(),o=[],a=[];return i.forEach((function(t){return u(n,void 0,void 0,(function(){return c(this,(function(e){return r.has(t)||o.push(t),[2]}))}))})),r.forEach((function(t){return u(n,void 0,void 0,(function(){return c(this,(function(e){return i.has(t)||a.push(t),[2]}))}))})),this.syncEngine.applyActiveTargetsChange(o,a)},Bf.prototype.handleOnlineStateEvent=function(t){this.activeClients[t.clientId]&&this.onlineStateHandler(t.onlineState)},Bf);function Bf(t,e,n,r,i){if(this.queue=t,this.platform=e,this.persistenceKey=n,this.localClientId=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!Bf.isAvailable(this.platform))throw new Hr(Qr.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=i,this.localClientStorageKey=this.toWebStorageClientStateKey(this.localClientId),this.sequenceNumberKey="firestore_sequence_number_"+n,this.activeClients[this.localClientId]=new Uf,this.clientStateKeyRe=new RegExp("^"+Af+"_"+o+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+Nf+"_"+o+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+kf+"_"+o+"_(\\d+)$"),this.onlineStateKey="firestore_online_state_"+n,this.platform.window.addEventListener("storage",this.storageListener)}var jf=(Wf.prototype.addPendingMutation=function(t){},Wf.prototype.updateMutationState=function(t,e,n){},Wf.prototype.addLocalQueryTarget=function(t){return this.localState.addQueryTarget(t),this.queryState[t]||"not-current"},Wf.prototype.updateQueryState=function(t,e,n){this.queryState[t]=e},Wf.prototype.removeLocalQueryTarget=function(t){this.localState.removeQueryTarget(t)},Wf.prototype.isLocalQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},Wf.prototype.clearQueryState=function(t){delete this.queryState[t]},Wf.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},Wf.prototype.isActiveQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},Wf.prototype.start=function(){return this.localState=new Uf,Promise.resolve()},Wf.prototype.handleUserChange=function(t,e,n){},Wf.prototype.setOnlineState=function(t){},Wf.prototype.shutdown=function(){},Wf.prototype.writeSequenceNumber=function(t){},Wf);function Wf(){this.localState=new Uf,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}var Kf="FirestoreClient",zf=(Gf.prototype.lruParams=function(){return Zu.withCacheSize(this.cacheSizeBytes)},Gf);function Gf(t,e){this.cacheSizeBytes=t,this.synchronizeTabs=e}var Qf=function(){},Hf=(Yf.prototype.start=function(t){var e=this;this.verifyNotTerminated();var n=new Xi,r=new Xi,i=!1;return this.credentials.setChangeListener((function(o){i?e.asyncQueue.enqueueAndForget((function(){return e.handleCredentialChange(o)})):(i=!0,e.initializePersistence(t,r,o).then((function(t){return e.initializeRest(o,t)})).then(n.resolve,n.reject))})),this.asyncQueue.enqueueAndForget((function(){return n.promise})),r.promise},Yf.prototype.enableNetwork=function(){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return t.syncEngine.enableNetwork()}))},Yf.prototype.initializePersistence=function(t,e,n){var r=this;return t instanceof zf?this.startIndexedDbPersistence(n,t).then((function(t){return e.resolve(),t})).catch((function(t){if(e.reject(t),!r.canFallback(t))throw t;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+t),r.startMemoryPersistence()})):(e.resolve(),this.startMemoryPersistence())},Yf.prototype.canFallback=function(t){return t instanceof Hr?t.code===Qr.FAILED_PRECONDITION||t.code===Qr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Yf.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Hr(Qr.FAILED_PRECONDITION,"The client has already been terminated.")},Yf.prototype.startIndexedDbPersistence=function(t,e){var n=this,r=pc.buildStoragePrefix(this.databaseInfo),i=new rf(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then((function(){return u(n,void 0,void 0,(function(){var n,o;return c(this,(function(a){switch(a.label){case 0:if(e.synchronizeTabs&&!Vf.isAvailable(this.platform))throw new Hr(Qr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return n=e.lruParams(),this.sharedClientState=e.synchronizeTabs?new Vf(this.asyncQueue,this.platform,r,this.clientId,t):new jf,[4,pc.createIndexedDbPersistence({allowTabSynchronization:e.synchronizeTabs,persistenceKey:r,clientId:this.clientId,platform:this.platform,queue:this.asyncQueue,serializer:i,lruParams:n,sequenceNumberSyncer:this.sharedClientState})];case 1:return o=a.sent(),[2,(this.persistence=o).referenceDelegate.garbageCollector]}}))}))}))},Yf.prototype.startMemoryPersistence=function(){return this.persistence=Uc.createEagerPersistence(this.clientId),this.sharedClientState=new jf,Promise.resolve(null)},Yf.prototype.initializeRest=function(t,e){var n=this;return Ur(Kf,"Initializing. user=",t.uid),this.platform.loadConnection(this.databaseInfo).then((function(r){return u(n,void 0,void 0,(function(){var n,i,o,a,s,h,l=this;return c(this,(function(f){switch(f.label){case 0:return n=new Qc,this.localStore=new Nc(this.persistence,n,t),[4,this.localStore.start()];case 1:return f.sent(),e&&(this.lruScheduler=new ec(e,this.asyncQueue,this.localStore)),i=this.platform.newConnectivityMonitor(),o=this.platform.newSerializer(this.databaseInfo.databaseId),a=new dh(this.asyncQueue,r,this.credentials,o),s=function(t){return l.syncEngine.applyOnlineStateChange(t,vh.RemoteStore)},h=function(t){return l.syncEngine.applyOnlineStateChange(t,vh.SharedClientState)},this.remoteStore=new tl(this.localStore,a,this.asyncQueue,s,i),this.syncEngine=new Tf(this.localStore,this.remoteStore,this.sharedClientState,t),this.sharedClientState.onlineStateHandler=h,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new sf(this.syncEngine),[4,this.sharedClientState.start()];case 2:return f.sent(),[4,this.remoteStore.start()];case 3:return f.sent(),[4,this.persistence.setPrimaryStateListener((function(t){return u(l,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,this.syncEngine.applyPrimaryState(t)];case 1:return e.sent(),this.lruScheduler&&(t&&!this.lruScheduler.started?this.lruScheduler.start():t||this.lruScheduler.stop()),[2]}}))}))}))];case 4:return f.sent(),[4,this.persistence.setDatabaseDeletedListener((function(){return u(l,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))}))];case 5:return f.sent(),[2]}}))}))}))},Yf.prototype.handleCredentialChange=function(t){return this.asyncQueue.verifyOperationInProgress(),Ur(Kf,"Credential Changed. Current user: "+t.uid),this.syncEngine.handleCredentialChange(t)},Yf.prototype.disableNetwork=function(){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return t.syncEngine.disableNetwork()}))},Yf.prototype.terminate=function(){var t=this;return this.asyncQueue.enqueueAndInitiateShutdown((function(){return u(t,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()];case 1:return t.sent(),[4,this.sharedClientState.shutdown()];case 2:return t.sent(),[4,this.persistence.shutdown()];case 3:return t.sent(),this.credentials.removeChangeListener(),[2]}}))}))}))},Yf.prototype.waitForPendingWrites=function(){var t=this;this.verifyNotTerminated();var e=new Xi;return this.asyncQueue.enqueueAndForget((function(){return t.syncEngine.registerPendingWritesCallback(e)})),e.promise},Yf.prototype.listen=function(t,e,n){var r=this;this.verifyNotTerminated();var i=new cf(t,e,n);return this.asyncQueue.enqueueAndForget((function(){return r.eventMgr.listen(i)})),i},Yf.prototype.unlisten=function(t){var e=this;this.clientTerminated||this.asyncQueue.enqueueAndForget((function(){return e.eventMgr.unlisten(t)}))},Yf.prototype.getDocumentFromLocalCache=function(t){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return e.localStore.readDocument(t)})).then((function(t){if(t instanceof Vs)return t;if(t instanceof Ws)return null;throw new Hr(Qr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")}))},Yf.prototype.getDocumentsFromLocalCache=function(t){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return u(e,void 0,void 0,(function(){var e,n,r;return c(this,(function(i){switch(i.label){case 0:return[4,this.localStore.executeQuery(t,!0)];case 1:return e=i.sent(),n=new mf(t,e.remoteKeys),r=n.computeDocChanges(e.documents),[2,n.applyChanges(r,!1).snapshot]}}))}))}))},Yf.prototype.write=function(t){var e=this;this.verifyNotTerminated();var n=new Xi;return this.asyncQueue.enqueueAndForget((function(){return e.syncEngine.write(t,n)})),n.promise},Yf.prototype.databaseId=function(){return this.databaseInfo.databaseId},Yf.prototype.addSnapshotsInSyncListener=function(t){var e=this;this.verifyNotTerminated(),this.asyncQueue.enqueueAndForget((function(){return e.eventMgr.addSnapshotsInSyncListener(t),Promise.resolve()}))},Yf.prototype.removeSnapshotsInSyncListener=function(t){this.clientTerminated||this.eventMgr.removeSnapshotsInSyncListener(t)},Object.defineProperty(Yf.prototype,"clientTerminated",{get:function(){return this.asyncQueue.isShuttingDown},enumerable:!0,configurable:!0}),Yf.prototype.transaction=function(t){var e=this;this.verifyNotTerminated();var n=new Xi;return this.asyncQueue.enqueueAndForget((function(){return e.syncEngine.runTransaction(e.asyncQueue,t,n),Promise.resolve()})),n.promise},Yf);function Yf(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r,this.clientId=wi.newId()}var $f=(Xf.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},Xf.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},Xf.prototype.mute=function(){this.muted=!0},Xf.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},Xf);function Xf(t){this.observer=t,this.muted=!1}var Jf=(Zf.documentId=function(){return Zf._DOCUMENT_ID},Zf.prototype.isEqual=function(t){if(!(t instanceof Zf))throw gi("isEqual","FieldPath",1,t);return this._internalPath.isEqual(t._internalPath)},Zf._DOCUMENT_ID=new Zf(zi.keyField().canonicalString()),Zf);function Zf(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,r){if(!(e instanceof Array)||e.length<r)throw new Hr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" argument to be an array with at least "+_i(r,"element")+".")}("FieldPath",t,"fieldNames",1);for(var n=0;n<t.length;++n)if(ai("FieldPath","string",n,t[n]),0===t[n].length)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zi(t)}var tp=new RegExp("[~\\*/\\[\\]]"),ep=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+t}},np=(rp.prototype.getToken=function(){return Promise.resolve(null)},rp.prototype.invalidateToken=function(){},rp.prototype.setChangeListener=function(t){jr(!this.changeListener,"Can only call setChangeListener() once."),(this.changeListener=t)(Sf.UNAUTHENTICATED)},rp.prototype.removeChangeListener=function(){jr(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},rp);function rp(){this.changeListener=null}var ip=(op.prototype.getToken=function(){var t=this;jr(null!=this.tokenListener,"getToken cannot be called after listener removed.");var e=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.app.INTERNAL.getToken(n).then((function(n){if(t.tokenCounter!==e)throw new Hr(Qr.ABORTED,"getToken aborted due to token change.");return n?(jr("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new ep(n.accessToken,t.currentUser)):null}))},op.prototype.invalidateToken=function(){this.forceRefresh=!0},op.prototype.setChangeListener=function(t){jr(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,this.receivedInitialUser&&t(this.currentUser)},op.prototype.removeChangeListener=function(){jr(null!=this.tokenListener,"removeChangeListener() called twice"),jr(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},op.prototype.getUser=function(){var t=this.app.INTERNAL.getUid();return jr(null===t||"string"==typeof t,"Received invalid UID: "+t),new Sf(t)},op);function op(t){var e=this;this.app=t,this.tokenListener=null,this.currentUser=Sf.UNAUTHENTICATED,this.receivedInitialUser=!1,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){e.tokenCounter++,e.currentUser=e.getUser(),e.receivedInitialUser=!0,e.changeListener&&e.changeListener(e.currentUser)},this.tokenCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}var ap=(Object.defineProperty(sp.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.sessionIndex},e=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),sp);function sp(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=Sf.FIRST_PARTY}var up=(cp.prototype.getToken=function(){return Promise.resolve(new ap(this.gapi,this.sessionIndex))},cp.prototype.setChangeListener=function(t){t(Sf.FIRST_PARTY)},cp.prototype.removeChangeListener=function(){},cp.prototype.invalidateToken=function(){},cp);function cp(t,e){this.gapi=t,this.sessionIndex=e}function hp(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=e;r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t,["next","error","complete"])}var lp=(fp.delete=function(){return ni("FieldValue.delete",arguments),dp.instance},fp.serverTimestamp=function(){return ni("FieldValue.serverTimestamp",arguments),gp.instance},fp.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ii("FieldValue.arrayUnion",arguments,1),new _p(t)},fp.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ii("FieldValue.arrayRemove",arguments,1),new Ep(t)},fp.increment=function(t){return ai("FieldValue.increment","number",1,t),ri("FieldValue.increment",arguments,1),new Ip(t)},fp.prototype.isEqual=function(t){return this===t},fp);function fp(t){this._methodName=t}var pp,dp=(i(mp,pp=lp),mp.instance=new mp,mp);function mp(){return pp.call(this,"FieldValue.delete")||this}var yp,gp=(i(vp,yp=lp),vp.instance=new vp,vp);function vp(){return yp.call(this,"FieldValue.serverTimestamp")||this}var bp,_p=(i(wp,bp=lp),wp);function wp(t){var e=bp.call(this,"FieldValue.arrayUnion")||this;return e._elements=t,e}var Tp,Ep=(i(Sp,Tp=lp),Sp);function Sp(t){var e=Tp.call(this,"FieldValue.arrayRemove")||this;return e._elements=t,e}var Cp,Ip=(i(Ap,Cp=lp),Ap);function Ap(t){var e=Cp.call(this,"FieldValue.increment")||this;return e._operand=t,e}var Np=$r(lp,"Use FieldValue.<field>() instead."),kp=/^__.*__$/,Dp=(xp.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new Pa(t,this.data,this.fieldMask,e)):n.push(new Oa(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ua(t,this.fieldTransforms)),n},xp);function xp(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}var Op,Rp,Mp=(Pp.prototype.toMutations=function(t,e){var n=[new Pa(t,this.data,this.fieldMask,e)];return 0<this.fieldTransforms.length&&n.push(new Ua(t,this.fieldTransforms)),n},Pp);function Pp(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}function Lp(t){switch(t){case Op.Set:case Op.MergeSet:case Op.Update:return!0;case Op.Argument:case Op.ArrayArgument:return!1;default:throw Br("Unexpected case for UserDataSource: "+t)}}(Rp=Op=Op||{})[Rp.Set=0]="Set",Rp[Rp.Update=1]="Update",Rp[Rp.MergeSet=2]="MergeSet",Rp[Rp.Argument=3]="Argument",Rp[Rp.ArrayArgument=4]="ArrayArgument";var Fp=(Up.prototype.childContextForField=function(t){var e=null==this.path?null:this.path.child(t),n=new Up(this.dataSource,this.methodName,e,!1,this.fieldTransforms,this.fieldMask);return n.validatePathSegment(t),n},Up.prototype.childContextForFieldPath=function(t){var e=null==this.path?null:this.path.child(t),n=new Up(this.dataSource,this.methodName,e,!1,this.fieldTransforms,this.fieldMask);return n.validatePath(),n},Up.prototype.childContextForArray=function(t){return new Up(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},Up.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new Hr(Qr.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},Up.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},Up.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},Up.prototype.validatePathSegment=function(t){if(0===t.length)throw this.createError("Document fields must not be empty");if(Lp(this.dataSource)&&kp.test(t))throw this.createError('Document fields cannot begin and end with "__"')},Up);function Up(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}var qp=function(t,e){this.databaseId=t,this.key=e},Vp=(Bp.prototype.parseSetData=function(t,e){var n=new Fp(Op.Set,t,zi.EMPTY_PATH);Wp("Data must be an object, but it was:",n,e);var r=this.parseData(e,n);return new Dp(r,null,n.fieldTransforms)},Bp.prototype.parseMergeData=function(t,e,n){var r=new Fp(Op.MergeSet,t,zi.EMPTY_PATH);Wp("Data must be an object, but it was:",r,e);var i,o,a=this.parseData(e,r);if(n){for(var s=new Eo(zi.comparator),u=0,c=n;u<c.length;u++){var h=c[u],l=void 0;if(h instanceof Jf)l=h._internalPath;else{if("string"!=typeof h)throw Br("Expected stringOrFieldPath to be a string or a FieldPath");l=zp(t,h)}if(!r.contains(l))throw new Hr(Qr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");s=s.add(l)}i=_a.fromSet(s),o=r.fieldTransforms.filter((function(t){return i.covers(t.field)}))}else i=_a.fromArray(r.fieldMask),o=r.fieldTransforms;return new Dp(a,i,o)},Bp.prototype.parseUpdateData=function(t,e){var n=this,r=new Fp(Op.Update,t,zi.EMPTY_PATH);Wp("Data must be an object, but it was:",r,e);var i=new Eo(zi.comparator),o=Os.EMPTY;ti(e,(function(e,a){var s=zp(t,e),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof dp)i=i.add(s);else{var c=n.parseData(a,u);null!=c&&(i=i.add(s),o=o.set(s,c))}}));var a=_a.fromSet(i);return new Mp(o,a,r.fieldTransforms)},Bp.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new Fp(Op.Update,t,zi.EMPTY_PATH),o=[Kp(t,e)],a=[n];if(r.length%2!=0)throw new Hr(Qr.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(Kp(t,r[s])),a.push(r[s+1]);var u=new Eo(zi.comparator),c=Os.EMPTY;for(s=0;s<o.length;++s){var h=o[s],l=i.childContextForFieldPath(h),f=this.runPreConverter(a[s],l);if(f instanceof dp)u=u.add(h);else{var p=this.parseData(f,l);null!=p&&(u=u.add(h),c=c.set(h,p))}}var d=_a.fromSet(u);return new Mp(c,d,i.fieldTransforms)},Bp.prototype.parseQueryValue=function(t,e,n){void 0===n&&(n=!1);var r=new Fp(n?Op.ArrayArgument:Op.Argument,t,zi.EMPTY_PATH),i=this.parseData(e,r);return jr(null!=i,"Parsed data should not be null."),jr(0===r.fieldTransforms.length,"Field transforms should have been disallowed."),i},Bp.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(t){var n=Gp(t);throw e.createError(n)}},Bp.prototype.parseData=function(t,e){if(jp(t=this.runPreConverter(t,e)))return Wp("Unsupported field value:",e,t),this.parseObject(t,e);if(t instanceof lp)return this.parseSentinelFieldValue(t,e),null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.arrayElement&&e.dataSource!==Op.ArrayArgument)throw e.createError("Nested arrays are not supported");return this.parseArray(t,e)}return this.parseScalarValue(t,e)},Bp.prototype.parseObject=function(t,e){var n=this,r=new mo(Ei);return ei(t)?e.path&&0<e.path.length&&e.fieldMask.push(e.path):ti(t,(function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))})),new Os(r)},Bp.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=o[i],s=this.parseData(a,e.childContextForArray(r));null==s&&(s=Ja.INSTANCE),n.push(s),r++}return new Ps(n)},Bp.prototype.parseSentinelFieldValue=function(t,e){if(!Lp(e.dataSource))throw e.createError(t._methodName+"() can only be used with update() and set()");if(null===e.path)throw e.createError(t._methodName+"() is not currently supported inside arrays");if(t instanceof dp){if(e.dataSource!==Op.MergeSet)throw e.dataSource===Op.Update?(jr(0<e.path.length,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data")):e.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.fieldMask.push(e.path)}else if(t instanceof gp)e.fieldTransforms.push(new Ta(e.path,ql.instance));else if(t instanceof _p){var n=this.parseArrayTransformElements(t._methodName,t._elements),r=new Bl(n);e.fieldTransforms.push(new Ta(e.path,r))}else if(t instanceof Ep){n=this.parseArrayTransformElements(t._methodName,t._elements);var i=new Wl(n);e.fieldTransforms.push(new Ta(e.path,i))}else if(t instanceof Ip){var o=this.parseQueryValue("FieldValue.increment",t._operand),a=new zl(o);e.fieldTransforms.push(new Ta(e.path,a))}else Br("Unknown FieldValue type: "+t)},Bp.prototype.parseScalarValue=function(t,e){if(null===t)return Ja.INSTANCE;if("number"==typeof t)return th(t)?new us(t):new ls(t);if("boolean"==typeof t)return es.of(t);if("string"==typeof t)return new ds(t);if(t instanceof Date)return new gs(ho.fromDate(t));if(t instanceof ho)return new gs(new ho(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof nl)return new ks(t);if(t instanceof Ni)return new Es(t);if(t instanceof qp)return new Is(t.databaseId,t.key);throw e.createError("Unsupported field value: "+di(t))},Bp.prototype.parseArrayTransformElements=function(t,e){var n=this;return e.map((function(e,r){var i=new Fp(Op.Argument,t,zi.EMPTY_PATH);return n.parseData(e,i.childContextForArray(r))}))},Bp);function Bp(t){this.preConverter=t}function jp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ho||t instanceof nl||t instanceof Ni||t instanceof qp||t instanceof lp)}function Wp(t,e,n){if(!jp(n)||!pi(n)){var r=di(n);throw"an object"===r?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Kp(t,e){if(e instanceof Jf)return e._internalPath;if("string"==typeof e)return zp(t,e);throw new Hr(Qr.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function zp(t,e){try{return function(t){if(0<=t.search(tp))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Jf.bind.apply(Jf,h([void 0],t.split("."))))}catch(e){throw new Hr(Qr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e)._internalPath}catch(e){var n=Gp(e);throw new Hr(Qr.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Gp(t){return t instanceof Error?t.message:t.toString()}var Qp=Zu.COLLECTION_DISABLED,Hp=(Yp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},Yp);function Yp(t){if(void 0===t.host){if(void 0!==t.ssl)throw new Hr(Qr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ui("settings","non-empty string","host",t.host),this.host=t.host,ci("settings","boolean","ssl",t.ssl),this.ssl=Jr(t.ssl,!0);if(yi("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),ci("settings","object","credentials",t.credentials),this.credentials=t.credentials,ci("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?qr("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===t.timestampsInSnapshots&&qr("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=Jr(t.timestampsInSnapshots,!0),ci("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Zu.DEFAULT_CACHE_SIZE_BYTES;else{if(t.cacheSizeBytes!==Qp&&t.cacheSizeBytes<Zu.MINIMUM_CACHE_SIZE_BYTES)throw new Hr(Qr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Zu.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=t.cacheSizeBytes}ci("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}var $p=(Xp.prototype.settings=function(t){if(ri("Firestore.settings",arguments,1),ai("Firestore.settings","object",1,t),Xr(t,"persistence"))throw new Hr(Qr.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new Hp(t);if(this._firestoreClient&&!this._settings.isEqual(e))throw new Hr(Qr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this._settings=e).credentials&&(this._credentials=function(t){if(!t)return new np;switch(t.type){case"gapi":var e=t.client;return jr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new up(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Hr(Qr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Xp.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},Xp.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},Xp.prototype.enablePersistence=function(t){if(this._firestoreClient)throw new Hr(Qr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1;return t&&(void 0!==t.experimentalTabSynchronization&&qr("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),e=Jr(void 0!==t.synchronizeTabs?t.synchronizeTabs:t.experimentalTabSynchronization,!1)),this.configureClient(new zf(this._settings.cacheSizeBytes,e))},Xp.prototype.clearPersistence=function(){var t=this,e=pc.buildStoragePrefix(this.makeDatabaseInfo()),n=new Xi;return this._queue.enqueueAndForgetEvenAfterShutdown((function(){return u(t,void 0,void 0,(function(){var t;return c(this,(function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),void 0!==this._firestoreClient&&!this._firestoreClient.clientTerminated)throw new Hr(Qr.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return[4,pc.clearPersistence(e)];case 1:return r.sent(),n.resolve(),[3,3];case 2:return t=r.sent(),n.reject(t),[3,3];case 3:return[2]}}))}))})),n.promise},Xp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Xp.prototype,"_isTerminated",{get:function(){return this.ensureClientConfigured(),this._firestoreClient.clientTerminated},enumerable:!0,configurable:!0}),Xp.prototype.waitForPendingWrites=function(){return this.ensureClientConfigured(),this._firestoreClient.waitForPendingWrites()},Xp.prototype.onSnapshotsInSync=function(t){if(this.ensureClientConfigured(),hp(t))return this.onSnapshotsInSyncInternal(t);ai("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.onSnapshotsInSyncInternal(e)},Xp.prototype.onSnapshotsInSyncInternal=function(t){var e=this,n=new $f({next:function(){t.next&&t.next()},error:function(t){throw Br("Uncaught Error in onSnapshotsInSync")}});return this._firestoreClient.addSnapshotsInSyncListener(n),function(){n.mute(),e._firestoreClient.removeSnapshotsInSyncListener(n)}},Xp.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new Qf),this._firestoreClient},Xp.prototype.makeDatabaseInfo=function(){return new xi(this._databaseId,this._persistenceKey,this._settings.host,this._settings.ssl,this._settings.forceLongPolling)},Xp.prototype.configureClient=function(t){jr(!!this._settings.host,"FirestoreSettings.host is not set"),jr(!this._firestoreClient,"configureClient() called multiple times");var e=this.makeDatabaseInfo();return this._firestoreClient=new Hf(Wr.getPlatform(),e,this._credentials,this._queue),this._firestoreClient.start(t)},Xp.prototype.createDataConverter=function(t){return new Vp((function(e){if(e instanceof nd){var n=t,r=e.firestore._databaseId;if(!r.isEqual(n))throw new Hr(Qr.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new qp(t,e._key)}return e}))},Xp.databaseIdFromApp=function(t){var e=t.options;if(!Xr(e,"projectId"))throw new Hr(Qr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=e.projectId;if(!n||"string"!=typeof n)throw new Hr(Qr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ri(n)},Object.defineProperty(Xp.prototype,"app",{get:function(){if(!this._firebaseApp)throw new Hr(Qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._firebaseApp},enumerable:!0,configurable:!0}),Xp.prototype.collection=function(t){return ri("Firestore.collection",arguments,1),ai("Firestore.collection","non-empty string",1,t),this.ensureClientConfigured(),new yd(Bi.fromString(t),this)},Xp.prototype.doc=function(t){return ri("Firestore.doc",arguments,1),ai("Firestore.doc","non-empty string",1,t),this.ensureClientConfigured(),nd.forPath(Bi.fromString(t),this)},Xp.prototype.collectionGroup=function(t){if(ri("Firestore.collectionGroup",arguments,1),ai("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ensureClientConfigured(),new ld(new ul(Bi.EMPTY_PATH,t),this)},Xp.prototype.runTransaction=function(t){var e=this;return ri("Firestore.runTransaction",arguments,1),ai("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction((function(n){return t(new Jp(e,n))}))},Xp.prototype.batch=function(){return this.ensureClientConfigured(),new td(this)},Object.defineProperty(Xp,"logLevel",{get:function(){switch(Lr()){case Ir.DEBUG:return"debug";case Ir.ERROR:return"error";case Ir.SILENT:return"silent";default:return Br("Unknown log level: "+Lr())}},enumerable:!0,configurable:!0}),Xp.setLogLevel=function(t){switch(ri("Firestore.setLogLevel",arguments,1),ai("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":Fr(Ir.DEBUG);break;case"error":Fr(Ir.ERROR);break;case"silent":Fr(Ir.SILENT);break;default:throw new Hr(Qr.INVALID_ARGUMENT,"Invalid log level: "+t)}},Xp.prototype._areTimestampsInSnapshotsEnabled=function(){return this._settings.timestampsInSnapshots},Xp);function Xp(t){var e=this;if(this._firebaseApp=null,this._queue=new to,this.INTERNAL={delete:function(){return u(e,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return this.ensureClientConfigured(),[4,this._firestoreClient.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof t.options){var n=t;this._firebaseApp=n,this._databaseId=Xp.databaseIdFromApp(n),this._persistenceKey=n.name,this._credentials=new ip(n)}else{var r=t;if(!r.projectId)throw new Hr(Qr.INVALID_ARGUMENT,"Must provide projectId");this._databaseId=new Ri(r.projectId,r.database),this._persistenceKey="[DEFAULT]",this._credentials=new np}this._settings=new Hp({}),this._dataConverter=this.createDataConverter(this._databaseId)}var Jp=(Zp.prototype.get=function(t){var e=this;ri("Transaction.get",arguments,1);var n=wd("Transaction.get",t,this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Br("Mismatch in docs returned from document lookup.");var r=t[0];if(r instanceof Ws)return new ad(e._firestore,n._key,null,!1,!1);if(r instanceof Vs)return new ad(e._firestore,n._key,r,!1,!1);throw Br("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)}))},Zp.prototype.set=function(t,e,n){oi("Transaction.set",arguments,2,3);var r=wd("Transaction.set",t,this._firestore),i=(n=vd("Transaction.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("Transaction.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("Transaction.set",e);return this._transaction.set(r._key,i),this},Zp.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return i="string"==typeof e||e instanceof Jf?(ii("Transaction.update",arguments,3),r=wd("Transaction.update",t,this._firestore),this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",e,n,o)):(ri("Transaction.update",arguments,2),r=wd("Transaction.update",t,this._firestore),this._firestore._dataConverter.parseUpdateData("Transaction.update",e)),this._transaction.update(r._key,i),this},Zp.prototype.delete=function(t){ri("Transaction.delete",arguments,1);var e=wd("Transaction.delete",t,this._firestore);return this._transaction.delete(e._key),this},Zp);function Zp(t,e){this._firestore=t,this._transaction=e}var td=(ed.prototype.set=function(t,e,n){oi("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=wd("WriteBatch.set",t,this._firestore),i=(n=vd("WriteBatch.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("WriteBatch.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("WriteBatch.set",e);return this._mutations=this._mutations.concat(i.toMutations(r._key,Aa.NONE)),this},ed.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.verifyNotCommitted(),i="string"==typeof e||e instanceof Jf?(ii("WriteBatch.update",arguments,3),r=wd("WriteBatch.update",t,this._firestore),this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,o)):(ri("WriteBatch.update",arguments,2),r=wd("WriteBatch.update",t,this._firestore),this._firestore._dataConverter.parseUpdateData("WriteBatch.update",e)),this._mutations=this._mutations.concat(i.toMutations(r._key,Aa.exists(!0))),this},ed.prototype.delete=function(t){ri("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=wd("WriteBatch.delete",t,this._firestore);return this._mutations=this._mutations.concat(new za(e._key,Aa.NONE)),this},ed.prototype.commit=function(){return u(this,void 0,void 0,(function(){return c(this,(function(t){return this.verifyNotCommitted(),this._committed=!0,0<this._mutations.length?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]}))}))},ed.prototype.verifyNotCommitted=function(){if(this._committed)throw new Hr(Qr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},ed);function ed(t){this._firestore=t,this._mutations=[],this._committed=!1}var nd=(rd.forPath=function(t,e){if(t.length%2!=0)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new rd(new Qi(t),e)},Object.defineProperty(rd.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(rd.prototype,"parent",{get:function(){return new yd(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(rd.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),rd.prototype.collection=function(t){if(ri("DocumentReference.collection",arguments,1),ai("DocumentReference.collection","non-empty string",1,t),!t)throw new Hr(Qr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Bi.fromString(t);return new yd(this._key.path.child(e),this.firestore)},rd.prototype.isEqual=function(t){if(!(t instanceof rd))throw gi("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this._key.isEqual(t._key)},rd.prototype.set=function(t,e){oi("DocumentReference.set",arguments,1,2);var n=(e=vd("DocumentReference.set",e)).merge||e.mergeFields?this.firestore._dataConverter.parseMergeData("DocumentReference.set",t,e.mergeFields):this.firestore._dataConverter.parseSetData("DocumentReference.set",t);return this._firestoreClient.write(n.toMutations(this._key,Aa.NONE))},rd.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Jf?(ii("DocumentReference.update",arguments,2),this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,r)):(ri("DocumentReference.update",arguments,1),this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this._firestoreClient.write(n.toMutations(this._key,Aa.exists(!0)))},rd.prototype.delete=function(){return ri("DocumentReference.delete",arguments,0),this._firestoreClient.write([new za(this._key,Aa.NONE)])},rd.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];oi("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||hp(t[i])||(yi("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),ci("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return n=hp(t[i])?t[i]:(ai("DocumentReference.onSnapshot","function",i,t[i]),si("DocumentReference.onSnapshot","function",i+1,t[i+1]),si("DocumentReference.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},rd.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new $f({next:function(t){if(e.next){jr(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n._key);e.next(new ad(n.firestore,n._key,r,t.fromCache,t.hasPendingWrites))}},error:r}),o=this._firestoreClient.listen(ul.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},rd.prototype.get=function(t){var e=this;return oi("DocumentReference.get",arguments,0,1),_d("DocumentReference.get",t),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentFromLocalCache(e._key).then((function(t){n(new ad(e.firestore,e._key,t,!0,t instanceof Vs&&t.hasLocalMutations))}),r):e.getViaSnapshotListener(n,r,t)}))},rd.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new Hr(Qr.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new Hr(Qr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},rd);function rd(t,e){this._key=t,this.firestore=e,this._firestoreClient=this.firestore.ensureClientConfigured()}var id=(od.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},od);function od(t,e){this.hasPendingWrites=t,this.fromCache=e}var ad=(sd.prototype.data=function(t){return oi("DocumentSnapshot.data",arguments,0,1),t=bd("DocumentSnapshot.data",t),this._document?this.convertObject(this._document.data(),Qa.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},sd.prototype.get=function(t,e){if(oi("DocumentSnapshot.get",arguments,1,2),e=bd("DocumentSnapshot.get",e),this._document){var n=this._document.data().field(Kp("DocumentSnapshot.get",t));if(null!==n)return this.convertValue(n,Qa.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(sd.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(sd.prototype,"ref",{get:function(){return new nd(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(sd.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(sd.prototype,"metadata",{get:function(){return new id(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),sd.prototype.isEqual=function(t){if(!(t instanceof sd))throw gi("isEqual","DocumentSnapshot",1,t);return this._firestore===t._firestore&&this._fromCache===t._fromCache&&this._key.isEqual(t._key)&&(null===this._document?null===t._document:this._document.isEqual(t._document))},sd.prototype.convertObject=function(t,e){var n=this,r={};return t.forEach((function(t,i){r[t]=n.convertValue(i,e)})),r},sd.prototype.convertValue=function(t,e){if(t instanceof Os)return this.convertObject(t,e);if(t instanceof Ps)return this.convertArray(t,e);if(t instanceof Is){var n=t.value(e),r=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.isEqual(r)||qr("Document "+this._key.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new nd(n,this._firestore)}return t.value(e)},sd.prototype.convertArray=function(t,e){var n=this;return t.internalValue.map((function(t){return n.convertValue(t,e)}))},sd);function sd(t,e,n,r,i){this._firestore=t,this._key=e,this._document=n,this._fromCache=r,this._hasPendingWrites=i}var ud,cd=(i(hd,ud=ad),hd.prototype.data=function(t){var e=ud.prototype.data.call(this,t);return jr("object"==typeof e,"Document in a QueryDocumentSnapshot should exist"),e},hd);function hd(){return null!==ud&&ud.apply(this,arguments)||this}var ld=(fd.prototype.where=function(t,e,n){var r;ri("Query.where",arguments,3),mi("Query.where",3,n),function(t,e,n,r){if(!e.some((function(t){return t===r})))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid value "+di(r)+" provided to function "+t+"() for its "+bi(n)+" argument. Acceptable values: "+e.join(", "))}("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var i=Kp("Query.where",t),o=ll.fromString(e);if(i.isKeyField()){if(o===ll.ARRAY_CONTAINS||o===ll.ARRAY_CONTAINS_ANY)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o.toString()+"' queries on FieldPath.documentId().");if(o===ll.IN){this.validateDisjunctiveFilterElements(n,o);for(var a=[],s=0,u=n;s<u.length;s++){var c=u[s];a.push(this.parseDocumentIdValue(c))}r=new Ps(a)}else r=this.parseDocumentIdValue(n)}else o!==ll.IN&&o!==ll.ARRAY_CONTAINS_ANY||this.validateDisjunctiveFilterElements(n,o),r=this.firestore._dataConverter.parseQueryValue("Query.where",n,o===ll.IN);var h=dl.create(i,o,r);return this.validateNewFilter(h),new fd(this._query.addFilter(h),this.firestore)},fd.prototype.orderBy=function(t,e){var n;if(oi("Query.orderBy",arguments,1,2),si("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n=xl.ASCENDING;else{if("desc"!==e)throw new Hr(Qr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n=xl.DESCENDING}if(null!==this._query.startAt)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var r=Kp("Query.orderBy",t),i=new Pl(r,n);return this.validateNewOrderBy(i),new fd(this._query.addOrderBy(i),this.firestore)},fd.prototype.limit=function(t){return ri("Query.limit",arguments,1),ai("Query.limit","number",1,t),vi("Query.limit",1,t),new fd(this._query.withLimitToFirst(t),this.firestore)},fd.prototype.limitToLast=function(t){return ri("Query.limitToLast",arguments,1),ai("Query.limitToLast","number",1,t),vi("Query.limitToLast",1,t),new fd(this._query.withLimitToLast(t),this.firestore)},fd.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ii("Query.startAt",arguments,1);var r=this.boundFromDocOrFields("Query.startAt",t,e,!0);return new fd(this._query.withStartAt(r),this.firestore)},fd.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ii("Query.startAfter",arguments,1);var r=this.boundFromDocOrFields("Query.startAfter",t,e,!1);return new fd(this._query.withStartAt(r),this.firestore)},fd.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ii("Query.endBefore",arguments,1);var r=this.boundFromDocOrFields("Query.endBefore",t,e,!0);return new fd(this._query.withEndAt(r),this.firestore)},fd.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ii("Query.endAt",arguments,1);var r=this.boundFromDocOrFields("Query.endAt",t,e,!1);return new fd(this._query.withEndAt(r),this.firestore)},fd.prototype.isEqual=function(t){if(!(t instanceof fd))throw gi("isEqual","Query",1,t);return this.firestore===t.firestore&&this._query.isEqual(t._query)},fd.prototype.boundFromDocOrFields=function(t,e,n,r){if(mi(t,1,e),e instanceof ad){if(0<n.length)throw new Hr(Qr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new Hr(Qr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},fd.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new Is(this.firestore._databaseId,e.key));else{var s=e.field(a.field);if(s instanceof _s)throw new Hr(Qr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=a.field.canonicalString();throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new Rl(r,n)},fd.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new Hr(Qr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var a=e[o];if(r[o].field.isKeyField()){if("string"!=typeof a)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof a);if(!this._query.isCollectionGroupQuery()&&-1!==a.indexOf("/"))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+a+"' contains a slash.");var s=this._query.path.child(Bi.fromString(a));if(!Qi.isDocumentKey(s))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+s+"' is not because it contains an odd number of segments.");var u=new Qi(s);i.push(new Is(this.firestore._databaseId,u))}else{var c=this.firestore._dataConverter.parseQueryValue(t,a);i.push(c)}}return new Rl(i,n)},fd.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];oi("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||hp(t[i])||(yi("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),ci("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),n=hp(t[i])?t[i]:(ai("Query.onSnapshot","function",i,t[i]),si("Query.onSnapshot","function",i+1,t[i+1]),si("Query.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.validateHasExplicitOrderByForLimitToLast(this._query),this.onSnapshotInternal(r,n)},fd.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new $f({next:function(t){e.next&&e.next(new pd(n.firestore,n._query,t))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(a)}},fd.prototype.validateHasExplicitOrderByForLimitToLast=function(t){if(t.hasLimitToLast()&&0===t.explicitOrderBy.length)throw new Hr(Qr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},fd.prototype.get=function(t){var e=this;return oi("Query.get",arguments,0,1),_d("Query.get",t),this.validateHasExplicitOrderByForLimitToLast(this._query),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentsFromLocalCache(e._query).then((function(t){n(new pd(e.firestore,e._query,t))}),r):e.getViaSnapshotListener(n,r,t)}))},fd.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new Hr(Qr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},fd.prototype.parseDocumentIdValue=function(t){if("string"==typeof t){if(""===t)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this._query.isCollectionGroupQuery()&&-1!==t.indexOf("/"))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this._query.path.child(Bi.fromString(t));if(!Qi.isDocumentKey(e))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return new Is(this.firestore._databaseId,new Qi(e))}if(t instanceof nd){var n=t;return new Is(this.firestore._databaseId,n._key)}throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+di(t)+".")},fd.prototype.validateDisjunctiveFilterElements=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter((function(t){return Number.isNaN(t)})).length)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},fd.prototype.validateNewFilter=function(t){if(t instanceof dl){var e=[ll.ARRAY_CONTAINS,ll.ARRAY_CONTAINS_ANY],n=[ll.IN,ll.ARRAY_CONTAINS_ANY],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.isInequality()){var o=this._query.getInequalityFilterField();if(null!==o&&!o.isEqual(t.field))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var a=this._query.getFirstOrderByField();null!==a&&this.validateOrderByAndInequalityMatch(t.field,a)}else if(i||r){var s=null;if(i&&(s=this._query.findFilterOperator(n)),null===s&&r&&(s=this._query.findFilterOperator(e)),null!=s)throw s===t.op?new Hr(Qr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Hr(Qr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+s.toString()+"' filters.")}}},fd.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},fd.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.isEqual(t))throw new Hr(Qr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},fd);function fd(t,e){this._query=t,this.firestore=e}var pd=(Object.defineProperty(dd.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!0,configurable:!0}),Object.defineProperty(dd.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(dd.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),dd.prototype.forEach=function(t,e){var n=this;oi("QuerySnapshot.forEach",arguments,1,2),ai("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach((function(r){t.call(e,n.convertToDocumentImpl(r))}))},Object.defineProperty(dd.prototype,"query",{get:function(){return new ld(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),dd.prototype.docChanges=function(t){t&&(yi("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ci("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this._snapshot.excludesMetadataChanges)throw new Hr(Qr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e,n){if(n.oldDocs.isEmpty()){var r,i=0;return n.docChanges.map((function(e){var o=new cd(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key));return jr(e.type===Nh.Added,"Invalid event type for first snapshot"),jr(!r||n.query.docComparator(r,e.doc)<0,"Got added events in wrong order"),r=e.doc,{type:"added",doc:o,oldIndex:-1,newIndex:i++}}))}var o=n.oldDocs;return n.docChanges.filter((function(t){return e||t.type!==Nh.Metadata})).map((function(e){var r=new cd(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key)),i=-1,a=-1;return e.type!==Nh.Added&&(jr(0<=(i=o.indexOf(e.doc.key)),"Index for document not found"),o=o.delete(e.doc.key)),e.type!==Nh.Removed&&(a=(o=o.add(e.doc)).indexOf(e.doc.key)),{type:function(t){switch(t){case Nh.Added:return"added";case Nh.Modified:case Nh.Metadata:return"modified";case Nh.Removed:return"removed";default:return Br("Unknown change type: "+t)}}(e.type),doc:r,oldIndex:i,newIndex:a}}))}(this._firestore,e,this._snapshot),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},dd.prototype.isEqual=function(t){if(!(t instanceof dd))throw gi("isEqual","QuerySnapshot",1,t);return this._firestore===t._firestore&&this._originalQuery.isEqual(t._originalQuery)&&this._snapshot.isEqual(t._snapshot)},dd.prototype.convertToDocumentImpl=function(t){return new cd(this._firestore,t.key,t,this.metadata.fromCache,this._snapshot.mutatedKeys.has(t.key))},dd);function dd(t,e,n){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new id(n.hasPendingWrites,n.fromCache)}h(["length","forEach","map"],"undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach((function(t){try{Object.defineProperty(pd.prototype.docChanges,t,{get:function(){return function(){throw new Hr(Qr.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(t){}}));var md,yd=(i(gd,md=ld),Object.defineProperty(gd.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(gd.prototype,"parent",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new nd(new Qi(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(gd.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),gd.prototype.doc=function(t){if(oi("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=wi.newId()),ai("CollectionReference.doc","non-empty string",1,t),""===t)throw new Hr(Qr.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=Bi.fromString(t);return nd.forPath(this._query.path.child(e),this.firestore)},gd.prototype.add=function(t){ri("CollectionReference.add",arguments,1),ai("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then((function(){return e}))},gd);function gd(t,e){var n=md.call(this,ul.atPath(t),e)||this;if(t.length%2!=1)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.canonicalString()+" has "+t.length);return n}function vd(t,e){if(void 0===e)return{merge:!1};if(yi(t,e,["merge","mergeFields"]),ci(t,"boolean","merge",e.merge),hi(t,"mergeFields","a string or a FieldPath",e.mergeFields,(function(t){return"string"==typeof t||t instanceof Jf})),void 0!==e.mergeFields&&void 0!==e.merge)throw new Hr(Qr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function bd(t,e){return void 0===e?{}:(yi(t,e,["serverTimestamps"]),li(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function _d(t,e){si(t,"object",1,e),e&&(yi(t,e,["source"]),li(t,0,"source",e.source,["default","server","cache"]))}function wd(t,e,n){if(e instanceof nd){if(e.firestore!==n)throw new Hr(Qr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw gi(t,"DocumentReference",1,e)}var Td=$r($p,"Use firebase.firestore() instead."),Ed=$r(Jp,"Use firebase.firestore().runTransaction() instead."),Sd=$r(td,"Use firebase.firestore().batch() instead."),Cd=$r(nd,"Use firebase.firestore().doc() instead."),Id=$r(ad),Ad=$r(cd),Nd=$r(ld),kd=$r(pd),Dd=$r(yd,"Use firebase.firestore().collection() instead."),xd={Firestore:Td,GeoPoint:nl,Timestamp:ho,Blob:Di,Transaction:Ed,WriteBatch:Sd,DocumentReference:Cd,DocumentSnapshot:Id,Query:Nd,QueryDocumentSnapshot:Ad,QuerySnapshot:kd,CollectionReference:Dd,FieldPath:Jf,FieldValue:Np,setLogLevel:$p.setLogLevel,CACHE_SIZE_UNLIMITED:Qp};function Od(t){t.INTERNAL.registerService("firestore",(function(t){return new $p(t)}),function(t){jr(t&&"object"==typeof t,"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}(xd))}var Rd=(Md.prototype.addCallback=function(t){},Md.prototype.shutdown=function(){},Md);function Md(){}var Pd="ConnectivityMonitor",Ld=(Fd.prototype.addCallback=function(t){this.callbacks.push(t)},Fd.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},Fd.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},Fd.prototype.onNetworkAvailable=function(){Ur(Pd,"Network connectivity changed: AVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++)(0,e[t])(0)},Fd.prototype.onNetworkUnavailable=function(){Ur(Pd,"Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++)(0,e[t])(1)},Fd.isAvailable=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Fd);function Fd(){var t=this;this.networkAvailableListener=function(){return t.onNetworkAvailable()},this.networkUnavailableListener=function(){return t.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}var Ud=(qd.prototype.onOpen=function(t){jr(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},qd.prototype.onClose=function(t){jr(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},qd.prototype.onMessage=function(t){jr(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},qd.prototype.close=function(){this.closeFn()},qd.prototype.send=function(t){this.sendFn(t)},qd.prototype.callOnOpen=function(){jr(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},qd.prototype.callOnClose=function(t){jr(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},qd.prototype.callOnMessage=function(t){jr(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},qd);function qd(t){this.sendFn=t.sendFn,this.closeFn=t.closeFn}var Vd="Connection",Bd={BatchGetDocuments:"batchGet",Commit:"commit"},jd="gl-js/ fire/"+Mr,Wd=(Kd.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=jd},Kd.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise((function(o,a){var u=new Rr;u.listenOnce(xr.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case Dr.NO_ERROR:var e=u.getResponseJson();Ur(Vd,"XHR received:",JSON.stringify(e)),o(e);break;case Dr.TIMEOUT:Ur(Vd,'RPC "'+t+'" timed out'),a(new Hr(Qr.DEADLINE_EXCEEDED,"Request time out"));break;case Dr.HTTP_ERROR:var n=u.getStatus();if(Ur(Vd,'RPC "'+t+'" failed with status:',n,"response text:",u.getResponseText()),0<n){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var i=function(t){var e=t.toLowerCase().replace("_","-");return 0<=Object.values(Qr).indexOf(e)?e:Qr.UNKNOWN}(r.status);a(new Hr(i,r.message))}else a(new Hr(Qr.UNKNOWN,"Server responded with status "+u.getStatus()))}else Ur(Vd,'RPC "'+t+'" failed'),a(new Hr(Qr.UNAVAILABLE,"Connection failed."));break;default:Br('RPC "'+t+'" failed with unanticipated webchannel error '+u.getLastErrorCode()+": "+u.getLastError()+", giving up.")}}finally{Ur(Vd,'RPC "'+t+'" completed.')}}));var c=s({},e);delete c.database;var h=JSON.stringify(c);Ur(Vd,"XHR sending: ",i+" "+h);var l={"Content-Type":"text/plain"};r.modifyHeadersForRequest(l,n),u.send(i,"POST",h,l,15)}))},Kd.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},Kd.prototype.openStream=function(t,e){var n=[this.baseUrl,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=kr(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.modifyHeadersForRequest(i.initMessageHeaders,e),"object"==typeof navigator&&"ReactNative"===navigator.product||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");function a(t,e){s.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))}Ur(Vd,"Creating WebChannel: "+o+" "+i);var s=r.createWebChannel(o,i),u=!1,c=!1,h=new Ud({sendFn:function(t){c?Ur(Vd,"Not sending because WebChannel is closed:",t):(u||(Ur(Vd,"Opening WebChannel transport."),s.open(),u=!0),Ur(Vd,"WebChannel sending:",t),s.send(t))},closeFn:function(){return s.close()}});return a(Or.EventType.OPEN,(function(){c||Ur(Vd,"WebChannel transport opened.")})),a(Or.EventType.CLOSE,(function(){c||(c=!0,Ur(Vd,"WebChannel transport closed"),h.callOnClose())})),a(Or.EventType.ERROR,(function(t){c||(c=!0,Ur(Vd,"WebChannel transport errored:",t),h.callOnClose(new Hr(Qr.UNAVAILABLE,"The operation could not be completed")))})),a(Or.EventType.MESSAGE,(function(t){if(!c){var e=t.data[0];jr(!!e,"Got a webchannel message without data.");var n=e,r=n.error||n[0]&&n[0].error;if(r){Ur(Vd,"WebChannel received error:",r);var i=r.status,o=function(t){var e=Th[t];if(void 0!==e)return Ah(e)}(i),a=r.message;void 0===o&&(o=Qr.INTERNAL,a="Unknown error status: "+i+" with message "+r.message),c=!0,h.callOnClose(new Hr(o,a)),s.close()}else Ur(Vd,"WebChannel received:",e),h.callOnMessage(e)}})),setTimeout((function(){h.callOnOpen()}),0),h},Kd.prototype.makeUrl=function(t){var e=Bd[t];return jr(void 0!==e,"Unknown REST mapping for: "+t),this.baseUrl+"/v1/projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents:"+e},Kd);function Kd(t){this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.baseUrl=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}var zd=(Object.defineProperty(Gd.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(Gd.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),Gd.prototype.loadConnection=function(t){return Promise.resolve(new Wd(t))},Gd.prototype.newConnectivityMonitor=function(){return Ld.isAvailable()?new Ld:new Rd},Gd.prototype.newSerializer=function(t){return new rf(t,{useProto3Json:!0})},Gd.prototype.formatJSON=function(t){return JSON.stringify(t)},Gd.prototype.atob=function(t){return atob(t)},Gd.prototype.btoa=function(t){return btoa(t)},Gd);function Gd(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}Wr.setPlatform(new zd),Od(n)}).apply(this,arguments)}catch(r){throw console.error(r),new Error("Cannot instantiate firebase-firestore - be sure to load firebase-app.js first.")}}))}).call(this,n("c8ba"),n("4362"))},f1ae:function(t,e,n){"use strict";var r=n("86cc"),i=n("4630");t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},f410:function(t,e,n){n("1af6"),t.exports=n("584a").Array.isArray},f605:function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},f6b4:function(t,e,n){"use strict";var r=n("c532");function i(){this.handlers=[]}i.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},i.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},i.prototype.forEach=function(t){r.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=i},f751:function(t,e,n){var r=n("5ca1");r(r.S+r.F,"Object",{assign:n("7333")})},f772:function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},fa5b:function(t,e,n){t.exports=n("5537")("native-function-to-string",Function.toString)},fab2:function(t,e,n){var r=n("7726").document;t.exports=r&&r.documentElement},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-vendors.a8f71e80.js.map